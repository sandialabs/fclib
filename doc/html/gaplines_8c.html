<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: tools/gaplines.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>tools/gaplines.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Look at gaps by creatings lines connecting the surfaces of two meshes. 
<p>
<dl class="rcs" compact><dt><b>Source</b></dt><dd>/usr/local/Repositories/fcdmf/fclib/tools/gaplines.c,v </dd></dl>
<dl class="rcs" compact><dt><b>Revision</b></dt><dd>1.20 </dd></dl>
<dl class="rcs" compact><dt><b>Date</b></dt><dd>2006/09/28 06:34:39 </dd></dl>
<p>
<b>Description:</b> <p>
First have to figure out where gaps might happen -- i.e. find surfaces of different measures that initially are abutted. Then create lines (initially of 0 length) between the surfaces. If the lines lengthen when the meshes are deformed, then you have a gap.<p>
(In future, thinking of creating elements of zero volume so that we can better characterize number of volumes of gaps.)<p>
Input<ul>
<li>Two meshes &amp; their displacement seq vars</li><li>Min distance that points can be from each other and still be considered to be touching.</li></ul>
<p>
Assumptions:<ul>
<li>Meshes do not interpenetrate (more than some very small amount).</li><li>Faces are planar</li><li>Can determine adjacent surfaces from initial geometry information.</li></ul>
<p>
Algorithm:<ul>
<li>Get outside surfaces of each mesh - i.e. skin</li><li>For each mesh, find all vertices that are a) close to a skin face on the other mesh (close means than if you project the vertex to the face, it lies within or on boundary of face AND the distance along that projection is less than the min distance) and b) are in a skin face themselves that have the same orientation as the face on the other mesh. Keep track of the vertex, the faces on both meshes, and the parameterized location of the projected vertex within the face on the other mesh.</li><li>Create a new mesh which is lines from each vertex to the paramterized point in the corresponding face on the other mesh. (Line lengths should all be less than min distance chosen in 1.)</li><li>New! using Shapes, create subsets of the line mesh for each side-side grouping of gap lines.</li><li>Create displacement variable for the line mesh.</li><li>Create variable which is the average normal of the two faces the line connects</li></ul>
<p>
Output:<ul>
<li>Report #, and min, max, average and standard dev of line lengths per step for each set of lines and the overall set of lines. Also report normal and tangent components.</li><li>Write a gaplines dataset</li></ul>
<p>
/modifications:<ul>
<li>01/05 Created, WSK.</li><li>02/07/06 Had to update to changes in library.</li><li>06/12/2006 WSD Making into an official tool.</li><li>08/25/2006 WSD Adding normal &amp; tangent break down of gapline line lengths (with respect to face normals). Also added break down by sides using <a class="el" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a>.</li><li>08/31/2006 WSD Added ability to drop gap lines connected to dead elements. </li></ul>

<p>Definition in file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;<a class="el" href="fc_8h-source.html">fc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="fcP_8h-source.html">fcP.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for gaplines.c:</div>
<div class="dynsection">
<p><center><img src="gaplines_8c__incl.gif" border="0" usemap="#tools/gaplines.c_map" alt=""></center>
<map name="tools/gaplines.c_map">
<area shape="rect" href="fc_8h.html" title="Master header file for FCLib." alt="" coords="1311,84,1359,111"><area shape="rect" href="fcP_8h.html" title="Master header file for private members and functions of FCLib." alt="" coords="3215,84,3268,111"><area shape="rect" href="base_8h.html" title="Public declarations for Data Types, Data Interface, and Handles Modules." alt="" coords="2432,161,2501,188"><area shape="rect" href="storage_8h.html" title="Public declarations for Simple Data Objects Module." alt="" coords="5,161,93,188"><area shape="rect" href="library_8h.html" title="Public declarations for the Library Module." alt="" coords="117,161,195,188"><area shape="rect" href="dataset_8h.html" title="Public declarations for the Dataset Module." alt="" coords="219,161,307,188"><area shape="rect" href="sequence_8h.html" title="Public declarations for the Sequence Module." alt="" coords="331,161,435,188"><area shape="rect" href="mesh_8h.html" title="Public declarations for the Mesh Module." alt="" coords="459,161,533,188"><area shape="rect" href="subset_8h.html" title="Public declarations for Subset module." alt="" coords="557,161,637,188"><area shape="rect" href="variable_8h.html" title="Public declarations for Variable Module." alt="" coords="1771,161,1864,188"><area shape="rect" href="feature_8h.html" title="Public declarations for Features module." alt="" coords="1888,161,1976,188"><area shape="rect" href="shape_8h.html" title="Declarations for Shape module." alt="" coords="2000,161,2077,188"><area shape="rect" href="fileio_8h.html" title="Public declarations for File IO module." alt="" coords="3173,239,3243,265"><area shape="rect" href="error_8h.html" title="Declarations for Error Handling Module." alt="" coords="2152,161,2219,188"><area shape="rect" href="geom_8h.html" title="Public declarations for Geometric Relations module." alt="" coords="1344,161,1421,188"><area shape="rect" href="statistics_8h.html" title="Public declarations for Statistics Routines module." alt="" coords="1064,239,1160,265"><area shape="rect" href="sierra_8h.html" title="Public declarations for the Sierra module." alt="" coords="792,161,867,188"><area shape="rect" href="threshold_8h.html" title="Public declarations for Threshold module." alt="" coords="891,161,992,188"><area shape="rect" href="elemdeath_8h.html" title="Declarations for Element Death module." alt="" coords="1016,161,1131,188"><area shape="rect" href="series_8h.html" title="Public declarations for Series Routines module." alt="" coords="1155,161,1229,188"><area shape="rect" href="topo_8h.html" title="Public declarations for Topological Relations module." alt="" coords="1253,161,1320,188"><area shape="rect" href="util_8h.html" title="Public declarations for Utilities module." alt="" coords="661,161,717,188"><area shape="rect" href="track_8h.html" title="Declaration of tracking routines." alt="" coords="1445,161,1515,188"><area shape="rect" href="varmath_8h.html" title="Public declarations for Variable Math module." alt="" coords="1539,161,1635,188"><area shape="rect" href="custom_8h.html" title="Declarations for Custom module." alt="" coords="1659,161,1747,188"><area shape="rect" href="storageP_8h.html" title="Private declarations for Simple Data Objects Module." alt="" coords="2659,161,2752,188"><area shape="rect" href="tableP_8h.html" title="Private declarations for Table (Private) module." alt="" coords="3548,239,3625,265"><area shape="rect" href="libraryP_8h.html" title="Private declarations for the Library module." alt="" coords="2776,161,2861,188"><area shape="rect" href="datasetP_8h.html" title="Private declarations for the Dataset module." alt="" coords="3648,161,3741,188"><area shape="rect" href="fileioP_8h.html" title="Private declarations for File IO module." alt="" coords="3655,239,3729,265"><area shape="rect" href="sequenceP_8h.html" title="Private declarations for the Sequence module." alt="" coords="2525,161,2635,188"><area shape="rect" href="meshP_8h.html" title="Private declarations for the Mesh module." alt="" coords="3544,161,3624,188"><area shape="rect" href="subsetP_8h.html" title="Private declarations for the Subset module." alt="" coords="2885,161,2971,188"><area shape="rect" href="variableP_8h.html" title="Private declarations for Variable module." alt="" coords="3765,161,3864,188"><area shape="rect" href="geomP_8h.html" title="Private declarations for Geometric Relations module." alt="" coords="2995,161,3077,188"><area shape="rect" href="sierraP_8h.html" title="Priate declarations for the Sierra module." alt="" coords="3101,161,3181,188"><area shape="rect" href="topoP_8h.html" title="Private declarations for Topological Relations module." alt="" coords="3205,161,3277,188"><area shape="rect" href="varmathP_8h.html" title="Private declarations for Variable Math module." alt="" coords="3301,161,3403,188"><area shape="rect" href="featureP_8h.html" title="Private declarations for Features module." alt="" coords="3427,161,3520,188"><area shape="rect" href="lsdynaioP_8h.html" title="Private declarations for (Private LS&#45;Dyna IO) module." alt="" coords="3643,316,3741,343"></map>
</div>

<p>
<a href="gaplines_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#6fb18051e7cbacebf794269fbf48714b">parseDeathVarSet</a> (int argc, char **argv, int *idx, int *numvars, <a class="el" href="structdeathvarinfo.html">deathvarinfo</a> **deathvars)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#f865191f0e1fd8ecd8cd232821e20580">getMeshMaxEdgeLength</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, double *max_len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#27005c79076374896c4a7d0cdc296c34">calcFaceOrients</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int numFace, int *faceIDs, int **faceOrients)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#7b03c631227ee26e89bffeb4f23d711e">getLinesAsVectors</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> displVar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *lineVectors)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#231047ab582a6ce1c7fb2bb3c6c1164c">findShapeSide</a> (int faceID, int numShape, <a class="el" href="structFC__Shape.html">FC_Shape</a> *shapes, int *shapeID, int *sideID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#63631fd67e55ca221855533f3f1b2f41">getRemoveSIAIntersection</a> (<a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *sia1, <a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *sia2, <a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *sia3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#036046e3a36e4539ede49168d87695d6">isItDead</a> (int numDeathVar, <a class="el" href="structdeathvarinfo.html">deathvarinfo</a> *deathvarinfos, int id1, double **data1, int id2, double **data2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a> (char *title, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *lengthSeqVar, <a class="el" href="structFC__Subset.html">FC_Subset</a> *inputSubset, <a class="el" href="structFC__Subset.html">FC_Subset</a> *alivePerTime, double *seq_coords)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaplines_8c.html#3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="27005c79076374896c4a7d0cdc296c34"></a><!-- doxytag: member="gaplines.c::calcFaceOrients" ref="27005c79076374896c4a7d0cdc296c34" args="(FC_Mesh mesh, int numFace, int *faceIDs, int **faceOrients)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> calcFaceOrients           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numFace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>faceIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>faceOrients</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00190">190</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04509">_fc_getMeshElementParentsOfFacesPtr()</a>, <a class="el" href="base_8c-source.html#l00622">fc_getElementTypeNumFace()</a>, <a class="el" href="mesh_8c-source.html#l03952">fc_getMeshElementFaceOrientsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03880">fc_getMeshElementToFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03061">fc_getMeshElementType()</a>, <a class="el" href="mesh_8c-source.html#l03208">fc_getMeshNumFace()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00191"></a>00191                                                           {
<a name="l00192"></a>00192   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00193"></a>00193   <span class="keywordtype">int</span> i, j;
<a name="l00194"></a>00194   <span class="keywordtype">int</span> numTotalFace;
<a name="l00195"></a>00195   <span class="keywordtype">int</span> numFacePerElem, *elemToFaceConns;
<a name="l00196"></a>00196   <span class="keywordtype">int</span>* elemFaceOrients;
<a name="l00197"></a>00197   <span class="keywordtype">int</span>* numElemPerFace, **elemParentsPerFace;
<a name="l00198"></a>00198   <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemtype;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   <span class="comment">// gather info</span>
<a name="l00201"></a>00201   rc = <a class="code" href="group__Mesh.html#g8c619c146c0850895098f5dbfb487418" title="Get number of faces in a mesh.">fc_getMeshNumFace</a>(mesh, &amp;numTotalFace);
<a name="l00202"></a>00202   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00203"></a>00203     <span class="keywordflow">return</span> rc;
<a name="l00204"></a>00204   rc = <a class="code" href="group__Mesh.html#g1c1684ecf98e82a0ab18f7f9dbdddfc5" title="Returns type of elements in the mesh.">fc_getMeshElementType</a>(mesh, &amp;elemtype);
<a name="l00205"></a>00205   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00206"></a>00206     <span class="keywordflow">return</span> rc;
<a name="l00207"></a>00207   numFacePerElem = <a class="code" href="group__DataTypes.html#g1cffd2eb82ec74e749ca93a6cb623e4a" title="Returns number of faces in a type of element.">fc_getElementTypeNumFace</a>(elemtype);
<a name="l00208"></a>00208   rc = <a class="code" href="group__Mesh.html#g7f17910148b4237e84ca374845688cfc" title="Return element to face connectivities.">fc_getMeshElementToFaceConnsPtr</a>(mesh, &amp;elemToFaceConns);
<a name="l00209"></a>00209   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00210"></a>00210     <span class="keywordflow">return</span> rc;
<a name="l00211"></a>00211   rc = <a class="code" href="group__Mesh.html#gfcea3747b7482cb7317b2aa54e7b1f8c" title="Return element&amp;#39;s face&amp;#39;s orientations relative to global faces.">fc_getMeshElementFaceOrientsPtr</a>(mesh, &amp;elemFaceOrients);
<a name="l00212"></a>00212   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00213"></a>00213     <span class="keywordflow">return</span> rc;
<a name="l00214"></a>00214   rc = <a class="code" href="group__PrivateMesh.html#g540b5f94172bea7ef0e2fcf41bf42425" title="Return parent elements of the faces.">_fc_getMeshElementParentsOfFacesPtr</a>(mesh, &amp;numElemPerFace,
<a name="l00215"></a>00215                             &amp;elemParentsPerFace);
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00217"></a>00217     <span class="keywordflow">return</span> rc;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="comment">// do it</span>
<a name="l00220"></a>00220   *faceOrients = (<span class="keywordtype">int</span>*)malloc(numTotalFace*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00221"></a>00221   <span class="keywordflow">if</span> (!(*faceOrients))
<a name="l00222"></a>00222     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00223"></a>00223   <span class="keywordflow">for</span> (i = 0; i &lt; numFace; i++) {
<a name="l00224"></a>00224     <span class="keywordtype">int</span> elemID = elemParentsPerFace[faceIDs[i]][0];
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="keywordflow">for</span> (j = 0; j &lt; numFacePerElem; j++) {
<a name="l00227"></a>00227       <span class="keywordflow">if</span> (elemToFaceConns[elemID*numFacePerElem+j] == faceIDs[i]) {
<a name="l00228"></a>00228      (*faceOrients)[faceIDs[i]] = elemFaceOrients[elemID*numFacePerElem+j];
<a name="l00229"></a>00229      <span class="keywordflow">break</span>;
<a name="l00230"></a>00230       }
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232   }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00235"></a>00235 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="231047ab582a6ce1c7fb2bb3c6c1164c"></a><!-- doxytag: member="gaplines.c::findShapeSide" ref="231047ab582a6ce1c7fb2bb3c6c1164c" args="(int faceID, int numShape, FC_Shape *shapes, int *shapeID, int *sideID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> findShapeSide           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>faceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numShape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shapes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>shapeID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>sideID</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00286">286</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="subset_8c-source.html#l02948">fc_isMemberInSubset()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00287"></a>00287                                                   {
<a name="l00288"></a>00288   <span class="keywordtype">int</span> i, j;
<a name="l00289"></a>00289   <span class="keywordflow">for</span> (i = 0; i &lt; numShape; i++) {
<a name="l00290"></a>00290     <span class="keywordflow">for</span> (j = 0; j &lt; shapes[i].<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++) {
<a name="l00291"></a>00291       <span class="keywordflow">if</span> (<a class="code" href="group__Subset.html#g744afc439663b83d95a3eae277bfdbc0" title="Check to see if a member is in a subset.">fc_isMemberInSubset</a>(shapes[i].faces[j], faceID)) {
<a name="l00292"></a>00292      *shapeID = i;
<a name="l00293"></a>00293      *sideID = j;
<a name="l00294"></a>00294      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00295"></a>00295       }
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297   }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   *shapeID = -1;
<a name="l00300"></a>00300   *sideID = -1;
<a name="l00301"></a>00301   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00302"></a>00302 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7b03c631227ee26e89bffeb4f23d711e"></a><!-- doxytag: member="gaplines.c::getLinesAsVectors" ref="7b03c631227ee26e89bffeb4f23d711e" args="(FC_Mesh mesh, FC_Variable displVar, FC_Variable *lineVectors)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> getLinesAsVectors           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>lineVectors</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00240">240</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="variable_8c-source.html#l00286">fc_createVariable()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="mesh_8c-source.html#l03762">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03025">fc_getMeshNumElement()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8h-source.html#l00171">FC_MT_VECTOR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="variable_8c-source.html#l00604">fc_setVariableDataPtr()</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00241"></a>00241                                                      {
<a name="l00242"></a>00242   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00243"></a>00243   <span class="keywordtype">int</span> i, j;
<a name="l00244"></a>00244   <span class="keywordtype">int</span> numElem, numDim, numVperE = 2; <span class="comment">// assuming lines</span>
<a name="l00245"></a>00245   <span class="keywordtype">double</span>* displCoords;
<a name="l00246"></a>00246   <span class="keywordtype">int</span>* conns;
<a name="l00247"></a>00247   <span class="keywordtype">double</span>* vectors;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   rc = <a class="code" href="group__Mesh.html#g8bcadefbf0728724adf77ef52c1f3732" title="Returns number of elements in a mesh.">fc_getMeshNumElement</a>(mesh, &amp;numElem);
<a name="l00250"></a>00250   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00251"></a>00251     <span class="keywordflow">return</span> rc;  
<a name="l00252"></a>00252   rc = <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(mesh, &amp;numDim);
<a name="l00253"></a>00253   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00254"></a>00254     <span class="keywordflow">return</span> rc;
<a name="l00255"></a>00255   rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(mesh, displVar, &amp;displCoords);
<a name="l00256"></a>00256   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00257"></a>00257     <span class="keywordflow">return</span> rc;
<a name="l00258"></a>00258   rc = <a class="code" href="group__Mesh.html#g19906bcae562d226991740da142000c0" title="Return element to vertex connectivities for the mesh.">fc_getMeshElementConnsPtr</a>(mesh, &amp;conns);
<a name="l00259"></a>00259   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00260"></a>00260     <span class="keywordflow">return</span> rc;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   vectors = malloc(numElem*numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00263"></a>00263   <span class="keywordflow">if</span> (!vectors) {
<a name="l00264"></a>00264     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00265"></a>00265     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00266"></a>00266   }
<a name="l00267"></a>00267   <span class="keywordflow">for</span> (i = 0; i &lt; numElem; i++) {
<a name="l00268"></a>00268     <span class="keywordtype">int</span> vert1 = conns[i*numVperE];
<a name="l00269"></a>00269     <span class="keywordtype">int</span> vert2 = conns[i*numVperE+1];
<a name="l00270"></a>00270     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++) {
<a name="l00271"></a>00271       vectors[i*numDim+j] = displCoords[vert1*numDim+j] -
<a name="l00272"></a>00272                          displCoords[vert2*numDim+j]; 
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274   }
<a name="l00275"></a>00275   free(displCoords);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277   rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(mesh, <span class="stringliteral">"line vectors"</span>, lineVectors);
<a name="l00278"></a>00278   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00279"></a>00279     <span class="keywordflow">return</span> rc;
<a name="l00280"></a>00280   rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(*lineVectors, numElem, numDim, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>,
<a name="l00281"></a>00281                     <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb207f48fe9fd9efb7bc772bbb41106e217f">FC_MT_VECTOR</a>, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>, (<span class="keywordtype">void</span>*)vectors);
<a name="l00282"></a>00282   <span class="keywordflow">return</span> rc;
<a name="l00283"></a>00283 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f865191f0e1fd8ecd8cd232821e20580"></a><!-- doxytag: member="gaplines.c::getMeshMaxEdgeLength" ref="f865191f0e1fd8ecd8cd232821e20580" args="(FC_Mesh mesh, double *max_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> getMeshMaxEdgeLength           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>max_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00176">176</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l03415">fc_getEdgeLengths()</a>, <a class="el" href="statistics_8c-source.html#l00097">fc_getVariableMinMax()</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00176"></a>00176                                                                          {
<a name="l00177"></a>00177   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00178"></a>00178   <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> lengths;
<a name="l00179"></a>00179   
<a name="l00180"></a>00180   rc = <a class="code" href="group__GeometricRelations.html#ga60d8aaab6f5dd1da9f6d9d97ce06ce8" title="Return a variable with the edge lengths of the mesh.">fc_getEdgeLengths</a>(mesh, &amp;lengths);
<a name="l00181"></a>00181   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00182"></a>00182     <span class="keywordflow">return</span> rc;
<a name="l00183"></a>00183   rc = <a class="code" href="group__Statistics.html#g8e828048c88585a6de200e4f05d61ee4" title="Find min &amp;amp; max data values of a variable.">fc_getVariableMinMax</a>(lengths, NULL, NULL, max_len, NULL);
<a name="l00184"></a>00184   <span class="keywordflow">return</span> rc;
<a name="l00185"></a>00185 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="63631fd67e55ca221855533f3f1b2f41"></a><!-- doxytag: member="gaplines.c::getRemoveSIAIntersection" ref="63631fd67e55ca221855533f3f1b2f41" args="(FC_SortedIntArray *sia1, FC_SortedIntArray *sia2, FC_SortedIntArray *sia3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void getRemoveSIAIntersection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *&nbsp;</td>
          <td class="paramname"> <em>sia1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *&nbsp;</td>
          <td class="paramname"> <em>sia2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *&nbsp;</td>
          <td class="paramname"> <em>sia3</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00306">306</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="storage_8c-source.html#l01698">_fc_deleteEntryFromSortedIntArray()</a>, <a class="el" href="storage_8c-source.html#l00397">fc_addIntToSortedIntArray()</a>, and <a class="el" href="storage_8h-source.html#l00101">FC_SortedIntArray::vals</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00308"></a>00308                                                   {
<a name="l00309"></a>00309   <span class="keywordtype">int</span> i, j;
<a name="l00310"></a>00310   i = 0;
<a name="l00311"></a>00311   j = 0;
<a name="l00312"></a>00312   <span class="keywordflow">while</span> (i &lt; sia1-&gt;numVal &amp;&amp; j &lt; sia2-&gt;numVal) {
<a name="l00313"></a>00313     <span class="keywordflow">if</span> (sia1-&gt;<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[i] &lt; sia2-&gt;<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[j]) {
<a name="l00314"></a>00314       i++;
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sia1-&gt;<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[i] &gt; sia2-&gt;<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[j]) {
<a name="l00317"></a>00317       j++;
<a name="l00318"></a>00318     }
<a name="l00319"></a>00319     <span class="keywordflow">else</span> {
<a name="l00320"></a>00320       <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(sia3, sia1-&gt;<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[i]);
<a name="l00321"></a>00321       <a class="code" href="group__PrivateSimpleDataObjects.html#gf6d4e209d3c0693b211a89889556b75f" title="Remove an entry at a specified location from a sorted int array.">_fc_deleteEntryFromSortedIntArray</a>(sia1, i);
<a name="l00322"></a>00322       <a class="code" href="group__PrivateSimpleDataObjects.html#gf6d4e209d3c0693b211a89889556b75f" title="Remove an entry at a specified location from a sorted int array.">_fc_deleteEntryFromSortedIntArray</a>(sia2, j);
<a name="l00323"></a>00323       <span class="comment">// don't increment i or j</span>
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325   }
<a name="l00326"></a>00326 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="036046e3a36e4539ede49168d87695d6"></a><!-- doxytag: member="gaplines.c::isItDead" ref="036046e3a36e4539ede49168d87695d6" args="(int numDeathVar, deathvarinfo *deathvarinfos, int id1, double **data1, int id2, double **data2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int isItDead           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDeathVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>deathvarinfos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>id1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>data1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>id2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>data2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00330">330</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="util_8c-source.html#l00606">fc_eqd()</a>, <a class="el" href="util_8c-source.html#l00691">fc_gtd()</a>, <a class="el" href="util_8c-source.html#l00714">fc_gteqd()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="util_8c-source.html#l00645">fc_ltd()</a>, <a class="el" href="util_8c-source.html#l00668">fc_lteqd()</a>, <a class="el" href="util_8c-source.html#l00625">fc_neqd()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="gaplines_8c-source.html#l00108">deathvarinfo::op</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00331"></a>00331                                                        {
<a name="l00332"></a>00332   <span class="keywordtype">int</span> i;
<a name="l00333"></a>00333   <span class="keywordtype">int</span> isItDead1 = 0, isItDead2 = 0;  <span class="comment">// start off assuming dead</span>
<a name="l00334"></a>00334 
<a name="l00335"></a>00335   <span class="keywordflow">for</span> (i = 0; i &lt; numDeathVar; i++) {
<a name="l00336"></a>00336     int (*compare)(double, double);
<a name="l00337"></a>00337     <span class="keywordtype">char</span>* compare_str = deathvarinfos[i].<a class="code" href="structdeathvarinfo.html#c3fcf6b77f55c2704758720ae73d46ca">op</a>;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     <span class="comment">// determine comparison</span>
<a name="l00340"></a>00340     <span class="comment">// break out at the first dead classification</span>
<a name="l00341"></a>00341     <span class="keywordflow">if</span> (!strcmp(compare_str, <span class="stringliteral">"="</span>) || !strcmp(compare_str, <span class="stringliteral">"=="</span>))
<a name="l00342"></a>00342       compare = <a class="code" href="group__PublicFloatingPoint.html#g586cfa132ea1f36cba13311e8e994c03" title="Test if two doubles are equal, assuming double precision.">fc_eqd</a>;
<a name="l00343"></a>00343     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(compare_str, <span class="stringliteral">"!="</span>) || !strcmp(compare_str, <span class="stringliteral">"=!"</span>))
<a name="l00344"></a>00344       compare = <a class="code" href="group__PublicFloatingPoint.html#gec7b1ef85d5f7cd57ccfd52bf56b6c92" title="Test if two doubles are not equal, assuming double precision.">fc_neqd</a>;
<a name="l00345"></a>00345     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(compare_str, <span class="stringliteral">"&lt;"</span>))
<a name="l00346"></a>00346       compare = <a class="code" href="group__PublicFloatingPoint.html#g9b72da62722becc8bf11b5eea7854bf9" title="Test if the first double is less than the second double, assuming double precision...">fc_ltd</a>;
<a name="l00347"></a>00347     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(compare_str, <span class="stringliteral">"&lt;="</span>) || !strcmp(compare_str, <span class="stringliteral">"=&lt;"</span>))
<a name="l00348"></a>00348     compare = <a class="code" href="group__PublicFloatingPoint.html#g8aaadf1df0008173eda4adc00905d951" title="Test if the first double is less than or equal to the second double, assuming double...">fc_lteqd</a>;
<a name="l00349"></a>00349     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(compare_str, <span class="stringliteral">"&gt;"</span>))
<a name="l00350"></a>00350       compare = <a class="code" href="group__PublicFloatingPoint.html#ge819a6954dbe19d55f2b8bf1f01fa186" title="Test if the first double is greater than the second double, assuming double precision...">fc_gtd</a>;
<a name="l00351"></a>00351     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(compare_str, <span class="stringliteral">"&gt;="</span>) || !strcmp(compare_str, <span class="stringliteral">"=&gt;"</span>))
<a name="l00352"></a>00352       compare = <a class="code" href="group__PublicFloatingPoint.html#g45332f43c64a42871f145326adbc1271" title="Test if the first double is greater than or equal to the second value, assmuming...">fc_gteqd</a>;
<a name="l00353"></a>00353     <span class="keywordflow">else</span> {
<a name="l00354"></a>00354       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Unknown comparison string: '%s'"</span>, compare_str);
<a name="l00355"></a>00355       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357     
<a name="l00358"></a>00358     <span class="keywordflow">if</span> (compare(data1[i][id1], deathvarinfos[i].val)) {
<a name="l00359"></a>00359       isItDead1 = 1;
<a name="l00360"></a>00360       <span class="keywordflow">break</span>;
<a name="l00361"></a>00361     }
<a name="l00362"></a>00362     <span class="keywordflow">if</span> (compare(data2[i][id2], deathvarinfos[i].val)) {
<a name="l00363"></a>00363       isItDead2 = 1;
<a name="l00364"></a>00364       <span class="keywordflow">break</span>;
<a name="l00365"></a>00365     }
<a name="l00366"></a>00366   }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   <span class="keywordflow">if</span> (isItDead1 || isItDead2)
<a name="l00369"></a>00369     <span class="keywordflow">return</span> 1;
<a name="l00370"></a>00370   <span class="keywordflow">else</span>
<a name="l00371"></a>00371     <span class="keywordflow">return</span> 0;
<a name="l00372"></a>00372 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3c04138a5bfe5d72780bb7e82a18e627"></a><!-- doxytag: member="gaplines.c::main" ref="3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00433">433</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l07177">_fc_calcQuadLocation()</a>, <a class="el" href="geom_8c-source.html#l07013">_fc_calcQuadParams()</a>, <a class="el" href="geom_8c-source.html#l06901">_fc_calcSurfaceNormal()</a>, <a class="el" href="mesh_8c-source.html#l04509">_fc_getMeshElementParentsOfFacesPtr()</a>, <a class="el" href="mesh_8c-source.html#l04318">_fc_getMeshFaceParentsOfVerticesPtr()</a>, <a class="el" href="gaplines_8c-source.html#l00190">calcFaceOrients()</a>, <a class="el" href="subset_8c-source.html#l02064">fc_addArrayMembersToSubset()</a>, <a class="el" href="storage_8c-source.html#l00397">fc_addIntToSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="geom_8c-source.html#l00215">fc_calcAngleBetweenVectors()</a>, <a class="el" href="geom_8c-source.html#l00163">fc_calcSquaredEuclideanDistance()</a>, <a class="el" href="dataset_8c-source.html#l00542">fc_changeDatasetName()</a>, <a class="el" href="variable_8c-source.html#l02735">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="subset_8c-source.html#l00869">fc_copySubsetWithNewAssociation()</a>, <a class="el" href="mesh_8c-source.html#l00119">fc_createMesh()</a>, <a class="el" href="geom_8c-source.html#l05522">fc_createMeshVertexBin()</a>, <a class="el" href="varmath_8c-source.html#l03847">fc_createNormalTangentVariables2()</a>, <a class="el" href="variable_8c-source.html#l00350">fc_createSeqVariable()</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="mesh_8c-source.html#l00845">fc_createSubsetMesh()</a>, <a class="el" href="threshold_8c-source.html#l00088">fc_createThresholdSubset()</a>, <a class="el" href="mesh_8c-source.html#l02626">fc_deleteMesh()</a>, <a class="el" href="sequence_8c-source.html#l01427">fc_deleteSequence()</a>, <a class="el" href="variable_8c-source.html#l05062">fc_deleteSeqVariable()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="variable_8c-source.html#l04980">fc_deleteVariable()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00121">FC_ET_LINE</a>, <a class="el" href="error_8h-source.html#l00080">fc_exitIfError</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="library_8c-source.html#l00256">fc_finalLibrary()</a>, <a class="el" href="shape_8c-source.html#l02320">fc_freeShape()</a>, <a class="el" href="storage_8c-source.html#l00846">fc_freeSortedIntArray()</a>, <a class="el" href="fileio_8h-source.html#l00081">FC_FT_EXODUS</a>, <a class="el" href="base_8c-source.html#l00477">fc_getAssociationTypeText()</a>, <a class="el" href="dataset_8c-source.html#l00784">fc_getDatasetName()</a>, <a class="el" href="geom_8c-source.html#l03503">fc_getDisplacedEdgeLengths()</a>, <a class="el" href="geom_8c-source.html#l05786">fc_getEntitiesWithinSphere()</a>, <a class="el" href="mesh_8c-source.html#l02285">fc_getMeshByName()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="mesh_8c-source.html#l02183">fc_getMeshes()</a>, <a class="el" href="mesh_8c-source.html#l03691">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="shape_8c-source.html#l01515">fc_getMeshShapes()</a>, <a class="el" href="topo_8c-source.html#l01792">fc_getMeshSkin()</a>, <a class="el" href="variable_8c-source.html#l04695">fc_getOrGenerateUniqueSeqVariableByName()</a>, <a class="el" href="sequence_8c-source.html#l01794">fc_getSequenceCoordsAsDataType()</a>, <a class="el" href="variable_8c-source.html#l05317">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="sequence_8c-source.html#l01150">fc_getSequences()</a>, <a class="el" href="variable_8c-source.html#l03637">fc_getSeqVariables()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="subset_8c-source.html#l02700">fc_getSubsetName()</a>, <a class="el" href="subset_8c-source.html#l02828">fc_getSubsetNumMember()</a>, <a class="el" href="subset_8c-source.html#l01253">fc_getSubsets()</a>, <a class="el" href="variable_8c-source.html#l05539">fc_getVariableAssociationType()</a>, <a class="el" href="variable_8c-source.html#l05773">fc_getVariableDataAsDataType()</a>, <a class="el" href="variable_8c-source.html#l03573">fc_getVariables()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="library_8c-source.html#l00208">fc_initLibrary()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02948">fc_isMemberInSubset()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="fileio_8c-source.html#l01565">fc_loadDataset()</a>, <a class="el" href="base_8h-source.html#l00084">FC_LOG_MESSAGES</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8h-source.html#l00170">FC_MT_SCALAR</a>, <a class="el" href="base_8h-source.html#l00171">FC_MT_VECTOR</a>, <a class="el" href="base_8h-source.html#l00081">FC_QUIET</a>, <a class="el" href="fileio_8c-source.html#l01776">fc_rewriteDataset()</a>, <a class="el" href="library_8c-source.html#l00146">fc_setLibraryVerbosity()</a>, <a class="el" href="mesh_8c-source.html#l00259">fc_setMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l00391">fc_setMeshElementConnsPtr()</a>, <a class="el" href="variable_8c-source.html#l00604">fc_setVariableDataPtr()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="varmath_8c-source.html#l01485">fc_varUnaryFunction()</a>, <a class="el" href="base_8h-source.html#l00083">FC_WARNING_MESSAGES</a>, <a class="el" href="subsetter_8c-source.html#l00114">file_name</a>, <a class="el" href="gaplines_8c-source.html#l00286">findShapeSide()</a>, <a class="el" href="gaplines_8c-source.html#l00240">getLinesAsVectors()</a>, <a class="el" href="gaplines_8c-source.html#l00176">getMeshMaxEdgeLength()</a>, <a class="el" href="gaplines_8c-source.html#l00306">getRemoveSIAIntersection()</a>, <a class="el" href="gaplines_8c-source.html#l00330">isItDead()</a>, <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>, <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>, <a class="el" href="subsetter_8c-source.html#l00108">op</a>, <a class="el" href="gaplines_8c-source.html#l00112">parseDeathVarSet()</a>, <a class="el" href="gaplines_8c-source.html#l00377">printStats()</a>, <a class="el" href="storage_8h-source.html#l00101">FC_SortedIntArray::vals</a>, and <a class="el" href="regionreassembler_8c-source.html#l00069">verbose_level</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00433"></a>00433                                 {
<a name="l00434"></a>00434   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00435"></a>00435   <a class="code" href="group__DataTypes.html#g1ceb59a5b485f8bcbcb8acad4cfb9323" title="Possible verbosity levels.">FC_VerbosityLevel</a> <a class="code" href="regionreassembler_8c.html#46e260e16f29333b3f475e879e4d8e70">verbose_level</a> = <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a>;
<a name="l00436"></a>00436   <span class="keywordtype">int</span> i, j, k, m, n;
<a name="l00437"></a>00437   <span class="keywordtype">int</span> numDeathVar = 0;
<a name="l00438"></a>00438   <a class="code" href="structdeathvarinfo.html">deathvarinfo</a>* deathVarInfos;
<a name="l00439"></a>00439   <a class="code" href="structFC__Dataset.html" title="Dataset Handle.">FC_Dataset</a> dataset;
<a name="l00440"></a>00440   <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a> sequence, sequences[2];
<a name="l00441"></a>00441   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> meshes[2], gap_mesh;
<a name="l00442"></a>00442   <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *displs[2], **deathVars[2];
<a name="l00443"></a>00443   <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *gap_displ, *aveFaceNorms, *isDeadVar = NULL;
<a name="l00444"></a>00444   <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *lengths, *norms, *tangs;
<a name="l00445"></a>00445   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> face_skins[2], vert_skins[2];
<a name="l00446"></a>00446   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *alivePerTime;
<a name="l00447"></a>00447   <span class="keywordtype">char</span>* <a class="code" href="subsetter_8c.html#8505c513bc640d1f69e5f76fb32b24a8">file_name</a> = NULL;
<a name="l00448"></a>00448   <span class="keywordtype">char</span>* mesh_names[2] = { NULL, NULL };
<a name="l00449"></a>00449   <span class="keywordtype">char</span>* displ_name = NULL;
<a name="l00450"></a>00450   <span class="keywordtype">char</span> charBuf[1024];
<a name="l00451"></a>00451   <span class="keywordtype">int</span> numDims[2], numDim, numStep;
<a name="l00452"></a>00452   <span class="keywordtype">double</span> max_lens[2]; <span class="comment">// maximum edge length</span>
<a name="l00453"></a>00453   <span class="keywordtype">double</span> max_dists[2]; <span class="comment">// maximum possible distance between point in quad </span>
<a name="l00454"></a>00454                        <span class="comment">// and the vert (in the quad) furthest from point</span>
<a name="l00455"></a>00455                        <span class="comment">// see also documentation at the calc below</span>
<a name="l00456"></a>00456   <span class="keywordtype">double</span> *coords[2];
<a name="l00457"></a>00457   <span class="keywordtype">int</span> *numFacePerVert[2], **faceParentsPerVert[2];
<a name="l00458"></a>00458   <span class="keywordtype">int</span> *numElemPerFace[2], **elemParentsPerFace[2];
<a name="l00459"></a>00459   <span class="keywordtype">int</span> *numVertexPerFace[2], *faceToVertConns[2], stride[2];
<a name="l00460"></a>00460   <span class="keywordtype">int</span> numVertIDs[2], *vertIDs[2], numFaceIDs[2], *faceIDs[2];
<a name="l00461"></a>00461   <span class="keywordtype">int</span> *faceOrients[2];
<a name="l00462"></a>00462   <span class="keywordtype">int</span> numKeeps[2], *keepVertIDs[2], *keepThisFaceIDs[2], *keepOtherFaceIDs[2];
<a name="l00463"></a>00463   <span class="keywordtype">double</span> **keepParams[2];
<a name="l00464"></a>00464   <a class="code" href="structFC__VertexBin.html" title="Spatially binned vertex IDs.">FC_VertexBin</a> *bins[2];
<a name="l00465"></a>00465   <span class="keywordtype">double</span> min_dist = 0.001; <span class="comment">// critical distance to identify "joined" meshes</span>
<a name="l00466"></a>00466   <span class="keywordtype">double</span>* seq_coords;
<a name="l00467"></a>00467   <span class="keywordtype">double</span> angle = 80; <span class="comment">// faces with angles greater than this are on diff faces</span>
<a name="l00468"></a>00468   <span class="keywordtype">int</span> numShapes[2];
<a name="l00469"></a>00469   <a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a> *shapes[2];
<a name="l00470"></a>00470   <span class="keywordtype">int</span> numSide;
<a name="l00471"></a>00471   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *sides;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473   <span class="comment">// handle arguments</span>
<a name="l00474"></a>00474   <span class="keywordflow">if</span> (argc &lt; 6) {
<a name="l00475"></a>00475   usage:
<a name="l00476"></a>00476     printf(<span class="stringliteral">"usage: %s [options] dataset mesh1name mesh2name displvarname min_dist\n"</span>,
<a name="l00477"></a>00477         argv[0]);
<a name="l00478"></a>00478     printf(<span class="stringliteral">"   -n # &lt;triplets&gt; : Specify the rules for finding dead elements.\n"</span>);
<a name="l00479"></a>00479     printf(<span class="stringliteral">"                     The first parameter is the number of triplets. Each\n"</span>); 
<a name="l00480"></a>00480     printf(<span class="stringliteral">"                     triplet is the name of variable to test, the comparison\n"</span>);
<a name="l00481"></a>00481     printf(<span class="stringliteral">"                     operator, and the value. The default is \n"</span>);
<a name="l00482"></a>00482     printf(<span class="stringliteral">"                     '-n 1 elem_death \"&lt;=\" 0', meaning all elements\n"</span>);
<a name="l00483"></a>00483     printf(<span class="stringliteral">"                     where the variable 'elem_death' is less than or\n"</span>);
<a name="l00484"></a>00484     printf(<span class="stringliteral">"                     equal to zero are treated as being dead.\n"</span>);
<a name="l00485"></a>00485     printf(<span class="stringliteral">"   -h              : print this help message\n"</span>);
<a name="l00486"></a>00486     printf(<span class="stringliteral">"   -v              : verbose: print calculation status and print warning\n"</span>);
<a name="l00487"></a>00487     printf(<span class="stringliteral">"                     and error messages\n"</span>);
<a name="l00488"></a>00488     printf(<span class="stringliteral">"   -V              : very verbose: print log and error messages\n"</span>);
<a name="l00489"></a>00489     printf(<span class="stringliteral">"\n"</span>);
<a name="l00490"></a>00490     printf(<span class="stringliteral">"Report gaps that form between the specified meshes assuming that surfaces\n"</span>);
<a name="l00491"></a>00491     printf(<span class="stringliteral">"of interest are those that are less than min_dist apart. This program will\n"</span>);
<a name="l00492"></a>00492     printf(<span class="stringliteral">"also create a dataset file 'gaplines.ex2' containing the gap lines.\n"</span>); 
<a name="l00493"></a>00493     printf(<span class="stringliteral">"If dead elements are specified, gaplines attached to dead elements will \n"</span>);
<a name="l00494"></a>00494     printf(<span class="stringliteral">"be dropped for stat calcs.\n"</span>);
<a name="l00495"></a>00495     printf(<span class="stringliteral">"\n"</span>);
<a name="l00496"></a>00496     fflush(NULL);
<a name="l00497"></a>00497     exit(-1);
<a name="l00498"></a>00498   }
<a name="l00499"></a>00499   <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {
<a name="l00500"></a>00500     <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-v"</span>)) {
<a name="l00501"></a>00501       verbose_level = <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323d5f8d0b704dba62980776bac1283a741">FC_WARNING_MESSAGES</a>;
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-V"</span>)) {
<a name="l00504"></a>00504       verbose_level = <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb932395535fc1e83f1faa426c80811de6c55e">FC_LOG_MESSAGES</a>;
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(argv[i], <span class="stringliteral">"-h"</span>, 2))
<a name="l00507"></a>00507       <span class="keywordflow">goto</span> usage;
<a name="l00508"></a>00508     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-n"</span>)) {
<a name="l00509"></a>00509       i++;
<a name="l00510"></a>00510       rc = <a class="code" href="gaplines_8c.html#6fb18051e7cbacebf794269fbf48714b">parseDeathVarSet</a>(argc, argv, &amp;i, &amp;numDeathVar, &amp;deathVarInfos);
<a name="l00511"></a>00511       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00512"></a>00512      <span class="keywordflow">goto</span> usage;
<a name="l00513"></a>00513     }
<a name="l00514"></a>00514     <span class="keywordflow">else</span> {
<a name="l00515"></a>00515       <span class="keywordflow">if</span> (i+4 &gt;= argc)
<a name="l00516"></a>00516         <span class="keywordflow">goto</span> usage;
<a name="l00517"></a>00517       file_name = argv[i];
<a name="l00518"></a>00518       mesh_names[0] = argv[i+1];
<a name="l00519"></a>00519       mesh_names[1] = argv[i+2];
<a name="l00520"></a>00520       displ_name = argv[i+3];
<a name="l00521"></a>00521       min_dist = atof(argv[i+4]);
<a name="l00522"></a>00522       i+=4;
<a name="l00523"></a>00523     }
<a name="l00524"></a>00524   }
<a name="l00525"></a>00525   
<a name="l00526"></a>00526   <span class="keywordflow">if</span> (!file_name || !mesh_names[0] || !mesh_names[1] || !displ_name || 
<a name="l00527"></a>00527       min_dist &lt; 0.)
<a name="l00528"></a>00528      <span class="keywordflow">goto</span> usage;
<a name="l00529"></a>00529 
<a name="l00530"></a>00530   <span class="comment">// Init library &amp; load dataset</span>
<a name="l00531"></a>00531   rc = <a class="code" href="group__Library.html#gc54575c50a63dd29c694c78315d8fcf2" title="Set the library verbosity level.">fc_setLibraryVerbosity</a>(verbose_level);
<a name="l00532"></a>00532   <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00533"></a>00533   rc = <a class="code" href="group__Library.html#g18b26962103ffc9596657386d55a93af" title="Setup Feature Characterization Library for use.">fc_initLibrary</a>();
<a name="l00534"></a>00534   <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00535"></a>00535   rc = <a class="code" href="group__FileIO.html#g77b8250a472752e14bda28962116a66b" title="Load a dataset and it&amp;#39;s members from a file.">fc_loadDataset</a>(file_name, &amp;dataset);
<a name="l00536"></a>00536   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to load dataset '%s'"</span>, file_name);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538   <span class="comment">// Get sequence, meshes, displacement seqVars &amp; death seqVars</span>
<a name="l00539"></a>00539   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l00540"></a>00540     <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> temp_assoc;
<a name="l00541"></a>00541     <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> *returnMeshes;
<a name="l00542"></a>00542     <span class="keywordtype">int</span> numReturnMeshes;
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     rc = <a class="code" href="group__Mesh.html#gb72987c2bf83a19f208df925bc8af86b" title="Get all meshes with a given name from the dataset.">fc_getMeshByName</a>(dataset, mesh_names[i], &amp;numReturnMeshes,
<a name="l00545"></a>00545                  &amp;returnMeshes);
<a name="l00546"></a>00546     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"Failed to get mesh by name"</span>);
<a name="l00547"></a>00547     <span class="keywordflow">if</span> (numReturnMeshes != 1){
<a name="l00548"></a>00548       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>,
<a name="l00549"></a>00549                   <span class="stringliteral">"Problems finding (unique) mesh '%s' - found %d matches"</span>,
<a name="l00550"></a>00550                   mesh_names[i], numReturnMeshes);
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552     meshes[i] = returnMeshes[0];
<a name="l00553"></a>00553     free(returnMeshes);
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     rc = <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(meshes[i], &amp;numDims[i]);
<a name="l00556"></a>00556     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get numDim of mesh '%s'"</span>,
<a name="l00557"></a>00557                 mesh_names[i]);
<a name="l00558"></a>00558     rc = <a class="code" href="group__Variable.html#g9022a4933230e252076467a05f101a68" title="Gets a unique seq var if it exists, otherwise generate it from components if possible...">fc_getOrGenerateUniqueSeqVariableByName</a>(meshes[i], displ_name,
<a name="l00559"></a>00559                                &amp;numStep, &amp;displs[i]);
<a name="l00560"></a>00560     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to find or generate seqVar '%s' in mesh '%s'"</span>, 
<a name="l00561"></a>00561                 displ_name, mesh_names[i]);
<a name="l00562"></a>00562     
<a name="l00563"></a>00563     <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricRelations.html#g904f6ade0783bc52bee008d10e7b6a36" title="Test to see if variable can be used as displacment variable.">fc_isValidDisplacementVariable</a>(meshes[i], displs[i][0]))
<a name="l00564"></a>00564       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"'%s' is not a valid displacement variable"</span>,
<a name="l00565"></a>00565                   displ_name);
<a name="l00566"></a>00566     rc = <a class="code" href="group__Variable.html#g314a992ec5ba07d7075f1172b13ef166" title="Get the parent sequence of a sequence variable.">fc_getSequenceFromSeqVariable</a>(numStep, displs[i], &amp;sequences[i]);
<a name="l00567"></a>00567     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to get sequence"</span>);
<a name="l00568"></a>00568     <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l00569"></a>00569       deathVars[i] = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>**)malloc(numDeathVar*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*));
<a name="l00570"></a>00570       <span class="keywordflow">if</span> (!deathVars[i])
<a name="l00571"></a>00571      <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00572"></a>00572       <span class="keywordflow">for</span> (j = 0; j &lt; numDeathVar; j++) {
<a name="l00573"></a>00573      rc = <a class="code" href="group__Variable.html#g9022a4933230e252076467a05f101a68" title="Gets a unique seq var if it exists, otherwise generate it from components if possible...">fc_getOrGenerateUniqueSeqVariableByName</a>(meshes[i],
<a name="l00574"></a>00574                                    deathVarInfos[j].name,
<a name="l00575"></a>00575                                    &amp;numStep,
<a name="l00576"></a>00576                                    &amp;deathVars[i][j]);
<a name="l00577"></a>00577      <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to find or generate seqVar '%s' in mesh '%s'"</span>, 
<a name="l00578"></a>00578                     deathVarInfos[j].name, mesh_names[i]);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580      <a class="code" href="group__Variable.html#ge4935bc28dae482ddabcfd421400ab13" title="Return data association of a variable.">fc_getVariableAssociationType</a>(deathVars[i][j][0], &amp;temp_assoc);
<a name="l00581"></a>00581      <span class="keywordflow">if</span> (temp_assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>) {
<a name="l00582"></a>00582        <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>, <span class="stringliteral">"Death var '%s' should be of assoc "</span>
<a name="l00583"></a>00583                       <span class="stringliteral">"%s not %s'"</span>, deathVarInfos[j].name,
<a name="l00584"></a>00584                       <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(<a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>),
<a name="l00585"></a>00585                       <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(temp_assoc));
<a name="l00586"></a>00586      }
<a name="l00587"></a>00587       }
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589   }
<a name="l00590"></a>00590   <span class="keywordflow">if</span> (numDims[0] != numDims[1]) 
<a name="l00591"></a>00591     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>, <span class="stringliteral">"expect meshes to have same numDim "</span>
<a name="l00592"></a>00592                 <span class="stringliteral">"(%d!=%d)"</span>, numDims[0], numDims[1]);
<a name="l00593"></a>00593   numDim = numDims[0];
<a name="l00594"></a>00594   <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(sequences[0], sequences[1])) 
<a name="l00595"></a>00595     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>, 
<a name="l00596"></a>00596                 <span class="stringliteral">"expected displacements to be on the same sequence"</span>);
<a name="l00597"></a>00597   sequence = sequences[0];
<a name="l00598"></a>00598 
<a name="l00599"></a>00599   <span class="comment">// Close everything else to 1) to make room, and 2) when we write the </span>
<a name="l00600"></a>00600   <span class="comment">// dataset we only get gapline related stuff</span>
<a name="l00601"></a>00601   {
<a name="l00602"></a>00602     <span class="keywordtype">int</span> temp_numSequence, temp_numMesh, temp_numSubset;
<a name="l00603"></a>00603     <span class="keywordtype">int</span> temp_numVar, temp_numSeqVar, *temp_numSteps;
<a name="l00604"></a>00604     <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a> *temp_sequences;
<a name="l00605"></a>00605     <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> *temp_meshes;
<a name="l00606"></a>00606     <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *temp_subsets;
<a name="l00607"></a>00607     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *temp_vars, **temp_seqVars;
<a name="l00608"></a>00608     rc = <a class="code" href="group__Sequence.html#g0ad1217500f245d78aaad5c79f960ba1" title="Get the sequences in a dataset.">fc_getSequences</a>(dataset, &amp;temp_numSequence, &amp;temp_sequences);
<a name="l00609"></a>00609     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00610"></a>00610     <span class="keywordflow">for</span> (i = 0; i &lt; temp_numSequence; i++) {
<a name="l00611"></a>00611       <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_sequences[i], sequence))
<a name="l00612"></a>00612      <a class="code" href="group__Sequence.html#ga14671e26b688c9f1e05fb966169b4d6" title="Delete a sequence.">fc_deleteSequence</a>(temp_sequences[i]);
<a name="l00613"></a>00613     }
<a name="l00614"></a>00614     free(temp_sequences);
<a name="l00615"></a>00615     rc = <a class="code" href="group__Mesh.html#gcb092c2c909dd536c0120830890a9f36" title="Get the meshes in a dataset.">fc_getMeshes</a>(dataset, &amp;temp_numMesh, &amp;temp_meshes);
<a name="l00616"></a>00616     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00617"></a>00617     <span class="keywordflow">for</span> (i = 0; i &lt; temp_numMesh; i++) {
<a name="l00618"></a>00618       <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_meshes[i], meshes[0]) &amp;&amp;
<a name="l00619"></a>00619        !<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_meshes[i], meshes[1]))
<a name="l00620"></a>00620      <a class="code" href="group__Mesh.html#g7e846c58fe79c1f2bac817a2b7ed692e" title="Delete a mesh.">fc_deleteMesh</a>(temp_meshes[i]);
<a name="l00621"></a>00621     }
<a name="l00622"></a>00622     free(temp_meshes);
<a name="l00623"></a>00623     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l00624"></a>00624       <a class="code" href="group__Subset.html#gb12aea784bf43ec6a29a8e51a3c0da51" title="Get the subsets in a mesh.">fc_getSubsets</a>(meshes[i], &amp;temp_numSubset, &amp;temp_subsets);
<a name="l00625"></a>00625       <span class="keywordflow">for</span> (j = 0; j &lt; temp_numSubset; j++)
<a name="l00626"></a>00626      <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(temp_subsets[j]);
<a name="l00627"></a>00627       free(temp_subsets);
<a name="l00628"></a>00628       <a class="code" href="group__Variable.html#ga96777675a667d79871c93c54729bde4" title="Get the variables in a mesh.">fc_getVariables</a>(meshes[i], &amp;temp_numVar, &amp;temp_vars);
<a name="l00629"></a>00629       <span class="keywordflow">for</span> (j = 0; j &lt; temp_numVar; j++)
<a name="l00630"></a>00630      <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(temp_vars[j]);
<a name="l00631"></a>00631       free(temp_vars);
<a name="l00632"></a>00632       <a class="code" href="group__Variable.html#g01bf1b0d9b1de983115a461216039449" title="Get the sequence variables in a mesh.">fc_getSeqVariables</a>(meshes[i], &amp;temp_numSeqVar, &amp;temp_numSteps, 
<a name="l00633"></a>00633                 &amp;temp_seqVars);
<a name="l00634"></a>00634       <span class="keywordflow">for</span> (j = 0; j &lt; temp_numSeqVar; j++) {
<a name="l00635"></a>00635      <span class="keywordtype">int</span> hasMatch = 0;
<a name="l00636"></a>00636      <span class="keywordflow">if</span> (<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_seqVars[j][0], displs[i][0]))
<a name="l00637"></a>00637        hasMatch = 1;
<a name="l00638"></a>00638      <span class="keywordflow">else</span> {
<a name="l00639"></a>00639        <span class="keywordflow">for</span> (k = 0; k &lt; numDeathVar; k++) {
<a name="l00640"></a>00640          <span class="keywordflow">if</span> (<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_seqVars[j][0], deathVars[i][k][0])) {
<a name="l00641"></a>00641            hasMatch = 1;
<a name="l00642"></a>00642            <span class="keywordflow">break</span>;
<a name="l00643"></a>00643          }
<a name="l00644"></a>00644        }
<a name="l00645"></a>00645      }
<a name="l00646"></a>00646      <span class="keywordflow">if</span> (!hasMatch) 
<a name="l00647"></a>00647        <a class="code" href="group__Variable.html#gef5ebe119abe1d217a216f0faad0e667" title="Delete a sequence variable.">fc_deleteSeqVariable</a>(temp_numSteps[j], temp_seqVars[j]);
<a name="l00648"></a>00648      free(temp_seqVars[j]);
<a name="l00649"></a>00649       }
<a name="l00650"></a>00650       free(temp_numSteps);
<a name="l00651"></a>00651       free(temp_seqVars);
<a name="l00652"></a>00652     }
<a name="l00653"></a>00653   }
<a name="l00654"></a>00654 
<a name="l00655"></a>00655   <span class="comment">// ---- done with setup</span>
<a name="l00656"></a>00656 
<a name="l00657"></a>00657   <span class="comment">// Header</span>
<a name="l00658"></a>00658   printf(<span class="stringliteral">"Generating gaplines for:\n"</span>);
<a name="l00659"></a>00659   printf(<span class="stringliteral">"Dataset: '%s'\n"</span>, file_name);
<a name="l00660"></a>00660   printf(<span class="stringliteral">"Meshes: '%s' and '%s'\n"</span>, mesh_names[0], mesh_names[1]);
<a name="l00661"></a>00661   printf(<span class="stringliteral">"Displ: '%s'\n"</span>, displ_name);
<a name="l00662"></a>00662   printf(<span class="stringliteral">"Min Dist: %g\n"</span>, min_dist);
<a name="l00663"></a>00663   <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l00664"></a>00664     printf(<span class="stringliteral">"Death Criteria: '%s' %s %g"</span>, deathVarInfos[0].name,
<a name="l00665"></a>00665         deathVarInfos[0].<a class="code" href="subsetter_8c.html#15206368e0a18f984f0ad6cb10c2995e">op</a>, deathVarInfos[0].val);
<a name="l00666"></a>00666     <span class="keywordflow">for</span> (i = 1; i &lt; numDeathVar; i++) 
<a name="l00667"></a>00667       printf(<span class="stringliteral">" or '%s' %s %g"</span>, deathVarInfos[i].name,
<a name="l00668"></a>00668           deathVarInfos[i].<a class="code" href="subsetter_8c.html#15206368e0a18f984f0ad6cb10c2995e">op</a>, deathVarInfos[i].val);
<a name="l00669"></a>00669     printf(<span class="stringliteral">"\n"</span>);
<a name="l00670"></a>00670   }
<a name="l00671"></a>00671   fflush(NULL);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <span class="comment">// skin the meshes (get face skin and vertex skin)</span>
<a name="l00674"></a>00674   <span class="comment">// also get shapes</span>
<a name="l00675"></a>00675   <span class="keywordflow">if</span> (verbose_level &gt; <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a>) {
<a name="l00676"></a>00676     printf(<span class="stringliteral">"Skinning meshes ...\n"</span>);
<a name="l00677"></a>00677     fflush(NULL);
<a name="l00678"></a>00678   }
<a name="l00679"></a>00679   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l00680"></a>00680     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(meshes[i], &amp;coords[i]);
<a name="l00681"></a>00681     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00682"></a>00682     rc = <a class="code" href="gaplines_8c.html#f865191f0e1fd8ecd8cd232821e20580">getMeshMaxEdgeLength</a>(meshes[i], &amp;max_lens[i]);
<a name="l00683"></a>00683     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to get mesh max edge length"</span>);
<a name="l00684"></a>00684     <span class="comment">// Imagine a 4 sided quad with edge lengths of max_lens[i]</span>
<a name="l00685"></a>00685     <span class="comment">// squash it - the two vertices farthest apart are 2*max_lens[i] apart</span>
<a name="l00686"></a>00686     <span class="comment">// Imagine a point min_dist above one of those two vertices</span>
<a name="l00687"></a>00687     <span class="comment">// max_dists[i] is distance from that point to other vert.</span>
<a name="l00688"></a>00688     max_dists[i] = sqrt(4*max_lens[i]*max_lens[i] + min_dist*min_dist);
<a name="l00689"></a>00689     rc = <a class="code" href="group__TopologyRelations.html#gc9cf699133b0d472adf19df31c8ce3bf" title="Create skin of the mesh.">fc_getMeshSkin</a>(meshes[i], &amp;face_skins[i]);
<a name="l00690"></a>00690     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00691"></a>00691     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(face_skins[i], &amp;numFaceIDs[i], &amp;faceIDs[i]);
<a name="l00692"></a>00692     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00693"></a>00693     sprintf(charBuf, <span class="stringliteral">"vert skin %d"</span>, i);
<a name="l00694"></a>00694     rc = <a class="code" href="group__Subset.html#g9d45e65acedb565fa3aff9483423236b" title="Create copy subset associated with a different mesh entity type.">fc_copySubsetWithNewAssociation</a>(face_skins[i], charBuf,
<a name="l00695"></a>00695                           <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, 1, &amp;vert_skins[i]);
<a name="l00696"></a>00696     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00697"></a>00697     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(vert_skins[i], &amp;numVertIDs[i], &amp;vertIDs[i]);
<a name="l00698"></a>00698     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00699"></a>00699     rc = <a class="code" href="group__Mesh.html#g8e318f4b17572413004acf14b18deb2b" title="Return face connectivities.">fc_getMeshFaceConnsPtr</a>(meshes[i], &amp;numVertexPerFace[i], &amp;stride[i],
<a name="l00700"></a>00700                     &amp;faceToVertConns[i]);
<a name="l00701"></a>00701     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00702"></a>00702     rc = <a class="code" href="group__PrivateMesh.html#g53879e825667d77328908ec1e4a75506" title="Return parent faces of the vertices.">_fc_getMeshFaceParentsOfVerticesPtr</a>(meshes[i], &amp;numFacePerVert[i],
<a name="l00703"></a>00703                               &amp;faceParentsPerVert[i]);
<a name="l00704"></a>00704     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00705"></a>00705     rc = <a class="code" href="group__Shape.html#g89c155b43d6f766ebc54f0049df31dec" title="given a mesh, returns an array of FC_Shapes">fc_getMeshShapes</a>(meshes[i], angle, 0, &amp;numShapes[i], &amp;shapes[i]);
<a name="l00706"></a>00706     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00707"></a>00707     <a class="code" href="gaplines_8c.html#27005c79076374896c4a7d0cdc296c34">calcFaceOrients</a>(meshes[i], numFaceIDs[i], faceIDs[i], &amp;faceOrients[i]);
<a name="l00708"></a>00708     <span class="comment">// FIX could move this to later ... don't need until constructing gap mesh</span>
<a name="l00709"></a>00709     rc = <a class="code" href="group__PrivateMesh.html#g540b5f94172bea7ef0e2fcf41bf42425" title="Return parent elements of the faces.">_fc_getMeshElementParentsOfFacesPtr</a>(meshes[i], &amp;numElemPerFace[i],
<a name="l00710"></a>00710                               &amp;elemParentsPerFace[i]);
<a name="l00711"></a>00711     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00712"></a>00712     rc = <a class="code" href="group__GeometricRelations.html#g8c37e5e697cade766ceb41e4a3ec2eac" title="Create spatial bins for vertices for geometric queries.">fc_createMeshVertexBin</a>(meshes[i], &amp;bins[i]);
<a name="l00713"></a>00713     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00714"></a>00714   }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716   <span class="comment">// Create lists of vert to face pairs</span>
<a name="l00717"></a>00717   <span class="keywordflow">if</span> (verbose_level &gt; <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a>) {
<a name="l00718"></a>00718     printf(<span class="stringliteral">"Finding vert to face pairs ...\n"</span>);
<a name="l00719"></a>00719     fflush(NULL);
<a name="l00720"></a>00720   }
<a name="l00721"></a>00721   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l00722"></a>00722     <span class="keywordtype">int</span> otherMesh = (i == 0 ? 1 : 0);
<a name="l00723"></a>00723     numKeeps[i] = 0;
<a name="l00724"></a>00724     keepVertIDs[i] = malloc(numVertIDs[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00725"></a>00725     keepThisFaceIDs[i] = malloc(numVertIDs[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00726"></a>00726     keepOtherFaceIDs[i] = malloc(numVertIDs[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00727"></a>00727     keepParams[i] = malloc(numVertIDs[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>*));
<a name="l00728"></a>00728     <span class="keywordflow">if</span> (!keepVertIDs[i] || !keepThisFaceIDs[i] || !keepOtherFaceIDs[i] ||
<a name="l00729"></a>00729      !keepParams[i]) {
<a name="l00730"></a>00730       printf(<span class="stringliteral">"Memory problem\n"</span>);
<a name="l00731"></a>00731       exit(-1);
<a name="l00732"></a>00732     }
<a name="l00733"></a>00733     <span class="keywordflow">for</span> (j = 0; j &lt; numVertIDs[i]; j++) {
<a name="l00734"></a>00734       <span class="comment">// look for a containing face on other mesh</span>
<a name="l00735"></a>00735       <span class="comment">// (assumption - can find such a face via nearest vertex</span>
<a name="l00736"></a>00736       <span class="comment">//   this is not true, but true enough; cases this doesn't hold</span>
<a name="l00737"></a>00737       <span class="comment">//   for are just discarded)</span>
<a name="l00738"></a>00738       <span class="keywordtype">int</span> thisVertID = vertIDs[i][j];
<a name="l00739"></a>00739       <span class="keywordtype">int</span> numOtherFace, *otherFaceIDs;
<a name="l00740"></a>00740       rc = <a class="code" href="group__GeometricRelations.html#ga54b4d882e664a4973368b093c274e34" title="Find all entities within a sphere.">fc_getEntitiesWithinSphere</a>(meshes[otherMesh], bins[otherMesh],
<a name="l00741"></a>00741                           &amp;coords[i][thisVertID*numDim], 
<a name="l00742"></a>00742                           max_dists[otherMesh], <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>, 
<a name="l00743"></a>00743                           &amp;numOtherFace, &amp;otherFaceIDs);
<a name="l00744"></a>00744       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to get entities within a sphere"</span>);
<a name="l00745"></a>00745       <span class="keywordflow">for</span> (k = 0; k &lt; numOtherFace; k++) {
<a name="l00746"></a>00746      <span class="keywordtype">int</span> numParam;
<a name="l00747"></a>00747      <span class="keywordtype">double</span> *params;
<a name="l00748"></a>00748      <span class="keywordtype">double</span> distance2, min_dist2 = min_dist*min_dist; <span class="comment">// squared distances</span>
<a name="l00749"></a>00749      <span class="comment">//int otherFaceID = faceParentsPerVert[otherMesh][otherVertID][k];</span>
<a name="l00750"></a>00750      <span class="keywordtype">int</span> otherFaceID = otherFaceIDs[k];
<a name="l00751"></a>00751      <span class="keywordtype">int</span> thisFaceID;
<a name="l00752"></a>00752      <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> otherNormal;
<a name="l00753"></a>00753      <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> otherFaceCoords[4], temp_newPoint;
<a name="l00754"></a>00754      <span class="keywordtype">int</span> foundMatch = 0;
<a name="l00755"></a>00755      <span class="comment">// skip if not in the skin</span>
<a name="l00756"></a>00756      <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g744afc439663b83d95a3eae277bfdbc0" title="Check to see if a member is in a subset.">fc_isMemberInSubset</a>(face_skins[otherMesh], otherFaceID))
<a name="l00757"></a>00757        <span class="keywordflow">continue</span>;
<a name="l00758"></a>00758      <span class="keywordflow">if</span> (numVertexPerFace[otherMesh][otherFaceID] != 4)
<a name="l00759"></a>00759        printf(<span class="stringliteral">"*** expected quads!\n"</span>);
<a name="l00760"></a>00760      <span class="comment">// setup</span>
<a name="l00761"></a>00761      <span class="keywordflow">for</span> (m = 0; m &lt; numVertexPerFace[otherMesh][otherFaceID]; m++) {
<a name="l00762"></a>00762        <span class="keywordtype">int</span> totherVertID = faceToVertConns[otherMesh][otherFaceID*4+m];
<a name="l00763"></a>00763        memcpy(otherFaceCoords[m], &amp;coords[otherMesh][numDim*totherVertID],
<a name="l00764"></a>00764            numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00765"></a>00765      }
<a name="l00766"></a>00766      <a class="code" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17" title="Compute unit normal of surface.">_fc_calcSurfaceNormal</a>(numVertexPerFace[otherMesh][otherFaceID],
<a name="l00767"></a>00767                      otherFaceCoords, &amp;otherNormal);
<a name="l00768"></a>00768      <span class="comment">// check that normal is oposite some face in the first mesh</span>
<a name="l00769"></a>00769      <span class="keywordflow">for</span> (m = 0; m &lt; numFacePerVert[i][thisVertID]; m++) {
<a name="l00770"></a>00770        thisFaceID = faceParentsPerVert[i][thisVertID][m];
<a name="l00771"></a>00771        <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> thisFaceCoords[4];
<a name="l00772"></a>00772        <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> thisNormal;
<a name="l00773"></a>00773        <span class="keywordtype">double</span> anglediff;
<a name="l00774"></a>00774        <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g744afc439663b83d95a3eae277bfdbc0" title="Check to see if a member is in a subset.">fc_isMemberInSubset</a>(face_skins[i], thisFaceID)) 
<a name="l00775"></a>00775          <span class="keywordflow">continue</span>;
<a name="l00776"></a>00776        <span class="keywordflow">for</span> (n = 0; n &lt; numVertexPerFace[i][thisFaceID]; n++)
<a name="l00777"></a>00777          memcpy(thisFaceCoords[n],
<a name="l00778"></a>00778              &amp;coords[i][numDim*faceToVertConns[i][thisFaceID*4+n]],
<a name="l00779"></a>00779              numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00780"></a>00780        <a class="code" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17" title="Compute unit normal of surface.">_fc_calcSurfaceNormal</a>(numVertexPerFace[i][thisFaceID],
<a name="l00781"></a>00781                     thisFaceCoords, &amp;thisNormal);
<a name="l00782"></a>00782        <a class="code" href="group__GeometricRelations.html#g30ce3387c782c3d8a74fb0075168bca0" title="Determine angle between two vectors.">fc_calcAngleBetweenVectors</a>(thisNormal, otherNormal, &amp;anglediff);
<a name="l00783"></a>00783        <span class="comment">//printf("angle = %g,faceorients = %d %d\n", anglediff,</span>
<a name="l00784"></a>00784        <span class="comment">// faceOrients[i][thisFaceID], faceOrients[otherMesh][otherFaceID]);</span>
<a name="l00785"></a>00785        <span class="keywordflow">if</span> ((faceOrients[i][thisFaceID] ==
<a name="l00786"></a>00786             faceOrients[otherMesh][otherFaceID] &amp;&amp; anglediff &gt; 175) ||
<a name="l00787"></a>00787            (faceOrients[i][thisFaceID] == 
<a name="l00788"></a>00788             -1*faceOrients[otherMesh][otherFaceID] &amp;&amp; anglediff &lt; 5)) {
<a name="l00789"></a>00789          foundMatch = 1;
<a name="l00790"></a>00790          <span class="keywordflow">break</span>;
<a name="l00791"></a>00791        }
<a name="l00792"></a>00792      }
<a name="l00793"></a>00793      <span class="keywordflow">if</span> (!foundMatch)
<a name="l00794"></a>00794        <span class="keywordflow">continue</span>;
<a name="l00795"></a>00795      <span class="comment">// check to see if it's inside face - within tolerance of DBL_EPSILON</span>
<a name="l00796"></a>00796      <a class="code" href="group__PrivateGeometricRelations.html#gda6b93e0c869be3fc8be603801ed56c9" title="Compute parameterization of a point on a quad.">_fc_calcQuadParams</a>(otherFaceCoords, &amp;coords[i][thisVertID*numDim], 
<a name="l00797"></a>00797                   &amp;numParam, &amp;params);
<a name="l00798"></a>00798      <span class="keywordflow">if</span> (!params || 
<a name="l00799"></a>00799          params[0] &lt; -1*FLT_EPSILON || params[0] &gt; 1 + FLT_EPSILON || 
<a name="l00800"></a>00800          params[1] &lt; -1*FLT_EPSILON || params[1] &gt; 1 + FLT_EPSILON ) {
<a name="l00801"></a>00801        free(params);
<a name="l00802"></a>00802        <span class="keywordflow">continue</span>; <span class="comment">// not inside the quad</span>
<a name="l00803"></a>00803      }
<a name="l00804"></a>00804      <a class="code" href="group__PrivateGeometricRelations.html#g57be9af467e6c84e274d6828ae4b52b0" title="Compute parameterization of a point on a quad.">_fc_calcQuadLocation</a>(otherFaceCoords, numParam, params, 
<a name="l00805"></a>00805                     &amp;temp_newPoint);
<a name="l00806"></a>00806      <span class="comment">// check distance</span>
<a name="l00807"></a>00807      <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(&amp;coords[i][thisVertID*numDim], 
<a name="l00808"></a>00808                          temp_newPoint, numDim, &amp;distance2);
<a name="l00809"></a>00809      <span class="comment">// Below is friendlier version of "if (distance2 &gt; min_dist2) {"</span>
<a name="l00810"></a>00810      <span class="keywordflow">if</span> (distance2 - min_dist2 &gt; DBL_EPSILON) {
<a name="l00811"></a>00811        free(params);
<a name="l00812"></a>00812        <span class="keywordflow">continue</span>;
<a name="l00813"></a>00813      }
<a name="l00814"></a>00814      <span class="comment">// passed the test, add to list and stop looking</span>
<a name="l00815"></a>00815      <span class="comment">//printf("keepFace = %d\n", otherFaceID);</span>
<a name="l00816"></a>00816      keepVertIDs[i][numKeeps[i]] = thisVertID;
<a name="l00817"></a>00817      keepThisFaceIDs[i][numKeeps[i]] = thisFaceID;
<a name="l00818"></a>00818      keepOtherFaceIDs[i][numKeeps[i]] = otherFaceID;
<a name="l00819"></a>00819      keepParams[i][numKeeps[i]] = params;
<a name="l00820"></a>00820      numKeeps[i]++;
<a name="l00821"></a>00821      <span class="keywordflow">break</span>;
<a name="l00822"></a>00822       }
<a name="l00823"></a>00823       free(otherFaceIDs);
<a name="l00824"></a>00824     }
<a name="l00825"></a>00825     realloc(keepVertIDs[i], numKeeps[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00826"></a>00826     realloc(keepThisFaceIDs[i], numKeeps[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00827"></a>00827     realloc(keepOtherFaceIDs[i], numKeeps[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00828"></a>00828     realloc(keepParams[i], numKeeps[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>*));
<a name="l00829"></a>00829   }
<a name="l00830"></a>00830   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l00831"></a>00831     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(face_skins[i]);
<a name="l00832"></a>00832     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(vert_skins[i]);
<a name="l00833"></a>00833   }
<a name="l00834"></a>00834 
<a name="l00835"></a>00835   <span class="comment">// Early exit - We are done if no pairs were found</span>
<a name="l00836"></a>00836   <span class="keywordflow">if</span> (numKeeps[0] + numKeeps[1] &lt; 1) {
<a name="l00837"></a>00837     printf(<span class="stringliteral">"\n"</span>);
<a name="l00838"></a>00838     printf(<span class="stringliteral">"Number of gap lines found = 0\n"</span>);
<a name="l00839"></a>00839     exit(0);
<a name="l00840"></a>00840   }
<a name="l00841"></a>00841     
<a name="l00842"></a>00842   <span class="comment">//debug</span>
<a name="l00843"></a>00843   <span class="comment">//printf("numKeeps[0] = %d, numKeeps[1] = %d\n", numKeeps[0], numKeeps[1]);</span>
<a name="l00844"></a>00844   <span class="comment">/*</span>
<a name="l00845"></a>00845 <span class="comment">  { // for debugging - make subsets of thisFaces &amp; otherFaces</span>
<a name="l00846"></a>00846 <span class="comment">    FC_Subset thisSubsets[2];</span>
<a name="l00847"></a>00847 <span class="comment">    FC_Subset otherSubsets[2];</span>
<a name="l00848"></a>00848 <span class="comment">    for (i = 0; i &lt; 2; i++) {</span>
<a name="l00849"></a>00849 <span class="comment">      char buf[1048];</span>
<a name="l00850"></a>00850 <span class="comment">      sprintf(buf, "%s-thisFaces", mesh_names[i]);</span>
<a name="l00851"></a>00851 <span class="comment">      fc_createSubset(meshes[i], buf, FC_AT_FACE, &amp;thisSubsets[i]);</span>
<a name="l00852"></a>00852 <span class="comment">      sprintf(buf, "%s-otherFaces", mesh_names[i]);</span>
<a name="l00853"></a>00853 <span class="comment">      fc_createSubset(meshes[i], buf, FC_AT_FACE, &amp;otherSubsets[i]);</span>
<a name="l00854"></a>00854 <span class="comment">    }</span>
<a name="l00855"></a>00855 <span class="comment">    for (i = 0; i &lt; 2; i++) {</span>
<a name="l00856"></a>00856 <span class="comment">      int otherMesh =(i == 0 ? 1 : 0);</span>
<a name="l00857"></a>00857 <span class="comment">      for (j = 0; j &lt; numKeeps[i]; j++) {</span>
<a name="l00858"></a>00858 <span class="comment">     fc_addMemberToSubset(thisSubsets[i], keepThisFaceIDs[i][j]);</span>
<a name="l00859"></a>00859 <span class="comment">     fc_addMemberToSubset(otherSubsets[otherMesh], keepOtherFaceIDs[i][j]);</span>
<a name="l00860"></a>00860 <span class="comment">      }</span>
<a name="l00861"></a>00861 <span class="comment">    }</span>
<a name="l00862"></a>00862 <span class="comment">  }</span>
<a name="l00863"></a>00863 <span class="comment">  */</span>
<a name="l00864"></a>00864 
<a name="l00865"></a>00865   <span class="comment">// Create the line mesh &amp; its displacements &amp; isDead var</span>
<a name="l00866"></a>00866   <span class="keywordflow">if</span> (verbose_level &gt; <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a>) {
<a name="l00867"></a>00867     printf(<span class="stringliteral">"Creating gaplines mesh ...\n"</span>);
<a name="l00868"></a>00868     fflush(NULL);
<a name="l00869"></a>00869   }  
<a name="l00870"></a>00870   {
<a name="l00871"></a>00871     <span class="keywordtype">int</span> vindex, eindex;
<a name="l00872"></a>00872     <span class="keywordtype">int</span> numElement = numKeeps[0] + numKeeps[1];
<a name="l00873"></a>00873     <span class="keywordtype">int</span> numVertex = numElement*2;
<a name="l00874"></a>00874     <span class="keywordtype">int</span> temp_numStep;
<a name="l00875"></a>00875     <span class="keywordtype">double</span>* new_coords = malloc(numDim*numVertex*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00876"></a>00876     <span class="keywordtype">int</span>* new_conns = malloc(2*numElement*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00877"></a>00877     <span class="keywordtype">double</span> *displ_datas[2], **death_datas[2];
<a name="l00878"></a>00878     <span class="keywordtype">double</span>* new_displ_data, *new_ave_face_data;
<a name="l00879"></a>00879     <span class="keywordtype">int</span> *new_isDead_data;
<a name="l00880"></a>00880     <span class="comment">// create coords &amp; conns</span>
<a name="l00881"></a>00881     vindex = 0;
<a name="l00882"></a>00882     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l00883"></a>00883       <span class="keywordtype">int</span> otherMesh = (i == 0 ? 1 : 0);
<a name="l00884"></a>00884       <span class="keywordflow">for</span> (j = 0; j &lt; numKeeps[i]; j++) {
<a name="l00885"></a>00885      <span class="keywordtype">int</span> otherFaceID = keepOtherFaceIDs[i][j];
<a name="l00886"></a>00886      <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> otherFaceCoords[4], newPoint;
<a name="l00887"></a>00887      <span class="comment">// First the vertex</span>
<a name="l00888"></a>00888      memcpy(new_coords+vindex*numDim, coords[i]+keepVertIDs[i][j]*numDim, 
<a name="l00889"></a>00889             numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00890"></a>00890      new_conns[vindex] = vindex;
<a name="l00891"></a>00891      vindex++;
<a name="l00892"></a>00892      <span class="comment">// Then the parameterized point on the face</span>
<a name="l00893"></a>00893      <span class="keywordflow">for</span> (k = 0; k &lt; 4; k++) {
<a name="l00894"></a>00894        <span class="keywordtype">int</span> totherVertID = faceToVertConns[otherMesh][otherFaceID*4+k];
<a name="l00895"></a>00895        memcpy(otherFaceCoords[k], &amp;coords[otherMesh][numDim*totherVertID],
<a name="l00896"></a>00896            numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00897"></a>00897      }
<a name="l00898"></a>00898      <a class="code" href="group__PrivateGeometricRelations.html#g57be9af467e6c84e274d6828ae4b52b0" title="Compute parameterization of a point on a quad.">_fc_calcQuadLocation</a>(otherFaceCoords, 2, keepParams[i][j], 
<a name="l00899"></a>00899                     &amp;newPoint);
<a name="l00900"></a>00900      memcpy(new_coords+vindex*numDim, newPoint, numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00901"></a>00901      new_conns[vindex] = vindex;
<a name="l00902"></a>00902      vindex++;
<a name="l00903"></a>00903       }
<a name="l00904"></a>00904     }
<a name="l00905"></a>00905     <span class="comment">// create mesh</span>
<a name="l00906"></a>00906     sprintf(charBuf, <span class="stringliteral">"gap lines"</span>);
<a name="l00907"></a>00907     rc = <a class="code" href="group__Mesh.html#g3928a328006617330e735ca1644e7cb3" title="Create a new mesh.">fc_createMesh</a>(dataset, charBuf, &amp;gap_mesh);
<a name="l00908"></a>00908     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00909"></a>00909     rc = <a class="code" href="group__Mesh.html#g00fb04104cb0c5a6638cca5027b4b1df" title="Set the pointer to the mesh coordinates.">fc_setMeshCoordsPtr</a>(gap_mesh, numDim, numVertex, new_coords);
<a name="l00910"></a>00910     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00911"></a>00911     rc = <a class="code" href="group__Mesh.html#g73caf4cfc1c9d8b302d880735a67cd2a" title="Set the pointer to the mesh element connectivities.">fc_setMeshElementConnsPtr</a>(gap_mesh, <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a80b8143aeefa54756df4ea881fb21fea">FC_ET_LINE</a>, numElement,
<a name="l00912"></a>00912                        new_conns);
<a name="l00913"></a>00913     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00914"></a>00914     <span class="comment">// create displacement var and face normals var</span>
<a name="l00915"></a>00915     rc = <a class="code" href="group__Variable.html#g05d5098e68c1761ac851b2509dfbea70" title="Create a new sequence variable.">fc_createSeqVariable</a>(gap_mesh, sequence, displ_name, &amp;temp_numStep,
<a name="l00916"></a>00916                      &amp;gap_displ);
<a name="l00917"></a>00917     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00918"></a>00918     rc = <a class="code" href="group__Variable.html#g05d5098e68c1761ac851b2509dfbea70" title="Create a new sequence variable.">fc_createSeqVariable</a>(gap_mesh, sequence, <span class="stringliteral">"ave face normals"</span>, 
<a name="l00919"></a>00919                 &amp;temp_numStep, &amp;aveFaceNorms);
<a name="l00920"></a>00920     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00921"></a>00921     <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l00922"></a>00922       rc = <a class="code" href="group__Variable.html#g05d5098e68c1761ac851b2509dfbea70" title="Create a new sequence variable.">fc_createSeqVariable</a>(gap_mesh, sequence, <span class="stringliteral">"isDead"</span>,
<a name="l00923"></a>00923                   &amp;temp_numStep, &amp;isDeadVar);
<a name="l00924"></a>00924       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00925"></a>00925     }
<a name="l00926"></a>00926     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00927"></a>00927       new_displ_data = calloc(numDim*numVertex, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00928"></a>00928       new_ave_face_data = malloc(numDim*numElement*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00929"></a>00929       <span class="keywordflow">if</span> (!new_displ_data || !new_ave_face_data)
<a name="l00930"></a>00930      <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00931"></a>00931       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l00932"></a>00932      rc = <a class="code" href="group__Variable.html#gd2bb293943346a413ef5fa244a072b8f" title="Get a copy of a variable&amp;#39;s data as the requested data type.">fc_getVariableDataAsDataType</a>(displs[j][i], <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>,
<a name="l00933"></a>00933                            (<span class="keywordtype">void</span>**)&amp;displ_datas[j]);
<a name="l00934"></a>00934      <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00935"></a>00935       }
<a name="l00936"></a>00936       <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l00937"></a>00937      new_isDead_data = malloc(numElement*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00938"></a>00938      <span class="keywordflow">if</span> (!new_isDead_data)
<a name="l00939"></a>00939        <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00940"></a>00940      <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l00941"></a>00941        death_datas[j] = (<span class="keywordtype">double</span>**)malloc(numDeathVar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>*));
<a name="l00942"></a>00942        <span class="keywordflow">if</span> (!death_datas[j])
<a name="l00943"></a>00943          <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00944"></a>00944        <span class="keywordflow">for</span> (k = 0; k &lt; numDeathVar; k++) {
<a name="l00945"></a>00945          <a class="code" href="group__Variable.html#gd2bb293943346a413ef5fa244a072b8f" title="Get a copy of a variable&amp;#39;s data as the requested data type.">fc_getVariableDataAsDataType</a>(deathVars[j][k][i], <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>,
<a name="l00946"></a>00946                           (<span class="keywordtype">void</span>**)&amp;death_datas[j][k]);
<a name="l00947"></a>00947          <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00948"></a>00948        }
<a name="l00949"></a>00949      }
<a name="l00950"></a>00950       }
<a name="l00951"></a>00951       vindex = 0;
<a name="l00952"></a>00952       eindex = 0;
<a name="l00953"></a>00953       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l00954"></a>00954      <span class="keywordtype">int</span> otherMesh = (j == 0 ? 1 : 0);
<a name="l00955"></a>00955      <span class="keywordflow">for</span> (k = 0; k &lt; numKeeps[j]; k++) {
<a name="l00956"></a>00956        <span class="keywordtype">int</span> thisFaceID = keepThisFaceIDs[j][k];
<a name="l00957"></a>00957        <span class="keywordtype">int</span> otherFaceID = keepOtherFaceIDs[j][k];
<a name="l00958"></a>00958        <span class="comment">// assume skin face (only 1 parent element)</span>
<a name="l00959"></a>00959        <span class="keywordtype">int</span> thisElemID = elemParentsPerFace[j][thisFaceID][0];
<a name="l00960"></a>00960        <span class="keywordtype">int</span> otherElemID = elemParentsPerFace[otherMesh][otherFaceID][0];
<a name="l00961"></a>00961        <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> thisFaceCoords[4], otherFaceCoords[4], newPoint;
<a name="l00962"></a>00962        <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> thisNormal, otherNormal;
<a name="l00963"></a>00963        <span class="comment">// First the vertex</span>
<a name="l00964"></a>00964        memcpy(&amp;new_displ_data[vindex*numDim],
<a name="l00965"></a>00965            &amp;displ_datas[j][keepVertIDs[j][k]*numDim], 
<a name="l00966"></a>00966            numDim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00967"></a>00967        vindex++;
<a name="l00968"></a>00968        <span class="comment">// Then the parameterized point on the face</span>
<a name="l00969"></a>00969        <span class="keywordflow">for</span> (m = 0; m &lt; 4; m++) {
<a name="l00970"></a>00970          <span class="keywordtype">int</span> otherVertID = faceToVertConns[otherMesh][otherFaceID*4+m];
<a name="l00971"></a>00971          <span class="keywordflow">for</span> (n = 0; n &lt; numDim; n++)
<a name="l00972"></a>00972            otherFaceCoords[m][n] = coords[otherMesh][numDim*otherVertID+n]
<a name="l00973"></a>00973           + displ_datas[otherMesh][numDim*otherVertID+n];
<a name="l00974"></a>00974        }
<a name="l00975"></a>00975        <a class="code" href="group__PrivateGeometricRelations.html#g57be9af467e6c84e274d6828ae4b52b0" title="Compute parameterization of a point on a quad.">_fc_calcQuadLocation</a>(otherFaceCoords, 2, keepParams[j][k],
<a name="l00976"></a>00976                       &amp;newPoint);
<a name="l00977"></a>00977        <span class="keywordflow">for</span> (m = 0; m &lt; numDim; m++)
<a name="l00978"></a>00978          new_displ_data[vindex*numDim+m] = newPoint[m] - 
<a name="l00979"></a>00979                                            new_coords[vindex*numDim+m];
<a name="l00980"></a>00980        vindex++;
<a name="l00981"></a>00981        <span class="comment">// Also save the face normals</span>
<a name="l00982"></a>00982        <span class="keywordflow">for</span> (m = 0; m &lt; 4; m++) {
<a name="l00983"></a>00983          <span class="keywordtype">int</span> thisVertID = faceToVertConns[j][thisFaceID*4+m];
<a name="l00984"></a>00984          <span class="keywordflow">for</span> (n = 0; n &lt; numDim; n++)
<a name="l00985"></a>00985            thisFaceCoords[m][n] = coords[j][numDim*thisVertID+n]
<a name="l00986"></a>00986           + displ_datas[j][numDim*thisVertID+n];
<a name="l00987"></a>00987        }
<a name="l00988"></a>00988        <a class="code" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17" title="Compute unit normal of surface.">_fc_calcSurfaceNormal</a>(4, thisFaceCoords, &amp;thisNormal);
<a name="l00989"></a>00989        <a class="code" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17" title="Compute unit normal of surface.">_fc_calcSurfaceNormal</a>(4, otherFaceCoords, &amp;otherNormal);
<a name="l00990"></a>00990        <span class="keywordflow">if</span> (faceOrients[j][thisFaceID] == faceOrients[otherMesh][otherFaceID]) {
<a name="l00991"></a>00991          <span class="keywordflow">for</span> (m = 0; m &lt; numDim; m++)
<a name="l00992"></a>00992            new_ave_face_data[eindex*numDim+m] = (thisNormal[m] - otherNormal[m])/2.;
<a name="l00993"></a>00993        }
<a name="l00994"></a>00994        <span class="keywordflow">else</span> {
<a name="l00995"></a>00995          <span class="keywordflow">for</span> (m = 0; m &lt; numDim; m++)
<a name="l00996"></a>00996            new_ave_face_data[eindex*numDim+m] = (thisNormal[m] + otherNormal[m])/2.;
<a name="l00997"></a>00997        }
<a name="l00998"></a>00998        <span class="comment">// also calc &amp; save isDead</span>
<a name="l00999"></a>00999        <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l01000"></a>01000          new_isDead_data[eindex] = <a class="code" href="gaplines_8c.html#036046e3a36e4539ede49168d87695d6">isItDead</a>(numDeathVar, deathVarInfos,
<a name="l01001"></a>01001                                 thisElemID, death_datas[j],
<a name="l01002"></a>01002                                 otherElemID, death_datas[otherMesh]);
<a name="l01003"></a>01003          <span class="comment">//int isDead = 1;</span>
<a name="l01004"></a>01004          <span class="comment">//for (m = 0; m &lt; numDeathVar; m++) {</span>
<a name="l01005"></a>01005          <span class="comment">//}</span>
<a name="l01006"></a>01006 
<a name="l01007"></a>01007          <span class="comment">// FIX! do a real calc!</span>
<a name="l01008"></a>01008          <span class="comment">//if (death_datas[j][0][thisElemID] == 1 || </span>
<a name="l01009"></a>01009          <span class="comment">//death_datas[otherMesh][0][otherElemID] == 1) </span>
<a name="l01010"></a>01010          <span class="comment">// new_isDead_data[eindex] = 1;</span>
<a name="l01011"></a>01011          <span class="comment">//else</span>
<a name="l01012"></a>01012          <span class="comment">//new_isDead_data[eindex] = 0;</span>
<a name="l01013"></a>01013        }
<a name="l01014"></a>01014        eindex++;
<a name="l01015"></a>01015      }
<a name="l01016"></a>01016       }
<a name="l01017"></a>01017       rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(gap_displ[i], numVertex, numDim, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>,
<a name="l01018"></a>01018                      <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb207f48fe9fd9efb7bc772bbb41106e217f">FC_MT_VECTOR</a>, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>, 
<a name="l01019"></a>01019                      (<span class="keywordtype">void</span>*)new_displ_data);
<a name="l01020"></a>01020       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01021"></a>01021       rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(aveFaceNorms[i], numElement, numDim, 
<a name="l01022"></a>01022                      <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb207f48fe9fd9efb7bc772bbb41106e217f">FC_MT_VECTOR</a>, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>, 
<a name="l01023"></a>01023                    (<span class="keywordtype">void</span>*)new_ave_face_data);
<a name="l01024"></a>01024       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01025"></a>01025       free(displ_datas[0]);
<a name="l01026"></a>01026       free(displ_datas[1]);
<a name="l01027"></a>01027       <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l01028"></a>01028      rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(isDeadVar[i], numElement, 1, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>,
<a name="l01029"></a>01029                      <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb206d3b58fc952172de6c4a1b3f75b8b5b2">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>, (<span class="keywordtype">void</span>*)new_isDead_data);
<a name="l01030"></a>01030      <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01031"></a>01031      <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l01032"></a>01032        <span class="keywordflow">for</span> (k = 0; k &lt; numDeathVar; k++)
<a name="l01033"></a>01033          free(death_datas[j][k]);
<a name="l01034"></a>01034        free(death_datas[j]);
<a name="l01035"></a>01035      }
<a name="l01036"></a>01036       }
<a name="l01037"></a>01037     }
<a name="l01038"></a>01038   }
<a name="l01039"></a>01039   free(displs[0]);
<a name="l01040"></a>01040   free(displs[1]);
<a name="l01041"></a>01041   <span class="comment">// FIX free death seq vars arrays (but not the vars)</span>
<a name="l01042"></a>01042 
<a name="l01043"></a>01043   <span class="comment">// Create more variables</span>
<a name="l01044"></a>01044   {
<a name="l01045"></a>01045     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> templengths[numStep], tempnorms[numStep], temptangs[numStep];
<a name="l01046"></a>01046     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01047"></a>01047       <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> tempvector, tempnorm, temptang;
<a name="l01048"></a>01048       rc = <a class="code" href="group__GeometricRelations.html#g8934310cf05ff732d5892fa851344085" title="Return a variable with the edge lengths of the displaced mesh.">fc_getDisplacedEdgeLengths</a>(gap_mesh, gap_displ[i], &amp;templengths[i]);
<a name="l01049"></a>01049       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01050"></a>01050       rc = <a class="code" href="gaplines_8c.html#7b03c631227ee26e89bffeb4f23d711e">getLinesAsVectors</a>(gap_mesh, gap_displ[i], &amp;tempvector);
<a name="l01051"></a>01051       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01052"></a>01052       rc = <a class="code" href="group__VariableMath.html#g7c0b9c92305c0da11b9654f0e6077d33" title="Decompose a vector into normal and tangent components respective to a reference vector...">fc_createNormalTangentVariables2</a>(tempvector, aveFaceNorms[i],
<a name="l01053"></a>01053                              &amp;tempnorm, &amp;temptang);
<a name="l01054"></a>01054       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01055"></a>01055       rc = <a class="code" href="group__VariableMath.html#gc65fff664346c952a3271574679f9665" title="Performs unary function on a variable.">fc_varUnaryFunction</a>(tempnorm, fabs, <span class="stringliteral">"normal"</span>, &amp;tempnorms[i]);
<a name="l01056"></a>01056       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01057"></a>01057       rc = <a class="code" href="group__VariableMath.html#gc65fff664346c952a3271574679f9665" title="Performs unary function on a variable.">fc_varUnaryFunction</a>(temptang, fabs, <span class="stringliteral">"tanget"</span>, &amp;temptangs[i]);
<a name="l01058"></a>01058       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01059"></a>01059       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(tempvector);
<a name="l01060"></a>01060       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(tempnorm);
<a name="l01061"></a>01061       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(temptang);
<a name="l01062"></a>01062     }
<a name="l01063"></a>01063     rc = <a class="code" href="group__Variable.html#g962a68f110466d7e77d7bae3df089f20" title="Convert an array of basic vars into a sequence var.">fc_convertVariablesToSeqVariable</a>(numStep, templengths, sequence, 
<a name="l01064"></a>01064                          <span class="stringliteral">"length"</span>, &amp;lengths);
<a name="l01065"></a>01065     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01066"></a>01066     rc = <a class="code" href="group__Variable.html#g962a68f110466d7e77d7bae3df089f20" title="Convert an array of basic vars into a sequence var.">fc_convertVariablesToSeqVariable</a>(numStep, tempnorms, sequence, 
<a name="l01067"></a>01067                          <span class="stringliteral">"length_norm"</span>, &amp;norms);
<a name="l01068"></a>01068     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01069"></a>01069     rc = <a class="code" href="group__Variable.html#g962a68f110466d7e77d7bae3df089f20" title="Convert an array of basic vars into a sequence var.">fc_convertVariablesToSeqVariable</a>(numStep, temptangs, sequence, 
<a name="l01070"></a>01070                          <span class="stringliteral">"length_tang"</span>, &amp;tangs);
<a name="l01071"></a>01071     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01072"></a>01072   }
<a name="l01073"></a>01073 
<a name="l01074"></a>01074   <span class="comment">/*</span>
<a name="l01075"></a>01075 <span class="comment">  { // for debugging - make gaplines from this and from other</span>
<a name="l01076"></a>01076 <span class="comment">    int eindex = 0;</span>
<a name="l01077"></a>01077 <span class="comment">    for (i = 0; i &lt; 2; i++) {</span>
<a name="l01078"></a>01078 <span class="comment">      FC_Mesh temp_mesh;</span>
<a name="l01079"></a>01079 <span class="comment">      FC_Subset temp_subset;</span>
<a name="l01080"></a>01080 <span class="comment">      if (i == 0) </span>
<a name="l01081"></a>01081 <span class="comment">     sprintf(charBuf, "thisGaplines");</span>
<a name="l01082"></a>01082 <span class="comment">      else</span>
<a name="l01083"></a>01083 <span class="comment">     sprintf(charBuf, "otherGaplines");</span>
<a name="l01084"></a>01084 <span class="comment">      fc_createSubset(gap_mesh, charBuf, FC_AT_ELEMENT, &amp;temp_subset);</span>
<a name="l01085"></a>01085 <span class="comment">      for (j = 0; j &lt; numKeeps[i]; j++) {</span>
<a name="l01086"></a>01086 <span class="comment">     fc_addMemberToSubset(temp_subset, eindex);</span>
<a name="l01087"></a>01087 <span class="comment">     eindex++;</span>
<a name="l01088"></a>01088 <span class="comment">      }</span>
<a name="l01089"></a>01089 <span class="comment">      // HACK for exodus not writing element subsets</span>
<a name="l01090"></a>01090 <span class="comment">      fc_createSubsetMesh(temp_subset, dataset, 1, charBuf, &amp;temp_mesh);</span>
<a name="l01091"></a>01091 <span class="comment">    }</span>
<a name="l01092"></a>01092 <span class="comment">  }</span>
<a name="l01093"></a>01093 <span class="comment">  */</span>
<a name="l01094"></a>01094 
<a name="l01095"></a>01095   <span class="comment">// Create per side gaplines subset</span>
<a name="l01096"></a>01096   {
<a name="l01097"></a>01097     <span class="keywordtype">int</span> eindex;
<a name="l01098"></a>01098     <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> **sias[2];
<a name="l01099"></a>01099     <span class="comment">// create initialize lists</span>
<a name="l01100"></a>01100     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) { 
<a name="l01101"></a>01101       sias[i] = malloc(numShapes[i]*<span class="keyword">sizeof</span>(<a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a>*));
<a name="l01102"></a>01102       <span class="keywordflow">if</span> (sias[i] == NULL)
<a name="l01103"></a>01103      <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l01104"></a>01104       <span class="keywordflow">for</span> (j = 0; j &lt; numShapes[i]; j++) {
<a name="l01105"></a>01105      sias[i][j] = calloc(shapes[i][j].numSides, <span class="keyword">sizeof</span>(<a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a>));
<a name="l01106"></a>01106      <span class="keywordflow">if</span> (sias[i][j] == NULL)
<a name="l01107"></a>01107        <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l01108"></a>01108       }
<a name="l01109"></a>01109     }
<a name="l01110"></a>01110     <span class="comment">// add gapline ids to appropriate lists</span>
<a name="l01111"></a>01111     eindex = 0;
<a name="l01112"></a>01112     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l01113"></a>01113       <span class="keywordtype">int</span> otherMesh = (i == 0 ? 1 : 0);
<a name="l01114"></a>01114       <span class="keywordflow">for</span> (j = 0; j &lt; numKeeps[i]; j++) {
<a name="l01115"></a>01115      <span class="keywordtype">int</span> shapeID, sideID;
<a name="l01116"></a>01116      <a class="code" href="gaplines_8c.html#231047ab582a6ce1c7fb2bb3c6c1164c">findShapeSide</a>(keepThisFaceIDs[i][j], numShapes[i], shapes[i], 
<a name="l01117"></a>01117                 &amp;shapeID, &amp;sideID);
<a name="l01118"></a>01118      <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;sias[i][shapeID][sideID], eindex);
<a name="l01119"></a>01119      <a class="code" href="gaplines_8c.html#231047ab582a6ce1c7fb2bb3c6c1164c">findShapeSide</a>(keepOtherFaceIDs[i][j], numShapes[otherMesh],
<a name="l01120"></a>01120            shapes[otherMesh], &amp;shapeID, &amp;sideID);
<a name="l01121"></a>01121      <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;sias[otherMesh][shapeID][sideID], eindex);
<a name="l01122"></a>01122      eindex++;
<a name="l01123"></a>01123       }
<a name="l01124"></a>01124     }
<a name="l01125"></a>01125     <span class="comment">// make subset of non empty lists</span>
<a name="l01126"></a>01126     numSide = 0;
<a name="l01127"></a>01127     sides = NULL;
<a name="l01128"></a>01128     <span class="comment">// loop over first mesh's shapes</span>
<a name="l01129"></a>01129     <span class="keywordflow">for</span> (i = 0; i &lt; numShapes[0]; i++) {
<a name="l01130"></a>01130       <span class="keywordflow">for</span> (j = 0; j &lt; shapes[0][i].<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++) {
<a name="l01131"></a>01131 
<a name="l01132"></a>01132      <span class="comment">// skip if no entries</span>
<a name="l01133"></a>01133      <span class="keywordflow">if</span> (sias[0][i][j].numVal &lt; 1)
<a name="l01134"></a>01134        <span class="keywordflow">continue</span>;
<a name="l01135"></a>01135 
<a name="l01136"></a>01136      <span class="comment">// loop over 2nd mesh's shapes</span>
<a name="l01137"></a>01137      <span class="keywordflow">for</span> (k = 0; k &lt; numShapes[1]; k++) {
<a name="l01138"></a>01138        <span class="keywordflow">for</span> (m = 0; m &lt; shapes[1][k].<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; m++) {
<a name="l01139"></a>01139          <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> temp_sia = { 0, 0, 0 };
<a name="l01140"></a>01140 
<a name="l01141"></a>01141          <span class="comment">// skip if no entries</span>
<a name="l01142"></a>01142          <span class="keywordflow">if</span> (sias[1][k][m].numVal &lt; 1)
<a name="l01143"></a>01143            <span class="keywordflow">continue</span>;
<a name="l01144"></a>01144 
<a name="l01145"></a>01145          <span class="comment">// look for intersection</span>
<a name="l01146"></a>01146          <a class="code" href="gaplines_8c.html#63631fd67e55ca221855533f3f1b2f41">getRemoveSIAIntersection</a>(&amp;sias[0][i][j], &amp;sias[1][k][m], 
<a name="l01147"></a>01147                          &amp;temp_sia);
<a name="l01148"></a>01148          <span class="keywordflow">if</span> (temp_sia.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a> &gt; 0) {
<a name="l01149"></a>01149            <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> temp_subset;
<a name="l01150"></a>01150            <span class="keywordtype">char</span> *subset_name = malloc((strlen(mesh_names[0]) +
<a name="l01151"></a>01151                            strlen(mesh_names[1]) + 
<a name="l01152"></a>01152                            100)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01153"></a>01153            sprintf(subset_name, <span class="stringliteral">"%s_shape%d_side%d-%s_shape%d_side%d"</span>,
<a name="l01154"></a>01154                 mesh_names[0], i, j, mesh_names[1], k, m);
<a name="l01155"></a>01155            rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(gap_mesh, subset_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>,
<a name="l01156"></a>01156                      &amp;temp_subset);
<a name="l01157"></a>01157            <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l01158"></a>01158            free(subset_name);
<a name="l01159"></a>01159            <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(temp_subset, temp_sia.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>, 
<a name="l01160"></a>01160                           temp_sia.<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>);
<a name="l01161"></a>01161            <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;temp_sia);
<a name="l01162"></a>01162            sides = realloc(sides, (numSide+1)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01163"></a>01163            <span class="keywordflow">if</span> (!sides) 
<a name="l01164"></a>01164           <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l01165"></a>01165            sides[numSide] = temp_subset;
<a name="l01166"></a>01166            numSide++;
<a name="l01167"></a>01167          }
<a name="l01168"></a>01168        }
<a name="l01169"></a>01169      } <span class="comment">// done' with 2nd mesh's shapes</span>
<a name="l01170"></a>01170       }
<a name="l01171"></a>01171     } <span class="comment">// done with 1 mesh's shapes</span>
<a name="l01172"></a>01172     <span class="comment">// delete lists</span>
<a name="l01173"></a>01173     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) { 
<a name="l01174"></a>01174       <span class="keywordflow">for</span> (j = 0; j &lt; numShapes[i]; j++) {
<a name="l01175"></a>01175      <span class="keywordflow">for</span> (k = 0; k &lt; shapes[i][j].<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; k++) 
<a name="l01176"></a>01176        <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;sias[i][j][k]);
<a name="l01177"></a>01177      free(sias[i][j]);
<a name="l01178"></a>01178       }
<a name="l01179"></a>01179       free(sias[i]);
<a name="l01180"></a>01180     }
<a name="l01181"></a>01181   } 
<a name="l01182"></a>01182 
<a name="l01183"></a>01183   <span class="comment">// make alive subsets for entire gap mesh</span>
<a name="l01184"></a>01184   alivePerTime = NULL;
<a name="l01185"></a>01185   <span class="keywordflow">if</span> (numDeathVar &gt; 0) {
<a name="l01186"></a>01186     <span class="comment">//FC_Mesh temp_mesh;</span>
<a name="l01187"></a>01187     alivePerTime = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01188"></a>01188     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01189"></a>01189       rc = <a class="code" href="group__Threshold.html#g6419d82dbacbe4aed0a6e2cde7c3d146" title="Create thresholded region.">fc_createThresholdSubset</a>(isDeadVar[i], <span class="stringliteral">"=="</span>, 0, <span class="stringliteral">"temp"</span>,
<a name="l01190"></a>01190                         &amp;alivePerTime[i]);
<a name="l01191"></a>01191       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to create alive subset"</span>);
<a name="l01192"></a>01192       <span class="comment">// FIX delete these subsets</span>
<a name="l01193"></a>01193       <span class="comment">// debug hack</span>
<a name="l01194"></a>01194       <span class="comment">//sprintf(charBuf, "alive at step %d", i);</span>
<a name="l01195"></a>01195       <span class="comment">//rc = fc_createSubsetMesh(alivePerTime[i], dataset, 1, charBuf, </span>
<a name="l01196"></a>01196       <span class="comment">//              &amp;temp_mesh);</span>
<a name="l01197"></a>01197       <span class="comment">//fc_exitIfErrorPrintf(rc, "could not create mesh versin of alive subset");</span>
<a name="l01198"></a>01198     }
<a name="l01199"></a>01199   }
<a name="l01200"></a>01200 
<a name="l01201"></a>01201   <span class="comment">// Report min/max/ave/stdev lengths of lines for each step</span>
<a name="l01202"></a>01202   rc = <a class="code" href="group__Sequence.html#gea571d126666a139232f8800e5abac0c" title="Get a copy of the sequence&amp;#39;s coords as the requested data type.">fc_getSequenceCoordsAsDataType</a>(sequence, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>,
<a name="l01203"></a>01203                           (<span class="keywordtype">void</span>**)&amp;seq_coords); 
<a name="l01204"></a>01204   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get sequence coords"</span>);
<a name="l01205"></a>01205 
<a name="l01206"></a>01206   printf(<span class="stringliteral">"\n"</span>);
<a name="l01207"></a>01207   printf(<span class="stringliteral">"Number of gap lines found = %d\n"</span>, numKeeps[0] + numKeeps[1]);
<a name="l01208"></a>01208   printf(<span class="stringliteral">"Number of sets of sides involved = %d\n"</span>, numSide);
<a name="l01209"></a>01209   <span class="keywordflow">for</span> (i = 0; i &lt; numSide; i++) {
<a name="l01210"></a>01210     <span class="keywordtype">int</span> numMember;
<a name="l01211"></a>01211     <span class="keywordtype">char</span> *temp_name;
<a name="l01212"></a>01212     <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(sides[i], &amp;temp_name);
<a name="l01213"></a>01213     <a class="code" href="group__Subset.html#gdf7851470403bb379426110abf7923ba" title="Get number of members in a subset.">fc_getSubsetNumMember</a>(sides[i], &amp;numMember);
<a name="l01214"></a>01214     printf(<span class="stringliteral">"\n"</span>);
<a name="l01215"></a>01215     printf(<span class="stringliteral">"Stats for set %d ('%s'):\n"</span>, i, temp_name);
<a name="l01216"></a>01216     free(temp_name);
<a name="l01217"></a>01217     printf(<span class="stringliteral">"numGapline = %d\n"</span>, numMember);
<a name="l01218"></a>01218     <a class="code" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a>(<span class="stringliteral">"Gap Length"</span>, numStep, lengths, &amp;sides[i], alivePerTime,
<a name="l01219"></a>01219             seq_coords);
<a name="l01220"></a>01220     <a class="code" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a>(<span class="stringliteral">"Normal Component of Gap Length"</span>, numStep, norms,
<a name="l01221"></a>01221             &amp;sides[i], alivePerTime, seq_coords);
<a name="l01222"></a>01222     <a class="code" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a>(<span class="stringliteral">"Tangent Component of Gap Length"</span>, numStep, tangs,
<a name="l01223"></a>01223             &amp;sides[i], alivePerTime, seq_coords);
<a name="l01224"></a>01224   }
<a name="l01225"></a>01225   <span class="keywordflow">if</span> (numSide &gt; 1) {
<a name="l01226"></a>01226     printf(<span class="stringliteral">"\n"</span>);
<a name="l01227"></a>01227     printf(<span class="stringliteral">"Overall stats:\n"</span>);
<a name="l01228"></a>01228     printf(<span class="stringliteral">"numGapline = %d\n"</span>, numKeeps[0] + numKeeps[1]);
<a name="l01229"></a>01229     fflush(NULL);
<a name="l01230"></a>01230     <a class="code" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a>(<span class="stringliteral">"Gap Length"</span>, numStep, lengths, NULL, alivePerTime, seq_coords);
<a name="l01231"></a>01231     <a class="code" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a>(<span class="stringliteral">"Normal Component of Gap Length"</span>, numStep, norms, NULL,
<a name="l01232"></a>01232             alivePerTime, seq_coords);
<a name="l01233"></a>01233     <a class="code" href="gaplines_8c.html#caf6727d88e584a2ce4b90e096a7f366">printStats</a>(<span class="stringliteral">"Tangent Component of Gap Length"</span>, numStep, tangs, NULL,
<a name="l01234"></a>01234             alivePerTime, seq_coords);
<a name="l01235"></a>01235   }
<a name="l01236"></a>01236   fflush(NULL);
<a name="l01237"></a>01237 
<a name="l01238"></a>01238   <span class="comment">// delete some more stuff so that it doesn't show up in output</span>
<a name="l01239"></a>01239   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l01240"></a>01240     <span class="keywordflow">for</span> (j = 0; j &lt; numShapes[i]; j++)
<a name="l01241"></a>01241       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shapes[i][j]);
<a name="l01242"></a>01242     free(shapes[i]);
<a name="l01243"></a>01243   }
<a name="l01244"></a>01244   <a class="code" href="group__Variable.html#gef5ebe119abe1d217a216f0faad0e667" title="Delete a sequence variable.">fc_deleteSeqVariable</a>(numStep, aveFaceNorms);
<a name="l01245"></a>01245 
<a name="l01246"></a>01246   <span class="comment">// FIX! HACK! Since exodus can't write element subsets, create mesh </span>
<a name="l01247"></a>01247   <span class="comment">// copies of sides</span>
<a name="l01248"></a>01248   <span class="keywordflow">for</span> (i = 0; i &lt; numSide; i++) {
<a name="l01249"></a>01249     <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> temp_mesh;
<a name="l01250"></a>01250     <span class="keywordtype">char</span> *temp_name;
<a name="l01251"></a>01251     <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(sides[i], &amp;temp_name);
<a name="l01252"></a>01252     rc = <a class="code" href="group__Mesh.html#g13ed8e3d8db0f8452d15bc3249b1c33d" title="Create a new mesh which is the subset of another mesh.">fc_createSubsetMesh</a>(sides[i], dataset, 1, 1, 1, 1, 1,
<a name="l01253"></a>01253                     temp_name, &amp;temp_mesh,
<a name="l01254"></a>01254                     NULL, NULL);
<a name="l01255"></a>01255     free(temp_name);
<a name="l01256"></a>01256     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, 
<a name="l01257"></a>01257                        <span class="stringliteral">"Could not create mesh versions of the side subsets"</span>);
<a name="l01258"></a>01258   }
<a name="l01259"></a>01259 
<a name="l01260"></a>01260   <span class="comment">// Write the gaplines dataset</span>
<a name="l01261"></a>01261   <span class="keywordflow">if</span> (verbose_level &gt; <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a>) {
<a name="l01262"></a>01262     printf(<span class="stringliteral">"Writing gaplines dataset ...\n"</span>);
<a name="l01263"></a>01263     fflush(NULL);
<a name="l01264"></a>01264   }
<a name="l01265"></a>01265   {
<a name="l01266"></a>01266     <span class="keywordtype">char</span> *temp_name;
<a name="l01267"></a>01267     <a class="code" href="group__Dataset.html#gf6ce6ef4b5b3aebbd1d694c4e8d55969" title="Return name of a dataset.">fc_getDatasetName</a>(dataset, &amp;temp_name);
<a name="l01268"></a>01268     sprintf(charBuf, <span class="stringliteral">"gap lines for '"</span>);
<a name="l01269"></a>01269     strncat(charBuf, temp_name, 1000);
<a name="l01270"></a>01270     free(temp_name);
<a name="l01271"></a>01271     strncat(charBuf, <span class="stringliteral">"'"</span>, 1);
<a name="l01272"></a>01272     <a class="code" href="group__Dataset.html#g7c81170793aea61bca2aeb30dff03214" title="Change the name of a dataset.">fc_changeDatasetName</a>(dataset, charBuf);
<a name="l01273"></a>01273     <a class="code" href="group__FileIO.html#g054de7ff5051dda3f84fa92f060b4571" title="Rewrite a dataset.">fc_rewriteDataset</a>(dataset, <span class="stringliteral">"gaplines.ex2"</span>, <a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>);
<a name="l01274"></a>01274   }
<a name="l01275"></a>01275 
<a name="l01276"></a>01276   <span class="comment">// Final library</span>
<a name="l01277"></a>01277   <a class="code" href="group__Library.html#g29ff0e41fb4f58b55489bc875ac32b2f" title="Cleanup when done using Feature Characterization Library.">fc_finalLibrary</a>();
<a name="l01278"></a>01278 
<a name="l01279"></a>01279   exit(0);  
<a name="l01280"></a>01280 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6fb18051e7cbacebf794269fbf48714b"></a><!-- doxytag: member="gaplines.c::parseDeathVarSet" ref="6fb18051e7cbacebf794269fbf48714b" args="(int argc, char **argv, int *idx, int *numvars, deathvarinfo **deathvars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int parseDeathVarSet           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a> **&nbsp;</td>
          <td class="paramname"> <em>deathvars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00112">112</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00234">parser()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00113"></a>00113                                              {
<a name="l00114"></a>00114   <span class="keywordtype">long</span> lcheck;
<a name="l00115"></a>00115   <span class="keywordtype">double</span> dcheck;
<a name="l00116"></a>00116   <span class="keywordtype">int</span> nvars;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <span class="keywordtype">char</span>* end_ptr;
<a name="l00119"></a>00119   <span class="keywordtype">int</span> i,j;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="keywordflow">if</span> (*numvars !=0){
<a name="l00122"></a>00122     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: already have death vars"</span>);
<a name="l00123"></a>00123     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00124"></a>00124   }
<a name="l00125"></a>00125    
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   i = *idx;
<a name="l00128"></a>00128   <span class="keywordflow">if</span> (argc &lt; *idx+1){
<a name="l00129"></a>00129     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: cant get num vars"</span>);
<a name="l00130"></a>00130     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; <span class="comment">//cant get the num of vars</span>
<a name="l00131"></a>00131   }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   lcheck =  strtol(argv[i], &amp;end_ptr,10);
<a name="l00134"></a>00134   <span class="keywordflow">if</span> (*end_ptr == <span class="charliteral">'\0'</span>){ <span class="comment">//its a number</span>
<a name="l00135"></a>00135     nvars = (int)lcheck;
<a name="l00136"></a>00136   }<span class="keywordflow">else</span> { <span class="comment">//not a number</span>
<a name="l00137"></a>00137     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00138"></a>00138   }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (nvars == 0){
<a name="l00141"></a>00141     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: no death vars"</span>);
<a name="l00142"></a>00142     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00143"></a>00143   }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <span class="keywordflow">if</span> (argc &lt; i+3*nvars+1){
<a name="l00146"></a>00146     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: not enough args for num vars"</span>);
<a name="l00147"></a>00147     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00148"></a>00148   }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   *deathvars = (<a class="code" href="structdeathvarinfo.html">deathvarinfo</a>*)malloc(nvars*<span class="keyword">sizeof</span>(<a class="code" href="structdeathvarinfo.html">deathvarinfo</a>));
<a name="l00151"></a>00151   <span class="keywordflow">if</span> (!deathvars){
<a name="l00152"></a>00152     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00153"></a>00153     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00154"></a>00154   }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   i++;
<a name="l00157"></a>00157   <span class="keywordflow">for</span>(j = 0; j &lt; nvars; j++){
<a name="l00158"></a>00158     (*deathvars)[j].name = argv[i++];
<a name="l00159"></a>00159     (*deathvars)[j].op = argv[i++];
<a name="l00160"></a>00160     dcheck =  strtod(argv[i++], &amp;end_ptr);
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (*end_ptr == <span class="charliteral">'\0'</span>){ <span class="comment">//its a number</span>
<a name="l00162"></a>00162       (*deathvars)[j].val = dcheck;
<a name="l00163"></a>00163     } <span class="keywordflow">else</span>{
<a name="l00164"></a>00164       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: non-numerical value for cutoff"</span>);
<a name="l00165"></a>00165       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167   }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   *numvars = nvars;           
<a name="l00170"></a>00170   *idx = i-1;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00173"></a>00173 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="caf6727d88e584a2ce4b90e096a7f366"></a><!-- doxytag: member="gaplines.c::printStats" ref="caf6727d88e584a2ce4b90e096a7f366" args="(char *title, int numStep, FC_Variable *lengthSeqVar, FC_Subset *inputSubset, FC_Subset *alivePerTime, double *seq_coords)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void printStats           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>lengthSeqVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>inputSubset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>alivePerTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>seq_coords</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="gaplines_8c-source.html#l00377">377</a> of file <a class="el" href="gaplines_8c-source.html">gaplines.c</a>.</p>

<p>References <a class="el" href="subset_8c-source.html#l02008">fc_addMemberToSubset()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01040">fc_createSubsetIntersection()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="variable_8c-source.html#l05392">fc_getMeshFromVariable()</a>, <a class="el" href="mesh_8c-source.html#l03025">fc_getMeshNumElement()</a>, <a class="el" href="subset_8c-source.html#l02828">fc_getSubsetNumMember()</a>, <a class="el" href="statistics_8c-source.html#l00542">fc_getVariableSubsetMeanSdev()</a>, and <a class="el" href="statistics_8c-source.html#l00394">fc_getVariableSubsetMinMax()</a>.</p>

<p>Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00379"></a>00379                                      {
<a name="l00380"></a>00380   <span class="keywordtype">int</span> i;
<a name="l00381"></a>00381   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> temp_subset, subsets[numStep];
<a name="l00382"></a>00382 
<a name="l00383"></a>00383   <span class="comment">// If not input subset, make a subset that is the entire mesh</span>
<a name="l00384"></a>00384   <span class="keywordflow">if</span> (inputSubset)
<a name="l00385"></a>00385     temp_subset = *inputSubset;
<a name="l00386"></a>00386   <span class="keywordflow">else</span> {
<a name="l00387"></a>00387     <span class="keywordtype">int</span> numMember;
<a name="l00388"></a>00388     <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l00389"></a>00389     <a class="code" href="group__Variable.html#g6808d2015766d9b530b93375f42296a3" title="Get the parent mesh of the variable.">fc_getMeshFromVariable</a>(lengthSeqVar[0], &amp;mesh);
<a name="l00390"></a>00390     <a class="code" href="group__Mesh.html#g8bcadefbf0728724adf77ef52c1f3732" title="Returns number of elements in a mesh.">fc_getMeshNumElement</a>(mesh, &amp;numMember);
<a name="l00391"></a>00391     <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, &amp;temp_subset);
<a name="l00392"></a>00392     <span class="keywordflow">for</span> (i = 0; i &lt; numMember; i++)
<a name="l00393"></a>00393       <a class="code" href="group__Subset.html#g5ed37876a6f144458716efed8cb78dbe" title="Add member to a subset.">fc_addMemberToSubset</a>(temp_subset, i);
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396   <span class="comment">// If death is possible, find the ones that are still alive</span>
<a name="l00397"></a>00397   <span class="keywordflow">if</span> (alivePerTime) {
<a name="l00398"></a>00398     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00399"></a>00399       <a class="code" href="group__Subset.html#gebbcc05ef1a5287612b7767903e69b68" title="Create subset based on intersection of two input subsets.">fc_createSubsetIntersection</a>(temp_subset, <span class="stringliteral">"&amp;&amp;"</span>, alivePerTime[i],
<a name="l00400"></a>00400                       <span class="stringliteral">"temp"</span>, &amp;subsets[i]);
<a name="l00401"></a>00401   }
<a name="l00402"></a>00402   <span class="keywordflow">else</span> {
<a name="l00403"></a>00403     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00404"></a>00404       subsets[i] = temp_subset;
<a name="l00405"></a>00405   }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <span class="comment">// print the stats</span>
<a name="l00408"></a>00408   printf(<span class="stringliteral">"----------------------------------------------------------------\n"</span>); 
<a name="l00409"></a>00409   printf(<span class="stringliteral">"    Step      |      |    %s\n"</span>, title);
<a name="l00410"></a>00410   printf(<span class="stringliteral">"--------------|------|------------------------------------------\n"</span>);
<a name="l00411"></a>00411   printf(<span class="stringliteral">"ID     Value  |  num |    min        max        mean      stdev\n"</span>);
<a name="l00412"></a>00412   printf(<span class="stringliteral">"----------------------------------------------------------------\n"</span>);
<a name="l00413"></a>00413   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00414"></a>00414     <span class="keywordtype">int</span> num;
<a name="l00415"></a>00415     <span class="keywordtype">double</span> min, max, mean, stdev;
<a name="l00416"></a>00416     <a class="code" href="group__Subset.html#gdf7851470403bb379426110abf7923ba" title="Get number of members in a subset.">fc_getSubsetNumMember</a>(subsets[i], &amp;num);
<a name="l00417"></a>00417     <a class="code" href="group__Statistics.html#g7b44d38b8800d8c619af4b6b52d58759" title="Find min &amp;amp; max data values in a subset of a variable.">fc_getVariableSubsetMinMax</a>(lengthSeqVar[i], subsets[i], &amp;min, NULL, 
<a name="l00418"></a>00418                       &amp;max, NULL);
<a name="l00419"></a>00419     <a class="code" href="group__Statistics.html#gfc12edf46aed1d007679cdc29521cf9b" title="Compute mean and standard deviation of a subset of a variable.">fc_getVariableSubsetMeanSdev</a>(lengthSeqVar[i], subsets[i], &amp;mean, &amp;stdev);
<a name="l00420"></a>00420     printf(<span class="stringliteral">"%-2d %10f %6d %10f %10f %10f %10f\n"</span>, i, seq_coords[i], num,
<a name="l00421"></a>00421         min, max, mean, stdev);
<a name="l00422"></a>00422     fflush(NULL);
<a name="l00423"></a>00423   }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425   <span class="keywordflow">if</span> (!inputSubset)
<a name="l00426"></a>00426     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(temp_subset);
<a name="l00427"></a>00427   <span class="keywordflow">if</span> (alivePerTime) {
<a name="l00428"></a>00428     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00429"></a>00429       <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(subsets[i]);
<a name="l00430"></a>00430   }
<a name="l00431"></a>00431 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:10 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
