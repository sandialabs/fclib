<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: (Private)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>(Private)<br>
<small>
[<a class="el" href="group__TopologyRelations.html">Topological Relations</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for (Private):</div>
<div class="dynsection">
<center><table><tr><td><img src="group__PrivateTopologyRelations.gif" border="0" alt="" usemap="#group____PrivateTopologyRelations_map">
<map name="group____PrivateTopologyRelations_map">
<area shape="rect" href="group__TopologyRelations.html" title="Relationships between elements and vertices of the mesh." alt="" coords="7,5,180,32"></map></td></tr></table></center>
</div>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#g37ea1b7c3c6f17d0497acf53b978f798">_fc_getVertexParents</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int vertexID, <a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a> parent_assoc, int *numParent, int **parentIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get mesh entities which contain the given vertex.  <a href="#g37ea1b7c3c6f17d0497acf53b978f798"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#g05b0c3e39b4592754ab154589c743098">_fc_getEdgeParents</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int edgeID, <a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a> parent_assoc, int *numParent, int **parentIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get mesh entities which contain the given edge.  <a href="#g05b0c3e39b4592754ab154589c743098"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#ga3c8e49eccdc11c03dab603207b2762d">_fc_getFaceParents</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int faceID, <a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a> parent_assoc, int *numParent, int **parentIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get mesh entities which contain the given face.  <a href="#ga3c8e49eccdc11c03dab603207b2762d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#gf2e4a6939b02d61548079bc0d164cdeb">_fc_getVertexNeighbors</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int vertexID, int *numNeigh, int **neighIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get vertices which are neighbors of this vertex.  <a href="#gf2e4a6939b02d61548079bc0d164cdeb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#ga97907c6e81b24c2e3e50a9546ae3171">_fc_getEdgeNeighbors</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int edgeID, int *numNeigh, int **neighIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get edges which are neighbors of this edge.  <a href="#ga97907c6e81b24c2e3e50a9546ae3171"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#g1343dbb569834571a9aa6f8c77007d68">_fc_getFaceNeighbors</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int faceID, int shared_dim, int *numNeigh, int **neighIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get faces which are neighbors of this faces.  <a href="#g1343dbb569834571a9aa6f8c77007d68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#g5dc5005142d498e07a21953ec8c475e8">_fc_getElementNeighbors</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int elemID, int shared_dim, int *numNeigh, int **neighIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the neighbors of an element.  <a href="#g5dc5005142d498e07a21953ec8c475e8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateTopologyRelations.html#g02cb3c4ef2956582d868077999c93ce6">_fc_growNeighborList</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *srcIDs, <a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a> assoc, int level, int shared_dim, int *checked, <a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *keepIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the neighbors of a group of mesh entities.  <a href="#g02cb3c4ef2956582d868077999c93ce6"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga97907c6e81b24c2e3e50a9546ae3171"></a><!-- doxytag: member="topo.c::_fc_getEdgeNeighbors" ref="ga97907c6e81b24c2e3e50a9546ae3171" args="(FC_Mesh mesh, int edgeID, int *numNeigh, int **neighIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getEdgeNeighbors           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>edgeID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numNeigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neighIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get edges which are neighbors of this edge. 
<p>
<b>Description:</b> <p>
Returns the neighbor edges of the given edge. Edges are considered to be neighbors if they are connected by a vertex.<p>
<b>Modifications:</b> <ul>
<li>07/23/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh </td></tr>
<tr><td valign="top"><em>edgeID</em>&nbsp;</td><td>
input - edge ID </td></tr>
<tr><td valign="top"><em>numNeigh</em>&nbsp;</td><td>
output - the number of neighbors </td></tr>
<tr><td valign="top"><em>neighIDs</em>&nbsp;</td><td>
output - the neighbor IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l01072">1072</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04250">_fc_getMeshEdgeParentsOfVerticesPtr()</a>, <a class="el" href="storage_8c-source.html#l00441">fc_addIntArrayToSortedIntArray()</a>, <a class="el" href="storage_8c-source.html#l01363">fc_convertSortedIntArrayToIntArray()</a>, <a class="el" href="storage_8c-source.html#l00591">fc_deleteIntFromSortedIntArray()</a>, <a class="el" href="mesh_8c-source.html#l03571">fc_getMeshEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03161">fc_getMeshNumEdge()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="storage_8c-source.html#l00095">fc_initSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00510">fc_getMeshEntityNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01077"></a>01077   {
<a name="l01078"></a>01078   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01079"></a>01079   <span class="keywordtype">int</span> i;
<a name="l01080"></a>01080   <span class="keywordtype">int</span> numEdge, *edgeConns, *numEdgePerVert, **edgeParentsPerVert;
<a name="l01081"></a>01081   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> sia;
<a name="l01082"></a>01082 
<a name="l01083"></a>01083   <span class="comment">// default return</span>
<a name="l01084"></a>01084   <span class="keywordflow">if</span> (numNeigh)
<a name="l01085"></a>01085     *numNeigh = -1;
<a name="l01086"></a>01086   <span class="keywordflow">if</span> (neighIDs)
<a name="l01087"></a>01087     *neighIDs = NULL;
<a name="l01088"></a>01088 
<a name="l01089"></a>01089   <span class="comment">// check input</span>
<a name="l01090"></a>01090   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || edgeID &lt; 0 || !numNeigh || !neighIDs) {
<a name="l01091"></a>01091     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01092"></a>01092     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01093"></a>01093   }
<a name="l01094"></a>01094   rc = <a class="code" href="group__Mesh.html#g82f4aa5cf3a4a5011ae65cab2ed1a8c1" title="Get number of edges in a mesh.">fc_getMeshNumEdge</a>(mesh, &amp;numEdge);
<a name="l01095"></a>01095   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || edgeID &gt;= numEdge) {
<a name="l01096"></a>01096     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01097"></a>01097     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01098"></a>01098   }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100   <span class="comment">// log message</span>
<a name="l01101"></a>01101   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting edges which are neighbors of this edge."</span>);
<a name="l01102"></a>01102 
<a name="l01103"></a>01103   <span class="comment">// setup</span>
<a name="l01104"></a>01104   rc = <a class="code" href="group__Mesh.html#gcae096882dec5f984503869f5f64acfc" title="Return edge connectivities.">fc_getMeshEdgeConnsPtr</a>(mesh, &amp;edgeConns);
<a name="l01105"></a>01105   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01106"></a>01106     <span class="keywordflow">return</span> rc;
<a name="l01107"></a>01107   rc = <a class="code" href="group__PrivateMesh.html#gf7980c0d2195acd513810a86a150800a" title="Return parent edges of the vertices.">_fc_getMeshEdgeParentsOfVerticesPtr</a>(mesh, &amp;numEdgePerVert,
<a name="l01108"></a>01108                                        &amp;edgeParentsPerVert); 
<a name="l01109"></a>01109   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01110"></a>01110     <span class="keywordflow">return</span> rc;  
<a name="l01111"></a>01111 
<a name="l01112"></a>01112   <span class="comment">// Get all edges that own vertices from this edge</span>
<a name="l01113"></a>01113   <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;sia);
<a name="l01114"></a>01114   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l01115"></a>01115     <span class="keywordtype">int</span> vertID = edgeConns[edgeID*2+i];
<a name="l01116"></a>01116     <span class="keywordtype">int</span> ret = <a class="code" href="group__SimpleDataObjects.html#gf842f060b1f39a0acfc54421bbe0865a" title="Add an array of ints to a sorted int array.">fc_addIntArrayToSortedIntArray</a>(&amp;sia, numEdgePerVert[vertID],
<a name="l01117"></a>01117                               edgeParentsPerVert[vertID], 0);
<a name="l01118"></a>01118     <span class="keywordflow">if</span> (ret &lt; 0) {
<a name="l01119"></a>01119       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to add int to sia"</span>);
<a name="l01120"></a>01120       <span class="keywordflow">return</span> ret;
<a name="l01121"></a>01121     }
<a name="l01122"></a>01122   }
<a name="l01123"></a>01123   
<a name="l01124"></a>01124   <span class="comment">// remove this edge from list</span>
<a name="l01125"></a>01125   <a class="code" href="group__SimpleDataObjects.html#gc800f634fb42d44a6c31d79743a6864c" title="Remove an int from a sorted int array.">fc_deleteIntFromSortedIntArray</a>(&amp;sia, edgeID);
<a name="l01126"></a>01126 
<a name="l01127"></a>01127   <span class="comment">// get array</span>
<a name="l01128"></a>01128   rc = <a class="code" href="group__SimpleDataObjects.html#g964b6f06b28b9587ae2fbd18fe2b7e9e" title="Convert sorted int array to array.">fc_convertSortedIntArrayToIntArray</a>(&amp;sia, numNeigh, neighIDs);  
<a name="l01129"></a>01129   
<a name="l01130"></a>01130   <span class="keywordflow">return</span> rc;
<a name="l01131"></a>01131 } 
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g05b0c3e39b4592754ab154589c743098"></a><!-- doxytag: member="topo.c::_fc_getEdgeParents" ref="g05b0c3e39b4592754ab154589c743098" args="(FC_Mesh mesh, int edgeID, FC_AssociationType parent_assoc, int *numParent, int **parentIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getEdgeParents           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>edgeID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a>&nbsp;</td>
          <td class="paramname"> <em>parent_assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>parentIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get mesh entities which contain the given edge. 
<p>
<b>Description:</b> <p>
Specify an edge and mesh entity (e.g. element) and this routines returns IDs of that type of mesh entity which contain (are made from) the given edge.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000099">Todo:</a></b></dt><dd>Make sure only calls edges/face stuff when it needs to. Cleanup!</dd></dl>
<b>Modifications:</b> <ul>
<li>07/09/04 WSK created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>edgeID</em>&nbsp;</td><td>
input - edge id </td></tr>
<tr><td valign="top"><em>parent_assoc</em>&nbsp;</td><td>
input - association type of the parent </td></tr>
<tr><td valign="top"><em>numParent</em>&nbsp;</td><td>
output - the number of parents </td></tr>
<tr><td valign="top"><em>parentIDs</em>&nbsp;</td><td>
output - array of parent IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l00798">798</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04444">_fc_getMeshElementParentsOfEdgesPtr()</a>, <a class="el" href="mesh_8c-source.html#l04318">_fc_getMeshFaceParentsOfVerticesPtr()</a>, <a class="el" href="storage_8c-source.html#l00397">fc_addIntToSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00192">FC_AT_EDGE</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00190">FC_AT_UNKNOWN</a>, <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="storage_8c-source.html#l01363">fc_convertSortedIntArrayToIntArray()</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="mesh_8c-source.html#l03571">fc_getMeshEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03161">fc_getMeshNumEdge()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="storage_8c-source.html#l00095">fc_initSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00286">fc_isAssociationTypeValid()</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00279">fc_getMeshEntityParents()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00804"></a>00804   {
<a name="l00805"></a>00805   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00806"></a>00806   <span class="keywordtype">int</span> i, j;
<a name="l00807"></a>00807   <span class="keywordtype">int</span> numEdge;
<a name="l00808"></a>00808   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> sia;
<a name="l00809"></a>00809   <span class="keywordtype">int</span>* edgeConns;
<a name="l00810"></a>00810   
<a name="l00811"></a>00811   <span class="comment">// default return values</span>
<a name="l00812"></a>00812   <span class="keywordflow">if</span> (numParent)
<a name="l00813"></a>00813     *numParent = -1;
<a name="l00814"></a>00814   <span class="keywordflow">if</span> (parentIDs)
<a name="l00815"></a>00815     *parentIDs = NULL;
<a name="l00816"></a>00816   
<a name="l00817"></a>00817   <span class="comment">// check input</span>
<a name="l00818"></a>00818   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || edgeID &lt; 0 || 
<a name="l00819"></a>00819       !<a class="code" href="group__DataTypes.html#gc3097dff5d1b0602671b7d2805162169" title="Verify that the given value is valid for this enum.">fc_isAssociationTypeValid</a>(parent_assoc) || 
<a name="l00820"></a>00820       parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a> || parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a> || 
<a name="l00821"></a>00821       parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6d5a38e6486b577a8d9bbba0e1c1a443d">FC_AT_UNKNOWN</a> || !numParent || !parentIDs) {
<a name="l00822"></a>00822     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00823"></a>00823     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00824"></a>00824   }  
<a name="l00825"></a>00825 
<a name="l00826"></a>00826   <span class="comment">// get mesh info</span>
<a name="l00827"></a>00827   rc = <a class="code" href="group__Mesh.html#g82f4aa5cf3a4a5011ae65cab2ed1a8c1" title="Get number of edges in a mesh.">fc_getMeshNumEdge</a>(mesh, &amp;numEdge);
<a name="l00828"></a>00828   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || edgeID &gt;= numEdge) {
<a name="l00829"></a>00829     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00830"></a>00830     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00831"></a>00831   }
<a name="l00832"></a>00832   rc = <a class="code" href="group__Mesh.html#gcae096882dec5f984503869f5f64acfc" title="Return edge connectivities.">fc_getMeshEdgeConnsPtr</a>(mesh, &amp;edgeConns);
<a name="l00833"></a>00833   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00834"></a>00834     <span class="keywordflow">return</span> rc;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836   <span class="comment">// log message</span>
<a name="l00837"></a>00837   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting mesh entities which contain the given edge."</span>);
<a name="l00838"></a>00838 
<a name="l00839"></a>00839   <span class="comment">// type of parent</span>
<a name="l00840"></a>00840   <span class="keywordflow">if</span> (parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>) {
<a name="l00841"></a>00841     *numParent = 1;
<a name="l00842"></a>00842     *parentIDs = (<span class="keywordtype">int</span>*)calloc(1, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00843"></a>00843     <span class="keywordflow">if</span> (*parentIDs == NULL) {
<a name="l00844"></a>00844       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00845"></a>00845       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00848"></a>00848   }
<a name="l00849"></a>00849   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>) {
<a name="l00850"></a>00850     <span class="keywordtype">int</span> *numElemPerEdge, **elemParentsPerEdge;
<a name="l00851"></a>00851     rc = <a class="code" href="group__PrivateMesh.html#g889846c3db62a020c33f8ceb6d7e27e7" title="Return parent elements of the edges.">_fc_getMeshElementParentsOfEdgesPtr</a>(mesh, &amp;numElemPerEdge,
<a name="l00852"></a>00852                                           &amp;elemParentsPerEdge);
<a name="l00853"></a>00853     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00854"></a>00854       <span class="keywordflow">return</span> rc;
<a name="l00855"></a>00855     *numParent = numElemPerEdge[edgeID];
<a name="l00856"></a>00856     *parentIDs = (<span class="keywordtype">int</span>*)malloc(*numParent*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00857"></a>00857     <span class="keywordflow">if</span> (*parentIDs == NULL) {
<a name="l00858"></a>00858       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00859"></a>00859       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00860"></a>00860     }
<a name="l00861"></a>00861     <span class="keywordflow">for</span> (i = 0; i &lt; *numParent; i++)
<a name="l00862"></a>00862       (*parentIDs)[i] = elemParentsPerEdge[edgeID][i];
<a name="l00863"></a>00863     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00864"></a>00864   }
<a name="l00865"></a>00865   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>) {
<a name="l00866"></a>00866     <span class="keywordtype">int</span> *numFacePerVert, **faceParentsPerVert;
<a name="l00867"></a>00867     <span class="keywordtype">int</span> vertID1, vertID2, numFace1, numFace2, *faceIDs1, *faceIDs2;
<a name="l00868"></a>00868     <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;sia);
<a name="l00869"></a>00869     rc = <a class="code" href="group__PrivateMesh.html#g53879e825667d77328908ec1e4a75506" title="Return parent faces of the vertices.">_fc_getMeshFaceParentsOfVerticesPtr</a>(mesh, &amp;numFacePerVert,
<a name="l00870"></a>00870                                          &amp;faceParentsPerVert);
<a name="l00871"></a>00871     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00872"></a>00872       <span class="keywordflow">return</span> rc;
<a name="l00873"></a>00873     <span class="keywordflow">if</span> (numFacePerVert == 0) {
<a name="l00874"></a>00874       *numParent = 0;
<a name="l00875"></a>00875       *parentIDs = NULL;
<a name="l00876"></a>00876       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00877"></a>00877     }
<a name="l00878"></a>00878     vertID1 = edgeConns[edgeID*2];
<a name="l00879"></a>00879     vertID2 = edgeConns[edgeID*2+1];
<a name="l00880"></a>00880     numFace1 = numFacePerVert[vertID1];
<a name="l00881"></a>00881     numFace2 = numFacePerVert[vertID2];
<a name="l00882"></a>00882     faceIDs1 = faceParentsPerVert[vertID1];
<a name="l00883"></a>00883     faceIDs2 = faceParentsPerVert[vertID2];
<a name="l00884"></a>00884     <span class="comment">// WSK - thought about walking the two lists at the same time for</span>
<a name="l00885"></a>00885     <span class="comment">// speedup, but that would require lists to be sorted, and since</span>
<a name="l00886"></a>00886     <span class="comment">// these lists are usually small, speedup would probably be minimal. </span>
<a name="l00887"></a>00887     <span class="keywordflow">for</span> (i = 0; i &lt; numFace1; i++) {
<a name="l00888"></a>00888       <span class="keywordflow">for</span> (j = 0; j &lt; numFace2; j++) {
<a name="l00889"></a>00889         <span class="keywordflow">if</span> (faceIDs1[i] == faceIDs2[j]) {
<a name="l00890"></a>00890           <span class="keywordtype">int</span> ret = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;sia, faceIDs1[i]);
<a name="l00891"></a>00891           <span class="keywordflow">if</span> (ret &lt; 0) {
<a name="l00892"></a>00892             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to add int to sia"</span>);
<a name="l00893"></a>00893             <span class="keywordflow">return</span> ret;
<a name="l00894"></a>00894           }
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896       }
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898     rc = <a class="code" href="group__SimpleDataObjects.html#g964b6f06b28b9587ae2fbd18fe2b7e9e" title="Convert sorted int array to array.">fc_convertSortedIntArrayToIntArray</a>(&amp;sia, numParent, parentIDs);
<a name="l00899"></a>00899     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00900"></a>00900       <span class="keywordflow">return</span> rc;
<a name="l00901"></a>00901     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00902"></a>00902   }
<a name="l00903"></a>00903   <span class="keywordflow">else</span> {
<a name="l00904"></a>00904     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"shouldn't be able to get here."</span>); 
<a name="l00905"></a>00905     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; <span class="comment">// shouldn't be able to get here</span>
<a name="l00906"></a>00906   }
<a name="l00907"></a>00907 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g5dc5005142d498e07a21953ec8c475e8"></a><!-- doxytag: member="topo.c::_fc_getElementNeighbors" ref="g5dc5005142d498e07a21953ec8c475e8" args="(FC_Mesh mesh, int elemID, int shared_dim, int *numNeigh, int **neighIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getElementNeighbors           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>elemID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numNeigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neighIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the neighbors of an element. 
<p>
<b>Description:</b> <p>
Returns the elements that are neighbors of the given element. The type of neighbor depends on the input argument 'shared_dim' which is the minimum dimensionality of the overlap between the elements. For example, 0 means that elements that share a vertex, edge or face are neighbors, while 2 means that only elements that share a face are neighbors. The higher the shared_dim, the more restrictive the neighbor condition.<p>
<b>Modifications:</b> <ul>
<li>04/24/03 WSK, Create. A more general purpose function to replace _fc_getEdgeNbrs and _fc_getVertexNbrs since they do almost exactly the same. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh </td></tr>
<tr><td valign="top"><em>elemID</em>&nbsp;</td><td>
input - element number </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - the minimum dimensionality of shared entity </td></tr>
<tr><td valign="top"><em>numNeigh</em>&nbsp;</td><td>
output - the number of neighbors </td></tr>
<tr><td valign="top"><em>neighIDs</em>&nbsp;</td><td>
output - the neighbor IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l01259">1259</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04706">_fc_getMeshElementNeighborsViaEdgePtr()</a>, <a class="el" href="mesh_8c-source.html#l04774">_fc_getMeshElementNeighborsViaFacePtr()</a>, <a class="el" href="mesh_8c-source.html#l04639">_fc_getMeshElementNeighborsViaVertexPtr()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00510">fc_getMeshEntityNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01265"></a>01265   {
<a name="l01266"></a>01266   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01267"></a>01267   <span class="keywordtype">int</span> *numElemNeighsViaEntity, **elemNeighsViaEntity;
<a name="l01268"></a>01268 
<a name="l01269"></a>01269   <span class="comment">// default return</span>
<a name="l01270"></a>01270   <span class="keywordflow">if</span> (numNeigh)
<a name="l01271"></a>01271     *numNeigh = -1;
<a name="l01272"></a>01272   <span class="keywordflow">if</span> (neighIDs)
<a name="l01273"></a>01273     *neighIDs = NULL;
<a name="l01274"></a>01274 
<a name="l01275"></a>01275   <span class="comment">// check input</span>
<a name="l01276"></a>01276   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || elemID &lt; 0 || shared_dim &lt; 0 || shared_dim &gt; 2
<a name="l01277"></a>01277       || !numNeigh || !neighIDs) {
<a name="l01278"></a>01278         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01279"></a>01279     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01280"></a>01280   }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282   <span class="comment">// log message</span>
<a name="l01283"></a>01283   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the neighbors of an element."</span>);
<a name="l01284"></a>01284 
<a name="l01285"></a>01285   <span class="comment">// Get entity specific info</span>
<a name="l01286"></a>01286   <span class="keywordflow">switch</span> (shared_dim) {
<a name="l01287"></a>01287   <span class="keywordflow">case</span> 0: 
<a name="l01288"></a>01288     rc = <a class="code" href="group__PrivateMesh.html#g30b413b6bbce08d1c23c96f24e4c162f" title="Return element neighbors that share an vertex.">_fc_getMeshElementNeighborsViaVertexPtr</a>(mesh, &amp;numElemNeighsViaEntity, 
<a name="l01289"></a>01289                                                  &amp;elemNeighsViaEntity);
<a name="l01290"></a>01290     <span class="keywordflow">break</span>;
<a name="l01291"></a>01291   <span class="keywordflow">case</span> 1:
<a name="l01292"></a>01292     rc = <a class="code" href="group__PrivateMesh.html#g92e7c53480a0b6fe6b0f2de140c17d2b" title="Return element neighbors that share an edge.">_fc_getMeshElementNeighborsViaEdgePtr</a>(mesh, &amp;numElemNeighsViaEntity, 
<a name="l01293"></a>01293                                                &amp;elemNeighsViaEntity);
<a name="l01294"></a>01294     <span class="keywordflow">break</span>;
<a name="l01295"></a>01295   <span class="keywordflow">case</span> 2:
<a name="l01296"></a>01296     rc = <a class="code" href="group__PrivateMesh.html#g9f4a1862e35188f1f387e5379f910ebe" title="Return element neighbors that share an face.">_fc_getMeshElementNeighborsViaFacePtr</a>(mesh, &amp;numElemNeighsViaEntity, 
<a name="l01297"></a>01297                                                &amp;elemNeighsViaEntity);
<a name="l01298"></a>01298     <span class="keywordflow">break</span>;
<a name="l01299"></a>01299   }
<a name="l01300"></a>01300   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01301"></a>01301     <span class="keywordflow">return</span> rc;
<a name="l01302"></a>01302 
<a name="l01303"></a>01303   <span class="comment">// Copy the ids</span>
<a name="l01304"></a>01304   <span class="keywordflow">if</span> (numElemNeighsViaEntity == NULL) {
<a name="l01305"></a>01305     *numNeigh = 0;
<a name="l01306"></a>01306     *neighIDs = NULL;
<a name="l01307"></a>01307     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01308"></a>01308   }
<a name="l01309"></a>01309   *numNeigh = numElemNeighsViaEntity[elemID];
<a name="l01310"></a>01310   <span class="keywordflow">if</span> (*numNeigh &gt; 0) {
<a name="l01311"></a>01311     *neighIDs = (<span class="keywordtype">int</span>*)malloc(*numNeigh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01312"></a>01312     <span class="keywordflow">if</span> (*neighIDs == NULL) {
<a name="l01313"></a>01313       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01314"></a>01314       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01315"></a>01315     }
<a name="l01316"></a>01316     memcpy(*neighIDs, elemNeighsViaEntity[elemID], *numNeigh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01317"></a>01317   }
<a name="l01318"></a>01318 
<a name="l01319"></a>01319   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01320"></a>01320 } 
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g1343dbb569834571a9aa6f8c77007d68"></a><!-- doxytag: member="topo.c::_fc_getFaceNeighbors" ref="g1343dbb569834571a9aa6f8c77007d68" args="(FC_Mesh mesh, int faceID, int shared_dim, int *numNeigh, int **neighIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getFaceNeighbors           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>faceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numNeigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neighIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get faces which are neighbors of this faces. 
<p>
<b>Description:</b> <p>
Returns the neighbor faces of the given face. The type of neighbor depends on the input argument 'shared_dim' which is the minimum dimensionality of the overlap between the elements. For example, 0 means that faces share at least a vertex while 1 means that faces must share an edge. The higher the shared_dim, the more more restrictive the neighbor condition.<p>
<b>Modifications:</b> <ul>
<li>07/23/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh </td></tr>
<tr><td valign="top"><em>faceID</em>&nbsp;</td><td>
input - face ID </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - the minimum dimensionality of shared entity </td></tr>
<tr><td valign="top"><em>numNeigh</em>&nbsp;</td><td>
output - the number of neighbors </td></tr>
<tr><td valign="top"><em>neighIDs</em>&nbsp;</td><td>
output - the neighbor IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l01149">1149</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04318">_fc_getMeshFaceParentsOfVerticesPtr()</a>, <a class="el" href="storage_8c-source.html#l00441">fc_addIntArrayToSortedIntArray()</a>, <a class="el" href="storage_8c-source.html#l01363">fc_convertSortedIntArrayToIntArray()</a>, <a class="el" href="storage_8c-source.html#l00591">fc_deleteIntFromSortedIntArray()</a>, <a class="el" href="mesh_8c-source.html#l03691">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03208">fc_getMeshNumFace()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="storage_8c-source.html#l00095">fc_initSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>, and <a class="el" href="storage_8h-source.html#l00101">FC_SortedIntArray::vals</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00510">fc_getMeshEntityNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01155"></a>01155   {
<a name="l01156"></a>01156   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01157"></a>01157   <span class="keywordtype">int</span> i, j, k;
<a name="l01158"></a>01158   <span class="keywordtype">int</span> numFace, maxNumVertPerFace, *numVertPerFace, *faceConns;
<a name="l01159"></a>01159   <span class="keywordtype">int</span> *numFacePerVert, **faceParentsPerVert;
<a name="l01160"></a>01160   <span class="comment">//_FC_Vertex *vertices, *vertex_p;</span>
<a name="l01161"></a>01161   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> sia;
<a name="l01162"></a>01162 
<a name="l01163"></a>01163   <span class="comment">// default return</span>
<a name="l01164"></a>01164   <span class="keywordflow">if</span> (numNeigh)
<a name="l01165"></a>01165     *numNeigh = -1;
<a name="l01166"></a>01166   <span class="keywordflow">if</span> (neighIDs)
<a name="l01167"></a>01167     *neighIDs = NULL;
<a name="l01168"></a>01168 
<a name="l01169"></a>01169   <span class="comment">// check input</span>
<a name="l01170"></a>01170   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || faceID &lt; 0 || shared_dim &lt; 0 || shared_dim &gt; 1
<a name="l01171"></a>01171       || !numNeigh || !neighIDs) {
<a name="l01172"></a>01172     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>)); 
<a name="l01173"></a>01173     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01174"></a>01174   }
<a name="l01175"></a>01175   rc = <a class="code" href="group__Mesh.html#g8c619c146c0850895098f5dbfb487418" title="Get number of faces in a mesh.">fc_getMeshNumFace</a>(mesh, &amp;numFace);
<a name="l01176"></a>01176   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || faceID &gt;= numFace) {
<a name="l01177"></a>01177         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>)); 
<a name="l01178"></a>01178     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01179"></a>01179   }
<a name="l01180"></a>01180 
<a name="l01181"></a>01181   <span class="comment">// log message</span>
<a name="l01182"></a>01182   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting faces which are neighbors of this face."</span>);
<a name="l01183"></a>01183 
<a name="l01184"></a>01184   <span class="comment">// setup</span>
<a name="l01185"></a>01185   rc = <a class="code" href="group__Mesh.html#g8e318f4b17572413004acf14b18deb2b" title="Return face connectivities.">fc_getMeshFaceConnsPtr</a>(mesh, &amp;numVertPerFace, &amp;maxNumVertPerFace,
<a name="l01186"></a>01186                               &amp;faceConns);
<a name="l01187"></a>01187   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01188"></a>01188     <span class="keywordflow">return</span> rc;
<a name="l01189"></a>01189   rc = <a class="code" href="group__PrivateMesh.html#g53879e825667d77328908ec1e4a75506" title="Return parent faces of the vertices.">_fc_getMeshFaceParentsOfVerticesPtr</a>(mesh, &amp;numFacePerVert,
<a name="l01190"></a>01190                                       &amp;faceParentsPerVert);
<a name="l01191"></a>01191   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01192"></a>01192     <span class="keywordflow">return</span> rc;
<a name="l01193"></a>01193 
<a name="l01194"></a>01194   <span class="comment">// Vertex neighbors: Get all faces that own vertices from this face</span>
<a name="l01195"></a>01195   <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;sia);
<a name="l01196"></a>01196   <span class="keywordflow">for</span> (i = 0; i &lt; numVertPerFace[faceID]; i++) {
<a name="l01197"></a>01197     <span class="keywordtype">int</span> vertID = faceConns[faceID*maxNumVertPerFace+i];
<a name="l01198"></a>01198     <span class="keywordtype">int</span> ret = <a class="code" href="group__SimpleDataObjects.html#gf842f060b1f39a0acfc54421bbe0865a" title="Add an array of ints to a sorted int array.">fc_addIntArrayToSortedIntArray</a>(&amp;sia, numFacePerVert[vertID],
<a name="l01199"></a>01199                               faceParentsPerVert[vertID], 0);
<a name="l01200"></a>01200     <span class="keywordflow">if</span> (ret &lt; 0) {
<a name="l01201"></a>01201       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to add ID to sia"</span>);
<a name="l01202"></a>01202       <span class="keywordflow">return</span> ret;
<a name="l01203"></a>01203     }
<a name="l01204"></a>01204   }
<a name="l01205"></a>01205   
<a name="l01206"></a>01206   <span class="comment">// remove this face from list</span>
<a name="l01207"></a>01207   <a class="code" href="group__SimpleDataObjects.html#gc800f634fb42d44a6c31d79743a6864c" title="Remove an int from a sorted int array.">fc_deleteIntFromSortedIntArray</a>(&amp;sia, faceID);
<a name="l01208"></a>01208 
<a name="l01209"></a>01209   <span class="comment">// Edge neighbors - remove faces that don't have 2 verts from this face</span>
<a name="l01210"></a>01210   <span class="keywordflow">if</span> (shared_dim == 1) {
<a name="l01211"></a>01211     k = 0;
<a name="l01212"></a>01212     <span class="keywordflow">while</span> (k &lt; sia.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>) {
<a name="l01213"></a>01213       <span class="keywordtype">int</span> currentID = sia.<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[k];
<a name="l01214"></a>01214       <span class="keywordtype">int</span> found = 0;
<a name="l01215"></a>01215       <span class="keywordflow">for</span> (i = 0; i &lt; numVertPerFace[faceID]; i++) {
<a name="l01216"></a>01216         <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerFace[currentID]; j++) {
<a name="l01217"></a>01217           <span class="keywordflow">if</span> (faceConns[faceID*maxNumVertPerFace+i] == 
<a name="l01218"></a>01218               faceConns[currentID*maxNumVertPerFace+j]) {
<a name="l01219"></a>01219             found++;
<a name="l01220"></a>01220             <span class="keywordflow">break</span>;
<a name="l01221"></a>01221           }
<a name="l01222"></a>01222         }
<a name="l01223"></a>01223         <span class="keywordflow">if</span> (found == 2)
<a name="l01224"></a>01224           <span class="keywordflow">break</span>;
<a name="l01225"></a>01225       }
<a name="l01226"></a>01226       <span class="keywordflow">if</span> (found &lt; 2) {
<a name="l01227"></a>01227         <a class="code" href="group__SimpleDataObjects.html#gc800f634fb42d44a6c31d79743a6864c" title="Remove an int from a sorted int array.">fc_deleteIntFromSortedIntArray</a>(&amp;sia, currentID);
<a name="l01228"></a>01228       }
<a name="l01229"></a>01229       <span class="keywordflow">else</span> {
<a name="l01230"></a>01230      k++;
<a name="l01231"></a>01231       }
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233   }
<a name="l01234"></a>01234   
<a name="l01235"></a>01235   <span class="comment">// get array</span>
<a name="l01236"></a>01236   rc = <a class="code" href="group__SimpleDataObjects.html#g964b6f06b28b9587ae2fbd18fe2b7e9e" title="Convert sorted int array to array.">fc_convertSortedIntArrayToIntArray</a>(&amp;sia, numNeigh, neighIDs);
<a name="l01237"></a>01237     
<a name="l01238"></a>01238   <span class="keywordflow">return</span> rc;
<a name="l01239"></a>01239 } 
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ga3c8e49eccdc11c03dab603207b2762d"></a><!-- doxytag: member="topo.c::_fc_getFaceParents" ref="ga3c8e49eccdc11c03dab603207b2762d" args="(FC_Mesh mesh, int faceID, FC_AssociationType parent_assoc, int *numParent, int **parentIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getFaceParents           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>faceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a>&nbsp;</td>
          <td class="paramname"> <em>parent_assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>parentIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get mesh entities which contain the given face. 
<p>
<b>Description:</b> <p>
Specify a face and mesh entity (e.g. element) and this routines returns IDs of that type of mesh entity which contain (are made from) the given face.<p>
<b>Modifications:</b> <ul>
<li>07/12/04 WSK created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>faceID</em>&nbsp;</td><td>
input - face id </td></tr>
<tr><td valign="top"><em>parent_assoc</em>&nbsp;</td><td>
input - association type of the parent </td></tr>
<tr><td valign="top"><em>numParent</em>&nbsp;</td><td>
output - the number of parents </td></tr>
<tr><td valign="top"><em>parentIDs</em>&nbsp;</td><td>
output - array of parent IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l00922">922</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04509">_fc_getMeshElementParentsOfFacesPtr()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="mesh_8c-source.html#l03208">fc_getMeshNumFace()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00279">fc_getMeshEntityParents()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00928"></a>00928   {
<a name="l00929"></a>00929   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00930"></a>00930   <span class="keywordtype">int</span> i;
<a name="l00931"></a>00931   <span class="keywordtype">int</span> numFace;
<a name="l00932"></a>00932   
<a name="l00933"></a>00933   <span class="comment">// default return values</span>
<a name="l00934"></a>00934   <span class="keywordflow">if</span> (numParent)
<a name="l00935"></a>00935     *numParent = -1;
<a name="l00936"></a>00936   <span class="keywordflow">if</span> (parentIDs)
<a name="l00937"></a>00937     *parentIDs = NULL;
<a name="l00938"></a>00938   
<a name="l00939"></a>00939   <span class="comment">// check input</span>
<a name="l00940"></a>00940   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || faceID &lt; 0 || 
<a name="l00941"></a>00941       (parent_assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a> &amp;&amp; parent_assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>) ||
<a name="l00942"></a>00942       !numParent || !parentIDs) {
<a name="l00943"></a>00943         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>)); 
<a name="l00944"></a>00944     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00945"></a>00945   }
<a name="l00946"></a>00946   <span class="comment">// get mesh info</span>
<a name="l00947"></a>00947   rc = <a class="code" href="group__Mesh.html#g8c619c146c0850895098f5dbfb487418" title="Get number of faces in a mesh.">fc_getMeshNumFace</a>(mesh, &amp;numFace);
<a name="l00948"></a>00948   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || faceID &gt;= numFace) {
<a name="l00949"></a>00949         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00950"></a>00950     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00951"></a>00951   }
<a name="l00952"></a>00952 
<a name="l00953"></a>00953   <span class="comment">// log message</span>
<a name="l00954"></a>00954   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting mesh entities which contain the given face."</span>);
<a name="l00955"></a>00955 
<a name="l00956"></a>00956   <span class="comment">// type of parent</span>
<a name="l00957"></a>00957   <span class="keywordflow">if</span> (parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>) {
<a name="l00958"></a>00958     *numParent = 1;
<a name="l00959"></a>00959     *parentIDs = (<span class="keywordtype">int</span>*)calloc(1, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00960"></a>00960     <span class="keywordflow">if</span> (*parentIDs == NULL) {
<a name="l00961"></a>00961       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00962"></a>00962       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00963"></a>00963     }
<a name="l00964"></a>00964     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00965"></a>00965   }
<a name="l00966"></a>00966   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>) {
<a name="l00967"></a>00967     <span class="keywordtype">int</span>* numElemPerFace, **elemParentsPerFace;
<a name="l00968"></a>00968     rc = <a class="code" href="group__PrivateMesh.html#g540b5f94172bea7ef0e2fcf41bf42425" title="Return parent elements of the faces.">_fc_getMeshElementParentsOfFacesPtr</a>(mesh, &amp;numElemPerFace,
<a name="l00969"></a>00969                                           &amp;elemParentsPerFace);
<a name="l00970"></a>00970     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00971"></a>00971       <span class="keywordflow">return</span> rc;
<a name="l00972"></a>00972     *numParent = numElemPerFace[faceID];
<a name="l00973"></a>00973     <span class="keywordflow">if</span> (*numParent &gt; 0) {
<a name="l00974"></a>00974       *parentIDs = (<span class="keywordtype">int</span>*)malloc(*numParent*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00975"></a>00975       <span class="keywordflow">if</span> (*parentIDs == NULL) {
<a name="l00976"></a>00976         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00977"></a>00977         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00978"></a>00978       } 
<a name="l00979"></a>00979       <span class="keywordflow">for</span> (i = 0; i &lt; *numParent; i++)
<a name="l00980"></a>00980         (*parentIDs)[i] = elemParentsPerFace[faceID][i];
<a name="l00981"></a>00981     }
<a name="l00982"></a>00982     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00983"></a>00983   }
<a name="l00984"></a>00984   <span class="keywordflow">else</span> {
<a name="l00985"></a>00985         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"shouldn't be able to get here."</span>); 
<a name="l00986"></a>00986     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; <span class="comment">// shouldn't be able to get here</span>
<a name="l00987"></a>00987   }
<a name="l00988"></a>00988 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf2e4a6939b02d61548079bc0d164cdeb"></a><!-- doxytag: member="topo.c::_fc_getVertexNeighbors" ref="gf2e4a6939b02d61548079bc0d164cdeb" args="(FC_Mesh mesh, int vertexID, int *numNeigh, int **neighIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getVertexNeighbors           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>vertexID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numNeigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neighIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get vertices which are neighbors of this vertex. 
<p>
<b>Description:</b> <p>
Returns the neighbor vertices of the given vertices. Vertices are considered to be neighbors if they are connected by an edge.<p>
<b>Modifications:</b> <ul>
<li>Nancy Collins Added this wrapper around steph's original routine to use compute the neighbors and extract them in a subset.</li><li>02/24/04 WSK, changed name and made more general purpose, like with _fc_getElementTopoNeighbors.</li><li>07/15/04 WSK - Changed to not be recursive. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh </td></tr>
<tr><td valign="top"><em>vertexID</em>&nbsp;</td><td>
input - vertex ID </td></tr>
<tr><td valign="top"><em>numNeigh</em>&nbsp;</td><td>
output - the number of neighbors </td></tr>
<tr><td valign="top"><em>neighIDs</em>&nbsp;</td><td>
output - the neighbor IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l01007">1007</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04577">_fc_getMeshVertexNeighborsViaEdgePtr()</a>, <a class="el" href="mesh_8c-source.html#l02989">fc_getMeshNumVertex()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00510">fc_getMeshEntityNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01012"></a>01012   {
<a name="l01013"></a>01013   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01014"></a>01014   <span class="keywordtype">int</span> numVertex, *numVertNeighsViaEdge, **vertNeighsViaEdge;
<a name="l01015"></a>01015 
<a name="l01016"></a>01016   <span class="comment">// default return</span>
<a name="l01017"></a>01017   <span class="keywordflow">if</span> (numNeigh)
<a name="l01018"></a>01018     *numNeigh = -1;
<a name="l01019"></a>01019   <span class="keywordflow">if</span> (neighIDs)
<a name="l01020"></a>01020     *neighIDs = NULL;
<a name="l01021"></a>01021 
<a name="l01022"></a>01022   <span class="comment">// check input</span>
<a name="l01023"></a>01023   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || vertexID &lt; 0 || !numNeigh || !neighIDs) {
<a name="l01024"></a>01024     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01025"></a>01025     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01026"></a>01026   }
<a name="l01027"></a>01027   rc = <a class="code" href="group__Mesh.html#g9dca153475c9927e7497fd827cfd5562" title="Return the number of vertices in a mesh.">fc_getMeshNumVertex</a>(mesh, &amp;numVertex);
<a name="l01028"></a>01028   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || vertexID &gt;= numVertex) {
<a name="l01029"></a>01029     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01030"></a>01030     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01031"></a>01031   }
<a name="l01032"></a>01032 
<a name="l01033"></a>01033   <span class="comment">// log message</span>
<a name="l01034"></a>01034   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting vertices which are neighbors of this vertex."</span>);
<a name="l01035"></a>01035 
<a name="l01036"></a>01036   <span class="comment">// copy array from Big Data struct</span>
<a name="l01037"></a>01037   rc = <a class="code" href="group__PrivateMesh.html#gb8468178474b9bf3d6f37e5798f53daf" title="Return vertex neighbors that share an edge.">_fc_getMeshVertexNeighborsViaEdgePtr</a>(mesh, &amp;numVertNeighsViaEdge,
<a name="l01038"></a>01038                                             &amp;vertNeighsViaEdge);
<a name="l01039"></a>01039   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01040"></a>01040     <span class="keywordflow">return</span> rc;
<a name="l01041"></a>01041   <span class="comment">// special case -- if edges don't exists</span>
<a name="l01042"></a>01042   <span class="keywordflow">if</span> (numVertNeighsViaEdge == NULL) {
<a name="l01043"></a>01043     *numNeigh = 0;
<a name="l01044"></a>01044     neighIDs = NULL;
<a name="l01045"></a>01045     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01046"></a>01046   }
<a name="l01047"></a>01047   *numNeigh = numVertNeighsViaEdge[vertexID];
<a name="l01048"></a>01048   <span class="keywordflow">if</span> (*numNeigh &gt; 0) {
<a name="l01049"></a>01049     *neighIDs = (<span class="keywordtype">int</span>*)malloc((*numNeigh)*<span class="keyword">sizeof</span>(int));
<a name="l01050"></a>01050     <span class="keywordflow">if</span> (*neighIDs == NULL) {
<a name="l01051"></a>01051       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01052"></a>01052       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01053"></a>01053     }
<a name="l01054"></a>01054     memcpy(*neighIDs, vertNeighsViaEdge[vertexID], *numNeigh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01055"></a>01055   }
<a name="l01056"></a>01056     
<a name="l01057"></a>01057   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01058"></a>01058 } 
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g37ea1b7c3c6f17d0497acf53b978f798"></a><!-- doxytag: member="topo.c::_fc_getVertexParents" ref="g37ea1b7c3c6f17d0497acf53b978f798" args="(FC_Mesh mesh, int vertexID, FC_AssociationType parent_assoc, int *numParent, int **parentIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getVertexParents           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>vertexID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a>&nbsp;</td>
          <td class="paramname"> <em>parent_assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>parentIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get mesh entities which contain the given vertex. 
<p>
<b>Description:</b> <p>
Specify a vertex and mesh entity (e.g. element) and this routines returns IDs of that type of mesh entity which contain (are made from) the given vertex.<p>
<b>Modifications:</b> <ul>
<li>07/09/04 WSK created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>vertexID</em>&nbsp;</td><td>
input - vertex number </td></tr>
<tr><td valign="top"><em>parent_assoc</em>&nbsp;</td><td>
input - association type of the parent </td></tr>
<tr><td valign="top"><em>numParent</em>&nbsp;</td><td>
output - the number of parents </td></tr>
<tr><td valign="top"><em>parentIDs</em>&nbsp;</td><td>
output - array of parent IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l00696">696</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l04250">_fc_getMeshEdgeParentsOfVerticesPtr()</a>, <a class="el" href="mesh_8c-source.html#l04380">_fc_getMeshElementParentsOfVerticesPtr()</a>, <a class="el" href="mesh_8c-source.html#l04318">_fc_getMeshFaceParentsOfVerticesPtr()</a>, <a class="el" href="base_8h-source.html#l00192">FC_AT_EDGE</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00190">FC_AT_UNKNOWN</a>, <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="mesh_8c-source.html#l02989">fc_getMeshNumVertex()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00286">fc_isAssociationTypeValid()</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l00279">fc_getMeshEntityParents()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00702"></a>00702   {
<a name="l00703"></a>00703   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00704"></a>00704   <span class="keywordtype">int</span> i;
<a name="l00705"></a>00705   <span class="keywordtype">int</span> numVertex, *temp_IDs, whole_ids[1] = { 0 };
<a name="l00706"></a>00706   <span class="keywordtype">int</span> *numEntityPerVert, **entityParentsPerVert;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708   <span class="comment">// default return values</span>
<a name="l00709"></a>00709   <span class="keywordflow">if</span> (numParent)
<a name="l00710"></a>00710     *numParent = -1;
<a name="l00711"></a>00711   <span class="keywordflow">if</span> (parentIDs)
<a name="l00712"></a>00712     *parentIDs = NULL;
<a name="l00713"></a>00713   
<a name="l00714"></a>00714   <span class="comment">// check input</span>
<a name="l00715"></a>00715   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || vertexID &lt; 0 || 
<a name="l00716"></a>00716       !<a class="code" href="group__DataTypes.html#gc3097dff5d1b0602671b7d2805162169" title="Verify that the given value is valid for this enum.">fc_isAssociationTypeValid</a>(parent_assoc) || 
<a name="l00717"></a>00717       parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a> || parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6d5a38e6486b577a8d9bbba0e1c1a443d">FC_AT_UNKNOWN</a> || 
<a name="l00718"></a>00718       !numParent || !parentIDs) {
<a name="l00719"></a>00719     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00720"></a>00720     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00721"></a>00721   }
<a name="l00722"></a>00722   
<a name="l00723"></a>00723   <span class="comment">// get mesh info</span>
<a name="l00724"></a>00724   rc = <a class="code" href="group__Mesh.html#g9dca153475c9927e7497fd827cfd5562" title="Return the number of vertices in a mesh.">fc_getMeshNumVertex</a>(mesh, &amp;numVertex);
<a name="l00725"></a>00725   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || vertexID &gt;= numVertex) {
<a name="l00726"></a>00726     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00727"></a>00727     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00728"></a>00728   }
<a name="l00729"></a>00729   
<a name="l00730"></a>00730   <span class="comment">// log message</span>
<a name="l00731"></a>00731   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting mesh entities which contain the given vertex."</span>);
<a name="l00732"></a>00732 
<a name="l00733"></a>00733   <span class="comment">// get the number of parents &amp; pointer to parent array to copy</span>
<a name="l00734"></a>00734   <span class="keywordflow">if</span> (parent_assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>) {
<a name="l00735"></a>00735     *numParent = 1;
<a name="l00736"></a>00736     temp_IDs = whole_ids;
<a name="l00737"></a>00737   }
<a name="l00738"></a>00738   <span class="keywordflow">else</span> {
<a name="l00739"></a>00739     <span class="keywordflow">switch</span> (parent_assoc) {
<a name="l00740"></a>00740     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>:
<a name="l00741"></a>00741       rc = <a class="code" href="group__PrivateMesh.html#gf7980c0d2195acd513810a86a150800a" title="Return parent edges of the vertices.">_fc_getMeshEdgeParentsOfVerticesPtr</a>(mesh, &amp;numEntityPerVert,
<a name="l00742"></a>00742                                            &amp;entityParentsPerVert);
<a name="l00743"></a>00743       <span class="keywordflow">break</span>;
<a name="l00744"></a>00744     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>:
<a name="l00745"></a>00745       rc = <a class="code" href="group__PrivateMesh.html#g53879e825667d77328908ec1e4a75506" title="Return parent faces of the vertices.">_fc_getMeshFaceParentsOfVerticesPtr</a>(mesh, &amp;numEntityPerVert,
<a name="l00746"></a>00746                                            &amp;entityParentsPerVert);
<a name="l00747"></a>00747       <span class="keywordflow">break</span>;
<a name="l00748"></a>00748     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>:
<a name="l00749"></a>00749       rc = <a class="code" href="group__PrivateMesh.html#gaf703b7a600d091844f13abac69bad2b" title="Return parent elements of the vertices.">_fc_getMeshElementParentsOfVerticesPtr</a>(mesh, &amp;numEntityPerVert,
<a name="l00750"></a>00750                                               &amp;entityParentsPerVert);
<a name="l00751"></a>00751       <span class="keywordflow">break</span>;
<a name="l00752"></a>00752     <span class="keywordflow">default</span>:
<a name="l00753"></a>00753       ; <span class="comment">// do nothing, just here to quiet compiler</span>
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00756"></a>00756       <span class="keywordflow">return</span> rc;
<a name="l00757"></a>00757     <span class="comment">// check to make sure entities of that type exist</span>
<a name="l00758"></a>00758     <span class="keywordflow">if</span> (numEntityPerVert == NULL) { 
<a name="l00759"></a>00759       *numParent = 0;
<a name="l00760"></a>00760       *parentIDs = NULL;
<a name="l00761"></a>00761       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00762"></a>00762     }
<a name="l00763"></a>00763     <span class="comment">// finally, set values</span>
<a name="l00764"></a>00764     *numParent = numEntityPerVert[vertexID];
<a name="l00765"></a>00765     temp_IDs = entityParentsPerVert[vertexID];
<a name="l00766"></a>00766   }
<a name="l00767"></a>00767   
<a name="l00768"></a>00768   <span class="comment">// make parent ID array</span>
<a name="l00769"></a>00769   <span class="keywordflow">if</span> (*numParent &gt; 0) {
<a name="l00770"></a>00770     *parentIDs = (<span class="keywordtype">int</span>*)malloc(*numParent*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00771"></a>00771     <span class="keywordflow">if</span> (*parentIDs == NULL) {
<a name="l00772"></a>00772       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00773"></a>00773       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775     <span class="keywordflow">for</span> (i = 0; i &lt; *numParent; i++)
<a name="l00776"></a>00776       (*parentIDs)[i] = temp_IDs[i];
<a name="l00777"></a>00777   }
<a name="l00778"></a>00778   
<a name="l00779"></a>00779   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00780"></a>00780 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g02cb3c4ef2956582d868077999c93ce6"></a><!-- doxytag: member="topo.c::_fc_growNeighborList" ref="g02cb3c4ef2956582d868077999c93ce6" args="(FC_Mesh mesh, FC_SortedIntArray *srcIDs, FC_AssociationType assoc, int level, int shared_dim, int *checked, FC_SortedIntArray *keepIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_growNeighborList           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *&nbsp;</td>
          <td class="paramname"> <em>srcIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6">FC_AssociationType</a>&nbsp;</td>
          <td class="paramname"> <em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>checked</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> *&nbsp;</td>
          <td class="paramname"> <em>keepIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the neighbors of a group of mesh entities. 
<p>
<b>Description:</b> <p>
This is a helper function for <a class="el" href="group__TopologyRelations.html#g90b1b90dfd00245a14d585f3b7f0bf6d" title="Get the neighbors of a subset.">fc_getSubsetNeighbors()</a>. It takes a list of entities to get neighbors from and adds them to the list of neighbors. It is meant to be called recursively with the first call providing the seed IDs and a null list to add to. In addition, a mask for the association type is provided with all zero entries (can prevent adding specific IDs by setting their mask entry to one).<p>
Entities cannot be of association type FC_AT_WHOLE_DATASET.<p>
<b>Modifications:</b> <ul>
<li>07/023/04 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh the entities are in </td></tr>
<tr><td valign="top"><em>srcIDs</em>&nbsp;</td><td>
input - List of IDs to get neighbors from </td></tr>
<tr><td valign="top"><em>assoc</em>&nbsp;</td><td>
input - the type of entity </td></tr>
<tr><td valign="top"><em>level</em>&nbsp;</td><td>
input - depth of recursion (1 = no recursion) </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - neighbor shared dimensionality </td></tr>
<tr><td valign="top"><em>checked</em>&nbsp;</td><td>
input - mask allocated by caller </td></tr>
<tr><td valign="top"><em>keepIDs</em>&nbsp;</td><td>
input/output - list of neighbor IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="topo_8c-source.html#l01341">1341</a> of file <a class="el" href="topo_8c-source.html">topo.c</a>.</p>

<p>References <a class="el" href="topo_8c-source.html#l01341">_fc_growNeighborList()</a>, <a class="el" href="storage_8c-source.html#l00441">fc_addIntArrayToSortedIntArray()</a>, <a class="el" href="storage_8c-source.html#l00397">fc_addIntToSortedIntArray()</a>, <a class="el" href="storage_8c-source.html#l00846">fc_freeSortedIntArray()</a>, <a class="el" href="topo_8c-source.html#l00510">fc_getMeshEntityNeighbors()</a>, <a class="el" href="storage_8c-source.html#l00095">fc_initSortedIntArray()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>, and <a class="el" href="storage_8h-source.html#l00101">FC_SortedIntArray::vals</a>.</p>

<p>Referenced by <a class="el" href="topo_8c-source.html#l01341">_fc_growNeighborList()</a>, and <a class="el" href="topo_8c-source.html#l00603">fc_getSubsetNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01349"></a>01349   {
<a name="l01350"></a>01350   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01351"></a>01351   <span class="keywordtype">int</span> i, j;
<a name="l01352"></a>01352   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> newIDs;
<a name="l01353"></a>01353   <span class="keywordtype">int</span> numNeigh, *neighIDs;
<a name="l01354"></a>01354   
<a name="l01355"></a>01355   <span class="comment">// input no checking because it's a helper function</span>
<a name="l01356"></a>01356  
<a name="l01357"></a>01357   <span class="comment">// log message</span>
<a name="l01358"></a>01358   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the neighbors of a group of mesh entities."</span>);
<a name="l01359"></a>01359 
<a name="l01360"></a>01360   <span class="comment">// go through srcIDs &amp; get unexamined neighbors</span>
<a name="l01361"></a>01361   <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;newIDs);
<a name="l01362"></a>01362   <span class="keywordflow">for</span> (j = 0; j &lt; srcIDs-&gt;<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; j++) {
<a name="l01363"></a>01363     <span class="keywordtype">int</span> currentID = srcIDs-&gt;<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[j];
<a name="l01364"></a>01364 
<a name="l01365"></a>01365     <span class="keywordflow">if</span> (checked[currentID])
<a name="l01366"></a>01366       <span class="keywordflow">continue</span>;
<a name="l01367"></a>01367 
<a name="l01368"></a>01368     <span class="comment">// check it's neighbors</span>
<a name="l01369"></a>01369     rc = <a class="code" href="group__TopologyRelations.html#g6ee1028bf4343f79d907b41cc0d108c4" title="Get the neighbors of a mesh subentity.">fc_getMeshEntityNeighbors</a>(mesh, currentID, assoc, shared_dim,
<a name="l01370"></a>01370                        &amp;numNeigh, &amp;neighIDs);
<a name="l01371"></a>01371     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01372"></a>01372       <span class="keywordflow">return</span> rc;
<a name="l01373"></a>01373     <span class="keywordflow">for</span> (i = 0; i &lt; numNeigh; i++) {
<a name="l01374"></a>01374         <span class="keywordflow">if</span> (!checked[neighIDs[i]]) {
<a name="l01375"></a>01375           <span class="keywordtype">int</span> ret = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;newIDs, neighIDs[i]);
<a name="l01376"></a>01376           <span class="keywordflow">if</span> (ret &lt; 0) {
<a name="l01377"></a>01377             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to add ID to list"</span>);
<a name="l01378"></a>01378             <span class="keywordflow">return</span> ret;
<a name="l01379"></a>01379           }
<a name="l01380"></a>01380         }
<a name="l01381"></a>01381     }
<a name="l01382"></a>01382     free(neighIDs);
<a name="l01383"></a>01383     checked[currentID] = 1;
<a name="l01384"></a>01384   }
<a name="l01385"></a>01385   
<a name="l01386"></a>01386   <span class="comment">// add the new neighbors to our keep list</span>
<a name="l01387"></a>01387   rc = <a class="code" href="group__SimpleDataObjects.html#gf842f060b1f39a0acfc54421bbe0865a" title="Add an array of ints to a sorted int array.">fc_addIntArrayToSortedIntArray</a>(keepIDs, newIDs.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>,
<a name="l01388"></a>01388                           newIDs.<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>, 1);
<a name="l01389"></a>01389   <span class="keywordflow">if</span> (rc &lt; <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01390"></a>01390     <span class="keywordflow">return</span> rc;
<a name="l01391"></a>01391 
<a name="l01392"></a>01392 
<a name="l01393"></a>01393   <span class="comment">// call recursively</span>
<a name="l01394"></a>01394   <span class="keywordflow">if</span> (level == 1 || newIDs.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a> == 0) {
<a name="l01395"></a>01395     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newIDs);
<a name="l01396"></a>01396     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01397"></a>01397   }
<a name="l01398"></a>01398   <span class="keywordflow">else</span> {
<a name="l01399"></a>01399     rc = <a class="code" href="group__PrivateTopologyRelations.html#g02cb3c4ef2956582d868077999c93ce6" title="Get the neighbors of a group of mesh entities.">_fc_growNeighborList</a>(mesh, &amp;newIDs, assoc, level-1, 
<a name="l01400"></a>01400                                shared_dim, checked, keepIDs);
<a name="l01401"></a>01401     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newIDs);
<a name="l01402"></a>01402     <span class="keywordflow">return</span> rc;
<a name="l01403"></a>01403   }
<a name="l01404"></a>01404 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:22 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
