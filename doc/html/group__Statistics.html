<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: Statistics Routines</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Statistics Routines<br>
<small>
[<a class="el" href="group__API.html">FCLib API</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for Statistics Routines:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__Statistics.gif" border="0" alt="" usemap="#group____Statistics_map">
<map name="group____Statistics_map">
<area shape="rect" href="group__API.html" title="Feature Characterization Library." alt="" coords="7,5,92,32"></map></td></tr></table></center>
</div>
<hr><a name="_details"></a><h2>Detailed Description</h2>
These routines compute simple statistical values of the data variables. 
<p>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>For a variable (spatial domain).</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g8e828048c88585a6de200e4f05d61ee4">fc_getVariableMinMax</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, double *min, int *min_index, double *max, int *max_index)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find min &amp; max data values of a variable.  <a href="#g8e828048c88585a6de200e4f05d61ee4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g389588bf87b0f50ae0572eb1f7ff4167">fc_getVariableMeanSdev</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, double *mean, double *sdev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute mean and standard deviation of a variable.  <a href="#g389588bf87b0f50ae0572eb1f7ff4167"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#ge130d2218f05fcaa83dcd0aa55c91c8e">fc_getVariableSum</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, double *sum_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute sum of all data values of a variable.  <a href="#ge130d2218f05fcaa83dcd0aa55c91c8e"></a><br></td></tr>
<tr><td colspan="2"><br><h2>For a subset of a variable (spatial domain).</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g7b44d38b8800d8c619af4b6b52d58759">fc_getVariableSubsetMinMax</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, <a class="el" href="structFC__Subset.html">FC_Subset</a> subset, double *min, int *min_index, double *max, int *max_index)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find min &amp; max data values in a subset of a variable.  <a href="#g7b44d38b8800d8c619af4b6b52d58759"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#gfc12edf46aed1d007679cdc29521cf9b">fc_getVariableSubsetMeanSdev</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, <a class="el" href="structFC__Subset.html">FC_Subset</a> subset, double *mean, double *sdev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute mean and standard deviation of a subset of a variable.  <a href="#gfc12edf46aed1d007679cdc29521cf9b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#ge7be077012a83bcf2ed8133cc8590576">fc_getVariableSubsetSum</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, <a class="el" href="structFC__Subset.html">FC_Subset</a> subset, double *sum_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute sum of all data values of a subset of a variable.  <a href="#ge7be077012a83bcf2ed8133cc8590576"></a><br></td></tr>
<tr><td colspan="2"><br><h2>For a sequence variable (spatial &amp; sequence domain).</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#gfa32a24cb703b1c9c1f08224e86a504f">fc_getSeqVariableMinMax</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seqVar, double *min, int *min_seq_id, int *min_entity_id, double *max, int *max_seq_id, int *max_entity_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find min &amp; max data values of a sequence variable.  <a href="#gfa32a24cb703b1c9c1f08224e86a504f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#gbe5670effd9d72bb4b162cb678193f8c">fc_getSeqVariableMeanSdev</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seqVar, double *mean, double *sdev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute mean and standard deviation of a sequence variable.  <a href="#gbe5670effd9d72bb4b162cb678193f8c"></a><br></td></tr>
<tr><td colspan="2"><br><h2>For each data point of a sequence variable (sequence domain).</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g8f565e977a0909545d87bb33bc7bd6f6">fc_getSeqVariableSeriesMinMax</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seqvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *minvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *maxvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *minindexvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *maxindexvar)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find min &amp; max data values of a sequence variable across its sequence (series) on a per data point, per component basis.  <a href="#g8f565e977a0909545d87bb33bc7bd6f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g6bb6087f9da82dc295d312ab9614d0da">fc_getSeqVariableSeriesMeanSdev</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seqvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *meanvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *sdevvar)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute mean and standard deviation of a seq variable across its sequence (series) on a per data point, per component basis.  <a href="#g6bb6087f9da82dc295d312ab9614d0da"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#gaa272ae4e4388ae2291cf0aaf3e378ea">fc_getSeqVariableSeriesSum</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seqvar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *sumvar)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute sum of all data values of a sequence variable across its sequence (series) on a per data point, per component basis.  <a href="#gaa272ae4e4388ae2291cf0aaf3e378ea"></a><br></td></tr>
<tr><td colspan="2"><br><h2>For a sequence (sequence domain).</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g31eedcdb364aa8ab2bdf2dde14c8bfbe">fc_getSequenceMinMaxMono</a> (<a class="el" href="structFC__Sequence.html">FC_Sequence</a> sequence, double *min, int *min_index, double *max, int *max_index, int *mono)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns min and max of a sequence and the indicies where they occur and returns monotonicity indicator.  <a href="#g31eedcdb364aa8ab2bdf2dde14c8bfbe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g8f24c59a1f5d8641fb877b6d9631c0f5">fc_getSequenceSpacingMinMaxMeanSdev</a> (<a class="el" href="structFC__Sequence.html">FC_Sequence</a> sequence, double *min, int *min_index, double *max, int *max_index, double *mean, double *std)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns min, max, mean, and std of spacing of a sequence. Returns indicies of the min and max spacings.  <a href="#g8f24c59a1f5d8641fb877b6d9631c0f5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Statistics.html#g81bf9960f929feabd7aed96c1730f3cb">fc_getClosestSequenceValue</a> (<a class="el" href="structFC__Sequence.html">FC_Sequence</a> sequence, char *comparer, double compval, double *seqval, int *stepIndex)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a value and a criteria for comparison (&lt;, &lt;=, =, !=, &gt;=, &gt;) returns the closest value meeting the conditions of the comparer a sequence has to that value and its index.  <a href="#g81bf9960f929feabd7aed96c1730f3cb"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g81bf9960f929feabd7aed96c1730f3cb"></a><!-- doxytag: member="statistics.c::fc_getClosestSequenceValue" ref="g81bf9960f929feabd7aed96c1730f3cb" args="(FC_Sequence sequence, char *comparer, double compval, double *seqval, int *stepIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getClosestSequenceValue           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Sequence.html">FC_Sequence</a>&nbsp;</td>
          <td class="paramname"> <em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>comparer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>compval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>seqval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>stepIndex</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given a value and a criteria for comparison (&lt;, &lt;=, =, !=, &gt;=, &gt;) returns the closest value meeting the conditions of the comparer a sequence has to that value and its index. 
<p>
<b>Description:</b> <p>
Given a value and a criteria for comparison (&lt;,=,&gt;) returns the closest value meeting the conditions of the comparer a sequence has to that value and its index. e.g., use to get the closest value in a sequence greater than or equal to 3.<p>
Sequence does not have to be ordered. In case of a tie, returns the first occurence of the value. In case there is no value matching the criteria or in case of error, return vals are -1. Return value is of type double regardless of the type of the orignal sequence.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000092">Todo:</a></b></dt><dd><ul>
<li>this does comparison as doubles. should we want something that treats INTs differently ?</li><li>= criteria is based on dbl comparison, should there be an epsilon you can pass in ? prob not as you can do the &lt;= and &gt;= and get the info you need. if so though can change this to use fc_leq etc macros.</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>5/17/05 ACG Created</li><li>6/27/05 ACG changed to support comparisons other than equals </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>sequence</em>&nbsp;</td><td>
input - sequence </td></tr>
<tr><td valign="top"><em>comparer</em>&nbsp;</td><td>
input - character string indicating the comparison criteria </td></tr>
<tr><td valign="top"><em>compval</em>&nbsp;</td><td>
input - val comparing to </td></tr>
<tr><td valign="top"><em>seqval</em>&nbsp;</td><td>
output - seq dataval closest to the compval </td></tr>
<tr><td valign="top"><em>stepIndex</em>&nbsp;</td><td>
output - index of the seqval </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l02219">2219</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="sequence_8c-source.html#l02142">_fc_getSeqSlot()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="sequence_8c-source.html#l01737">fc_getSequenceCoordsPtr()</a>, <a class="el" href="sequence_8c-source.html#l01612">fc_getSequenceInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="sequence_8c-source.html#l01505">fc_isSequenceValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="sequenceP_8h-source.html#l00075">_FC_SeqSlot::header</a>, and <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>.</p>

<p>Referenced by <a class="el" href="sequence_8c-source.html#l00934">fc_createIntersectingRangeRegularSequence()</a>, and <a class="el" href="sequence_8c-source.html#l00687">fc_createIntersectingRegularSequence()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02225"></a>02225    {
<a name="l02226"></a>02226   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02227"></a>02227   <a class="code" href="struct__FC__SeqSlot.html" title="Sequence Slot Structure for the Sequence Table.">_FC_SeqSlot</a>* seqSlot;
<a name="l02228"></a>02228   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l02229"></a>02229   <span class="keywordtype">int</span> numStep;
<a name="l02230"></a>02230   <span class="keywordtype">void</span> *coordsp;
<a name="l02231"></a>02231   <span class="keywordtype">int</span> holdindex;
<a name="l02232"></a>02232   <span class="keywordtype">double</span> holdval, currval;
<a name="l02233"></a>02233   <span class="keywordtype">double</span> holddiff, currdiff;
<a name="l02234"></a>02234   <span class="keywordtype">int</span> i, icomparer;
<a name="l02235"></a>02235 
<a name="l02236"></a>02236   <span class="comment">//default</span>
<a name="l02237"></a>02237   <span class="keywordflow">if</span> (stepIndex)
<a name="l02238"></a>02238     *stepIndex = -1;
<a name="l02239"></a>02239   <span class="keywordflow">if</span> (seqval)
<a name="l02240"></a>02240     *seqval = -1;
<a name="l02241"></a>02241 
<a name="l02242"></a>02242   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"getting closest seq val for sequence '%s'"</span>, 
<a name="l02243"></a>02243                       seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c5e5166b76af0f8c08946df88105d729">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l02244"></a>02244 
<a name="l02245"></a>02245   seqSlot = <a class="code" href="group__PrivateSequence.html#g311b52c3aa6307afba63b26ad035afe5" title="Get a sequence slot from a sequence handle.">_fc_getSeqSlot</a>(sequence);
<a name="l02246"></a>02246   <span class="keywordflow">if</span> (seqSlot == NULL){
<a name="l02247"></a>02247       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02248"></a>02248       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02249"></a>02249   }
<a name="l02250"></a>02250 
<a name="l02251"></a>02251   <span class="keywordflow">if</span> (seqSlot == NULL || !<a class="code" href="group__Sequence.html#g55e1bf7be4e19be93103378503b123b9" title="Check that the handle refers to a valid sequence.">fc_isSequenceValid</a>(sequence)  ||
<a name="l02252"></a>02252       !stepIndex || !seqval || !comparer){
<a name="l02253"></a>02253       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02254"></a>02254       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02255"></a>02255   }
<a name="l02256"></a>02256 
<a name="l02257"></a>02257   icomparer = -1;
<a name="l02258"></a>02258   <span class="keywordflow">if</span> (strcmp(comparer,<span class="stringliteral">"&lt;"</span>) == 0) icomparer = 0;
<a name="l02259"></a>02259   <span class="keywordflow">if</span> (strcmp(comparer,<span class="stringliteral">"&lt;="</span>) == 0) icomparer = 1;
<a name="l02260"></a>02260   <span class="keywordflow">if</span> (strcmp(comparer,<span class="stringliteral">"="</span>) == 0) icomparer = 2;
<a name="l02261"></a>02261   <span class="keywordflow">if</span> (strcmp(comparer,<span class="stringliteral">"&gt;="</span>) == 0) icomparer = 3;
<a name="l02262"></a>02262   <span class="keywordflow">if</span> (strcmp(comparer,<span class="stringliteral">"&gt;"</span>) == 0) icomparer = 4;
<a name="l02263"></a>02263   <span class="keywordflow">if</span> (strcmp(comparer,<span class="stringliteral">"!="</span>) == 0) icomparer = 5;
<a name="l02264"></a>02264   <span class="keywordflow">if</span> (icomparer ==- 1){
<a name="l02265"></a>02265     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"invalid comparison criteria"</span>);
<a name="l02266"></a>02266     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02267"></a>02267   }
<a name="l02268"></a>02268  
<a name="l02269"></a>02269   rc = <a class="code" href="group__Sequence.html#g39b5198d7c58288101f909fac5569f71" title="Get information about a sequence.">fc_getSequenceInfo</a> (sequence, &amp;numStep, &amp;datatype);
<a name="l02270"></a>02270   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02271"></a>02271     <span class="keywordflow">return</span> rc;
<a name="l02272"></a>02272   }
<a name="l02273"></a>02273 
<a name="l02274"></a>02274   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> &amp;&amp; datatype !=<a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> &amp;&amp;
<a name="l02275"></a>02275       datatype != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>){
<a name="l02276"></a>02276     <span class="comment">//non-numerical input sequence</span>
<a name="l02277"></a>02277     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02278"></a>02278   }
<a name="l02279"></a>02279 
<a name="l02280"></a>02280   <span class="comment">//ready to go</span>
<a name="l02281"></a>02281 
<a name="l02282"></a>02282   rc = <a class="code" href="group__Sequence.html#ga88160e25be202c8de18ac89edf876c6" title="Get sequence coordinates.">fc_getSequenceCoordsPtr</a>(sequence,&amp;coordsp);
<a name="l02283"></a>02283   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02284"></a>02284     <span class="keywordflow">return</span> rc;
<a name="l02285"></a>02285   }
<a name="l02286"></a>02286 
<a name="l02287"></a>02287   holdindex = -1;
<a name="l02288"></a>02288   <span class="keywordflow">for</span> (i = 0; i &lt;numStep; i++){
<a name="l02289"></a>02289     <span class="keywordflow">switch</span>(datatype){
<a name="l02290"></a>02290     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l02291"></a>02291       currval = (double)(((<span class="keywordtype">int</span>*)coordsp)[i]);
<a name="l02292"></a>02292       <span class="keywordflow">break</span>;
<a name="l02293"></a>02293     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l02294"></a>02294       currval = (double)(((<span class="keywordtype">float</span>*)coordsp)[i]);
<a name="l02295"></a>02295       <span class="keywordflow">break</span>;
<a name="l02296"></a>02296     <span class="keywordflow">default</span>: <span class="comment">//know its a double</span>
<a name="l02297"></a>02297       currval = ((<span class="keywordtype">double</span>*)coordsp)[i];
<a name="l02298"></a>02298       <span class="keywordflow">break</span>;
<a name="l02299"></a>02299     }
<a name="l02300"></a>02300 
<a name="l02301"></a>02301     <span class="keywordflow">switch</span> (icomparer){ <span class="comment">//closest value strictly less than</span>
<a name="l02302"></a>02302     <span class="keywordflow">case</span> 0:
<a name="l02303"></a>02303       <span class="comment">//avoid round off error</span>
<a name="l02304"></a>02304       <span class="keywordflow">if</span> (!<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(currval,compval) &amp;&amp; currval &lt; compval){
<a name="l02305"></a>02305         currdiff = fabs(currval-compval);
<a name="l02306"></a>02306         <span class="keywordflow">if</span> (holdindex == -1 || (holdindex != -1 &amp;&amp; currdiff &lt; holddiff)){
<a name="l02307"></a>02307           holdindex = i;
<a name="l02308"></a>02308           holdval = currval;
<a name="l02309"></a>02309           holddiff = currdiff;
<a name="l02310"></a>02310         }
<a name="l02311"></a>02311       }
<a name="l02312"></a>02312     <span class="keywordflow">break</span>;
<a name="l02313"></a>02313     <span class="keywordflow">case</span> 1: <span class="comment">//closest value lt or = to</span>
<a name="l02314"></a>02314       <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(currval,compval)){
<a name="l02315"></a>02315         <span class="comment">//call them equal and return</span>
<a name="l02316"></a>02316         *stepIndex = i;
<a name="l02317"></a>02317         *seqval = currval;
<a name="l02318"></a>02318         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02319"></a>02319       }
<a name="l02320"></a>02320       <span class="keywordflow">if</span> (currval &lt; compval){
<a name="l02321"></a>02321         currdiff = fabs(currval-compval);
<a name="l02322"></a>02322         <span class="keywordflow">if</span> (holdindex == -1 || (holdindex != -1 &amp;&amp; currdiff &lt; holddiff)){
<a name="l02323"></a>02323           holdindex = i;
<a name="l02324"></a>02324           holdval = currval;
<a name="l02325"></a>02325           holddiff = currdiff;
<a name="l02326"></a>02326         }
<a name="l02327"></a>02327       }
<a name="l02328"></a>02328       <span class="keywordflow">break</span>;
<a name="l02329"></a>02329     <span class="keywordflow">case</span> 2: <span class="comment">//closest value, including possibly = to</span>
<a name="l02330"></a>02330       <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(currval,compval)){
<a name="l02331"></a>02331         <span class="comment">//call them equal and return</span>
<a name="l02332"></a>02332         *stepIndex = i;
<a name="l02333"></a>02333         *seqval = compval;
<a name="l02334"></a>02334         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02335"></a>02335       } <span class="keywordflow">else</span> {
<a name="l02336"></a>02336         currdiff = fabs(currval-compval);
<a name="l02337"></a>02337         <span class="keywordflow">if</span> (holdindex == -1 || (holdindex != -1 &amp;&amp; currdiff &lt; holddiff)){
<a name="l02338"></a>02338           holdindex = i;
<a name="l02339"></a>02339           holdval = currval;
<a name="l02340"></a>02340           holddiff = currdiff;
<a name="l02341"></a>02341         }
<a name="l02342"></a>02342       }
<a name="l02343"></a>02343       <span class="keywordflow">break</span>;
<a name="l02344"></a>02344     <span class="keywordflow">case</span> 3:  <span class="comment">//closest value gt or = to</span>
<a name="l02345"></a>02345       <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(currval,compval)){
<a name="l02346"></a>02346         <span class="comment">//call them equal and return</span>
<a name="l02347"></a>02347         *stepIndex = i;
<a name="l02348"></a>02348         *seqval = currval;
<a name="l02349"></a>02349         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02350"></a>02350       }
<a name="l02351"></a>02351       <span class="keywordflow">if</span> (currval &gt; compval){
<a name="l02352"></a>02352         currdiff = fabs(currval-compval);
<a name="l02353"></a>02353         <span class="keywordflow">if</span> (holdindex == -1 || (holdindex != -1 &amp;&amp; currdiff &lt; holddiff)){
<a name="l02354"></a>02354           holdindex = i;
<a name="l02355"></a>02355           holdval = currval;
<a name="l02356"></a>02356           holddiff = currdiff;
<a name="l02357"></a>02357         }
<a name="l02358"></a>02358       }
<a name="l02359"></a>02359       <span class="keywordflow">break</span>;
<a name="l02360"></a>02360     <span class="keywordflow">case</span> 4: <span class="comment">//closest value strictly greater than</span>
<a name="l02361"></a>02361       <span class="comment">//avoid round off error</span>
<a name="l02362"></a>02362       <span class="keywordflow">if</span> (!<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(currval,compval) &amp;&amp; currval &gt; compval){
<a name="l02363"></a>02363         currdiff = fabs(currval-compval);
<a name="l02364"></a>02364         <span class="keywordflow">if</span> (holdindex == -1 || (holdindex != -1 &amp;&amp; currdiff &lt; holddiff)){
<a name="l02365"></a>02365           holdindex = i;
<a name="l02366"></a>02366           holdval = currval;
<a name="l02367"></a>02367           holddiff = currdiff;
<a name="l02368"></a>02368         }
<a name="l02369"></a>02369       }
<a name="l02370"></a>02370       <span class="keywordflow">break</span>;
<a name="l02371"></a>02371     <span class="keywordflow">case</span> 5: <span class="comment">//closest value either &lt; or &gt; but not equal to</span>
<a name="l02372"></a>02372       <span class="keywordflow">if</span> (!<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(currval,compval)){
<a name="l02373"></a>02373         currdiff = fabs(currval-compval);
<a name="l02374"></a>02374         <span class="keywordflow">if</span> (holdindex == -1 || (holdindex != -1 &amp;&amp; currdiff &lt; holddiff)){
<a name="l02375"></a>02375           holdindex = i;
<a name="l02376"></a>02376           holdval = currval;
<a name="l02377"></a>02377           holddiff = currdiff;
<a name="l02378"></a>02378         }
<a name="l02379"></a>02379       }
<a name="l02380"></a>02380       <span class="keywordflow">break</span>;
<a name="l02381"></a>02381     <span class="keywordflow">default</span>:
<a name="l02382"></a>02382       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>,<span class="stringliteral">"WARNING: devloper error ! should never reach this point!"</span>);
<a name="l02383"></a>02383       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02384"></a>02384     }
<a name="l02385"></a>02385   }
<a name="l02386"></a>02386 
<a name="l02387"></a>02387   <span class="keywordflow">if</span> (holdindex != -1){
<a name="l02388"></a>02388     *stepIndex = holdindex;
<a name="l02389"></a>02389     *seqval = holdval;
<a name="l02390"></a>02390   }
<a name="l02391"></a>02391   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02392"></a>02392 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g31eedcdb364aa8ab2bdf2dde14c8bfbe"></a><!-- doxytag: member="statistics.c::fc_getSequenceMinMaxMono" ref="g31eedcdb364aa8ab2bdf2dde14c8bfbe" args="(FC_Sequence sequence, double *min, int *min_index, double *max, int *max_index, int *mono)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSequenceMinMaxMono           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Sequence.html">FC_Sequence</a>&nbsp;</td>
          <td class="paramname"> <em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>min_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>max_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>mono</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns min and max of a sequence and the indicies where they occur and returns monotonicity indicator. 
<p>
<b>Description:</b> <p>
Returns min and max of a sequence and indicies of where they occur. in case of repeated values returns the index of the first occurrence.<p>
Return vals for mono are:<ul>
<li>montonically increasing = 1,</li><li>monotonically decreasing = -1,</li><li>single point sequence can be either so = 2,</li><li>and 0 otherwise.</li></ul>
<p>
Nonnumerical sequences return with an error. In case of error, return vals are -1, except for mono which returns 0.<p>
Any return arguments can be passed in NULL. Return vals of min and max are doubles, despite the type of the original sequence.<p>
If you are doing any comparisons afterward you should do them relative to the native tye of the sequence (e.g.&lt; float) even though the return type is double becuase of casting errors.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000090">Todo:</a></b></dt><dd><ul>
<li>is there any reason we would want to do this in its native type throughout ?</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>5/12/05 ACG Created</li><li>5/16/05 ACG changed so single point seq returns 2 for monotonicity (this gives way for it to match either increasing or decreasing seqs)</li><li>7/01/05 ACG added regularity check</li><li>7/07/05 ACG removed regularity check </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>sequence</em>&nbsp;</td><td>
input - sequence </td></tr>
<tr><td valign="top"><em>min</em>&nbsp;</td><td>
output - min data value </td></tr>
<tr><td valign="top"><em>min_index</em>&nbsp;</td><td>
output - index at which first min value was found </td></tr>
<tr><td valign="top"><em>max</em>&nbsp;</td><td>
output - max data value </td></tr>
<tr><td valign="top"><em>max_index</em>&nbsp;</td><td>
output - index as which first max value was found </td></tr>
<tr><td valign="top"><em>mono</em>&nbsp;</td><td>
output - integer indicating monotonicity </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l01753">1753</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="sequence_8c-source.html#l02142">_fc_getSeqSlot()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="sequence_8c-source.html#l01737">fc_getSequenceCoordsPtr()</a>, <a class="el" href="sequence_8c-source.html#l01612">fc_getSequenceInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="sequence_8c-source.html#l01505">fc_isSequenceValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="sequenceP_8h-source.html#l00075">_FC_SeqSlot::header</a>, and <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>.</p>

<p>Referenced by <a class="el" href="sequence_8c-source.html#l00934">fc_createIntersectingRangeRegularSequence()</a>, <a class="el" href="sequence_8c-source.html#l00687">fc_createIntersectingRegularSequence()</a>, <a class="el" href="series_8c-source.html#l03021">fc_dimensionlessAreaBetweenCurves()</a>, and <a class="el" href="series_8c-source.html#l00347">fc_linearInterpolation()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01760"></a>01760    {
<a name="l01761"></a>01761   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01762"></a>01762   <a class="code" href="struct__FC__SeqSlot.html" title="Sequence Slot Structure for the Sequence Table.">_FC_SeqSlot</a>* seqSlot;
<a name="l01763"></a>01763   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l01764"></a>01764   <span class="keywordtype">int</span> numStep;
<a name="l01765"></a>01765   <span class="keywordtype">void</span> *coordsp;
<a name="l01766"></a>01766   <span class="keywordtype">double</span> prev,next;
<a name="l01767"></a>01767   <span class="keywordtype">double</span> movingmin, movingmax;
<a name="l01768"></a>01768   <span class="keywordtype">int</span> movingminindex, movingmaxindex;
<a name="l01769"></a>01769   <span class="keywordtype">int</span> onlymono;
<a name="l01770"></a>01770   <span class="keywordtype">int</span> i, movingmono;
<a name="l01771"></a>01771 
<a name="l01772"></a>01772   <span class="comment">//default</span>
<a name="l01773"></a>01773   <span class="keywordflow">if</span> (mono)
<a name="l01774"></a>01774     *mono = 0;
<a name="l01775"></a>01775   <span class="keywordflow">if</span> (min)
<a name="l01776"></a>01776     *min = -1;
<a name="l01777"></a>01777   <span class="keywordflow">if</span> (min_index)
<a name="l01778"></a>01778     *min_index = -1;
<a name="l01779"></a>01779   <span class="keywordflow">if</span> (max)
<a name="l01780"></a>01780     *max = -1;
<a name="l01781"></a>01781   <span class="keywordflow">if</span> (max_index)
<a name="l01782"></a>01782     *max_index = -1;
<a name="l01783"></a>01783 
<a name="l01784"></a>01784   seqSlot = <a class="code" href="group__PrivateSequence.html#g311b52c3aa6307afba63b26ad035afe5" title="Get a sequence slot from a sequence handle.">_fc_getSeqSlot</a>(sequence);
<a name="l01785"></a>01785   <span class="comment">// check input - they don't have to take </span>
<a name="l01786"></a>01786   <span class="keywordflow">if</span> (seqSlot == NULL || !<a class="code" href="group__Sequence.html#g55e1bf7be4e19be93103378503b123b9" title="Check that the handle refers to a valid sequence.">fc_isSequenceValid</a>(sequence)  ||
<a name="l01787"></a>01787       (!min &amp;&amp; !min_index &amp;&amp; !max &amp;&amp; !max_index &amp;&amp; !mono)){
<a name="l01788"></a>01788       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01789"></a>01789       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01790"></a>01790   }
<a name="l01791"></a>01791 
<a name="l01792"></a>01792   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"getting minmax and montonicity of sequence '%s'"</span>, 
<a name="l01793"></a>01793                       seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c5e5166b76af0f8c08946df88105d729">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01794"></a>01794 
<a name="l01795"></a>01795   rc = <a class="code" href="group__Sequence.html#g39b5198d7c58288101f909fac5569f71" title="Get information about a sequence.">fc_getSequenceInfo</a> (sequence, &amp;numStep, &amp;datatype);
<a name="l01796"></a>01796   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01797"></a>01797     <span class="keywordflow">return</span> rc;
<a name="l01798"></a>01798   }
<a name="l01799"></a>01799 
<a name="l01800"></a>01800   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> &amp;&amp; datatype !=<a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> &amp;&amp;
<a name="l01801"></a>01801       datatype != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>){
<a name="l01802"></a>01802     <span class="comment">//non-numerical input sequence</span>
<a name="l01803"></a>01803     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01804"></a>01804   }
<a name="l01805"></a>01805 
<a name="l01806"></a>01806   <span class="keywordflow">if</span> (numStep == 0){
<a name="l01807"></a>01807     <span class="comment">//zero step seq</span>
<a name="l01808"></a>01808     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01809"></a>01809   }
<a name="l01810"></a>01810 
<a name="l01811"></a>01811   rc = <a class="code" href="group__Sequence.html#ga88160e25be202c8de18ac89edf876c6" title="Get sequence coordinates.">fc_getSequenceCoordsPtr</a>(sequence,&amp;coordsp);
<a name="l01812"></a>01812   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01813"></a>01813     <span class="comment">//return 0</span>
<a name="l01814"></a>01814     <span class="keywordflow">return</span> rc;
<a name="l01815"></a>01815   }
<a name="l01816"></a>01816   <span class="keywordflow">switch</span>(datatype){
<a name="l01817"></a>01817   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l01818"></a>01818     prev = (double)(((<span class="keywordtype">int</span>*)coordsp)[0]);
<a name="l01819"></a>01819     <span class="keywordflow">break</span>;
<a name="l01820"></a>01820   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l01821"></a>01821     prev = (double)(((<span class="keywordtype">float</span>*)coordsp)[0]);
<a name="l01822"></a>01822     <span class="keywordflow">break</span>;
<a name="l01823"></a>01823   <span class="keywordflow">default</span>: <span class="comment">//know its a double</span>
<a name="l01824"></a>01824     prev = ((<span class="keywordtype">double</span>*)coordsp)[0];
<a name="l01825"></a>01825     <span class="keywordflow">break</span>;
<a name="l01826"></a>01826   }
<a name="l01827"></a>01827   <span class="keywordflow">if</span> (numStep == 1){
<a name="l01828"></a>01828     <span class="keywordflow">if</span> (min)
<a name="l01829"></a>01829       *min = prev;
<a name="l01830"></a>01830     <span class="keywordflow">if</span> (min_index)
<a name="l01831"></a>01831       *min_index = 0;
<a name="l01832"></a>01832     <span class="keywordflow">if</span> (max)
<a name="l01833"></a>01833       *max = prev;
<a name="l01834"></a>01834     <span class="keywordflow">if</span> (max_index)
<a name="l01835"></a>01835       *max_index = 0;
<a name="l01836"></a>01836     <span class="keywordflow">if</span> (mono)
<a name="l01837"></a>01837       *mono = 2;
<a name="l01838"></a>01838     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01839"></a>01839   } 
<a name="l01840"></a>01840   movingmin = prev;
<a name="l01841"></a>01841   movingmax = prev;
<a name="l01842"></a>01842   movingminindex = 0;
<a name="l01843"></a>01843   movingmaxindex = 0;
<a name="l01844"></a>01844   movingmono = 2;
<a name="l01845"></a>01845 
<a name="l01846"></a>01846   <span class="comment">//at least two steps</span>
<a name="l01847"></a>01847   onlymono = (mono &amp;&amp; (!min &amp;&amp; !min_index &amp;&amp; !max &amp;&amp; !max_index));
<a name="l01848"></a>01848 
<a name="l01849"></a>01849   next = prev;
<a name="l01850"></a>01850   <span class="keywordflow">for</span> (i = 1; i &lt; numStep; i++){
<a name="l01851"></a>01851     prev = next;
<a name="l01852"></a>01852     <span class="keywordflow">switch</span>(datatype){
<a name="l01853"></a>01853     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l01854"></a>01854       next = (double)(((<span class="keywordtype">int</span>*)coordsp)[i]);
<a name="l01855"></a>01855       <span class="keywordflow">break</span>;
<a name="l01856"></a>01856     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l01857"></a>01857       next = (double)(((<span class="keywordtype">float</span>*)coordsp)[i]);
<a name="l01858"></a>01858       <span class="keywordflow">break</span>;
<a name="l01859"></a>01859     <span class="keywordflow">default</span>: <span class="comment">//know its a double</span>
<a name="l01860"></a>01860       next = ((<span class="keywordtype">double</span>*)coordsp)[i];
<a name="l01861"></a>01861       <span class="keywordflow">break</span>;
<a name="l01862"></a>01862     }
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <span class="comment">//this is inefficient</span>
<a name="l01865"></a>01865     <span class="keywordflow">if</span> (i == 1){
<a name="l01866"></a>01866       <span class="comment">//2nd pt</span>
<a name="l01867"></a>01867       <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(prev,next)){
<a name="l01868"></a>01868         movingmono = 0;
<a name="l01869"></a>01869       } <span class="keywordflow">else</span> {
<a name="l01870"></a>01870         movingmono = (next &gt; prev ? 1: -1);
<a name="l01871"></a>01871       }
<a name="l01872"></a>01872     } <span class="keywordflow">else</span> {
<a name="l01873"></a>01873       <span class="keywordflow">if</span> (movingmono != 0 &amp;&amp; mono){ <span class="comment">//not already bad &amp; we actaully care about it</span>
<a name="l01874"></a>01874         <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(prev,next)){
<a name="l01875"></a>01875           movingmono = 0;
<a name="l01876"></a>01876         } <span class="keywordflow">else</span> {
<a name="l01877"></a>01877           <span class="keywordflow">if</span> (next &gt; prev){
<a name="l01878"></a>01878             movingmono = (movingmono == 1 ? 1: 0);
<a name="l01879"></a>01879           } <span class="keywordflow">else</span> {
<a name="l01880"></a>01880             movingmono = (movingmono == -1 ? -1: 0);
<a name="l01881"></a>01881           }
<a name="l01882"></a>01882         }
<a name="l01883"></a>01883       }
<a name="l01884"></a>01884     }
<a name="l01885"></a>01885 
<a name="l01886"></a>01886     <span class="keywordflow">if</span> (next &lt;movingmin){
<a name="l01887"></a>01887       movingmin = next;
<a name="l01888"></a>01888       movingminindex = i;
<a name="l01889"></a>01889     }
<a name="l01890"></a>01890     <span class="keywordflow">if</span> (next &gt; movingmax){
<a name="l01891"></a>01891       movingmax = next;
<a name="l01892"></a>01892       movingmaxindex = i;
<a name="l01893"></a>01893     }  <span class="comment">//if equal keep the original one</span>
<a name="l01894"></a>01894 
<a name="l01895"></a>01895     <span class="comment">//returns if we know we are done</span>
<a name="l01896"></a>01896 
<a name="l01897"></a>01897     <span class="keywordflow">if</span> (onlymono &amp;&amp; (movingmono == 0)){
<a name="l01898"></a>01898       <span class="comment">//exit if already know its zero</span>
<a name="l01899"></a>01899       *mono = 0;
<a name="l01900"></a>01900       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01901"></a>01901     }
<a name="l01902"></a>01902   }
<a name="l01903"></a>01903 
<a name="l01904"></a>01904   <span class="comment">//finished</span>
<a name="l01905"></a>01905 
<a name="l01906"></a>01906   <span class="keywordflow">if</span> (mono)
<a name="l01907"></a>01907     *mono = movingmono;
<a name="l01908"></a>01908   <span class="keywordflow">if</span> (min)
<a name="l01909"></a>01909     *min = movingmin;
<a name="l01910"></a>01910   <span class="keywordflow">if</span> (max)
<a name="l01911"></a>01911     *max = movingmax;
<a name="l01912"></a>01912   <span class="keywordflow">if</span> (min_index)
<a name="l01913"></a>01913     *min_index = movingminindex;
<a name="l01914"></a>01914   <span class="keywordflow">if</span> (max_index)
<a name="l01915"></a>01915     *max_index = movingmaxindex;
<a name="l01916"></a>01916   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01917"></a>01917 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8f24c59a1f5d8641fb877b6d9631c0f5"></a><!-- doxytag: member="statistics.c::fc_getSequenceSpacingMinMaxMeanSdev" ref="g8f24c59a1f5d8641fb877b6d9631c0f5" args="(FC_Sequence sequence, double *min, int *min_index, double *max, int *max_index, double *mean, double *std)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSequenceSpacingMinMaxMeanSdev           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Sequence.html">FC_Sequence</a>&nbsp;</td>
          <td class="paramname"> <em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>min_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>max_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>std</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns min, max, mean, and std of spacing of a sequence. Returns indicies of the min and max spacings. 
<p>
<b>Description:</b> <p>
Returns min, max, mean, and std of spacing of a sequence. Returns indicies of the min and max spacings. Indicies are those of the beginning of the step (ie. return val of index 1 means the step between 1&amp;2). If two or more steps have the same spacing and it is the min or max spacing on the sequence then the index of the first occurence is the one returned.<p>
Return vals of stats are doubles, regardless of the native datatype of the sequence (although the calculation is done in the native type becuase of round off errors). If you want to check afterward for the regularity of your sequence, you will want to know that min &amp; max differ by no more than the epsilon of the native type - i.e., if your original sequence was FC_DT_FLOAT then use FC_FLT_EQUIV even though you are returned double values.<p>
Nonnumerical sequences return with an error. Sequence must have at least 2 vals. All invalid return vals are -1. Must have at least one non-NULL output parameter.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000091">Todo:</a></b></dt><dd><ul>
<li>see if want optional args</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>7/07/05 ACG Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>sequence</em>&nbsp;</td><td>
input - sequence </td></tr>
<tr><td valign="top"><em>min</em>&nbsp;</td><td>
output - min spacing value </td></tr>
<tr><td valign="top"><em>min_index</em>&nbsp;</td><td>
output - index at which first min spacing was found </td></tr>
<tr><td valign="top"><em>max</em>&nbsp;</td><td>
output - max spacing value </td></tr>
<tr><td valign="top"><em>max_index</em>&nbsp;</td><td>
output - index as which first max spacing was found </td></tr>
<tr><td valign="top"><em>mean</em>&nbsp;</td><td>
output - mean spacing value </td></tr>
<tr><td valign="top"><em>std</em>&nbsp;</td><td>
output - std of the spacing </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l01951">1951</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="sequence_8c-source.html#l02142">_fc_getSeqSlot()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="util_8h-source.html#l00111">FC_FLT_EQUIV</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="sequence_8c-source.html#l01737">fc_getSequenceCoordsPtr()</a>, <a class="el" href="sequence_8c-source.html#l01612">fc_getSequenceInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="sequence_8c-source.html#l01505">fc_isSequenceValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="sequenceP_8h-source.html#l00075">_FC_SeqSlot::header</a>, and <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>.</p>

<p>Referenced by <a class="el" href="series_8c-source.html#l00676">fc_firstDerivative_REA()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01959"></a>01959    {
<a name="l01960"></a>01960   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01961"></a>01961   <a class="code" href="struct__FC__SeqSlot.html" title="Sequence Slot Structure for the Sequence Table.">_FC_SeqSlot</a>* seqSlot;
<a name="l01962"></a>01962   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l01963"></a>01963   <span class="keywordtype">int</span> numStep;
<a name="l01964"></a>01964   <span class="keywordtype">void</span> *coordsp;
<a name="l01965"></a>01965   <span class="keywordtype">int</span> i;
<a name="l01966"></a>01966 
<a name="l01967"></a>01967   <span class="comment">//default</span>
<a name="l01968"></a>01968   <span class="keywordflow">if</span> (min)
<a name="l01969"></a>01969     *min = -1;
<a name="l01970"></a>01970   <span class="keywordflow">if</span> (min_index)
<a name="l01971"></a>01971     *min_index = -1;
<a name="l01972"></a>01972   <span class="keywordflow">if</span> (max)
<a name="l01973"></a>01973     *max = -1;
<a name="l01974"></a>01974   <span class="keywordflow">if</span> (max_index)
<a name="l01975"></a>01975     *max_index = -1;
<a name="l01976"></a>01976   <span class="keywordflow">if</span> (mean)
<a name="l01977"></a>01977     *mean = -1;
<a name="l01978"></a>01978   <span class="keywordflow">if</span> (std)
<a name="l01979"></a>01979     *std = -1;
<a name="l01980"></a>01980 
<a name="l01981"></a>01981   seqSlot = <a class="code" href="group__PrivateSequence.html#g311b52c3aa6307afba63b26ad035afe5" title="Get a sequence slot from a sequence handle.">_fc_getSeqSlot</a>(sequence);
<a name="l01982"></a>01982   <span class="keywordflow">if</span> (seqSlot == NULL || !<a class="code" href="group__Sequence.html#g55e1bf7be4e19be93103378503b123b9" title="Check that the handle refers to a valid sequence.">fc_isSequenceValid</a>(sequence)  ||
<a name="l01983"></a>01983       (!min &amp;&amp; !min_index &amp;&amp; !max &amp;&amp; !max_index &amp;&amp; !mean &amp;&amp; ! std)){
<a name="l01984"></a>01984       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01985"></a>01985       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01986"></a>01986   }
<a name="l01987"></a>01987 
<a name="l01988"></a>01988   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"getting spacing minmaxmeanstd of sequence '%s'"</span>, 
<a name="l01989"></a>01989                       seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c5e5166b76af0f8c08946df88105d729">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01990"></a>01990 
<a name="l01991"></a>01991   rc = <a class="code" href="group__Sequence.html#g39b5198d7c58288101f909fac5569f71" title="Get information about a sequence.">fc_getSequenceInfo</a> (sequence, &amp;numStep, &amp;datatype);
<a name="l01992"></a>01992   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01993"></a>01993     <span class="keywordflow">return</span> rc;
<a name="l01994"></a>01994   }
<a name="l01995"></a>01995 
<a name="l01996"></a>01996   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> &amp;&amp; datatype !=<a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> &amp;&amp;
<a name="l01997"></a>01997       datatype != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>){
<a name="l01998"></a>01998     <span class="comment">//non-numerical input sequence</span>
<a name="l01999"></a>01999     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>,<span class="stringliteral">"invalid seq datatype"</span>);
<a name="l02000"></a>02000     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02001"></a>02001   }
<a name="l02002"></a>02002 
<a name="l02003"></a>02003   <span class="keywordflow">if</span> (numStep &lt; 2){
<a name="l02004"></a>02004     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>,<span class="stringliteral">"too few steps in seq"</span>);
<a name="l02005"></a>02005     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02006"></a>02006   }
<a name="l02007"></a>02007 
<a name="l02008"></a>02008   rc = <a class="code" href="group__Sequence.html#ga88160e25be202c8de18ac89edf876c6" title="Get sequence coordinates.">fc_getSequenceCoordsPtr</a>(sequence,&amp;coordsp);
<a name="l02009"></a>02009   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02010"></a>02010     <span class="keywordflow">return</span> rc;
<a name="l02011"></a>02011   }
<a name="l02012"></a>02012 
<a name="l02013"></a>02013   <span class="keywordflow">switch</span>(datatype){
<a name="l02014"></a>02014   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l02015"></a>02015     {
<a name="l02016"></a>02016       <span class="keywordtype">int</span> *spacings;
<a name="l02017"></a>02017       <span class="keywordtype">int</span> movmin,movminindex,movmax,movmaxindex, movsum, movsum2;
<a name="l02018"></a>02018       
<a name="l02019"></a>02019       spacings = (<span class="keywordtype">int</span>*)malloc((numStep-1)*<span class="keyword">sizeof</span>(int));
<a name="l02020"></a>02020       
<a name="l02021"></a>02021       <span class="comment">//first get spacings in native type</span>
<a name="l02022"></a>02022       <span class="keywordflow">for</span> (i = 0; i &lt; numStep-1; i++){
<a name="l02023"></a>02023         spacings[i] = ((<span class="keywordtype">int</span>*)coordsp)[i+1] - ((<span class="keywordtype">int</span>*)coordsp)[i];
<a name="l02024"></a>02024       }
<a name="l02025"></a>02025       
<a name="l02026"></a>02026       <span class="comment">//then do comparisons in native type</span>
<a name="l02027"></a>02027       
<a name="l02028"></a>02028       movsum = spacings[0];
<a name="l02029"></a>02029       movsum2 = spacings[0]*spacings[0];
<a name="l02030"></a>02030       movmin = spacings[0];
<a name="l02031"></a>02031       movminindex = 0;
<a name="l02032"></a>02032       movmax = spacings[0];
<a name="l02033"></a>02033       movmaxindex = 0;
<a name="l02034"></a>02034       <span class="keywordflow">for</span> (i = 1; i &lt; numStep-1; i++){
<a name="l02035"></a>02035         <span class="keywordflow">if</span> (spacings[i] &lt; movmin){
<a name="l02036"></a>02036           movmin = spacings[i];
<a name="l02037"></a>02037           movminindex = i;
<a name="l02038"></a>02038         }
<a name="l02039"></a>02039         <span class="keywordflow">if</span> (spacings[i] &gt; movmax){
<a name="l02040"></a>02040           movmax = spacings[i];
<a name="l02041"></a>02041           movmaxindex = i;
<a name="l02042"></a>02042         }
<a name="l02043"></a>02043         movsum+=spacings[i];
<a name="l02044"></a>02044         movsum2+=spacings[i]*spacings[i];
<a name="l02045"></a>02045       }
<a name="l02046"></a>02046       <span class="keywordflow">if</span> (min)  *min = (double)(movmin);
<a name="l02047"></a>02047       <span class="keywordflow">if</span> (min_index) *min_index = movminindex;
<a name="l02048"></a>02048       <span class="keywordflow">if</span> (max) *max = (double)(movmax);
<a name="l02049"></a>02049       <span class="keywordflow">if</span> (max_index) *max_index = movmaxindex;
<a name="l02050"></a>02050       <span class="keywordflow">if</span> (mean) *mean = (double)((movsum)/(double)(numStep-1));
<a name="l02051"></a>02051       <span class="keywordflow">if</span> (std){
<a name="l02052"></a>02052         <span class="keywordflow">if</span> (numStep-2 &gt; 0) {
<a name="l02053"></a>02053           <span class="keywordflow">if</span> (movsum2*(numStep-1) == movsum*movsum){
<a name="l02054"></a>02054             *std = 0.0;
<a name="l02055"></a>02055           }<span class="keywordflow">else</span> {
<a name="l02056"></a>02056             <span class="keywordtype">int</span> temp = (numStep-1)*movsum2 - (movsum * movsum);
<a name="l02057"></a>02057             <span class="keywordtype">double</span> temp2 = (double)(temp)/(double)((numStep-1)*(numStep-2));
<a name="l02058"></a>02058             *std = sqrt(fabs(temp2)); <span class="comment">// might be negative if roundoff error</span>
<a name="l02059"></a>02059           }
<a name="l02060"></a>02060         } <span class="keywordflow">else</span> {
<a name="l02061"></a>02061           *std = 0.;
<a name="l02062"></a>02062         }
<a name="l02063"></a>02063       }
<a name="l02064"></a>02064 
<a name="l02065"></a>02065       free (spacings);
<a name="l02066"></a>02066       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02067"></a>02067     }
<a name="l02068"></a>02068     <span class="keywordflow">break</span>;
<a name="l02069"></a>02069   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l02070"></a>02070     {
<a name="l02071"></a>02071       <span class="keywordtype">float</span> *spacings;
<a name="l02072"></a>02072       <span class="keywordtype">float</span> movmin,movmax, movsum, movsum2;
<a name="l02073"></a>02073       <span class="keywordtype">int</span> movminindex, movmaxindex;
<a name="l02074"></a>02074     
<a name="l02075"></a>02075       spacings = (<span class="keywordtype">float</span>*)malloc((numStep-1)*<span class="keyword">sizeof</span>(float));
<a name="l02076"></a>02076 
<a name="l02077"></a>02077       <span class="comment">//first get spacings in native type</span>
<a name="l02078"></a>02078       <span class="keywordflow">for</span> (i = 0; i &lt; numStep-1; i++){
<a name="l02079"></a>02079         spacings[i] = ((<span class="keywordtype">float</span>*)coordsp)[i+1] - ((<span class="keywordtype">float</span>*)coordsp)[i];
<a name="l02080"></a>02080       }
<a name="l02081"></a>02081     
<a name="l02082"></a>02082       <span class="comment">//then do comparisons in native type</span>
<a name="l02083"></a>02083       movsum = spacings[0];
<a name="l02084"></a>02084       movsum2 = spacings[0]*spacings[0];
<a name="l02085"></a>02085       movmin = spacings[0];
<a name="l02086"></a>02086       movminindex = 0;
<a name="l02087"></a>02087       movmax = spacings[0];
<a name="l02088"></a>02088       movmaxindex = 0;
<a name="l02089"></a>02089       <span class="keywordflow">for</span> (i = 1; i &lt; numStep-1; i++){
<a name="l02090"></a>02090         <span class="keywordflow">if</span> (spacings[i] &lt; movmin){
<a name="l02091"></a>02091           movmin = spacings[i];
<a name="l02092"></a>02092           movminindex = i;
<a name="l02093"></a>02093         }
<a name="l02094"></a>02094         <span class="keywordflow">if</span> (spacings[i] &gt; movmax){
<a name="l02095"></a>02095           movmax = spacings[i];
<a name="l02096"></a>02096           movmaxindex = i;
<a name="l02097"></a>02097         }
<a name="l02098"></a>02098         movsum+=spacings[i];
<a name="l02099"></a>02099         movsum2+=spacings[i]*spacings[i];
<a name="l02100"></a>02100       }
<a name="l02101"></a>02101       <span class="keywordflow">if</span> (min) *min = (double)(movmin);
<a name="l02102"></a>02102       <span class="keywordflow">if</span> (min_index) *min_index = movminindex;
<a name="l02103"></a>02103       <span class="keywordflow">if</span> (max) *max = (double)(movmax);
<a name="l02104"></a>02104       <span class="keywordflow">if</span> (max_index) *max_index = movmaxindex;
<a name="l02105"></a>02105       <span class="keywordflow">if</span> (mean) *mean = (double)(movsum)/(float)(numStep-1);
<a name="l02106"></a>02106       <span class="keywordflow">if</span> (std){
<a name="l02107"></a>02107         <span class="keywordflow">if</span> (numStep-2 &gt; 0) {
<a name="l02108"></a>02108           <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g564c35a50d7fa88019003ccfb2bbff97" title="Test equality of two values with float precision.">FC_FLT_EQUIV</a>((numStep-1)*movsum2,(movsum*movsum))){
<a name="l02109"></a>02109             <span class="comment">//      printf("eval std to zero : %10.8g %10.8g\n",(numStep-1)*movsum2,(movsum*movsum));</span>
<a name="l02110"></a>02110             *std = 0.0;
<a name="l02111"></a>02111           }<span class="keywordflow">else</span> {
<a name="l02112"></a>02112             <span class="keywordtype">float</span> temp = (numStep-1)*movsum2 - (movsum * movsum);
<a name="l02113"></a>02113             temp/=(float)((numStep-2)*(numStep-1));
<a name="l02114"></a>02114             *std = (double)sqrt(fabs(temp)); <span class="comment">// might be negative if roundoff error</span>
<a name="l02115"></a>02115           }
<a name="l02116"></a>02116         } <span class="keywordflow">else</span> {
<a name="l02117"></a>02117           *std = 0.;
<a name="l02118"></a>02118         }
<a name="l02119"></a>02119       }
<a name="l02120"></a>02120       free (spacings);
<a name="l02121"></a>02121       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02122"></a>02122     }
<a name="l02123"></a>02123     <span class="keywordflow">break</span>;
<a name="l02124"></a>02124   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:
<a name="l02125"></a>02125     {
<a name="l02126"></a>02126       <span class="keywordtype">double</span> *spacings;
<a name="l02127"></a>02127       <span class="keywordtype">double</span> movmin,movmax, movsum, movsum2;
<a name="l02128"></a>02128       <span class="keywordtype">int</span> movminindex, movmaxindex;
<a name="l02129"></a>02129       
<a name="l02130"></a>02130       spacings = (<span class="keywordtype">double</span>*)malloc((numStep-1)*<span class="keyword">sizeof</span>(double));
<a name="l02131"></a>02131       
<a name="l02132"></a>02132       <span class="comment">//first get spacings in native type</span>
<a name="l02133"></a>02133       <span class="keywordflow">for</span> (i = 0; i &lt; numStep-1; i++){
<a name="l02134"></a>02134         spacings[i] = ((<span class="keywordtype">double</span>*)coordsp)[i+1] - ((<span class="keywordtype">double</span>*)coordsp)[i];
<a name="l02135"></a>02135       }
<a name="l02136"></a>02136       
<a name="l02137"></a>02137       <span class="comment">//then do comparisons in native type</span>
<a name="l02138"></a>02138       
<a name="l02139"></a>02139       movsum = spacings[0];
<a name="l02140"></a>02140       movsum2 = spacings[0]*spacings[0];
<a name="l02141"></a>02141       movmin = spacings[0];
<a name="l02142"></a>02142       movminindex = 0;
<a name="l02143"></a>02143       movmax = spacings[0];
<a name="l02144"></a>02144       movmaxindex = 0;
<a name="l02145"></a>02145       <span class="keywordflow">for</span> (i = 1; i &lt; numStep-1; i++){
<a name="l02146"></a>02146         <span class="keywordflow">if</span> (spacings[i] &lt; movmin){
<a name="l02147"></a>02147           movmin = spacings[i];
<a name="l02148"></a>02148           movminindex = i;
<a name="l02149"></a>02149         }
<a name="l02150"></a>02150         <span class="keywordflow">if</span> (spacings[i] &gt; movmax){
<a name="l02151"></a>02151           movmax = spacings[i];
<a name="l02152"></a>02152           movmaxindex = i;
<a name="l02153"></a>02153         }
<a name="l02154"></a>02154         movsum+=spacings[i];
<a name="l02155"></a>02155         movsum2+=spacings[i]*spacings[i];
<a name="l02156"></a>02156       }
<a name="l02157"></a>02157       <span class="keywordflow">if</span> (min) *min = movmin;
<a name="l02158"></a>02158       <span class="keywordflow">if</span> (min_index) *min_index = movminindex;
<a name="l02159"></a>02159       <span class="keywordflow">if</span> (max) *max = movmax;
<a name="l02160"></a>02160       <span class="keywordflow">if</span> (max_index)  *max_index = movmaxindex;
<a name="l02161"></a>02161       <span class="keywordflow">if</span> (mean) *mean = movsum/(double)(numStep-1);
<a name="l02162"></a>02162       <span class="keywordflow">if</span> (std){
<a name="l02163"></a>02163         <span class="keywordflow">if</span> (numStep-2 &gt; 0) {
<a name="l02164"></a>02164           <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(movsum2,(movsum*movsum/(<span class="keywordtype">float</span>)(numStep-1)))){
<a name="l02165"></a>02165             *std = 0.0;
<a name="l02166"></a>02166           }<span class="keywordflow">else</span> {
<a name="l02167"></a>02167             <span class="keywordtype">double</span> temp = (numStep-1)*movsum2 - (movsum * movsum);
<a name="l02168"></a>02168             temp/=(double)((numStep-2)*(numStep-1));
<a name="l02169"></a>02169             *std = sqrt(fabs(temp)); <span class="comment">// might be negative if roundoff error</span>
<a name="l02170"></a>02170           }
<a name="l02171"></a>02171         } <span class="keywordflow">else</span> {
<a name="l02172"></a>02172           *std = 0.;
<a name="l02173"></a>02173         }
<a name="l02174"></a>02174       }
<a name="l02175"></a>02175       free (spacings);
<a name="l02176"></a>02176       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02177"></a>02177     }
<a name="l02178"></a>02178     <span class="keywordflow">break</span>;
<a name="l02179"></a>02179   <span class="keywordflow">default</span>:
<a name="l02180"></a>02180     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>,<span class="stringliteral">"WARNING: devloper error ! should never reach this point!"</span>);
<a name="l02181"></a>02181     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02182"></a>02182     <span class="keywordflow">break</span>;
<a name="l02183"></a>02183   }
<a name="l02184"></a>02184 
<a name="l02185"></a>02185   <span class="comment">//should never reach this point</span>
<a name="l02186"></a>02186   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02187"></a>02187 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gbe5670effd9d72bb4b162cb678193f8c"></a><!-- doxytag: member="statistics.c::fc_getSeqVariableMeanSdev" ref="gbe5670effd9d72bb4b162cb678193f8c" args="(int numStep, FC_Variable *seqVar, double *mean, double *sdev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSeqVariableMeanSdev           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seqVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>sdev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute mean and standard deviation of a sequence variable. 
<p>
<b>Description:</b> <p>
Returns the mean and standard deviation of the values of all steps of a sequence variable. This routine only operates on fields with one component and error value is returned for vector and tensor fields.<p>
<b>Modifications:</b> <ul>
<li>2006-07-24 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - the number of steps in the seq variable </td></tr>
<tr><td valign="top"><em>seqVar</em>&nbsp;</td><td>
input - the seq variable's handles </td></tr>
<tr><td valign="top"><em>mean</em>&nbsp;</td><td>
output - average </td></tr>
<tr><td valign="top"><em>sdev</em>&nbsp;</td><td>
output - standard deviation(optional) </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00891">891</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05178">fc_isSeqVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00896"></a>00896   {
<a name="l00897"></a>00897   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00898"></a>00898   <span class="keywordtype">int</span> i, j;
<a name="l00899"></a>00899   <span class="keywordtype">int</span> numDataPoint, numTotal, dim;
<a name="l00900"></a>00900   <span class="keywordtype">void</span> *datap;
<a name="l00901"></a>00901   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00902"></a>00902   <span class="keywordtype">double</span> temp, value;
<a name="l00903"></a>00903   <span class="keywordtype">double</span> moving_sum = 0.0;
<a name="l00904"></a>00904   <span class="keywordtype">double</span> moving_sumsq = 0.0;
<a name="l00905"></a>00905 
<a name="l00906"></a>00906   <span class="comment">// default output</span>
<a name="l00907"></a>00907   <span class="keywordflow">if</span> (mean)
<a name="l00908"></a>00908     *mean = -1;
<a name="l00909"></a>00909   <span class="keywordflow">if</span> (sdev)
<a name="l00910"></a>00910     *sdev = -1;
<a name="l00911"></a>00911 
<a name="l00912"></a>00912   <span class="comment">// check input - they don't have to take </span>
<a name="l00913"></a>00913   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#gac07e226e274bee4de4b21db8e03ae0e" title="Check that the handle refers to a valid variable.">fc_isSeqVariableValid</a>(numStep, seqVar) || !mean) {
<a name="l00914"></a>00914     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00915"></a>00915     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00916"></a>00916   }
<a name="l00917"></a>00917 
<a name="l00918"></a>00918   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing mean and standard deviation."</span>);
<a name="l00919"></a>00919 
<a name="l00920"></a>00920   <span class="comment">// get a count &amp; pointer to the data array. </span>
<a name="l00921"></a>00921   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(seqVar[0], &amp;numDataPoint, &amp;dim, NULL, NULL, &amp;datatype);
<a name="l00922"></a>00922   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00923"></a>00923     <span class="keywordflow">return</span> rc;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925   <span class="comment">// can only do 1 component fields</span>
<a name="l00926"></a>00926   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00927"></a>00927     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00928"></a>00928     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00929"></a>00929   }
<a name="l00930"></a>00930   
<a name="l00931"></a>00931 
<a name="l00932"></a>00932   <span class="comment">// collect sums</span>
<a name="l00933"></a>00933   numTotal = numStep*numDataPoint;
<a name="l00934"></a>00934   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00935"></a>00935     <span class="comment">// get data</span>
<a name="l00936"></a>00936     rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqVar[i], &amp;datap);
<a name="l00937"></a>00937     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00938"></a>00938       <span class="keywordflow">return</span> rc;
<a name="l00939"></a>00939   
<a name="l00940"></a>00940     <span class="comment">// Perform the calculation</span>
<a name="l00941"></a>00941     <span class="keywordflow">for</span> (j = 0; j &lt; numDataPoint; j++) {
<a name="l00942"></a>00942       <span class="keywordflow">switch</span>(datatype) {
<a name="l00943"></a>00943       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:     value = ((<span class="keywordtype">int</span>*)datap)[j];     <span class="keywordflow">break</span>;
<a name="l00944"></a>00944       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[j];   <span class="keywordflow">break</span>;
<a name="l00945"></a>00945       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[j];  <span class="keywordflow">break</span>;
<a name="l00946"></a>00946       <span class="keywordflow">default</span>: 
<a name="l00947"></a>00947         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00948"></a>00948         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00949"></a>00949       }
<a name="l00950"></a>00950       moving_sum += value;
<a name="l00951"></a>00951       moving_sumsq += value*value;
<a name="l00952"></a>00952     }
<a name="l00953"></a>00953   }
<a name="l00954"></a>00954   
<a name="l00955"></a>00955   <span class="comment">// if user asked for mean, compute it here</span>
<a name="l00956"></a>00956   <span class="keywordflow">if</span> (mean != NULL) 
<a name="l00957"></a>00957     *mean = moving_sum / numTotal;
<a name="l00958"></a>00958   
<a name="l00959"></a>00959   <span class="comment">// if user asked for std dev, compute it here</span>
<a name="l00960"></a>00960   <span class="comment">// This is probably the "best" way to computer the</span>
<a name="l00961"></a>00961   <span class="comment">// stdev as it minimizes the number of '-' operations that might</span>
<a name="l00962"></a>00962   <span class="comment">// cause roundoff error.</span>
<a name="l00963"></a>00963   <span class="keywordflow">if</span> (sdev != NULL) {
<a name="l00964"></a>00964     <span class="keywordflow">if</span> (numTotal &gt; 1) { 
<a name="l00965"></a>00965       temp = (moving_sumsq - (moving_sum * moving_sum / numTotal)) 
<a name="l00966"></a>00966         / (numTotal - 1);
<a name="l00967"></a>00967       *sdev = sqrt(fabs(temp)); <span class="comment">// might be negative if roundoff error</span>
<a name="l00968"></a>00968     }
<a name="l00969"></a>00969     <span class="keywordflow">else</span>
<a name="l00970"></a>00970       *sdev = 0;  <span class="comment">//FIX? report NAN?</span>
<a name="l00971"></a>00971   }
<a name="l00972"></a>00972   
<a name="l00973"></a>00973   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00974"></a>00974 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfa32a24cb703b1c9c1f08224e86a504f"></a><!-- doxytag: member="statistics.c::fc_getSeqVariableMinMax" ref="gfa32a24cb703b1c9c1f08224e86a504f" args="(int numStep, FC_Variable *seqVar, double *min, int *min_seq_id, int *min_entity_id, double *max, int *max_seq_id, int *max_entity_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSeqVariableMinMax           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seqVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>min_seq_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>min_entity_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>max_seq_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>max_entity_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find min &amp; max data values of a sequence variable. 
<p>
<b>Description:</b> <p>
Returns the min and max values of a sequence variable. Also returns sequence step id and the id of the entity which had the min and max values (the first one encountered if more than one node or element have the same value). This routine only operates on fields with one component and error value is returned for vector and tensor fields.<p>
<b>Modifications:</b> <ul>
<li>2006-07-24 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - the number of steps in the seq variable </td></tr>
<tr><td valign="top"><em>seqVar</em>&nbsp;</td><td>
input - the seq variable's handles </td></tr>
<tr><td valign="top"><em>min</em>&nbsp;</td><td>
output - the min data value </td></tr>
<tr><td valign="top"><em>min_seq_id</em>&nbsp;</td><td>
output - the step ID at which the first min value was found </td></tr>
<tr><td valign="top"><em>min_entity_id</em>&nbsp;</td><td>
output - the entity ID at which first min value was found </td></tr>
<tr><td valign="top"><em>max</em>&nbsp;</td><td>
output - max data value </td></tr>
<tr><td valign="top"><em>max_seq_id</em>&nbsp;</td><td>
output - the step ID at which the first max value was found </td></tr>
<tr><td valign="top"><em>max_entity_id</em>&nbsp;</td><td>
output - the entity ID at which first max value was found </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00764">764</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05178">fc_isSeqVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="varNormalize_8c-source.html#l00196">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00777"></a>00777   {
<a name="l00778"></a>00778   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00779"></a>00779   <span class="keywordtype">int</span> i, j;
<a name="l00780"></a>00780   <span class="keywordtype">int</span> numDataPoint, dim;
<a name="l00781"></a>00781   <span class="keywordtype">void</span> *datap;
<a name="l00782"></a>00782   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00783"></a>00783   <span class="keywordtype">double</span> value, moving_min, moving_max;
<a name="l00784"></a>00784   <span class="keywordtype">int</span> minsi, minei, maxsi, maxei;
<a name="l00785"></a>00785   
<a name="l00786"></a>00786   <span class="comment">// default output</span>
<a name="l00787"></a>00787   <span class="keywordflow">if</span> (min)
<a name="l00788"></a>00788     *min = -1;
<a name="l00789"></a>00789   <span class="keywordflow">if</span> (min_seq_id)
<a name="l00790"></a>00790     *min_seq_id = -1;
<a name="l00791"></a>00791   <span class="keywordflow">if</span> (min_entity_id)
<a name="l00792"></a>00792     *min_entity_id = -1;
<a name="l00793"></a>00793   <span class="keywordflow">if</span> (max)
<a name="l00794"></a>00794     *max = -1;
<a name="l00795"></a>00795   <span class="keywordflow">if</span> (max_seq_id)
<a name="l00796"></a>00796     *max_seq_id = -1;
<a name="l00797"></a>00797   <span class="keywordflow">if</span> (max_entity_id)
<a name="l00798"></a>00798     *max_entity_id = -1;
<a name="l00799"></a>00799 
<a name="l00800"></a>00800   <span class="comment">// check input - they don't have to take </span>
<a name="l00801"></a>00801   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#gac07e226e274bee4de4b21db8e03ae0e" title="Check that the handle refers to a valid variable.">fc_isSeqVariableValid</a>(numStep, seqVar) || 
<a name="l00802"></a>00802       (!min &amp;&amp; !min_seq_id &amp;&amp; !min_entity_id &amp;&amp; !max &amp;&amp; !max_seq_id &amp;&amp; !max_entity_id)) {
<a name="l00803"></a>00803     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00804"></a>00804     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00805"></a>00805   }
<a name="l00806"></a>00806 
<a name="l00807"></a>00807   <span class="comment">// log message</span>
<a name="l00808"></a>00808   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Finding min and max values."</span>);
<a name="l00809"></a>00809 
<a name="l00810"></a>00810   <span class="comment">// get a count &amp; pointer to the data array. </span>
<a name="l00811"></a>00811   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(seqVar[0], &amp;numDataPoint, &amp;dim, NULL, NULL, &amp;datatype);
<a name="l00812"></a>00812   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00813"></a>00813     <span class="keywordflow">return</span> rc;
<a name="l00814"></a>00814 
<a name="l00815"></a>00815   <span class="comment">// can only do 1 component fields</span>
<a name="l00816"></a>00816   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00817"></a>00817     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00818"></a>00818     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00819"></a>00819   }
<a name="l00820"></a>00820   
<a name="l00821"></a>00821   <span class="comment">// initialize the first point</span>
<a name="l00822"></a>00822   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqVar[0], &amp;datap);
<a name="l00823"></a>00823   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00824"></a>00824     <span class="keywordflow">return</span> rc;
<a name="l00825"></a>00825   <span class="keywordflow">switch</span> (datatype) {
<a name="l00826"></a>00826   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> :    value = ((<span class="keywordtype">int</span>*)datap)[0];     <span class="keywordflow">break</span>;
<a name="l00827"></a>00827   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[0];   <span class="keywordflow">break</span>;
<a name="l00828"></a>00828   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[0];  <span class="keywordflow">break</span>;
<a name="l00829"></a>00829   <span class="keywordflow">default</span>: 
<a name="l00830"></a>00830     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00831"></a>00831     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00832"></a>00832   }
<a name="l00833"></a>00833   moving_min = moving_max = value;
<a name="l00834"></a>00834   minsi = minei = maxsi = maxei = 0;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836   <span class="comment">// Look at all points (will repeat first one because less coding work)        </span>
<a name="l00837"></a>00837   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00838"></a>00838     rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqVar[i], &amp;datap);
<a name="l00839"></a>00839     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00840"></a>00840       <span class="keywordflow">return</span> rc;
<a name="l00841"></a>00841     <span class="keywordflow">for</span> (j = 0; j &lt; numDataPoint; j++) {
<a name="l00842"></a>00842       <span class="keywordflow">switch</span>(datatype) {
<a name="l00843"></a>00843       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> :    value = ((<span class="keywordtype">int</span>*)datap)[j];     <span class="keywordflow">break</span>;
<a name="l00844"></a>00844       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[j];   <span class="keywordflow">break</span>;
<a name="l00845"></a>00845       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[j];  <span class="keywordflow">break</span>;
<a name="l00846"></a>00846       <span class="keywordflow">default</span>: ;<span class="comment">// nothing</span>
<a name="l00847"></a>00847       }
<a name="l00848"></a>00848       <span class="keywordflow">if</span> (value &lt; moving_min) {
<a name="l00849"></a>00849      moving_min = value;
<a name="l00850"></a>00850      minsi = i;
<a name="l00851"></a>00851      minei = j;
<a name="l00852"></a>00852       }
<a name="l00853"></a>00853       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value &gt; moving_max) {
<a name="l00854"></a>00854      moving_max = value;
<a name="l00855"></a>00855      maxsi = i;
<a name="l00856"></a>00856      maxei = j;
<a name="l00857"></a>00857       }
<a name="l00858"></a>00858     }
<a name="l00859"></a>00859   }
<a name="l00860"></a>00860   
<a name="l00861"></a>00861   <span class="comment">// only set the ones the user requested  </span>
<a name="l00862"></a>00862   <span class="keywordflow">if</span> (min != NULL)
<a name="l00863"></a>00863     *min = moving_min;
<a name="l00864"></a>00864   <span class="keywordflow">if</span> (min_seq_id != NULL)
<a name="l00865"></a>00865     *min_seq_id = minsi;
<a name="l00866"></a>00866   <span class="keywordflow">if</span> (min_entity_id != NULL)
<a name="l00867"></a>00867     *min_entity_id = minei;
<a name="l00868"></a>00868   <span class="keywordflow">if</span> (max != NULL)
<a name="l00869"></a>00869     *max = moving_max;
<a name="l00870"></a>00870   <span class="keywordflow">if</span> (max_seq_id != NULL)
<a name="l00871"></a>00871     *max_seq_id = maxsi;
<a name="l00872"></a>00872   <span class="keywordflow">if</span> (max_entity_id != NULL)
<a name="l00873"></a>00873     *max_entity_id = maxei;
<a name="l00874"></a>00874   
<a name="l00875"></a>00875   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00876"></a>00876 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g6bb6087f9da82dc295d312ab9614d0da"></a><!-- doxytag: member="statistics.c::fc_getSeqVariableSeriesMeanSdev" ref="g6bb6087f9da82dc295d312ab9614d0da" args="(int numStep, FC_Variable *seqvar, FC_Variable *meanvar, FC_Variable *sdevvar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSeqVariableSeriesMeanSdev           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seqvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>meanvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>sdevvar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute mean and standard deviation of a seq variable across its sequence (series) on a per data point, per component basis. 
<p>
<b>Description:</b> <p>
Returns the mean and standard deviation of the values of a variable field. This routine treats each data point and each component of the sequence variable separately. Thus, the computation is over the sequence quantity (e.g., time) rather than over the data points as it is in the fc_getVariableXXX functions.<p>
NOTE:<ul>
<li>Output is an <a class="el" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> with each sum at the corresponding data array location, rather than raw data - unlike the fc_getVariableMeanSdevfunction. The output variable names are the name of the original subset, postpended with "_SeriesMean" or "_SeriesSdev".</li><li>Return type of data array is FC_DT_DOUBLE as in fc_getVariableMeanSdev.</li><li>Like other methods in this module, this is the square root of the bias corrected variance, i.e., sqrt(((1/(N-1)) * sum((xi - xave)**2)) so sample variance =sqrt((N-1)/N) * stddev_from_here where N = number of steps in the series.</li><li>Stdev is an optional arg.</li><li>In the case of variable with a single data point, the standard dev is technically undefined, but this routine will return 0.</li></ul>
<p>
<b>Modifications:</b> <ul>
<li>1/19/05 ACG Created.</li><li>2/3/05 ACG changed name to have "Time" in title. While the sequence is not necessarily a time sequence, this makes it clear that the function is over the sequence and not over the data points, as in the fc_getVariableXXX functions in this module.</li><li>2/3/05 ACG changed output type to <a class="el" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> at WSK request.</li><li>2/9/05 ACG removed output name option to be consistent with other sequence variable functions in the module</li><li>6/2/05 ACG changing name from "TimeMean" to "SeriesMean" </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - numStep in sequenceVariable </td></tr>
<tr><td valign="top"><em>seqvar</em>&nbsp;</td><td>
input - seq variable handle </td></tr>
<tr><td valign="top"><em>meanvar</em>&nbsp;</td><td>
output - mean data value array </td></tr>
<tr><td valign="top"><em>sdevvar</em>&nbsp;</td><td>
output - sdev data value array </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l01324">1324</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00286">fc_createVariable()</a>, <a class="el" href="variable_8c-source.html#l04980">fc_deleteVariable()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l05392">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05178">fc_isSeqVariableValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00779">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00604">fc_setVariableDataPtr()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="seriesAnalyzer_8c-source.html#l00102">numComponent</a>.</p>

<p>Referenced by <a class="el" href="series_8c-source.html#l02072">fc_normalForm()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01329"></a>01329    {
<a name="l01330"></a>01330   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01331"></a>01331   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01332"></a>01332   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l01333"></a>01333   <span class="keywordtype">int</span> numDataPoint;
<a name="l01334"></a>01334   <span class="keywordtype">int</span> <a class="code" href="seriesAnalyzer_8c.html#9ba814c62f21460639802c7771e86fa6">numComponent</a>;
<a name="l01335"></a>01335   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l01336"></a>01336   <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype;
<a name="l01337"></a>01337   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l01338"></a>01338   <span class="keywordtype">int</span> sum_dim;
<a name="l01339"></a>01339   <span class="keywordtype">int</span> i,j;
<a name="l01340"></a>01340   <span class="keywordtype">void</span> *data;
<a name="l01341"></a>01341   <span class="keywordtype">double</span> *sum, *sumsq, *temp, *mean, *sdev;
<a name="l01342"></a>01342 
<a name="l01343"></a>01343   <span class="keywordtype">char</span> *meanname, *sdevname, *varname;
<a name="l01344"></a>01344 
<a name="l01345"></a>01345 
<a name="l01346"></a>01346   <span class="keywordflow">if</span> (meanvar)
<a name="l01347"></a>01347     *meanvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349 
<a name="l01350"></a>01350   <span class="keywordflow">if</span> (sdevvar)
<a name="l01351"></a>01351     *sdevvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01352"></a>01352 
<a name="l01353"></a>01353   <span class="comment">//check input</span>
<a name="l01354"></a>01354   <span class="keywordflow">if</span> (meanvar == NULL ||
<a name="l01355"></a>01355       !<a class="code" href="group__Variable.html#gac07e226e274bee4de4b21db8e03ae0e" title="Check that the handle refers to a valid variable.">fc_isSeqVariableValid</a>(numStep,seqvar)){
<a name="l01356"></a>01356     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01357"></a>01357     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01358"></a>01358   }
<a name="l01359"></a>01359 
<a name="l01360"></a>01360 
<a name="l01361"></a>01361   varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqvar[0]);
<a name="l01362"></a>01362   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting mean and sdev for seq variable '%s'"</span>,
<a name="l01363"></a>01363                       varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01364"></a>01364 
<a name="l01365"></a>01365 
<a name="l01366"></a>01366   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(seqvar[0], &amp;numDataPoint, &amp;numComponent, &amp;assoc,
<a name="l01367"></a>01367                            &amp;mathtype, &amp;datatype);
<a name="l01368"></a>01368   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01369"></a>01369     <span class="keywordflow">return</span> rc;
<a name="l01370"></a>01370   }
<a name="l01371"></a>01371 
<a name="l01372"></a>01372   <span class="keywordflow">if</span> (!(datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> ||
<a name="l01373"></a>01373         datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> ||
<a name="l01374"></a>01374         datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> )
<a name="l01375"></a>01375       ){
<a name="l01376"></a>01376     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01377"></a>01377   }
<a name="l01378"></a>01378 
<a name="l01379"></a>01379   sum_dim = numDataPoint*numComponent;
<a name="l01380"></a>01380   sum = (<span class="keywordtype">double</span>*)malloc(sum_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01381"></a>01381   <span class="keywordflow">if</span> (sum == NULL) {
<a name="l01382"></a>01382     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01383"></a>01383     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01384"></a>01384   }
<a name="l01385"></a>01385   sumsq = (<span class="keywordtype">double</span>*)malloc(sum_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01386"></a>01386   <span class="keywordflow">if</span> (sumsq == NULL) {
<a name="l01387"></a>01387     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01388"></a>01388     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01389"></a>01389   }
<a name="l01390"></a>01390 
<a name="l01391"></a>01391   <span class="keywordflow">for</span> (i =0; i &lt; sum_dim; i++){
<a name="l01392"></a>01392     sum[i] = 0.0;
<a name="l01393"></a>01393     sumsq[i] = 0.0;
<a name="l01394"></a>01394   }
<a name="l01395"></a>01395 
<a name="l01396"></a>01396   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++){
<a name="l01397"></a>01397     rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqvar[i], &amp;data);
<a name="l01398"></a>01398     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01399"></a>01399       data = NULL;
<a name="l01400"></a>01400       free(sum);
<a name="l01401"></a>01401       free(sumsq);
<a name="l01402"></a>01402       <span class="keywordflow">return</span> rc;
<a name="l01403"></a>01403     }
<a name="l01404"></a>01404     <span class="keywordflow">for</span> (j = 0; j &lt; sum_dim; j++){
<a name="l01405"></a>01405       <span class="keywordtype">double</span> quan = 0.0;
<a name="l01406"></a>01406       <span class="keywordflow">switch</span>(datatype){
<a name="l01407"></a>01407       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:
<a name="l01408"></a>01408         quan = ((<span class="keywordtype">double</span>*)data)[j];
<a name="l01409"></a>01409         <span class="keywordflow">break</span>;
<a name="l01410"></a>01410       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l01411"></a>01411         quan = (double)(((<span class="keywordtype">int</span>*)data)[j]);
<a name="l01412"></a>01412         <span class="keywordflow">break</span>;
<a name="l01413"></a>01413       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l01414"></a>01414         quan = (double)(((<span class="keywordtype">float</span>*)data)[j]);
<a name="l01415"></a>01415         <span class="keywordflow">break</span>;
<a name="l01416"></a>01416       <span class="keywordflow">default</span>:
<a name="l01417"></a>01417         printf(<span class="stringliteral">"** Developer Alert! Should never reach this point!**\n"</span>);
<a name="l01418"></a>01418         fflush(NULL);
<a name="l01419"></a>01419         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Invalid data type"</span>);
<a name="l01420"></a>01420         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01421"></a>01421         <span class="keywordflow">break</span>;
<a name="l01422"></a>01422       }
<a name="l01423"></a>01423       sum[j]+= quan;
<a name="l01424"></a>01424       sumsq[j]+= quan*quan;
<a name="l01425"></a>01425     }
<a name="l01426"></a>01426   }
<a name="l01427"></a>01427 
<a name="l01428"></a>01428 
<a name="l01429"></a>01429   temp = (<span class="keywordtype">double</span>*)malloc(sum_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01430"></a>01430   <span class="keywordflow">if</span> (temp == NULL) {
<a name="l01431"></a>01431     free(sum);
<a name="l01432"></a>01432     free(sumsq);
<a name="l01433"></a>01433     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01434"></a>01434     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01435"></a>01435   }
<a name="l01436"></a>01436 
<a name="l01437"></a>01437   mean = (<span class="keywordtype">double</span>*)malloc(sum_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01438"></a>01438   <span class="keywordflow">if</span> (mean == NULL) {
<a name="l01439"></a>01439     free(temp);
<a name="l01440"></a>01440     free(sum);
<a name="l01441"></a>01441     free(sumsq);
<a name="l01442"></a>01442     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01443"></a>01443     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01444"></a>01444   }
<a name="l01445"></a>01445 
<a name="l01446"></a>01446   <span class="keywordflow">if</span> (sdevvar != NULL){
<a name="l01447"></a>01447     sdev = (<span class="keywordtype">double</span>*)malloc(sum_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01448"></a>01448     <span class="keywordflow">if</span> (sdev == NULL) {
<a name="l01449"></a>01449       free(temp);
<a name="l01450"></a>01450       free(mean);
<a name="l01451"></a>01451       free(sum);
<a name="l01452"></a>01452       free(sumsq);
<a name="l01453"></a>01453       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01454"></a>01454       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01455"></a>01455     }
<a name="l01456"></a>01456   }
<a name="l01457"></a>01457 
<a name="l01458"></a>01458   <span class="keywordflow">for</span> (j = 0; j &lt; sum_dim; j++){
<a name="l01459"></a>01459     mean[j] = sum[j]/numStep;
<a name="l01460"></a>01460     
<a name="l01461"></a>01461     <span class="keywordflow">if</span> (sdevvar != NULL){
<a name="l01462"></a>01462       <span class="keywordflow">if</span> (numStep &gt; 1) { 
<a name="l01463"></a>01463         temp[j] = (sumsq[j] - (sum[j] * sum[j] / numStep)) / (numStep - 1);
<a name="l01464"></a>01464         sdev[j] = sqrt(fabs(temp[j]));
<a name="l01465"></a>01465         <span class="comment">// might be negative if roundoff error</span>
<a name="l01466"></a>01466       }
<a name="l01467"></a>01467       <span class="keywordflow">else</span>{
<a name="l01468"></a>01468         sdev[j] = 0.0;  <span class="comment">//FIX? report NAN?</span>
<a name="l01469"></a>01469       }
<a name="l01470"></a>01470     }
<a name="l01471"></a>01471   }
<a name="l01472"></a>01472 
<a name="l01473"></a>01473   free(temp);
<a name="l01474"></a>01474   free(sum);
<a name="l01475"></a>01475   free(sumsq);
<a name="l01476"></a>01476 
<a name="l01477"></a>01477   rc = <a class="code" href="group__Variable.html#g6808d2015766d9b530b93375f42296a3" title="Get the parent mesh of the variable.">fc_getMeshFromVariable</a>(seqvar[0],&amp;mesh);
<a name="l01478"></a>01478   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01479"></a>01479     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(rc));
<a name="l01480"></a>01480     free(mean);
<a name="l01481"></a>01481     <span class="keywordflow">if</span> (sdev) free(sdev);
<a name="l01482"></a>01482     <span class="keywordflow">return</span> rc;
<a name="l01483"></a>01483   }
<a name="l01484"></a>01484 
<a name="l01485"></a>01485 
<a name="l01486"></a>01486   varname = varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>;
<a name="l01487"></a>01487   meanname = malloc((strlen(varname)+20)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01488"></a>01488   <span class="keywordflow">if</span> (meanname == NULL) {
<a name="l01489"></a>01489     free(mean);
<a name="l01490"></a>01490     <span class="keywordflow">if</span> (sdev) free(sdev);
<a name="l01491"></a>01491     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01492"></a>01492     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01493"></a>01493   }
<a name="l01494"></a>01494   sprintf(meanname, <span class="stringliteral">"%s_SeriesMean"</span>, varname);
<a name="l01495"></a>01495 
<a name="l01496"></a>01496 
<a name="l01497"></a>01497 
<a name="l01498"></a>01498   rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(mesh,meanname,meanvar);
<a name="l01499"></a>01499   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01500"></a>01500     free(mean);
<a name="l01501"></a>01501     <span class="keywordflow">if</span> (meanname) free(meanname);
<a name="l01502"></a>01502     <span class="keywordflow">if</span> (sdev) free(sdev);
<a name="l01503"></a>01503     <span class="keywordflow">return</span> rc;
<a name="l01504"></a>01504   }
<a name="l01505"></a>01505 
<a name="l01506"></a>01506   free(meanname);
<a name="l01507"></a>01507 
<a name="l01508"></a>01508   rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(*meanvar,numDataPoint, numComponent,
<a name="l01509"></a>01509                              assoc,mathtype,<a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>,mean);
<a name="l01510"></a>01510   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01511"></a>01511     <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*meanvar);
<a name="l01512"></a>01512     <span class="keywordflow">if</span> (mean) free(mean);
<a name="l01513"></a>01513     <span class="keywordflow">if</span> (sdev) free(sdev);
<a name="l01514"></a>01514     <span class="keywordflow">return</span> rc;
<a name="l01515"></a>01515   }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517 
<a name="l01518"></a>01518   <span class="keywordflow">if</span> (sdevvar != NULL){
<a name="l01519"></a>01519     sdevname = malloc((strlen(varname)+20)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01520"></a>01520     <span class="keywordflow">if</span> (sdevname == NULL) {
<a name="l01521"></a>01521       free(sdev);
<a name="l01522"></a>01522       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01523"></a>01523       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01524"></a>01524     }
<a name="l01525"></a>01525     sprintf(sdevname, <span class="stringliteral">"%s_SeriesSdev"</span>, varname);
<a name="l01526"></a>01526     
<a name="l01527"></a>01527     rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(mesh,sdevname,sdevvar);
<a name="l01528"></a>01528     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01529"></a>01529       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*meanvar);
<a name="l01530"></a>01530       free(sdevname);
<a name="l01531"></a>01531       free(sdev);
<a name="l01532"></a>01532       <span class="keywordflow">return</span> rc;
<a name="l01533"></a>01533     }
<a name="l01534"></a>01534 
<a name="l01535"></a>01535     free(sdevname);
<a name="l01536"></a>01536 
<a name="l01537"></a>01537     rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(*sdevvar,numDataPoint, numComponent,
<a name="l01538"></a>01538                                assoc,mathtype,<a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>,sdev);
<a name="l01539"></a>01539     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01540"></a>01540       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*meanvar);
<a name="l01541"></a>01541       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*sdevvar);
<a name="l01542"></a>01542       <span class="keywordflow">if</span> (sdev) free(sdev);
<a name="l01543"></a>01543       <span class="keywordflow">return</span> rc;
<a name="l01544"></a>01544     }
<a name="l01545"></a>01545   }
<a name="l01546"></a>01546 
<a name="l01547"></a>01547   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01548"></a>01548 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8f565e977a0909545d87bb33bc7bd6f6"></a><!-- doxytag: member="statistics.c::fc_getSeqVariableSeriesMinMax" ref="g8f565e977a0909545d87bb33bc7bd6f6" args="(int numStep, FC_Variable *seqvar, FC_Variable *minvar, FC_Variable *maxvar, FC_Variable *minindexvar, FC_Variable *maxindexvar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSeqVariableSeriesMinMax           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seqvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>minvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>maxvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>minindexvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>maxindexvar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find min &amp; max data values of a sequence variable across its sequence (series) on a per data point, per component basis. 
<p>
<b>Description:</b> <p>
Returns the min and max values of a variable field (and sequence (e.g., time) indicies of them - see below). This routine treats each data point and each component of the sequence variable separately. Thus, the min and max are calc across a series (e.g., time) rather than over the data points as it is in the fc_getVariableXXX functions. This routine also returns the sequence index of the min and max (the first one encountered if the var has teh same value at more than one point in "time").<p>
NOTE:<ul>
<li>Outputs are FC_Variables with each value at the corresponding data array location, rather than raw data - unlike the fc_getVariableMinMax function. The output variable names are the name of the original subset, postpended with "_SeriesMin", "_SeriesMax", "_SeriesMinIndex" and "_SeriesMaxIndex".</li><li>Return type of variable data are FC_DT_DOUBLE as in fc_getVariableMinMax, rather than native type.</li><li>Unlike fc_getVariableMinMax, none of the output variables is optional</li></ul>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000089">Todo:</a></b></dt><dd>see about making the output options optional.</dd></dl>
<b>Modifications:</b> <ul>
<li>1/18/05 ACG Created.</li><li>2/3/05 ACG changed name to have "Time" in title. While the sequence is not necessarily a time sequence, this makes it clear that the function is over the sequence and not over the data points, as in the fc_getVariableXXX functions in this module.</li><li>2/4/05 ACG changing interface to return FC_Variables at request of WSK.</li><li>2/9/05 ACG removed output name options as the signature was too unwieldy.</li><li>6/1/05 ACG renamed to "series" rather than "time" to reflect change of timeseries module to series module</li><li>1/09/06 ACG removing cleanup in case of developer error at suggest of WSK becuase its confusing hte results of the coverage tests. if things reach that point, it should really be killed so cleanup doesnt matter. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - numStep in sequenceVariable </td></tr>
<tr><td valign="top"><em>seqvar</em>&nbsp;</td><td>
input - seq variable handle </td></tr>
<tr><td valign="top"><em>minvar</em>&nbsp;</td><td>
output - min var variable </td></tr>
<tr><td valign="top"><em>maxvar</em>&nbsp;</td><td>
output - max var variable </td></tr>
<tr><td valign="top"><em>minindexvar</em>&nbsp;</td><td>
output - min series index var variable </td></tr>
<tr><td valign="top"><em>maxindexvar</em>&nbsp;</td><td>
output - max series index var variable </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l01028">1028</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00286">fc_createVariable()</a>, <a class="el" href="variable_8c-source.html#l04980">fc_deleteVariable()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l05392">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05178">fc_isSeqVariableValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00779">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00604">fc_setVariableDataPtr()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="seriesAnalyzer_8c-source.html#l00102">numComponent</a>.</p>

<p>Referenced by <a class="el" href="seriesAnalyzer_8c-source.html#l00439">doSingles()</a>, and <a class="el" href="series_8c-source.html#l03021">fc_dimensionlessAreaBetweenCurves()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01035"></a>01035   {
<a name="l01036"></a>01036   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01037"></a>01037   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l01038"></a>01038   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01039"></a>01039   <span class="keywordtype">int</span> numDataPoint;
<a name="l01040"></a>01040   <span class="keywordtype">int</span> <a class="code" href="seriesAnalyzer_8c.html#9ba814c62f21460639802c7771e86fa6">numComponent</a>;
<a name="l01041"></a>01041   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l01042"></a>01042   <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype;
<a name="l01043"></a>01043   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l01044"></a>01044   <span class="keywordtype">int</span> var_dim;
<a name="l01045"></a>01045   <span class="keywordtype">int</span> i,j;
<a name="l01046"></a>01046   <span class="keywordtype">double</span> *mindata, *maxdata;
<a name="l01047"></a>01047   <span class="keywordtype">int</span> *minindexdata, *maxindexdata;
<a name="l01048"></a>01048   <span class="keywordtype">void</span> *data;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050   <span class="keywordtype">char</span>* varname;
<a name="l01051"></a>01051   <span class="keywordtype">char</span>* name;
<a name="l01052"></a>01052   <span class="keywordtype">void</span>* mdata;
<a name="l01053"></a>01053   <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* mvar;
<a name="l01054"></a>01054   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> mdt;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056 
<a name="l01057"></a>01057   <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l01058"></a>01058     MMIN = 0,
<a name="l01059"></a>01059     MMAX = 1,
<a name="l01060"></a>01060     MMINI = 2,
<a name="l01061"></a>01061     MMAXI = 3
<a name="l01062"></a>01062   } junktype;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064 
<a name="l01065"></a>01065   <span class="keywordflow">if</span> (minvar)
<a name="l01066"></a>01066     *minvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01067"></a>01067   <span class="keywordflow">if</span> (maxvar)
<a name="l01068"></a>01068     *maxvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01069"></a>01069   <span class="keywordflow">if</span> (minindexvar)
<a name="l01070"></a>01070     *minindexvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01071"></a>01071   <span class="keywordflow">if</span> (maxindexvar)
<a name="l01072"></a>01072     *maxindexvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074 
<a name="l01075"></a>01075 
<a name="l01076"></a>01076   <span class="comment">//check input</span>
<a name="l01077"></a>01077   <span class="keywordflow">if</span> (minvar == NULL || 
<a name="l01078"></a>01078       maxvar == NULL || 
<a name="l01079"></a>01079       minindexvar == NULL || 
<a name="l01080"></a>01080       maxindexvar == NULL || 
<a name="l01081"></a>01081       (!<a class="code" href="group__Variable.html#gac07e226e274bee4de4b21db8e03ae0e" title="Check that the handle refers to a valid variable.">fc_isSeqVariableValid</a>(numStep,seqvar))){
<a name="l01082"></a>01082     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01083"></a>01083     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01084"></a>01084   }
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 
<a name="l01087"></a>01087   varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqvar[0]);
<a name="l01088"></a>01088   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting min max for seq variable '%s'"</span>,
<a name="l01089"></a>01089                       varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01090"></a>01090 
<a name="l01091"></a>01091   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(seqvar[0], &amp;numDataPoint, &amp;numComponent, &amp;assoc,
<a name="l01092"></a>01092                            &amp;mathtype, &amp;datatype);
<a name="l01093"></a>01093   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01094"></a>01094     <span class="keywordflow">return</span> rc;
<a name="l01095"></a>01095   }
<a name="l01096"></a>01096 
<a name="l01097"></a>01097   <span class="keywordflow">if</span> (!(datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> ||
<a name="l01098"></a>01098         datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> ||
<a name="l01099"></a>01099         datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> )
<a name="l01100"></a>01100       ){
<a name="l01101"></a>01101     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01102"></a>01102   } 
<a name="l01103"></a>01103 
<a name="l01104"></a>01104   <span class="comment">//finally ok</span>
<a name="l01105"></a>01105 
<a name="l01106"></a>01106   var_dim = numDataPoint*numComponent;
<a name="l01107"></a>01107   
<a name="l01108"></a>01108 
<a name="l01109"></a>01109   mindata = (<span class="keywordtype">double</span>*)malloc(var_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01110"></a>01110   maxdata = (<span class="keywordtype">double</span>*)malloc(var_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01111"></a>01111   minindexdata = (<span class="keywordtype">int</span>*)malloc(var_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01112"></a>01112   maxindexdata = (<span class="keywordtype">int</span>*)malloc(var_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01113"></a>01113   <span class="keywordflow">if</span> (mindata == NULL || maxdata == NULL || minindexdata == NULL ||
<a name="l01114"></a>01114       maxindexdata == NULL) {
<a name="l01115"></a>01115     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01116"></a>01116     free(mindata);
<a name="l01117"></a>01117     free(maxdata);
<a name="l01118"></a>01118     free(minindexdata);
<a name="l01119"></a>01119     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01120"></a>01120   }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122   
<a name="l01123"></a>01123   <span class="comment">//initialize with first point</span>
<a name="l01124"></a>01124   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqvar[0], &amp;data);
<a name="l01125"></a>01125   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01126"></a>01126     data = NULL;
<a name="l01127"></a>01127     free(mindata);
<a name="l01128"></a>01128     free(maxdata);
<a name="l01129"></a>01129     free(minindexdata);
<a name="l01130"></a>01130     free(maxindexdata);
<a name="l01131"></a>01131     <span class="keywordflow">return</span> rc;
<a name="l01132"></a>01132   }
<a name="l01133"></a>01133   <span class="keywordflow">for</span> (j = 0; j &lt; var_dim; j++){
<a name="l01134"></a>01134     <span class="keywordtype">double</span> quan = 0.0;
<a name="l01135"></a>01135     <span class="keywordflow">switch</span>(datatype){
<a name="l01136"></a>01136     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:
<a name="l01137"></a>01137       quan= ((<span class="keywordtype">double</span>*)data)[j];
<a name="l01138"></a>01138       <span class="keywordflow">break</span>;
<a name="l01139"></a>01139     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l01140"></a>01140       quan= (double)(((<span class="keywordtype">int</span>*)data)[j]);
<a name="l01141"></a>01141       <span class="keywordflow">break</span>;
<a name="l01142"></a>01142     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l01143"></a>01143       quan= (double)(((<span class="keywordtype">float</span>*)data)[j]);
<a name="l01144"></a>01144       <span class="keywordflow">break</span>;
<a name="l01145"></a>01145     <span class="keywordflow">default</span>:
<a name="l01146"></a>01146       printf(<span class="stringliteral">"** Developer Alert! Should never reach this point!**\n"</span>);
<a name="l01147"></a>01147       fflush(NULL);
<a name="l01148"></a>01148       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Invalid id type"</span>);
<a name="l01149"></a>01149       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01150"></a>01150       <span class="keywordflow">break</span>;
<a name="l01151"></a>01151     }
<a name="l01152"></a>01152     mindata[j] = quan; 
<a name="l01153"></a>01153     maxdata[j] = quan; 
<a name="l01154"></a>01154     minindexdata[j]= 0;
<a name="l01155"></a>01155     maxindexdata[j]= 0;
<a name="l01156"></a>01156     }
<a name="l01157"></a>01157 
<a name="l01158"></a>01158   
<a name="l01159"></a>01159   <span class="keywordflow">for</span> (i = 1; i &lt; numStep; i++){
<a name="l01160"></a>01160     rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqvar[i], &amp;data);
<a name="l01161"></a>01161     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01162"></a>01162       data = NULL;
<a name="l01163"></a>01163       free(mindata);
<a name="l01164"></a>01164       free(maxdata);
<a name="l01165"></a>01165       free(minindexdata);
<a name="l01166"></a>01166       free(maxindexdata);
<a name="l01167"></a>01167       <span class="keywordflow">return</span> rc;
<a name="l01168"></a>01168     }
<a name="l01169"></a>01169     <span class="keywordflow">for</span> (j = 0; j &lt; var_dim; j++){
<a name="l01170"></a>01170       <span class="keywordtype">double</span> quan = 0.0;
<a name="l01171"></a>01171       <span class="keywordflow">switch</span>(datatype){
<a name="l01172"></a>01172       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:
<a name="l01173"></a>01173         quan = ((<span class="keywordtype">double</span>*)data)[j];
<a name="l01174"></a>01174         <span class="keywordflow">break</span>;
<a name="l01175"></a>01175       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l01176"></a>01176         quan = (double)(((<span class="keywordtype">int</span>*)data)[j]);
<a name="l01177"></a>01177         <span class="keywordflow">break</span>;
<a name="l01178"></a>01178       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l01179"></a>01179         quan = (double)(((<span class="keywordtype">float</span>*)data)[j]);
<a name="l01180"></a>01180         <span class="keywordflow">break</span>;
<a name="l01181"></a>01181       <span class="keywordflow">default</span>:
<a name="l01182"></a>01182         printf(<span class="stringliteral">"** Developer Alert! Should never reach this point!**\n"</span>);
<a name="l01183"></a>01183         fflush(NULL);
<a name="l01184"></a>01184         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Invalid id type"</span>);
<a name="l01185"></a>01185         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01186"></a>01186         <span class="keywordflow">break</span>;
<a name="l01187"></a>01187       }
<a name="l01188"></a>01188       <span class="keywordflow">if</span> (quan &lt; mindata[j]){
<a name="l01189"></a>01189         mindata[j] = quan;
<a name="l01190"></a>01190         minindexdata[j] = i;
<a name="l01191"></a>01191       }
<a name="l01192"></a>01192       <span class="keywordflow">if</span> (quan &gt; maxdata[j]){
<a name="l01193"></a>01193         maxdata[j] = quan;
<a name="l01194"></a>01194         maxindexdata[j] = i;
<a name="l01195"></a>01195       }
<a name="l01196"></a>01196     }
<a name="l01197"></a>01197   }
<a name="l01198"></a>01198 
<a name="l01199"></a>01199   rc = <a class="code" href="group__Variable.html#g6808d2015766d9b530b93375f42296a3" title="Get the parent mesh of the variable.">fc_getMeshFromVariable</a>(seqvar[0],&amp;mesh);
<a name="l01200"></a>01200   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01201"></a>01201     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(rc));
<a name="l01202"></a>01202     free(mindata);
<a name="l01203"></a>01203     free(maxdata);
<a name="l01204"></a>01204     free(minindexdata);
<a name="l01205"></a>01205     free(maxindexdata);
<a name="l01206"></a>01206     <span class="keywordflow">return</span> rc;
<a name="l01207"></a>01207   }
<a name="l01208"></a>01208 
<a name="l01209"></a>01209 
<a name="l01210"></a>01210   varname = varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>;
<a name="l01211"></a>01211   name = malloc((strlen(varname)+20)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01212"></a>01212   <span class="keywordflow">if</span> (name == NULL){
<a name="l01213"></a>01213     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01214"></a>01214     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01215"></a>01215   }
<a name="l01216"></a>01216   <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++){
<a name="l01217"></a>01217     <span class="keywordflow">switch</span> (i){
<a name="l01218"></a>01218     <span class="keywordflow">case</span> MMIN:
<a name="l01219"></a>01219       sprintf(name, <span class="stringliteral">"%s_SeriesMin"</span>, varname);
<a name="l01220"></a>01220       mdata = mindata;
<a name="l01221"></a>01221       mvar = minvar;
<a name="l01222"></a>01222       mdt = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>;
<a name="l01223"></a>01223       <span class="keywordflow">break</span>;
<a name="l01224"></a>01224     <span class="keywordflow">case</span> MMAX:
<a name="l01225"></a>01225       sprintf(name, <span class="stringliteral">"%s_SeriesMax"</span>, varname);
<a name="l01226"></a>01226       mdata = maxdata;
<a name="l01227"></a>01227       mvar = maxvar;
<a name="l01228"></a>01228       mdt = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>;
<a name="l01229"></a>01229       <span class="keywordflow">break</span>;
<a name="l01230"></a>01230     <span class="keywordflow">case</span> MMINI:
<a name="l01231"></a>01231       sprintf(name, <span class="stringliteral">"%s_SeriesMinIndex"</span>, varname);
<a name="l01232"></a>01232       mdata = minindexdata;
<a name="l01233"></a>01233       mvar = minindexvar;
<a name="l01234"></a>01234       mdt = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>;
<a name="l01235"></a>01235       <span class="keywordflow">break</span>;
<a name="l01236"></a>01236     <span class="keywordflow">case</span> MMAXI:
<a name="l01237"></a>01237       sprintf(name, <span class="stringliteral">"%s_SeriesMaxIndex"</span>, varname);
<a name="l01238"></a>01238       mdata = maxindexdata;
<a name="l01239"></a>01239       mvar = maxindexvar;
<a name="l01240"></a>01240       mdt = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>;
<a name="l01241"></a>01241       <span class="keywordflow">break</span>;
<a name="l01242"></a>01242     <span class="keywordflow">default</span>:
<a name="l01243"></a>01243       printf(<span class="stringliteral">"** Developer Alert! Should never reach this point!**\n"</span>);
<a name="l01244"></a>01244       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Invalid id type"</span>);
<a name="l01245"></a>01245       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01246"></a>01246       <span class="keywordflow">break</span>;
<a name="l01247"></a>01247     }
<a name="l01248"></a>01248     rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(mesh,name,mvar);
<a name="l01249"></a>01249     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01250"></a>01250       free(name);
<a name="l01251"></a>01251       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*minvar);
<a name="l01252"></a>01252       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*maxvar);
<a name="l01253"></a>01253       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*minindexvar);
<a name="l01254"></a>01254       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*maxindexvar);
<a name="l01255"></a>01255       <span class="keywordflow">if</span> (mindata) free(mindata);
<a name="l01256"></a>01256       <span class="keywordflow">if</span> (maxdata) free(maxdata);
<a name="l01257"></a>01257       <span class="keywordflow">if</span> (minindexdata) free(minindexdata);
<a name="l01258"></a>01258       <span class="keywordflow">if</span> (maxindexdata) free(maxindexdata);
<a name="l01259"></a>01259       <span class="keywordflow">return</span> rc;
<a name="l01260"></a>01260     }
<a name="l01261"></a>01261 
<a name="l01262"></a>01262     rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(*mvar,numDataPoint, numComponent,
<a name="l01263"></a>01263                              assoc,mathtype,mdt,mdata);
<a name="l01264"></a>01264     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01265"></a>01265       free(name);
<a name="l01266"></a>01266       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*minvar);
<a name="l01267"></a>01267       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*maxvar);
<a name="l01268"></a>01268       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*minindexvar);
<a name="l01269"></a>01269       <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*maxindexvar);
<a name="l01270"></a>01270       <span class="keywordflow">if</span> (mindata) free(mindata);
<a name="l01271"></a>01271       <span class="keywordflow">if</span> (maxdata) free(maxdata);
<a name="l01272"></a>01272       <span class="keywordflow">if</span> (minindexdata) free(minindexdata);
<a name="l01273"></a>01273       <span class="keywordflow">if</span> (maxindexdata) free(maxindexdata);
<a name="l01274"></a>01274       <span class="keywordflow">return</span> rc;
<a name="l01275"></a>01275     }
<a name="l01276"></a>01276   }
<a name="l01277"></a>01277 
<a name="l01278"></a>01278   free(name);
<a name="l01279"></a>01279 
<a name="l01280"></a>01280   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01281"></a>01281 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gaa272ae4e4388ae2291cf0aaf3e378ea"></a><!-- doxytag: member="statistics.c::fc_getSeqVariableSeriesSum" ref="gaa272ae4e4388ae2291cf0aaf3e378ea" args="(int numStep, FC_Variable *seqvar, FC_Variable *sumvar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSeqVariableSeriesSum           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seqvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>sumvar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute sum of all data values of a sequence variable across its sequence (series) on a per data point, per component basis. 
<p>
<b>Description:</b> <p>
Returns the sum of a sequence variable field. This routine treats each data point and each component of the sequence variable separately. Thus, the sum is over the sequence quantity (e.g., time) rather than over the data points as it is in the fc_getVariableXXX functions.<p>
NOTE:<ul>
<li>Output is an <a class="el" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> with each sum at the corresponding data array location, rather than raw data - unlike the fc_getVariableSum function. The output variable name is the name of the original subset, postpended with "_SeriesSum"</li><li>Return type of variable data is FC_DT_DOUBLE as in fc_getVariableSum, rather than native type.</li></ul>
<p>
<b>Modifications:</b> <ul>
<li>1/18/05 ACG Created.</li><li>2/3/05 ACG changed name to have "Time" in title. While the sequence is not necessarily a time sequence, this makes it clear that the function is over the sequence and not over the data points, as in the fc_getVariableXXX functions in this module.</li><li>2/3/05 ACG changed output type to <a class="el" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> at WSK request.</li><li>2/9/05 ACG removed output name option to be consistent with other sequence variable functions in the module</li><li>6/2/05 ACG changed title from "TimeSum" to "SeriesSum" </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - numStep in sequenceVariable </td></tr>
<tr><td valign="top"><em>seqvar</em>&nbsp;</td><td>
input - seq variable handle </td></tr>
<tr><td valign="top"><em>sumvar</em>&nbsp;</td><td>
output - sum data value car </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l01584">1584</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00286">fc_createVariable()</a>, <a class="el" href="variable_8c-source.html#l04980">fc_deleteVariable()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l05392">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05178">fc_isSeqVariableValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00779">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00604">fc_setVariableDataPtr()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="seriesAnalyzer_8c-source.html#l00102">numComponent</a>.</p>

<p>Referenced by <a class="el" href="series_8c-source.html#l02844">fc_euclideanDistanceBetweenCurves()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01588"></a>01588   {
<a name="l01589"></a>01589   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01590"></a>01590   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01591"></a>01591   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l01592"></a>01592   <span class="keywordtype">int</span> numDataPoint;
<a name="l01593"></a>01593   <span class="keywordtype">int</span> <a class="code" href="seriesAnalyzer_8c.html#9ba814c62f21460639802c7771e86fa6">numComponent</a>;
<a name="l01594"></a>01594   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l01595"></a>01595   <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype;
<a name="l01596"></a>01596   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l01597"></a>01597   <span class="keywordtype">int</span> sum_dim;
<a name="l01598"></a>01598   <span class="keywordtype">int</span> i,j;
<a name="l01599"></a>01599   <span class="keywordtype">void</span> *data;
<a name="l01600"></a>01600   <span class="keywordtype">double</span>* sum;
<a name="l01601"></a>01601   <span class="keywordtype">char</span> *varname, *returnname;
<a name="l01602"></a>01602 
<a name="l01603"></a>01603 
<a name="l01604"></a>01604   <span class="keywordflow">if</span> (sumvar)
<a name="l01605"></a>01605     *sumvar = <a class="code" href="group__Handles.html#g82162b8ad3f5476855507c3c6450db09" title="Null (default) variable handle.">FC_NULL_VARIABLE</a>;
<a name="l01606"></a>01606 
<a name="l01607"></a>01607   <span class="comment">//check input</span>
<a name="l01608"></a>01608   <span class="keywordflow">if</span> (sumvar == NULL ||
<a name="l01609"></a>01609       (!<a class="code" href="group__Variable.html#gac07e226e274bee4de4b21db8e03ae0e" title="Check that the handle refers to a valid variable.">fc_isSeqVariableValid</a>(numStep,seqvar))){
<a name="l01610"></a>01610     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01611"></a>01611     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01612"></a>01612   }
<a name="l01613"></a>01613 
<a name="l01614"></a>01614 
<a name="l01615"></a>01615   varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqvar[0]);
<a name="l01616"></a>01616   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting sum for seq variable '%s'"</span>,
<a name="l01617"></a>01617                       varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01618"></a>01618 
<a name="l01619"></a>01619 
<a name="l01620"></a>01620   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(seqvar[0], &amp;numDataPoint, &amp;numComponent, &amp;assoc,
<a name="l01621"></a>01621                            &amp;mathtype, &amp;datatype);
<a name="l01622"></a>01622   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01623"></a>01623     <span class="keywordflow">return</span> rc;
<a name="l01624"></a>01624   }
<a name="l01625"></a>01625 
<a name="l01626"></a>01626   <span class="keywordflow">if</span> (!(datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> ||
<a name="l01627"></a>01627         datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> ||
<a name="l01628"></a>01628         datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> )
<a name="l01629"></a>01629       ){
<a name="l01630"></a>01630     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01631"></a>01631   } 
<a name="l01632"></a>01632 
<a name="l01633"></a>01633   sum_dim = numDataPoint*numComponent;
<a name="l01634"></a>01634   sum = (<span class="keywordtype">double</span>*)malloc(sum_dim*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01635"></a>01635   <span class="keywordflow">if</span> (sum == NULL) {
<a name="l01636"></a>01636     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01637"></a>01637     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01638"></a>01638   }
<a name="l01639"></a>01639 
<a name="l01640"></a>01640   <span class="keywordflow">for</span> (i =0; i &lt; sum_dim; i++){
<a name="l01641"></a>01641     sum[i] = 0;
<a name="l01642"></a>01642   }
<a name="l01643"></a>01643 
<a name="l01644"></a>01644   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++){
<a name="l01645"></a>01645     rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(seqvar[i], &amp;data);
<a name="l01646"></a>01646     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01647"></a>01647       data = NULL;
<a name="l01648"></a>01648       free(sum);
<a name="l01649"></a>01649       <span class="keywordflow">return</span> rc;
<a name="l01650"></a>01650     }
<a name="l01651"></a>01651     <span class="keywordflow">for</span> (j = 0; j &lt; sum_dim; j++){
<a name="l01652"></a>01652       <span class="keywordflow">switch</span>(datatype){
<a name="l01653"></a>01653       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:
<a name="l01654"></a>01654         sum[j]+= ((<span class="keywordtype">double</span>*)data)[j];
<a name="l01655"></a>01655         <span class="keywordflow">break</span>;
<a name="l01656"></a>01656       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l01657"></a>01657         sum[j]+= (double)(((<span class="keywordtype">int</span>*)data)[j]);
<a name="l01658"></a>01658         <span class="keywordflow">break</span>;
<a name="l01659"></a>01659       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l01660"></a>01660         sum[j]+= (double)(((<span class="keywordtype">float</span>*)data)[j]);
<a name="l01661"></a>01661         <span class="keywordflow">break</span>;
<a name="l01662"></a>01662       <span class="keywordflow">default</span>:
<a name="l01663"></a>01663         printf(<span class="stringliteral">"** Developer Alert! Should never reach this point!**\n"</span>);
<a name="l01664"></a>01664         fflush(NULL);
<a name="l01665"></a>01665         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Invalid data type"</span>);
<a name="l01666"></a>01666         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01667"></a>01667         <span class="keywordflow">break</span>;
<a name="l01668"></a>01668       }
<a name="l01669"></a>01669     }
<a name="l01670"></a>01670   }
<a name="l01671"></a>01671 
<a name="l01672"></a>01672   rc = <a class="code" href="group__Variable.html#g6808d2015766d9b530b93375f42296a3" title="Get the parent mesh of the variable.">fc_getMeshFromVariable</a>(seqvar[0],&amp;mesh);
<a name="l01673"></a>01673   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01674"></a>01674     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(rc));
<a name="l01675"></a>01675     free(sum);
<a name="l01676"></a>01676     <span class="keywordflow">return</span> rc;
<a name="l01677"></a>01677   }
<a name="l01678"></a>01678 
<a name="l01679"></a>01679 
<a name="l01680"></a>01680   varname = varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>;
<a name="l01681"></a>01681   returnname = malloc((strlen(varname)+20)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01682"></a>01682   <span class="keywordflow">if</span> (returnname == NULL) {
<a name="l01683"></a>01683     free(sum);
<a name="l01684"></a>01684     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01685"></a>01685     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01686"></a>01686   }
<a name="l01687"></a>01687   sprintf(returnname, <span class="stringliteral">"%s_SeriesSum"</span>, varname);
<a name="l01688"></a>01688 
<a name="l01689"></a>01689   rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(mesh,returnname,sumvar);
<a name="l01690"></a>01690   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01691"></a>01691     free(sum);
<a name="l01692"></a>01692     free(returnname);
<a name="l01693"></a>01693     <span class="keywordflow">return</span> rc;
<a name="l01694"></a>01694   }
<a name="l01695"></a>01695 
<a name="l01696"></a>01696   free(returnname);
<a name="l01697"></a>01697   rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>(*sumvar,numDataPoint, numComponent,
<a name="l01698"></a>01698                              assoc,mathtype,<a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>,sum);
<a name="l01699"></a>01699   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01700"></a>01700     <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(*sumvar);
<a name="l01701"></a>01701     <span class="keywordflow">return</span> rc;
<a name="l01702"></a>01702   }
<a name="l01703"></a>01703 
<a name="l01704"></a>01704   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01705"></a>01705 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g389588bf87b0f50ae0572eb1f7ff4167"></a><!-- doxytag: member="statistics.c::fc_getVariableMeanSdev" ref="g389588bf87b0f50ae0572eb1f7ff4167" args="(FC_Variable var, double *mean, double *sdev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getVariableMeanSdev           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>sdev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute mean and standard deviation of a variable. 
<p>
<b>Description:</b> <p>
Returns the mean and standard deviation of the values of a variable field. This routine only operates on fields with one component and and an error value is returned for vector and tensor fields.<p>
In the case of variable with a single data point, the standard dev is technically undefined, but this routine will return 0.<p>
<b>Modifications:</b> <ul>
<li>Andre Smirnov Created.</li><li>Nancy Collins revamped.</li><li>Wendy Koegler Added checking datatype. Also changed initial moving_max</li><li>APR-08-2003 Wendy Koegler. Added magnitude calculation for vectors. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable handle </td></tr>
<tr><td valign="top"><em>mean</em>&nbsp;</td><td>
output - average </td></tr>
<tr><td valign="top"><em>sdev</em>&nbsp;</td><td>
output - standard deviation (optional) </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00212">212</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="edgeStats_8c-source.html#l00063">get_and_print_lengths()</a>, and <a class="el" href="varStats_8c-source.html#l00061">get_and_print_stats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00216"></a>00216   {
<a name="l00217"></a>00217   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00218"></a>00218   <span class="keywordtype">int</span> i, numDataPoint, dim;
<a name="l00219"></a>00219   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00220"></a>00220   <span class="keywordtype">void</span> *datap;
<a name="l00221"></a>00221   <span class="keywordtype">double</span> temp, value;
<a name="l00222"></a>00222   <span class="keywordtype">double</span> moving_sum = 0.0;
<a name="l00223"></a>00223   <span class="keywordtype">double</span> moving_sumsq = 0.0;
<a name="l00224"></a>00224   
<a name="l00225"></a>00225   <span class="comment">// default return</span>
<a name="l00226"></a>00226   <span class="keywordflow">if</span> (mean)
<a name="l00227"></a>00227     *mean = -1;
<a name="l00228"></a>00228   <span class="keywordflow">if</span> (sdev)
<a name="l00229"></a>00229     *sdev = -1;
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   <span class="comment">// check input</span>
<a name="l00232"></a>00232   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(var) || !mean) {
<a name="l00233"></a>00233       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00234"></a>00234       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="comment">// log message</span>
<a name="l00238"></a>00238   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing mean and standard deviation."</span>);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240   <span class="comment">// get a count &amp; pointer to the data array</span>
<a name="l00241"></a>00241   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(var, &amp;numDataPoint, &amp;dim, NULL, NULL, &amp;datatype);
<a name="l00242"></a>00242   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00243"></a>00243     <span class="keywordflow">return</span> rc;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   <span class="comment">// can only do 1 component fields</span>
<a name="l00246"></a>00246   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00247"></a>00247       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00248"></a>00248       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00249"></a>00249     }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   <span class="comment">// get data</span>
<a name="l00252"></a>00252   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(var, &amp;datap);
<a name="l00253"></a>00253   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00254"></a>00254     <span class="keywordflow">return</span> rc;
<a name="l00255"></a>00255   
<a name="l00256"></a>00256   <span class="comment">// Perform the calculation</span>
<a name="l00257"></a>00257   <span class="keywordflow">for</span> (i = 0; i &lt; numDataPoint; i++) {
<a name="l00258"></a>00258     <span class="keywordflow">switch</span>(datatype) {
<a name="l00259"></a>00259     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:     value = ((<span class="keywordtype">int</span>*)datap)[i];     <span class="keywordflow">break</span>;
<a name="l00260"></a>00260     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[i];   <span class="keywordflow">break</span>;
<a name="l00261"></a>00261     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[i];  <span class="keywordflow">break</span>;
<a name="l00262"></a>00262     <span class="keywordflow">default</span>: 
<a name="l00263"></a>00263         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00264"></a>00264         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     moving_sum += value;
<a name="l00267"></a>00267     moving_sumsq += value*value;
<a name="l00268"></a>00268   }
<a name="l00269"></a>00269   
<a name="l00270"></a>00270   <span class="comment">// if user asked for mean, compute it here</span>
<a name="l00271"></a>00271   <span class="keywordflow">if</span> (mean != NULL) 
<a name="l00272"></a>00272     *mean = moving_sum / numDataPoint;
<a name="l00273"></a>00273   
<a name="l00274"></a>00274   <span class="comment">// if user asked for std dev, compute it here</span>
<a name="l00275"></a>00275   <span class="comment">// This is probably the "best" way to computer the</span>
<a name="l00276"></a>00276   <span class="comment">// stdev as it minimizes the number of '-' operations that might</span>
<a name="l00277"></a>00277   <span class="comment">// cause roundoff error.</span>
<a name="l00278"></a>00278   <span class="keywordflow">if</span> (sdev != NULL) {
<a name="l00279"></a>00279     <span class="keywordflow">if</span> (numDataPoint &gt; 1) { 
<a name="l00280"></a>00280       temp = (moving_sumsq - (moving_sum * moving_sum / numDataPoint)) 
<a name="l00281"></a>00281         / (numDataPoint - 1);
<a name="l00282"></a>00282       *sdev = sqrt(fabs(temp)); <span class="comment">// might be negative if roundoff error</span>
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284     <span class="keywordflow">else</span>
<a name="l00285"></a>00285       *sdev = 0;  <span class="comment">//FIX? report NAN?</span>
<a name="l00286"></a>00286   }
<a name="l00287"></a>00287   
<a name="l00288"></a>00288   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00289"></a>00289 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8e828048c88585a6de200e4f05d61ee4"></a><!-- doxytag: member="statistics.c::fc_getVariableMinMax" ref="g8e828048c88585a6de200e4f05d61ee4" args="(FC_Variable var, double *min, int *min_index, double *max, int *max_index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getVariableMinMax           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>min_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>max_index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find min &amp; max data values of a variable. 
<p>
<b>Description:</b> <p>
Returns the min and max values of a variable field. Also returns the id of the entity which had the min and max values (the first one encountered if more than one node or element have the same value). This routine only operates on fields with one component and error value is returned for vector and tensor fields.<p>
<b>Modifications:</b> <ul>
<li>Andre Smirnov Created.</li><li>Nancy Collins revamped.</li><li>Wendy Koegler Added checking datatype. Also changed initial moving_max from MINFLOAT to -MAXFLOAT.</li><li>APR-08-2003 Wendy Koegler. Added magnitude calculation for vectors.</li><li>2003-JUL-08 W Koegler Removed dependence on MINFLOAT &amp; MAXFLOAT</li><li>5/3/04 WSK, changed to only work on one component fields. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable handle </td></tr>
<tr><td valign="top"><em>min</em>&nbsp;</td><td>
output - min data value </td></tr>
<tr><td valign="top"><em>min_index</em>&nbsp;</td><td>
output - index at which first min value was found </td></tr>
<tr><td valign="top"><em>max</em>&nbsp;</td><td>
output - max data value </td></tr>
<tr><td valign="top"><em>max_index</em>&nbsp;</td><td>
output - index as which first max value was found </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00097">97</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="edgeStats_8c-source.html#l00063">get_and_print_lengths()</a>, <a class="el" href="varStats_8c-source.html#l00061">get_and_print_stats()</a>, <a class="el" href="gaplines_8c-source.html#l00176">getMeshMaxEdgeLength()</a>, <a class="el" href="maxStress_8c-source.html#l00074">main()</a>, and <a class="el" href="subsetter_8c-source.html#l00344">processOneVar()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00103"></a>00103   {
<a name="l00104"></a>00104   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00105"></a>00105   <span class="keywordtype">int</span> i;
<a name="l00106"></a>00106   <span class="keywordtype">int</span> numDataPoint, dim;
<a name="l00107"></a>00107   <span class="keywordtype">void</span> *datap;
<a name="l00108"></a>00108   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00109"></a>00109   <span class="keywordtype">double</span> value, moving_min, moving_max;
<a name="l00110"></a>00110   <span class="keywordtype">int</span> mini, maxi;
<a name="l00111"></a>00111   
<a name="l00112"></a>00112   <span class="comment">// default output</span>
<a name="l00113"></a>00113   <span class="keywordflow">if</span> (min)
<a name="l00114"></a>00114     *min = -1;
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (min_index)
<a name="l00116"></a>00116     *min_index = -1;
<a name="l00117"></a>00117   <span class="keywordflow">if</span> (max)
<a name="l00118"></a>00118     *max = -1;
<a name="l00119"></a>00119   <span class="keywordflow">if</span> (max_index)
<a name="l00120"></a>00120     *max_index = -1;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   <span class="comment">// check input - they don't have to take </span>
<a name="l00123"></a>00123   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(var) || (!min &amp;&amp; !min_index &amp;&amp; !max &amp;&amp; !max_index)) {
<a name="l00124"></a>00124       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00125"></a>00125       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <span class="comment">// log message</span>
<a name="l00129"></a>00129   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Finding min and max values."</span>);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <span class="comment">// get a count &amp; pointer to the data array. </span>
<a name="l00132"></a>00132   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(var, &amp;numDataPoint, &amp;dim, NULL, NULL, &amp;datatype);
<a name="l00133"></a>00133   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00134"></a>00134     <span class="keywordflow">return</span> rc;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="comment">// can only do 1 component fields</span>
<a name="l00137"></a>00137   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00138"></a>00138       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00139"></a>00139       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141   
<a name="l00142"></a>00142   <span class="comment">// get data</span>
<a name="l00143"></a>00143   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(var, &amp;datap);
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00145"></a>00145     <span class="keywordflow">return</span> rc;
<a name="l00146"></a>00146   
<a name="l00147"></a>00147   <span class="comment">// initialize with first point</span>
<a name="l00148"></a>00148   <span class="keywordflow">switch</span> (datatype) {
<a name="l00149"></a>00149   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> :    value = ((<span class="keywordtype">int</span>*)datap)[0];     <span class="keywordflow">break</span>;
<a name="l00150"></a>00150   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[0];   <span class="keywordflow">break</span>;
<a name="l00151"></a>00151   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[0];  <span class="keywordflow">break</span>;
<a name="l00152"></a>00152   <span class="keywordflow">default</span>: 
<a name="l00153"></a>00153       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00154"></a>00154       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156   moving_min = moving_max = value;
<a name="l00157"></a>00157   mini = maxi = 0;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159   <span class="comment">// look at the remaining points</span>
<a name="l00160"></a>00160   <span class="keywordflow">for</span> (i = 1; i &lt; numDataPoint; i++) {
<a name="l00161"></a>00161     <span class="keywordflow">switch</span>(datatype) {
<a name="l00162"></a>00162     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> :    value = ((<span class="keywordtype">int</span>*)datap)[i];     <span class="keywordflow">break</span>;
<a name="l00163"></a>00163     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[i];   <span class="keywordflow">break</span>;
<a name="l00164"></a>00164     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[i];  <span class="keywordflow">break</span>;
<a name="l00165"></a>00165     <span class="keywordflow">default</span>: ;<span class="comment">// nothing</span>
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167     <span class="keywordflow">if</span> (value &lt; moving_min) {
<a name="l00168"></a>00168       moving_min = value;
<a name="l00169"></a>00169       mini = i;
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value &gt; moving_max) {
<a name="l00172"></a>00172       moving_max = value;
<a name="l00173"></a>00173       maxi = i;
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175   }
<a name="l00176"></a>00176   
<a name="l00177"></a>00177   <span class="comment">// only set the ones the user requested</span>
<a name="l00178"></a>00178   <span class="comment">// ignore any which are null</span>
<a name="l00179"></a>00179   
<a name="l00180"></a>00180   <span class="keywordflow">if</span> (min != NULL)
<a name="l00181"></a>00181     *min = moving_min;
<a name="l00182"></a>00182   <span class="keywordflow">if</span> (min_index != NULL)
<a name="l00183"></a>00183     *min_index = mini;
<a name="l00184"></a>00184   <span class="keywordflow">if</span> (max != NULL)
<a name="l00185"></a>00185     *max = moving_max;
<a name="l00186"></a>00186   <span class="keywordflow">if</span> (max_index != NULL)
<a name="l00187"></a>00187     *max_index = maxi;
<a name="l00188"></a>00188   
<a name="l00189"></a>00189   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00190"></a>00190 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfc12edf46aed1d007679cdc29521cf9b"></a><!-- doxytag: member="statistics.c::fc_getVariableSubsetMeanSdev" ref="gfc12edf46aed1d007679cdc29521cf9b" args="(FC_Variable var, FC_Subset subset, double *mean, double *sdev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getVariableSubsetMeanSdev           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>sdev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute mean and standard deviation of a subset of a variable. 
<p>
<b>Description:</b> <p>
Returns the mean and standard deviation of the values of a subset of a variable field. This routine only operates on fields with one component and and an error value is returned for vector and tensor fields.<p>
In the case of subset with a single data point, the standard dev is technically undefined, but this routine will return 0.<p>
The variable and the subset must be defined on the same type of entity (e.g. both on vertices or both on elements). They don't necessarily have to be on the same mesh as long as the total number of entities is the same.<p>
The function returns an error if the subset is empty.<p>
<b>Modifications:</b> <ul>
<li>Andre Smirnov Created.</li><li>Nancy Collins revamped.</li><li>Wendy Koegler Added checking datatype. Also changed initial moving_max</li><li>APR-08-2003 Wendy Koegler. Added magnitude calculation for vectors. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable handle </td></tr>
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset handle </td></tr>
<tr><td valign="top"><em>mean</em>&nbsp;</td><td>
output - average </td></tr>
<tr><td valign="top"><em>sdev</em>&nbsp;</td><td>
output - standard deviation (optional) </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00542">542</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="ex3__createCharactrztn_8c-source.html#l00219">main()</a>, and <a class="el" href="gaplines_8c-source.html#l00377">printStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00547"></a>00547   {
<a name="l00548"></a>00548   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00549"></a>00549   <span class="keywordtype">int</span> i, numDataPoint, dim, maxNumMember, numMember, *memberIDs;
<a name="l00550"></a>00550   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc_var, assoc_subset;
<a name="l00551"></a>00551   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00552"></a>00552   <span class="keywordtype">void</span> *datap;
<a name="l00553"></a>00553   <span class="keywordtype">double</span> temp, value;
<a name="l00554"></a>00554   <span class="keywordtype">double</span> moving_sum = 0.0;
<a name="l00555"></a>00555   <span class="keywordtype">double</span> moving_sumsq = 0.0;
<a name="l00556"></a>00556   
<a name="l00557"></a>00557   <span class="comment">// default return</span>
<a name="l00558"></a>00558   <span class="keywordflow">if</span> (mean)
<a name="l00559"></a>00559     *mean = -1;
<a name="l00560"></a>00560   <span class="keywordflow">if</span> (sdev)
<a name="l00561"></a>00561     *sdev = -1;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563   <span class="comment">// check input</span>
<a name="l00564"></a>00564   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(var) || !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(subset) || !mean) {
<a name="l00565"></a>00565     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00566"></a>00566     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00567"></a>00567   }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569   <span class="comment">// log message</span>
<a name="l00570"></a>00570   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing mean and standard deviation of a subset "</span>
<a name="l00571"></a>00571                       <span class="stringliteral">" of a variable"</span>);
<a name="l00572"></a>00572 
<a name="l00573"></a>00573   <span class="comment">// get info from var &amp; subset</span>
<a name="l00574"></a>00574   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(var, &amp;numDataPoint, &amp;dim, &amp;assoc_var, NULL, 
<a name="l00575"></a>00575                           &amp;datatype);
<a name="l00576"></a>00576   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00577"></a>00577     <span class="keywordflow">return</span> rc;
<a name="l00578"></a>00578   rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subset, &amp;numMember, &amp;maxNumMember, &amp;assoc_subset);
<a name="l00579"></a>00579   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00580"></a>00580     <span class="keywordflow">return</span> rc;
<a name="l00581"></a>00581 
<a name="l00582"></a>00582   <span class="comment">// A little more checking</span>
<a name="l00583"></a>00583   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00584"></a>00584     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variable can only have 1 component not %d"</span>, dim);
<a name="l00585"></a>00585     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00586"></a>00586   }
<a name="l00587"></a>00587   <span class="keywordflow">if</span> (numDataPoint &lt; 1)  {
<a name="l00588"></a>00588     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variable has no data"</span>);
<a name="l00589"></a>00589     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591   <span class="keywordflow">if</span> (assoc_var != assoc_subset || numDataPoint != maxNumMember) {
<a name="l00592"></a>00592     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Mismatch of entities"</span>);
<a name="l00593"></a>00593     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00594"></a>00594   }
<a name="l00595"></a>00595   <span class="keywordflow">if</span> (numMember &lt; 1) {
<a name="l00596"></a>00596     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset cannot be empty"</span>);
<a name="l00597"></a>00597     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599   
<a name="l00600"></a>00600   <span class="comment">// get variable data &amp;&amp; subset members</span>
<a name="l00601"></a>00601   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(var, &amp;datap);
<a name="l00602"></a>00602   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00603"></a>00603     <span class="keywordflow">return</span> rc;
<a name="l00604"></a>00604   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l00605"></a>00605   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00606"></a>00606     <span class="keywordflow">return</span> rc;
<a name="l00607"></a>00607     
<a name="l00608"></a>00608   <span class="comment">// Perform the calculation</span>
<a name="l00609"></a>00609   <span class="keywordflow">for</span> (i = 0; i &lt; numMember; i++) {
<a name="l00610"></a>00610     <span class="keywordflow">switch</span>(datatype) {
<a name="l00611"></a>00611     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:     value = ((<span class="keywordtype">int</span>*)datap)[memberIDs[i]];     <span class="keywordflow">break</span>;
<a name="l00612"></a>00612     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[memberIDs[i]];   <span class="keywordflow">break</span>;
<a name="l00613"></a>00613     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[memberIDs[i]];  <span class="keywordflow">break</span>;
<a name="l00614"></a>00614     <span class="keywordflow">default</span>: 
<a name="l00615"></a>00615       free(memberIDs);
<a name="l00616"></a>00616       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00617"></a>00617       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619     moving_sum += value;
<a name="l00620"></a>00620     moving_sumsq += value*value;
<a name="l00621"></a>00621   }
<a name="l00622"></a>00622   free(memberIDs);
<a name="l00623"></a>00623   
<a name="l00624"></a>00624   <span class="comment">// if user asked for mean, compute it here</span>
<a name="l00625"></a>00625   <span class="keywordflow">if</span> (mean != NULL) 
<a name="l00626"></a>00626     *mean = moving_sum / numMember;
<a name="l00627"></a>00627   
<a name="l00628"></a>00628   <span class="comment">// if user asked for std dev, compute it here</span>
<a name="l00629"></a>00629   <span class="comment">// This is probably the "best" way to computer the</span>
<a name="l00630"></a>00630   <span class="comment">// stdev as it minimizes the number of '-' operations that might</span>
<a name="l00631"></a>00631   <span class="comment">// cause roundoff error.</span>
<a name="l00632"></a>00632   <span class="keywordflow">if</span> (sdev != NULL) {
<a name="l00633"></a>00633     <span class="keywordflow">if</span> (numMember &gt; 1) { 
<a name="l00634"></a>00634       temp = (moving_sumsq - (moving_sum * moving_sum / numMember)) 
<a name="l00635"></a>00635         / (numMember - 1);
<a name="l00636"></a>00636       *sdev = sqrt(fabs(temp)); <span class="comment">// might be negative if roundoff error</span>
<a name="l00637"></a>00637     }
<a name="l00638"></a>00638     <span class="keywordflow">else</span>
<a name="l00639"></a>00639       *sdev = 0;  <span class="comment">//FIX? report NAN?</span>
<a name="l00640"></a>00640   }
<a name="l00641"></a>00641   
<a name="l00642"></a>00642   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00643"></a>00643 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g7b44d38b8800d8c619af4b6b52d58759"></a><!-- doxytag: member="statistics.c::fc_getVariableSubsetMinMax" ref="g7b44d38b8800d8c619af4b6b52d58759" args="(FC_Variable var, FC_Subset subset, double *min, int *min_index, double *max, int *max_index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getVariableSubsetMinMax           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>min_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>max_index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find min &amp; max data values in a subset of a variable. 
<p>
<b>Description:</b> <p>
Returns the min and max values of the subset of a variable field. Also returns the id of the entity which had the min and max values (the first one encountered if more than one node or element have the same value). This routine only operates on fields with one component and error value is returned for vector and tensor fields.<p>
The variable and the subset must be defined on the same type of entity (e.g. both on vertices or both on elements). They don't necessarily have to be on the same mesh as long as the total number of entities is the same.<p>
The function returns an error if the subset is empty.<p>
<b>Modifications:</b> <ul>
<li>Andre Smirnov Created.</li><li>Nancy Collins revamped.</li><li>Wendy Koegler Added checking datatype. Also changed initial moving_max from MINFLOAT to -MAXFLOAT.</li><li>APR-08-2003 Wendy Koegler. Added magnitude calculation for vectors.</li><li>2003-JUL-08 W Koegler Removed dependence on MINFLOAT &amp; MAXFLOAT</li><li>5/3/04 WSK, changed to only work on one component fields. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable handle </td></tr>
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset handle </td></tr>
<tr><td valign="top"><em>min</em>&nbsp;</td><td>
output - min data value (optional) </td></tr>
<tr><td valign="top"><em>min_index</em>&nbsp;</td><td>
output - index at which first min value was found (optional) </td></tr>
<tr><td valign="top"><em>max</em>&nbsp;</td><td>
output - max data value (optional) </td></tr>
<tr><td valign="top"><em>max_index</em>&nbsp;</td><td>
output - index as which first max value was found (optional) </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00394">394</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="ex1__intro_8c-source.html#l00069">main()</a>, and <a class="el" href="gaplines_8c-source.html#l00377">printStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00403"></a>00403   {
<a name="l00404"></a>00404   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00405"></a>00405   <span class="keywordtype">int</span> i;
<a name="l00406"></a>00406   <span class="keywordtype">int</span> numDataPoint, dim, maxNumMember, numMember, *memberIDs;
<a name="l00407"></a>00407   <span class="keywordtype">void</span> *datap;
<a name="l00408"></a>00408   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc_var, assoc_subset;
<a name="l00409"></a>00409   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00410"></a>00410   <span class="keywordtype">double</span> value, moving_min, moving_max;
<a name="l00411"></a>00411   <span class="keywordtype">int</span> mini, maxi;
<a name="l00412"></a>00412   
<a name="l00413"></a>00413   <span class="comment">// default output</span>
<a name="l00414"></a>00414   <span class="keywordflow">if</span> (min)
<a name="l00415"></a>00415     *min = -1;
<a name="l00416"></a>00416   <span class="keywordflow">if</span> (min_index)
<a name="l00417"></a>00417     *min_index = -1;
<a name="l00418"></a>00418   <span class="keywordflow">if</span> (max)
<a name="l00419"></a>00419     *max = -1;
<a name="l00420"></a>00420   <span class="keywordflow">if</span> (max_index)
<a name="l00421"></a>00421     *max_index = -1;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423   <span class="comment">// check input - they don't have to take all of the returned values</span>
<a name="l00424"></a>00424   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(var) || !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(subset) ||
<a name="l00425"></a>00425       (!min &amp;&amp; !min_index &amp;&amp; !max &amp;&amp; !max_index) ) {
<a name="l00426"></a>00426       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00427"></a>00427       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430   <span class="comment">// log message</span>
<a name="l00431"></a>00431   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing min and max of subset of a variable"</span>);
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="comment">// get info from var &amp; subset</span>
<a name="l00434"></a>00434   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(var, &amp;numDataPoint, &amp;dim, &amp;assoc_var, NULL, 
<a name="l00435"></a>00435                           &amp;datatype);
<a name="l00436"></a>00436   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00437"></a>00437     <span class="keywordflow">return</span> rc;
<a name="l00438"></a>00438   rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subset, &amp;numMember, &amp;maxNumMember, &amp;assoc_subset);
<a name="l00439"></a>00439   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00440"></a>00440     <span class="keywordflow">return</span> rc;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442   <span class="comment">// A little more checking</span>
<a name="l00443"></a>00443   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00444"></a>00444     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variable can only have 1 component not %d"</span>, dim);
<a name="l00445"></a>00445     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00446"></a>00446   }
<a name="l00447"></a>00447   <span class="keywordflow">if</span> (numDataPoint &lt; 1)  {
<a name="l00448"></a>00448     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variable has no data"</span>);
<a name="l00449"></a>00449     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00450"></a>00450   }
<a name="l00451"></a>00451   <span class="keywordflow">if</span> (assoc_var != assoc_subset || numDataPoint != maxNumMember) {
<a name="l00452"></a>00452     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Mismatch of entities"</span>);
<a name="l00453"></a>00453     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00454"></a>00454   }
<a name="l00455"></a>00455   <span class="keywordflow">if</span> (numMember &lt; 1) {
<a name="l00456"></a>00456     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset cannot be empty"</span>);
<a name="l00457"></a>00457     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00458"></a>00458   }
<a name="l00459"></a>00459   
<a name="l00460"></a>00460   <span class="comment">// get variable data &amp;&amp; subset members</span>
<a name="l00461"></a>00461   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(var, &amp;datap);
<a name="l00462"></a>00462   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00463"></a>00463     <span class="keywordflow">return</span> rc;
<a name="l00464"></a>00464   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l00465"></a>00465   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00466"></a>00466     <span class="keywordflow">return</span> rc;
<a name="l00467"></a>00467   
<a name="l00468"></a>00468   <span class="comment">// initialize with first point</span>
<a name="l00469"></a>00469   <span class="keywordflow">switch</span> (datatype) {
<a name="l00470"></a>00470   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> :    value = ((<span class="keywordtype">int</span>*)datap)[memberIDs[0]];     <span class="keywordflow">break</span>;
<a name="l00471"></a>00471   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[memberIDs[0]];   <span class="keywordflow">break</span>;
<a name="l00472"></a>00472   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[memberIDs[0]];  <span class="keywordflow">break</span>;
<a name="l00473"></a>00473   <span class="keywordflow">default</span>: 
<a name="l00474"></a>00474     free(memberIDs);
<a name="l00475"></a>00475     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00476"></a>00476     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00477"></a>00477   }
<a name="l00478"></a>00478   moving_min = moving_max = value;
<a name="l00479"></a>00479   mini = maxi = memberIDs[0];
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="comment">// look at the remaining points</span>
<a name="l00482"></a>00482   <span class="keywordflow">for</span> (i = 1; i &lt; numMember; i++) {
<a name="l00483"></a>00483     <span class="keywordflow">switch</span>(datatype) {
<a name="l00484"></a>00484     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> :    value = ((<span class="keywordtype">int</span>*)datap)[memberIDs[i]];     <span class="keywordflow">break</span>;
<a name="l00485"></a>00485     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   value = ((<span class="keywordtype">float</span>*)datap)[memberIDs[i]];   <span class="keywordflow">break</span>;
<a name="l00486"></a>00486     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  value = ((<span class="keywordtype">double</span>*)datap)[memberIDs[i]];  <span class="keywordflow">break</span>;
<a name="l00487"></a>00487     <span class="keywordflow">default</span>: ;<span class="comment">// nothing</span>
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489     <span class="keywordflow">if</span> (value &lt; moving_min) {
<a name="l00490"></a>00490       moving_min = value;
<a name="l00491"></a>00491       mini = memberIDs[i];
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value &gt; moving_max) {
<a name="l00494"></a>00494       moving_max = value;
<a name="l00495"></a>00495       maxi = memberIDs[i];
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497   }
<a name="l00498"></a>00498   free(memberIDs);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500   <span class="comment">// only set the ones the user requested</span>
<a name="l00501"></a>00501   <span class="comment">// ignore any which are null</span>
<a name="l00502"></a>00502   
<a name="l00503"></a>00503   <span class="keywordflow">if</span> (min != NULL)
<a name="l00504"></a>00504     *min = moving_min;
<a name="l00505"></a>00505   <span class="keywordflow">if</span> (min_index != NULL)
<a name="l00506"></a>00506     *min_index = mini;
<a name="l00507"></a>00507   <span class="keywordflow">if</span> (max != NULL)
<a name="l00508"></a>00508     *max = moving_max;
<a name="l00509"></a>00509   <span class="keywordflow">if</span> (max_index != NULL)
<a name="l00510"></a>00510     *max_index = maxi;
<a name="l00511"></a>00511   
<a name="l00512"></a>00512   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00513"></a>00513 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge7be077012a83bcf2ed8133cc8590576"></a><!-- doxytag: member="statistics.c::fc_getVariableSubsetSum" ref="ge7be077012a83bcf2ed8133cc8590576" args="(FC_Variable var, FC_Subset subset, double *sum_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getVariableSubsetSum           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>sum_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute sum of all data values of a subset of a variable. 
<p>
<b>Description:</b> <p>
This routine only operates on fields with one component and and an error value is returned for vector and tensor fields.<p>
The variable and the subset must be defined on the same type of entity (e.g. both on vertices or both on elements). They don't necessarily have to be on the same mesh as long as the total number of entities is the same.<p>
The function returns an error if the subset is empty.<p>
<b>Modifications:</b> <ul>
<li>02/19/04 WSK, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable handle </td></tr>
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset handle </td></tr>
<tr><td valign="top"><em>sum_p</em>&nbsp;</td><td>
output - sum of the data values </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00664">664</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="loadHistory_8c-source.html#l00064">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00668"></a>00668   {
<a name="l00669"></a>00669   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00670"></a>00670   <span class="keywordtype">int</span> i, numDataPoint, dim, maxNumMember, numMember, *memberIDs;
<a name="l00671"></a>00671   <span class="keywordtype">void</span> *datap;
<a name="l00672"></a>00672   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc_var, assoc_subset;
<a name="l00673"></a>00673   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00674"></a>00674   <span class="keywordtype">double</span> sum;
<a name="l00675"></a>00675   
<a name="l00676"></a>00676   <span class="comment">// default output</span>
<a name="l00677"></a>00677   <span class="keywordflow">if</span> (sum_p)
<a name="l00678"></a>00678     *sum_p = -1;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680   <span class="comment">// check input</span>
<a name="l00681"></a>00681   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(var) || !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(subset) || !sum_p) {
<a name="l00682"></a>00682     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00683"></a>00683     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00684"></a>00684   }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686   <span class="comment">// get info from var &amp; subset</span>
<a name="l00687"></a>00687   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(var, &amp;numDataPoint, &amp;dim, &amp;assoc_var, NULL, 
<a name="l00688"></a>00688                           &amp;datatype);
<a name="l00689"></a>00689   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00690"></a>00690     <span class="keywordflow">return</span> rc;
<a name="l00691"></a>00691   rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subset, &amp;numMember, &amp;maxNumMember, &amp;assoc_subset);
<a name="l00692"></a>00692   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00693"></a>00693     <span class="keywordflow">return</span> rc;
<a name="l00694"></a>00694 
<a name="l00695"></a>00695   <span class="comment">// A little more checking</span>
<a name="l00696"></a>00696   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00697"></a>00697     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variable can only have 1 component not %d"</span>, dim);
<a name="l00698"></a>00698     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00699"></a>00699   }
<a name="l00700"></a>00700   <span class="keywordflow">if</span> (numDataPoint &lt; 1)  {
<a name="l00701"></a>00701     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variable has no data"</span>);
<a name="l00702"></a>00702     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00703"></a>00703   }
<a name="l00704"></a>00704   <span class="keywordflow">if</span> (assoc_var != assoc_subset || numDataPoint != maxNumMember) {
<a name="l00705"></a>00705     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Mismatch of entities"</span>);
<a name="l00706"></a>00706     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00707"></a>00707   }
<a name="l00708"></a>00708   <span class="keywordflow">if</span> (numMember &lt; 1) {
<a name="l00709"></a>00709     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset cannot be empty"</span>);
<a name="l00710"></a>00710     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00711"></a>00711   }
<a name="l00712"></a>00712   
<a name="l00713"></a>00713   <span class="comment">// log message</span>
<a name="l00714"></a>00714   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing sum of all data values of subset of variable."</span>);
<a name="l00715"></a>00715 
<a name="l00716"></a>00716   <span class="comment">// get variable data &amp;&amp; subset members</span>
<a name="l00717"></a>00717   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(var, &amp;datap);
<a name="l00718"></a>00718   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00719"></a>00719     <span class="keywordflow">return</span> rc;
<a name="l00720"></a>00720   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l00721"></a>00721   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00722"></a>00722     <span class="keywordflow">return</span> rc;
<a name="l00723"></a>00723   
<a name="l00724"></a>00724   <span class="comment">// Perform the calculation</span>
<a name="l00725"></a>00725   sum = 0.;
<a name="l00726"></a>00726   <span class="keywordflow">for</span> (i = 0; i &lt; numMember; i++) {
<a name="l00727"></a>00727     <span class="keywordflow">switch</span>(datatype) {
<a name="l00728"></a>00728     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:     sum += ((<span class="keywordtype">int</span>*)datap)[memberIDs[i]];     <span class="keywordflow">break</span>;
<a name="l00729"></a>00729     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   sum += ((<span class="keywordtype">float</span>*)datap)[memberIDs[i]];   <span class="keywordflow">break</span>;
<a name="l00730"></a>00730     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  sum += ((<span class="keywordtype">double</span>*)datap)[memberIDs[i]];  <span class="keywordflow">break</span>;
<a name="l00731"></a>00731     <span class="keywordflow">default</span>: 
<a name="l00732"></a>00732       free(memberIDs);
<a name="l00733"></a>00733       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00734"></a>00734       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00735"></a>00735     }
<a name="l00736"></a>00736   }
<a name="l00737"></a>00737   free(memberIDs);
<a name="l00738"></a>00738   
<a name="l00739"></a>00739   *sum_p = sum;
<a name="l00740"></a>00740   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00741"></a>00741 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge130d2218f05fcaa83dcd0aa55c91c8e"></a><!-- doxytag: member="statistics.c::fc_getVariableSum" ref="ge130d2218f05fcaa83dcd0aa55c91c8e" args="(FC_Variable var, double *sum_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getVariableSum           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>sum_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute sum of all data values of a variable. 
<p>
<b>Description:</b> <p>
This routine only operates on fields with one component and and an error value is returned for vector and tensor fields.<p>
<b>Modifications:</b> <ul>
<li>02/19/04 WSK, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable handle </td></tr>
<tr><td valign="top"><em>sum_p</em>&nbsp;</td><td>
output - sum of the data values </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="statistics_8c-source.html#l00303">303</a> of file <a class="el" href="statistics_8c-source.html">statistics.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l04065">fc_getDisplacedMeshVolume()</a>, <a class="el" href="geom_8c-source.html#l04004">fc_getMeshVolume()</a>, and <a class="el" href="varStats_8c-source.html#l00061">get_and_print_stats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00306"></a>00306   {
<a name="l00307"></a>00307   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00308"></a>00308   <span class="keywordtype">int</span> i, numDataPoint, dim;
<a name="l00309"></a>00309   <span class="keywordtype">void</span> *datap;
<a name="l00310"></a>00310   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype;
<a name="l00311"></a>00311   <span class="keywordtype">double</span> sum;
<a name="l00312"></a>00312 
<a name="l00313"></a>00313   <span class="comment">// default output</span>
<a name="l00314"></a>00314   <span class="keywordflow">if</span> (sum_p)
<a name="l00315"></a>00315     *sum_p = -1;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317   <span class="comment">// check input</span>
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(var) || !sum_p) {
<a name="l00319"></a>00319       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00320"></a>00320       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00321"></a>00321   }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323   <span class="comment">// get a count &amp; pointer to the data array. </span>
<a name="l00324"></a>00324   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(var, &amp;numDataPoint, &amp;dim, NULL, NULL, &amp;datatype);
<a name="l00325"></a>00325   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00326"></a>00326     <span class="keywordflow">return</span> rc;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   <span class="comment">// can only do 1 component fields</span>
<a name="l00329"></a>00329   <span class="keywordflow">if</span> (dim != 1 || numDataPoint &lt; 1)  {
<a name="l00330"></a>00330     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00331"></a>00331     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00332"></a>00332   }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334   <span class="comment">// log message</span>
<a name="l00335"></a>00335   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing sum of all data values."</span>);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337   <span class="comment">// get data</span>
<a name="l00338"></a>00338   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(var, &amp;datap);
<a name="l00339"></a>00339   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00340"></a>00340     <span class="keywordflow">return</span> rc;
<a name="l00341"></a>00341   
<a name="l00342"></a>00342   <span class="comment">// Perform the calculation</span>
<a name="l00343"></a>00343   sum = 0.;
<a name="l00344"></a>00344   <span class="keywordflow">for</span> (i = 0; i &lt; numDataPoint; i++) {
<a name="l00345"></a>00345     <span class="keywordflow">switch</span>(datatype) {
<a name="l00346"></a>00346     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:     sum += ((<span class="keywordtype">int</span>*)datap)[i];     <span class="keywordflow">break</span>;
<a name="l00347"></a>00347     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   sum += ((<span class="keywordtype">float</span>*)datap)[i];   <span class="keywordflow">break</span>;
<a name="l00348"></a>00348     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  sum += ((<span class="keywordtype">double</span>*)datap)[i];  <span class="keywordflow">break</span>;
<a name="l00349"></a>00349     <span class="keywordflow">default</span>: {
<a name="l00350"></a>00350         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00351"></a>00351         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00352"></a>00352       }
<a name="l00353"></a>00353     }
<a name="l00354"></a>00354   }
<a name="l00355"></a>00355   
<a name="l00356"></a>00356   *sum_p = sum;
<a name="l00357"></a>00357   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00358"></a>00358 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:18 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
