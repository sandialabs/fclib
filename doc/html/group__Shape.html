<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: Shape</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Shape<br>
<small>
[<a class="el" href="group__API.html">FCLib API</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for Shape:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__Shape.gif" border="0" alt="" usemap="#group____Shape_map">
<map name="group____Shape_map">
<area shape="rect" href="group__PrivateShape.html" title="(Private)" alt="" coords="260,5,340,32"><area shape="rect" href="group__API.html" title="Feature Characterization Library." alt="" coords="7,5,92,32"></map></td></tr></table></center>
</div>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Information about Shapes. 
<p>
<b>Description:</b> <p>
Information about Shapes (shapes of meshes etc). These may have a topological flavor to them, but since they arent heirarchical (e.g., children-parent), they are being located here rather than <a class="el" href="group__TopologyRelations.html">Topological Relations</a>. This is meant to work in conjunction with <a class="el" href="group__ElemDeath.html">Element Death</a> e.g., given some information about the shape of a mesh is there some information about a dead element region that would be of interest, such as the region cutting through the shape ? 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html">(Private)</a></td></tr>

<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFC__Shape.html">FC_Shape</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Shape Struct.  <a href="structFC__Shape.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Creating General Shapes from Subsets and Meshes</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g390c8304bc716ff39e4ef3c63657a6f5">fc_getSubsetShapes</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> in_subset, double comp_angle, int shared_dim, int *numShapes, <a class="el" href="structFC__Shape.html">FC_Shape</a> **shapes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a subset, returns an array of FC_Shapes  <a href="#g390c8304bc716ff39e4ef3c63657a6f5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g89c155b43d6f766ebc54f0049df31dec">fc_getMeshShapes</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, double comp_angle, int shared_dim, int *numShapes, <a class="el" href="structFC__Shape.html">FC_Shape</a> **shapes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a mesh, returns an array of FC_Shapes  <a href="#g89c155b43d6f766ebc54f0049df31dec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#ge71972e167b0795eb9875d8af2490363">fc_reshapeByAngle</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *inshape, double newangle, int seg_dim, <a class="el" href="structFC__Shape.html">FC_Shape</a> *newshape)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a shape and a new angle, creates a new shape where the sides are distinguished byt he new angle  <a href="#ge71972e167b0795eb9875d8af2490363"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gdaf726863fc5a2b2e07012b7ef1b392a">fc_reduceShapeNumSides</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *inshape, int reducedNumSides, <a class="el" href="structFC__Shape.html">FC_Shape</a> *reducedshape)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a shape and a desired number of sides, fewer than the current number of sides, creates a new shape with the desired number of sides  <a href="#gdaf726863fc5a2b2e07012b7ef1b392a"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Shape Helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gcf5618411fe3bf78dec5b0c8cba35766">fc_copyShape</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *inshape, <a class="el" href="structFC__Shape.html">FC_Shape</a> *outshape)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy a shape.  <a href="#gcf5618411fe3bf78dec5b0c8cba35766"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g2e06fed57b8dac98cac3f52481a7f21c">fc_reorderShape</a> (int *neworder, <a class="el" href="structFC__Shape.html">FC_Shape</a> *shape)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a new ordering of the sides, reorders a shape  <a href="#g2e06fed57b8dac98cac3f52481a7f21c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19">fc_freeShape</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *fcss)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">frees a Shape  <a href="#gfb8474857a22e70a547b5e7875dc9c19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g5cd2feb27390c38a13f19e52a80654c7">fc_clearShape</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *fcss)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">clears the allocated shape memory, but leaves the subsets alive  <a href="#g5cd2feb27390c38a13f19e52a80654c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gb8848b3711ed4db6e2fee49f5de0cd8c">fc_initShape</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *fcss)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">inits a Shape  <a href="#gb8848b3711ed4db6e2fee49f5de0cd8c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g1c2ac1ebcb636d73f4c84e715e96dd83">fc_printShape</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *fcss, char *label, int verb)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">prints a Shape  <a href="#g1c2ac1ebcb636d73f4c84e715e96dd83"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Side Orders</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g4c1cad04e96980564d0fade1f5fbf069">fc_createScrewShapeOrder</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, int **neworder)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a shape, returns the reordering array for a screw  <a href="#g4c1cad04e96980564d0fade1f5fbf069"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g07d6ca065cd2797eb5f921c8ad2e9be0">fc_createDescendingAreaOrder</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, int **neworder)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a shape returns an array of the side ids in descending face area order  <a href="#g07d6ca065cd2797eb5f921c8ad2e9be0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gf9d1244014996a75fb574936bca1f47b">fc_createLargeAndNonAdjacentSidesOrder</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, int **neworder)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">As an approximation to obtaining the major sides of a thin shape, given a shape returns an array of the side ids in the ordered desired for shape with a large side and a non-adjacent side, subject to certain constraints.  <a href="#gf9d1244014996a75fb574936bca1f47b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gb659e74e602507081f3ea7d7b26eafab">fc_createLargeAndOpposingSidesOrder</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, double maxangle, int **neworder)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">As an approximation to obtaining the major sides of a thin shape, given a shape returns an array of the side ids in the ordered desired for a shape with a large and opposing side.  <a href="#gb659e74e602507081f3ea7d7b26eafab"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Adjacencies</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g4b10e29509f918bfe429c8c7420ea679">fc_createSideAdjacencyMatrix</a> (int numSubsets, <a class="el" href="structFC__Subset.html">FC_Subset</a> *subsets, int shared_dim, int ***intmatrix)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given an array of subsets specifying the faces of each side of a shape, returns a matrix specifying the side adjacencies.  <a href="#g4b10e29509f918bfe429c8c7420ea679"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g0bd777744173330b8a9d77b85eb53b0c">fc_segmentAdjacencyMatrix</a> (int matrixdim, int **adjmatrix, int *numsegments, int **sidespersegment, int ***sideids)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given an adjacency matrix, returns segments of it based on connectivities.  <a href="#g0bd777744173330b8a9d77b85eb53b0c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g1c7648a1250fe6a2b2ff7d2dafe53a91">fc_calcDistanceMatrix</a> (int nsides, int **adjmatrix, int ***distmatrix)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given an nxn adjacency matrix returns the (shortestpath) distance matrix.  <a href="#g1c7648a1250fe6a2b2ff7d2dafe53a91"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Misc</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gf49458c53989d7b1733647a5bca33754">fc_getShapeEnds</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, int *numEnds, int **endArray)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a shape returns the shape's ends.  <a href="#gf49458c53989d7b1733647a5bca33754"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gc3084dfed2f0a3c0e2f7b4e8e4ef3005">fc_getShapeSidesAreas</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, double **area)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a Shape, returns the (non-displaced) area for each side.  <a href="#gc3084dfed2f0a3c0e2f7b4e8e4ef3005"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#gc9ab86a7eb1c1ac2780f2493b9219bc3">fc_getPlanarSideNormal</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, int sideid, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *normal)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a shape and the ID of a planar side, returns the outward normal to that face.  <a href="#gc9ab86a7eb1c1ac2780f2493b9219bc3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Shape.html#g7a2a66886ce110aa18616af7cbe7de0c">fc_getSideNormalMeanSdev</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, int sideid, <a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *mean, <a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *std)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a shape and a sideid, returns the outward normal and std in each direction to that face.  <a href="#g7a2a66886ce110aa18616af7cbe7de0c"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g1c7648a1250fe6a2b2ff7d2dafe53a91"></a><!-- doxytag: member="shape.c::fc_calcDistanceMatrix" ref="g1c7648a1250fe6a2b2ff7d2dafe53a91" args="(int nsides, int **adjmatrix, int ***distmatrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_calcDistanceMatrix           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nsides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>adjmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int ***&nbsp;</td>
          <td class="paramname"> <em>distmatrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given an nxn adjacency matrix returns the (shortestpath) distance matrix. 
<p>
<b>Description:</b> <p>
Given an nxn adjacency matrix returns the (shortest path) distance matrix. This is not limited to cases where the adj matrix represents the adj of the sides, but it is intended to be used in that way. Does not take advantage of the symmetry of the adj matrix, so this could be used for non symm matricies. Uses Floyd's algorithm<p>
Note: -1 is used for infinite distance entries.<p>
Note: in theory, this should work for weighted entries; I haven't tried this however, since this method isnt in here for general matrix calculations, but as a precursor for determining side pairs of interest.<p>
<b>Modifications:</b> <ul>
<li>12/21/05 ACG created.</li><li>01/30/05 ACG changed return val so infinite distance entries return value = -1. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>nsides</em>&nbsp;</td><td>
input - nsides (nxn matrix) </td></tr>
<tr><td valign="top"><em>adjmatrix</em>&nbsp;</td><td>
input - adj matrix </td></tr>
<tr><td valign="top"><em>distmatrix</em>&nbsp;</td><td>
output - distance matrix </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03469">3469</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l01725">fc_reduceShapeNumSides()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03473"></a>03473  {
<a name="l03474"></a>03474   <span class="keywordtype">int</span>** imatrix_a; <span class="comment">//intermediatematrix</span>
<a name="l03475"></a>03475   <span class="keywordtype">int</span>** imatrix_b; <span class="comment">//intermediatematrix</span>
<a name="l03476"></a>03476   <span class="keywordtype">int</span> ***curr, ***next, ***temp;
<a name="l03477"></a>03477   <span class="keywordtype">int</span> i,j,k;
<a name="l03478"></a>03478 
<a name="l03479"></a>03479 
<a name="l03480"></a>03480   <span class="comment">//default return</span>
<a name="l03481"></a>03481   <span class="keywordflow">if</span> (distmatrix)
<a name="l03482"></a>03482     *distmatrix = NULL;
<a name="l03483"></a>03483 
<a name="l03484"></a>03484   <span class="keywordflow">if</span> (!nsides || !adjmatrix || !distmatrix){
<a name="l03485"></a>03485     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03486"></a>03486     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03487"></a>03487   }
<a name="l03488"></a>03488 
<a name="l03489"></a>03489   <span class="comment">// log message</span>
<a name="l03490"></a>03490   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing Side Distance Matrix"</span>);
<a name="l03491"></a>03491 
<a name="l03492"></a>03492   <span class="comment">// create space for the adj array, initialize to zero</span>
<a name="l03493"></a>03493   imatrix_a = calloc(nsides, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l03494"></a>03494   imatrix_b = calloc(nsides, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l03495"></a>03495   <span class="keywordflow">if</span> (imatrix_a == NULL || imatrix_b == NULL) {
<a name="l03496"></a>03496     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03497"></a>03497     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03498"></a>03498   }
<a name="l03499"></a>03499   <span class="keywordflow">for</span> (i = 0; i &lt; nsides; i++) {
<a name="l03500"></a>03500     imatrix_a[i] = calloc(nsides, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03501"></a>03501     imatrix_b[i] = calloc(nsides, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03502"></a>03502     <span class="keywordflow">if</span> (imatrix_a[i] == NULL || imatrix_b[i] == NULL) {
<a name="l03503"></a>03503       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03504"></a>03504       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03505"></a>03505     }
<a name="l03506"></a>03506   }
<a name="l03507"></a>03507 
<a name="l03508"></a>03508   <span class="comment">//intial vals</span>
<a name="l03509"></a>03509   <span class="keywordflow">for</span> (i = 0; i &lt; nsides; i++){
<a name="l03510"></a>03510     imatrix_a[i][i] = 0;
<a name="l03511"></a>03511     <span class="keywordflow">for</span> (j = 0; j &lt; nsides; j++){ 
<a name="l03512"></a>03512       <span class="keywordflow">if</span> (i == j){
<a name="l03513"></a>03513      imatrix_a[i][i] = 0;
<a name="l03514"></a>03514       } <span class="keywordflow">else</span> {
<a name="l03515"></a>03515      <span class="keywordflow">if</span> (adjmatrix[i][j] == 1){
<a name="l03516"></a>03516        imatrix_a[i][j] = 1;
<a name="l03517"></a>03517      } <span class="keywordflow">else</span> {
<a name="l03518"></a>03518        imatrix_a[i][j] = -1; 
<a name="l03519"></a>03519        <span class="comment">//   imatrix_a[i][j] = INT_MAX; </span>
<a name="l03520"></a>03520      }
<a name="l03521"></a>03521       }
<a name="l03522"></a>03522     }
<a name="l03523"></a>03523   }
<a name="l03524"></a>03524 
<a name="l03525"></a>03525   next = &amp;imatrix_a; 
<a name="l03526"></a>03526   curr = &amp;imatrix_b; 
<a name="l03527"></a>03527   <span class="keywordflow">for</span> (k = 0; k &lt; nsides; k++){
<a name="l03528"></a>03528     temp = next;
<a name="l03529"></a>03529     next = curr;
<a name="l03530"></a>03530     curr = temp;
<a name="l03531"></a>03531     <span class="keywordflow">for</span> (i = 0; i &lt; nsides; i++){
<a name="l03532"></a>03532       <span class="keywordflow">for</span> (j = 0; j &lt; nsides; j++){
<a name="l03533"></a>03533      <span class="keywordtype">int</span> a = (*curr)[i][j];
<a name="l03534"></a>03534      <span class="keywordtype">int</span> b;
<a name="l03535"></a>03535      <span class="comment">//   if ((*curr)[i][k] == INT_MAX || (*curr)[k][j] == INT_MAX){</span>
<a name="l03536"></a>03536      <span class="comment">//     b = INT_MAX;</span>
<a name="l03537"></a>03537      <span class="keywordflow">if</span> ((*curr)[i][k] == -1 || (*curr)[k][j] == -1){
<a name="l03538"></a>03538        b = -1;
<a name="l03539"></a>03539      } <span class="keywordflow">else</span> {
<a name="l03540"></a>03540        b = (*curr)[i][k]+(*curr)[k][j];
<a name="l03541"></a>03541      }
<a name="l03542"></a>03542 
<a name="l03543"></a>03543      <span class="keywordflow">if</span> (a == -1){
<a name="l03544"></a>03544        (*next)[i][j] = b;
<a name="l03545"></a>03545      }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (b == -1){
<a name="l03546"></a>03546        (*next)[i][j] = a;
<a name="l03547"></a>03547      }<span class="keywordflow">else</span> {
<a name="l03548"></a>03548        (*next)[i][j] = a &lt; b ? a : b;
<a name="l03549"></a>03549      }
<a name="l03550"></a>03550      <span class="comment">//     (*next)[i][j] = a &lt; b ? a : b;</span>
<a name="l03551"></a>03551       }
<a name="l03552"></a>03552     }
<a name="l03553"></a>03553   }
<a name="l03554"></a>03554 
<a name="l03555"></a>03555   <span class="keywordflow">for</span> (i = 0; i &lt; nsides; i++){
<a name="l03556"></a>03556     free((*curr)[i]);
<a name="l03557"></a>03557   }
<a name="l03558"></a>03558   free(*curr);
<a name="l03559"></a>03559 
<a name="l03560"></a>03560   *distmatrix = *next;
<a name="l03561"></a>03561   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03562"></a>03562 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g5cd2feb27390c38a13f19e52a80654c7"></a><!-- doxytag: member="shape.c::fc_clearShape" ref="g5cd2feb27390c38a13f19e52a80654c7" args="(FC_Shape *fcss)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_clearShape           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>fcss</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
clears the allocated shape memory, but leaves the subsets alive 
<p>
<b>Description:</b> <p>
Clears the allocated shape memory, but leaves the subsets alive. The user will need handles to them to eventually delete them.<p>
<b>Modifications:</b> <ul>
<li>08/22/06 ACG created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fcss</em>&nbsp;</td><td>
input - the shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02370">2370</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02372"></a>02372  {
<a name="l02373"></a>02373   <span class="keywordtype">int</span> i;
<a name="l02374"></a>02374 
<a name="l02375"></a>02375   <span class="keywordflow">if</span> (!fcss){
<a name="l02376"></a>02376     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02377"></a>02377     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02378"></a>02378   }
<a name="l02379"></a>02379 
<a name="l02380"></a>02380   <span class="keywordflow">for</span> (i = 0; i &lt; fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02381"></a>02381     free(fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i]);
<a name="l02382"></a>02382   }
<a name="l02383"></a>02383   free(fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>);
<a name="l02384"></a>02384   free(fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>);
<a name="l02385"></a>02385   free(fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>);
<a name="l02386"></a>02386   fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>= NULL;
<a name="l02387"></a>02387   fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>= NULL;
<a name="l02388"></a>02388   fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>= NULL;
<a name="l02389"></a>02389   fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = 0;
<a name="l02390"></a>02390 
<a name="l02391"></a>02391   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02392"></a>02392 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gcf5618411fe3bf78dec5b0c8cba35766"></a><!-- doxytag: member="shape.c::fc_copyShape" ref="gcf5618411fe3bf78dec5b0c8cba35766" args="(FC_Shape *inshape, FC_Shape *outshape)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_copyShape           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>inshape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>outshape</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy a shape. 
<p>
<b>Description:</b> <p>
This is a deep copy; it allocates memory and the created shape will need to be freed by the caller.<p>
<b>Modifications:</b> <ul>
<li>06/18/06 ACG created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>inshape</em>&nbsp;</td><td>
input - ptr to shape </td></tr>
<tr><td valign="top"><em>outshape</em>&nbsp;</td><td>
output - ptr to the shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02098">2098</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="subset_8c-source.html#l00351">fc_copySubset()</a>, <a class="el" href="shape_8c-source.html#l02320">fc_freeShape()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02700">fc_getSubsetName()</a>, <a class="el" href="shape_8c-source.html#l02414">fc_initShape()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l01725">fc_reduceShapeNumSides()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02101"></a>02101  {
<a name="l02102"></a>02102 
<a name="l02103"></a>02103   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02104"></a>02104   <a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a> shape;
<a name="l02105"></a>02105   <span class="keywordtype">int</span> i,j;
<a name="l02106"></a>02106 
<a name="l02107"></a>02107   <span class="comment">//defaults</span>
<a name="l02108"></a>02108   <span class="keywordflow">if</span> (outshape){
<a name="l02109"></a>02109     <a class="code" href="group__Shape.html#gb8848b3711ed4db6e2fee49f5de0cd8c" title="inits a Shape">fc_initShape</a>(outshape);
<a name="l02110"></a>02110   }
<a name="l02111"></a>02111 
<a name="l02112"></a>02112 
<a name="l02113"></a>02113   <span class="keywordflow">if</span> (!inshape || !outshape ){
<a name="l02114"></a>02114     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02115"></a>02115     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02116"></a>02116   }
<a name="l02117"></a>02117 
<a name="l02118"></a>02118   <span class="comment">// log message</span>
<a name="l02119"></a>02119   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"copying shape"</span>);
<a name="l02120"></a>02120 
<a name="l02121"></a>02121   shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l02122"></a>02122   shape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02123"></a>02123   shape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02124"></a>02124   shape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a> = (<span class="keywordtype">int</span>**)malloc(shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l02125"></a>02125   <span class="keywordflow">if</span> (!shape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> || ! shape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> || ! shape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>){
<a name="l02126"></a>02126     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02127"></a>02127     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02128"></a>02128   }
<a name="l02129"></a>02129   <span class="keywordflow">for</span> (i = 0; i &lt; shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02130"></a>02130     <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh; <span class="comment">//these really should all be onthe same mesh</span>
<a name="l02131"></a>02131     <span class="keywordtype">char</span>* subname;
<a name="l02132"></a>02132 
<a name="l02133"></a>02133     rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],&amp;mesh);
<a name="l02134"></a>02134     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02135"></a>02135       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get mesh from subset"</span>);
<a name="l02136"></a>02136       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shape);
<a name="l02137"></a>02137       <span class="keywordflow">return</span> rc;
<a name="l02138"></a>02138     }
<a name="l02139"></a>02139     rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],&amp;subname);
<a name="l02140"></a>02140     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02141"></a>02141       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get name of subset"</span>);
<a name="l02142"></a>02142       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shape);
<a name="l02143"></a>02143       <span class="keywordflow">return</span> rc;
<a name="l02144"></a>02144     }
<a name="l02145"></a>02145     <span class="comment">//is it ok to use the same name ?</span>
<a name="l02146"></a>02146     rc =  <a class="code" href="group__Subset.html#g8c233583d14e8205bbfe4aca0d196772" title="Copy subset to a new subset.">fc_copySubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],mesh,subname,&amp;(shape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i]));
<a name="l02147"></a>02147     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02148"></a>02148       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant copy subset"</span>);
<a name="l02149"></a>02149       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shape);
<a name="l02150"></a>02150       <span class="keywordflow">return</span> rc;
<a name="l02151"></a>02151     }
<a name="l02152"></a>02152     free(subname);
<a name="l02153"></a>02153 
<a name="l02154"></a>02154     rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],&amp;mesh);
<a name="l02155"></a>02155     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02156"></a>02156       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get mesh from subset"</span>);
<a name="l02157"></a>02157       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shape);
<a name="l02158"></a>02158       <span class="keywordflow">return</span> rc;
<a name="l02159"></a>02159     }
<a name="l02160"></a>02160     rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],&amp;subname);
<a name="l02161"></a>02161     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02162"></a>02162       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get name of subset"</span>);
<a name="l02163"></a>02163       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shape);
<a name="l02164"></a>02164       <span class="keywordflow">return</span> rc;
<a name="l02165"></a>02165     }
<a name="l02166"></a>02166     <span class="comment">//is it ok to use the same name ?</span>
<a name="l02167"></a>02167     rc =  <a class="code" href="group__Subset.html#g8c233583d14e8205bbfe4aca0d196772" title="Copy subset to a new subset.">fc_copySubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],mesh,subname,&amp;(shape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i]));
<a name="l02168"></a>02168     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02169"></a>02169       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant copy subset"</span>);
<a name="l02170"></a>02170       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;shape);
<a name="l02171"></a>02171       <span class="keywordflow">return</span> rc;
<a name="l02172"></a>02172     }
<a name="l02173"></a>02173     
<a name="l02174"></a>02174     free(subname);
<a name="l02175"></a>02175 
<a name="l02176"></a>02176     shape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i] = (<span class="keywordtype">int</span>*)malloc(shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02177"></a>02177     <span class="keywordflow">if</span> (!shape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i]){
<a name="l02178"></a>02178       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02179"></a>02179       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02180"></a>02180     }
<a name="l02181"></a>02181   }
<a name="l02182"></a>02182     
<a name="l02183"></a>02183   <span class="keywordflow">for</span> (i = 0; i &lt; shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02184"></a>02184     <span class="keywordflow">for</span> (j = 0; j &lt; shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++){
<a name="l02185"></a>02185       shape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] = inshape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j];
<a name="l02186"></a>02186     }
<a name="l02187"></a>02187   }
<a name="l02188"></a>02188 
<a name="l02189"></a>02189   outshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = shape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l02190"></a>02190   outshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> = shape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>;
<a name="l02191"></a>02191   outshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> = shape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>;
<a name="l02192"></a>02192   outshape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a> = shape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>;
<a name="l02193"></a>02193 
<a name="l02194"></a>02194   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02195"></a>02195 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g07d6ca065cd2797eb5f921c8ad2e9be0"></a><!-- doxytag: member="shape.c::fc_createDescendingAreaOrder" ref="g07d6ca065cd2797eb5f921c8ad2e9be0" args="(FC_Shape *shape, int **neworder)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_createDescendingAreaOrder           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neworder</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a shape returns an array of the side ids in descending face area order 
<p>
<b>Description:</b> <p>
Given a shape returns an array of the side ids in descending face area order. This can then be fed into <a class="el" href="group__Shape.html#g2e06fed57b8dac98cac3f52481a7f21c">fc_reorderShape</a><p>
<b>Modifications:</b> <ul>
<li>06/18/06 ACG, created</li><li>06/19/06 ACG updated to reflect change in the ordering of the array expected by reorderShape, unittested</li><li>09/27/06 ACG changed from ascending to descending </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - shape </td></tr>
<tr><td valign="top"><em>neworder</em>&nbsp;</td><td>
output - ids of sides </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02669">2669</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="shape_8c-source.html#l03754">fc_getShapeSidesAreas()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="tears_8c-source.html#l00640">createShapeWOrder()</a>, <a class="el" href="shape_8c-source.html#l02818">fc_createLargeAndNonAdjacentSidesOrder()</a>, and <a class="el" href="shape_8c-source.html#l03005">fc_createLargeAndOpposingSidesOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02672"></a>02672     {
<a name="l02673"></a>02673 
<a name="l02674"></a>02674   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02675"></a>02675   <span class="keywordtype">double</span> *areas;
<a name="l02676"></a>02676   <span class="keywordtype">int</span> numSides;
<a name="l02677"></a>02677   <span class="keywordtype">int</span> *order;
<a name="l02678"></a>02678   <span class="keywordtype">int</span> i,j;
<a name="l02679"></a>02679 
<a name="l02680"></a>02680   <span class="comment">//defaults</span>
<a name="l02681"></a>02681   <span class="keywordflow">if</span> (neworder)
<a name="l02682"></a>02682     *neworder = NULL;
<a name="l02683"></a>02683 
<a name="l02684"></a>02684   <span class="keywordflow">if</span> ( !shape ||  !neworder){
<a name="l02685"></a>02685     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02686"></a>02686     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02687"></a>02687   }
<a name="l02688"></a>02688 
<a name="l02689"></a>02689   <span class="comment">// log message</span>
<a name="l02690"></a>02690   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting descending area order"</span>);
<a name="l02691"></a>02691 
<a name="l02692"></a>02692   numSides = shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l02693"></a>02693 
<a name="l02694"></a>02694   rc= <a class="code" href="group__Shape.html#gc3084dfed2f0a3c0e2f7b4e8e4ef3005" title="Given a Shape, returns the (non-displaced) area for each side.">fc_getShapeSidesAreas</a>(shape,&amp;areas);
<a name="l02695"></a>02695   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02696"></a>02696     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get sides areas"</span>);
<a name="l02697"></a>02697     <span class="keywordflow">return</span> rc;
<a name="l02698"></a>02698   }
<a name="l02699"></a>02699     
<a name="l02700"></a>02700   order = (<span class="keywordtype">int</span>*)malloc(numSides*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02701"></a>02701   <span class="keywordflow">if</span> (order == NULL){
<a name="l02702"></a>02702     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02703"></a>02703     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02704"></a>02704   }
<a name="l02705"></a>02705   
<a name="l02706"></a>02706   <span class="keywordflow">for</span> (i =0; i &lt; numSides; i++){
<a name="l02707"></a>02707     order[i] = i;
<a name="l02708"></a>02708   }
<a name="l02709"></a>02709   
<a name="l02710"></a>02710 
<a name="l02711"></a>02711   <span class="comment">//order sides by area</span>
<a name="l02712"></a>02712   <span class="comment">//sort sides areas. yes i know, its bubblesort.</span>
<a name="l02713"></a>02713   {
<a name="l02714"></a>02714     <span class="keywordtype">double</span> tempa;
<a name="l02715"></a>02715     <span class="keywordtype">int</span> tempi;
<a name="l02716"></a>02716     <span class="keywordtype">int</span> test; 
<a name="l02717"></a>02717     
<a name="l02718"></a>02718     <span class="keywordflow">for</span>(i = numSides - 1; i &gt; 0; i--){
<a name="l02719"></a>02719       test=0;
<a name="l02720"></a>02720       <span class="keywordflow">for</span>(j = 0; j &lt; i; j++){
<a name="l02721"></a>02721      <span class="keywordflow">if</span> (areas[j] &gt; areas[j+1]){
<a name="l02722"></a>02722        tempa = areas[j]; 
<a name="l02723"></a>02723        areas[j] = areas[j+1];
<a name="l02724"></a>02724        areas[j+1] = tempa;
<a name="l02725"></a>02725        tempi = order[j]; 
<a name="l02726"></a>02726        order[j] = order[j+1];
<a name="l02727"></a>02727        order[j+1] = tempi;
<a name="l02728"></a>02728        test=1;
<a name="l02729"></a>02729      }
<a name="l02730"></a>02730       }
<a name="l02731"></a>02731       <span class="keywordflow">if</span>(test==0) <span class="keywordflow">break</span>; <span class="comment">//exit if sorted</span>
<a name="l02732"></a>02732     }
<a name="l02733"></a>02733   }
<a name="l02734"></a>02734   free(areas);
<a name="l02735"></a>02735 
<a name="l02736"></a>02736   <span class="comment">//reverse the order</span>
<a name="l02737"></a>02737   <span class="comment">//flip order around for convenience</span>
<a name="l02738"></a>02738   <span class="keywordflow">for</span> (i = 0; i &lt; numSides/2; i++){
<a name="l02739"></a>02739     <span class="keywordtype">int</span> a = order[i];
<a name="l02740"></a>02740     order[i] = order[numSides-1-i];
<a name="l02741"></a>02741     order[numSides-1-i] = a;
<a name="l02742"></a>02742   }
<a name="l02743"></a>02743 
<a name="l02744"></a>02744   *neworder = order;
<a name="l02745"></a>02745 
<a name="l02746"></a>02746   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02747"></a>02747 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf9d1244014996a75fb574936bca1f47b"></a><!-- doxytag: member="shape.c::fc_createLargeAndNonAdjacentSidesOrder" ref="gf9d1244014996a75fb574936bca1f47b" args="(FC_Shape *shape, int **neworder)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_createLargeAndNonAdjacentSidesOrder           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neworder</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
As an approximation to obtaining the major sides of a thin shape, given a shape returns an array of the side ids in the ordered desired for shape with a large side and a non-adjacent side, subject to certain constraints. 
<p>
<b>Description:</b> As an approximation to obtaining the major sides of a thin shape, given a shape returns an array of the side ids in the ordered desired for shape with a large side and a non-adjacent side, subject to certain constraints.<p>
A thin shape is a shape that in some dimension is narrow and in a roughly perpendicular direction has a pair of large opposing sides, which are the major sides that the user is interested in. The thin shape order would then have those major sides in the 0th and 1st position, with all other sides in random order. This can then be fed into <a class="el" href="group__Shape.html#g2e06fed57b8dac98cac3f52481a7f21c">fc_reorderShape</a>.<p>
This method uses simplifying assumtions to get the major sides, which may not be correct in all cases. Specifically, this method attempts to find the largest side and its largest non-adjacent side and call them the major sides subject to the following constraints (in order):<ul>
<li>If there are three or more sides that are the largest, it is not a thin shape (e.g., rectangular prism)</li><li>If the two largest sides are of equal area, returns them in random order if they are nonadj. If they are adjacent, then it is not a thin shape.</li><li>If the largest non-adj side to the unique largest side is equal in size to another non-adj side, then it is not a thin shape.</li><li>If there is no side that is non-adjacent to the largest side then it is not a thin shape.</li></ul>
<p>
Note that tests for equals are FC_FLT_EQUIV in order to keep the interface small. If you want to change those conditions, you have to write your own method.<p>
Note that there can be undesirable results for shapes that have no sharp corners and therefore what may be expected to be the thin side actually wraps around the shape as one large continuous side and is therefore the largest side. This case is attempted to be handled by <a class="el" href="group__Shape.html#gb659e74e602507081f3ea7d7b26eafab">fc_createLargeAndOpposingSidesOrder</a>.<p>
Returns with an error if there is something fundamentally wrong. Returns FC_SUCCESS but empty order array if the shape does not satisfy the thin shape criteria.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000081">Todo:</a></b></dt><dd><ul>
<li>allows user to send in criteria for equals comparison?</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>07/18/06 ACG created</li><li>07/19/06 ACG changed so returns FC_SUCCESS and null order if it is not an appropriate shape. Only error if there is actually an error.</li><li>08/08/06 ACG renamed from createThinShapeOrder.</li><li>09/19/06 ACG changed equal comparison from dbl to float </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - shape </td></tr>
<tr><td valign="top"><em>neworder</em>&nbsp;</td><td>
output - ids of sides </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02818">2818</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8c-source.html#l02669">fc_createDescendingAreaOrder()</a>, <a class="el" href="util_8h-source.html#l00111">FC_FLT_EQUIV</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="shape_8c-source.html#l03754">fc_getShapeSidesAreas()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="tears_8c-source.html#l00640">createShapeWOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02821"></a>02821     {
<a name="l02822"></a>02822 
<a name="l02823"></a>02823   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02824"></a>02824   <span class="keywordtype">double</span> *areas;
<a name="l02825"></a>02825   <span class="keywordtype">int</span> numSides;
<a name="l02826"></a>02826   <span class="keywordtype">int</span> *order;
<a name="l02827"></a>02827   <span class="keywordtype">int</span> sidemax,nextside,testside;
<a name="l02828"></a>02828   <span class="keywordtype">int</span> i,count;
<a name="l02829"></a>02829 
<a name="l02830"></a>02830   <span class="comment">//defaults</span>
<a name="l02831"></a>02831   <span class="keywordflow">if</span> (neworder)
<a name="l02832"></a>02832     *neworder = NULL;
<a name="l02833"></a>02833 
<a name="l02834"></a>02834   <span class="keywordflow">if</span> (!shape || !neworder){
<a name="l02835"></a>02835     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02836"></a>02836     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02837"></a>02837   }
<a name="l02838"></a>02838 
<a name="l02839"></a>02839   <span class="comment">// log message</span>
<a name="l02840"></a>02840   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting large nonadjside area order"</span>);
<a name="l02841"></a>02841 
<a name="l02842"></a>02842   numSides = shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l02843"></a>02843 
<a name="l02844"></a>02844   <span class="comment">//must be at least 3 sides for this to do anything</span>
<a name="l02845"></a>02845   <span class="keywordflow">if</span> (numSides &lt; 3){
<a name="l02846"></a>02846     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"shape must have at least 3 sides to have a nonadj side"</span>);
<a name="l02847"></a>02847     <span class="comment">//    return FC_INPUT_ERROR;</span>
<a name="l02848"></a>02848     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">//null return</span>
<a name="l02849"></a>02849   }
<a name="l02850"></a>02850 
<a name="l02851"></a>02851   rc = <a class="code" href="group__Shape.html#gc3084dfed2f0a3c0e2f7b4e8e4ef3005" title="Given a Shape, returns the (non-displaced) area for each side.">fc_getShapeSidesAreas</a>(shape,&amp;areas);
<a name="l02852"></a>02852   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02853"></a>02853     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get sides areas"</span>);
<a name="l02854"></a>02854     <span class="keywordflow">return</span> rc;
<a name="l02855"></a>02855   }
<a name="l02856"></a>02856 
<a name="l02857"></a>02857   rc = <a class="code" href="group__Shape.html#g07d6ca065cd2797eb5f921c8ad2e9be0" title="given a shape returns an array of the side ids in descending face area order">fc_createDescendingAreaOrder</a>(shape,&amp;order);
<a name="l02858"></a>02858   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02859"></a>02859     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get descending order"</span>);
<a name="l02860"></a>02860     free(areas);
<a name="l02861"></a>02861     <span class="keywordflow">return</span> rc;
<a name="l02862"></a>02862   }
<a name="l02863"></a>02863 
<a name="l02864"></a>02864   sidemax = -1;
<a name="l02865"></a>02865   nextside = -1;
<a name="l02866"></a>02866   testside = -1;
<a name="l02867"></a>02867 
<a name="l02868"></a>02868   <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g564c35a50d7fa88019003ccfb2bbff97" title="Test equality of two values with float precision.">FC_FLT_EQUIV</a>(areas[order[0]], areas[order[1]])){ <span class="comment">//two largest sides are of equal area</span>
<a name="l02869"></a>02869     <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g564c35a50d7fa88019003ccfb2bbff97" title="Test equality of two values with float precision.">FC_FLT_EQUIV</a>(areas[order[1]], areas[order[2]])){
<a name="l02870"></a>02870       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"3 or more largest sides - cant get thin shape order"</span>);
<a name="l02871"></a>02871       free(areas);
<a name="l02872"></a>02872       free(order);
<a name="l02873"></a>02873       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">// not a thin shape, null return</span>
<a name="l02874"></a>02874     }<span class="keywordflow">else</span>{
<a name="l02875"></a>02875       <span class="comment">//only two largest sides but if the two largest sides are adj - bad</span>
<a name="l02876"></a>02876       <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[order[0]][order[1]] == 1){
<a name="l02877"></a>02877      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"two largest sides adj - cant get thin shape order"</span>);
<a name="l02878"></a>02878      free(areas);
<a name="l02879"></a>02879      free(order);
<a name="l02880"></a>02880      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">// not a thin shape, null return</span>
<a name="l02881"></a>02881       }<span class="keywordflow">else</span>{
<a name="l02882"></a>02882      <span class="comment">//return them in random order</span>
<a name="l02883"></a>02883      sidemax = order[0];
<a name="l02884"></a>02884      nextside = order[1];
<a name="l02885"></a>02885       }
<a name="l02886"></a>02886     }
<a name="l02887"></a>02887   }<span class="keywordflow">else</span>{
<a name="l02888"></a>02888     <span class="comment">//two largest sides are not of equal area</span>
<a name="l02889"></a>02889 
<a name="l02890"></a>02890     sidemax = order[0];
<a name="l02891"></a>02891     <span class="comment">//find the largest non-adjacent side. if that isnt unique - bad</span>
<a name="l02892"></a>02892 
<a name="l02893"></a>02893     nextside = -1;
<a name="l02894"></a>02894     testside = -1;
<a name="l02895"></a>02895     <span class="keywordflow">for</span> (i = 1; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02896"></a>02896       <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[sidemax][order[i]] == 0){
<a name="l02897"></a>02897      <span class="keywordflow">if</span> (nextside == -1){
<a name="l02898"></a>02898        nextside = order[i];
<a name="l02899"></a>02899      }<span class="keywordflow">else</span>{
<a name="l02900"></a>02900        testside = order[i];
<a name="l02901"></a>02901        <span class="keywordflow">break</span>;
<a name="l02902"></a>02902      }
<a name="l02903"></a>02903       }
<a name="l02904"></a>02904     }
<a name="l02905"></a>02905   }
<a name="l02906"></a>02906 
<a name="l02907"></a>02907   <span class="comment">//sidemax cannot be -1</span>
<a name="l02908"></a>02908   <span class="keywordflow">if</span> (nextside == -1){
<a name="l02909"></a>02909     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"no non-adj side - cant get thin shape order"</span>);
<a name="l02910"></a>02910     free(areas);
<a name="l02911"></a>02911     free(order);
<a name="l02912"></a>02912     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">// not a thin shape, null return</span>
<a name="l02913"></a>02913   }
<a name="l02914"></a>02914   
<a name="l02915"></a>02915 
<a name="l02916"></a>02916   <span class="keywordflow">if</span> (testside != -1){
<a name="l02917"></a>02917     <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g564c35a50d7fa88019003ccfb2bbff97" title="Test equality of two values with float precision.">FC_FLT_EQUIV</a>(areas[nextside],areas[testside])){
<a name="l02918"></a>02918       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"two largest non-adj sides are of equal area - cant get thin shape order"</span>);
<a name="l02919"></a>02919       free(areas);
<a name="l02920"></a>02920       free(order);
<a name="l02921"></a>02921       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">// not a thin shape, null return</span>
<a name="l02922"></a>02922     }
<a name="l02923"></a>02923   }
<a name="l02924"></a>02924 
<a name="l02925"></a>02925   <span class="comment">//now we have our sides fill in all other ones randomly</span>
<a name="l02926"></a>02926   free(order);
<a name="l02927"></a>02927   free(areas);
<a name="l02928"></a>02928 
<a name="l02929"></a>02929   order = (<span class="keywordtype">int</span>*)malloc((shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>)*<span class="keyword">sizeof</span>(int));
<a name="l02930"></a>02930   order[0] = sidemax;
<a name="l02931"></a>02931   order[1] = nextside;
<a name="l02932"></a>02932   count = 2;
<a name="l02933"></a>02933   <span class="keywordflow">for</span> (i = 0; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02934"></a>02934     <span class="keywordflow">if</span> (i != sidemax &amp;&amp; i!=nextside){
<a name="l02935"></a>02935       order[count]= i;
<a name="l02936"></a>02936       count++;
<a name="l02937"></a>02937     }
<a name="l02938"></a>02938   }
<a name="l02939"></a>02939   
<a name="l02940"></a>02940   *neworder = order;
<a name="l02941"></a>02941   
<a name="l02942"></a>02942   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02943"></a>02943 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gb659e74e602507081f3ea7d7b26eafab"></a><!-- doxytag: member="shape.c::fc_createLargeAndOpposingSidesOrder" ref="gb659e74e602507081f3ea7d7b26eafab" args="(FC_Shape *shape, double maxangle, int **neworder)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_createLargeAndOpposingSidesOrder           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>maxangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neworder</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
As an approximation to obtaining the major sides of a thin shape, given a shape returns an array of the side ids in the ordered desired for a shape with a large and opposing side. 
<p>
<b>Description:</b> <p>
As an approximation to obtaining the major sides of a thin shape, given a shape returns an array of the side ids in the ordered desired for a shape with a large and opposing side. A thin shape is a shape that in some dimension is narrow and in a roughly perpendicular direction has a pair of large opposing sides, which are the major sides that the user is interested in. The thin shape order would then have those major sides in the 0th and 1st position, with all other sides in random order. This can then be fed into <a class="el" href="group__Shape.html#g2e06fed57b8dac98cac3f52481a7f21c">fc_reorderShape</a>.<p>
This method uses simplifying assumtions to get the major sides, which may not be correct in all cases. This method will iterate through the sides, starting with the largest one and attempt to find the the largest non-adjacent side for which the angle between the mean of the normals of each face for each side is in the range (180- the input angle) to 180. Currently, there is no restriction on the size of the sides relative to one another.<p>
Note that there can be undesirable results for some shapes - see <a class="el" href="group__Shape.html#g7a2a66886ce110aa18616af7cbe7de0c">fc_getSideNormalMeanSdev</a> for comments onthe limitations of the mean of the normals and angle calculation. See also <a class="el" href="group__Shape.html#gf9d1244014996a75fb574936bca1f47b">fc_createLargeAndNonAdjacentSidesOrder</a> for another approximation to the ideal thin shape order.<p>
Note that there are no chekcs for unique sides like there are in the largeandnonadj side method. (that is, when there are multiple side options with the same area)<p>
Returns with an error if there is something fundamentally wrong. Returns FC_SUCCESS but empty order array if the shape does not satisfy the large opposing sides criteria.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000082">Todo:</a></b></dt><dd><ul>
<li>there are no checks on uniqueness in here like there are in non-adj side, prob want to put those in.</li><li>make sure both sides are large? add an arg that also limits the ration of the sides relative to each other ?</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>08/04/06 ACG created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - shape </td></tr>
<tr><td valign="top"><em>maxangle</em>&nbsp;</td><td>
input - opposing angle range </td></tr>
<tr><td valign="top"><em>neworder</em>&nbsp;</td><td>
output - ids of sides </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03005">3005</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="geom_8c-source.html#l00215">fc_calcAngleBetweenVectors()</a>, <a class="el" href="shape_8c-source.html#l02669">fc_createDescendingAreaOrder()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="shape_8c-source.html#l04008">fc_getSideNormalMeanSdev()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="tears_8c-source.html#l00640">createShapeWOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03009"></a>03009     {
<a name="l03010"></a>03010 
<a name="l03011"></a>03011   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l03012"></a>03012   <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a>* mean;
<a name="l03013"></a>03013   <span class="keywordtype">int</span> numSides;
<a name="l03014"></a>03014   <span class="keywordtype">int</span> *order;
<a name="l03015"></a>03015   <span class="keywordtype">int</span> currside, compside;
<a name="l03016"></a>03016   <span class="keywordtype">double</span> angle;
<a name="l03017"></a>03017   <span class="keywordtype">int</span> found = 0;
<a name="l03018"></a>03018   <span class="keywordtype">int</span> i,j;
<a name="l03019"></a>03019 
<a name="l03020"></a>03020   <span class="comment">//defaults</span>
<a name="l03021"></a>03021   <span class="keywordflow">if</span> (neworder)
<a name="l03022"></a>03022     *neworder = NULL;
<a name="l03023"></a>03023 
<a name="l03024"></a>03024   <span class="keywordflow">if</span> (!shape ||  !neworder || maxangle &lt; 0 || maxangle &gt; 180){
<a name="l03025"></a>03025     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03026"></a>03026     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03027"></a>03027   }
<a name="l03028"></a>03028 
<a name="l03029"></a>03029   <span class="comment">// log message</span>
<a name="l03030"></a>03030   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting large opposing sides order"</span>);
<a name="l03031"></a>03031 
<a name="l03032"></a>03032   numSides = shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l03033"></a>03033 
<a name="l03034"></a>03034   <span class="comment">//must be at least 3 sides for this to do anything</span>
<a name="l03035"></a>03035   <span class="keywordflow">if</span> (numSides &lt; 3){
<a name="l03036"></a>03036     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"shape must have at least 3 sides to have opposing sides/thin shape"</span>);
<a name="l03037"></a>03037     <span class="comment">//    return FC_INPUT_ERROR;</span>
<a name="l03038"></a>03038     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;<span class="comment">//null return</span>
<a name="l03039"></a>03039   }
<a name="l03040"></a>03040 
<a name="l03041"></a>03041   rc = <a class="code" href="group__Shape.html#g07d6ca065cd2797eb5f921c8ad2e9be0" title="given a shape returns an array of the side ids in descending face area order">fc_createDescendingAreaOrder</a>(shape,&amp;order);
<a name="l03042"></a>03042   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03043"></a>03043     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get ascending area order"</span>);
<a name="l03044"></a>03044     <span class="keywordflow">return</span> rc;
<a name="l03045"></a>03045   }
<a name="l03046"></a>03046 
<a name="l03047"></a>03047   mean = (<a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a>*)malloc((shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>)*<span class="keyword">sizeof</span>(<a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a>));
<a name="l03048"></a>03048   <span class="keywordflow">if</span> (!mean){
<a name="l03049"></a>03049     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03050"></a>03050     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03051"></a>03051   }
<a name="l03052"></a>03052 
<a name="l03053"></a>03053   <span class="keywordflow">for</span> (i = 0; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l03054"></a>03054     <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> junk;
<a name="l03055"></a>03055     rc = <a class="code" href="group__Shape.html#g7a2a66886ce110aa18616af7cbe7de0c" title="Given a shape and a sideid, returns the outward normal and std in each direction...">fc_getSideNormalMeanSdev</a>(shape,i,&amp;mean[i],&amp;junk);
<a name="l03056"></a>03056     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03057"></a>03057       free(mean);
<a name="l03058"></a>03058       <span class="keywordflow">return</span> rc;
<a name="l03059"></a>03059     }
<a name="l03060"></a>03060   }
<a name="l03061"></a>03061 
<a name="l03062"></a>03062 
<a name="l03063"></a>03063   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l03064"></a>03064     currside = order[i];
<a name="l03065"></a>03065     <span class="keywordflow">for</span> (j = i+1; j &lt; numSides; j++){
<a name="l03066"></a>03066       compside = order[j];
<a name="l03067"></a>03067       <span class="keywordflow">if</span> (!shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[currside][compside]){
<a name="l03068"></a>03068      rc = <a class="code" href="group__GeometricRelations.html#g30ce3387c782c3d8a74fb0075168bca0" title="Determine angle between two vectors.">fc_calcAngleBetweenVectors</a>(mean[currside],mean[compside],
<a name="l03069"></a>03069                          &amp;angle);
<a name="l03070"></a>03070      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03071"></a>03071        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get angle between vectors"</span>);
<a name="l03072"></a>03072        free(mean);
<a name="l03073"></a>03073        free(order);
<a name="l03074"></a>03074        <span class="keywordflow">return</span> rc;
<a name="l03075"></a>03075      }
<a name="l03076"></a>03076      <span class="keywordflow">if</span> (angle &gt;= (180-maxangle)){
<a name="l03077"></a>03077        found = 1;
<a name="l03078"></a>03078        <span class="keywordflow">break</span>;
<a name="l03079"></a>03079      }
<a name="l03080"></a>03080       }
<a name="l03081"></a>03081     }
<a name="l03082"></a>03082     <span class="keywordflow">if</span> (found){
<a name="l03083"></a>03083       <span class="keywordflow">break</span>;
<a name="l03084"></a>03084     }
<a name="l03085"></a>03085   }
<a name="l03086"></a>03086 
<a name="l03087"></a>03087   free(mean);
<a name="l03088"></a>03088 
<a name="l03089"></a>03089   <span class="keywordflow">if</span> (found){
<a name="l03090"></a>03090     <span class="keywordtype">int</span> count = 2;
<a name="l03091"></a>03091     order[0] = currside;
<a name="l03092"></a>03092     order[1] = compside;
<a name="l03093"></a>03093     <span class="comment">//now we have our sides fill in all other ones randomly</span>
<a name="l03094"></a>03094     <span class="keywordflow">for</span> (i = 0; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l03095"></a>03095       <span class="keywordflow">if</span> (i != currside &amp;&amp; i != compside){
<a name="l03096"></a>03096      order[count] = i;
<a name="l03097"></a>03097      count++;
<a name="l03098"></a>03098       }
<a name="l03099"></a>03099     }
<a name="l03100"></a>03100    
<a name="l03101"></a>03101     *neworder = order;
<a name="l03102"></a>03102   }<span class="keywordflow">else</span>{
<a name="l03103"></a>03103     <span class="comment">//not a large opposing sides shape, null return</span>
<a name="l03104"></a>03104     free(order);
<a name="l03105"></a>03105   }
<a name="l03106"></a>03106 
<a name="l03107"></a>03107   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03108"></a>03108 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g4c1cad04e96980564d0fade1f5fbf069"></a><!-- doxytag: member="shape.c::fc_createScrewShapeOrder" ref="g4c1cad04e96980564d0fade1f5fbf069" args="(FC_Shape *shape, int **neworder)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_createScrewShapeOrder           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>neworder</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a shape, returns the reordering array for a screw 
<p>
<b>Description:</b> <p>
Given a shape, returns the reordering array for a screw. It returns the sides in the following order: head plane, head cylinder, middle plane, base cylinder, base plane (I've made up these names)<p>
If the shape does not satisfy the screw criteria, the method returns FC_SUCCESS but a NULL order array. These cases are shapes without 5 sides or those whose adjacency matricies don't fit the screw adjmatrix pattern. Some non-screw things in theory could slip through the testing cracks. It is up to the user to make sure he uses this in the right way.<p>
<b>Modifications:</b> <ul>
<li>06/18/06 ACG created</li><li>07/19/06 ACG changed so if the shape is not a screw it returns FC_SUCCESS but an empty order array. Only returns FC_ERROR if there is an actual error.</li><li>08/06/06 ACG more of the above - for if not 5 sided figure. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - shape </td></tr>
<tr><td valign="top"><em>neworder</em>&nbsp;</td><td>
output - order array </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02520">2520</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="geom_8c-source.html#l04344">fc_getSubsetArea()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="tears_8c-source.html#l00640">createShapeWOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02523"></a>02523   {
<a name="l02524"></a>02524 
<a name="l02525"></a>02525   <span class="comment">//head plane has 1 adj side</span>
<a name="l02526"></a>02526   <span class="comment">//base plane has 1 adj side</span>
<a name="l02527"></a>02527   <span class="comment">//head cylinder is adj to the head plane and the mid plane</span>
<a name="l02528"></a>02528   <span class="comment">//base cylinder is adj to the base plane and the mid plane</span>
<a name="l02529"></a>02529   <span class="comment">//mid plane is adj to the base cylinder and the head cylinder</span>
<a name="l02530"></a>02530   <span class="comment">//head plane has greater area than base plane</span>
<a name="l02531"></a>02531 
<a name="l02532"></a>02532   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02533"></a>02533 
<a name="l02534"></a>02534   <span class="keywordtype">int</span> endcount = 0;
<a name="l02535"></a>02535   <span class="keywordtype">int</span> othercount = 0;
<a name="l02536"></a>02536   <span class="keywordtype">int</span> endoptions[5], otheroptions[5];
<a name="l02537"></a>02537   <span class="keywordtype">double</span> areas[2];
<a name="l02538"></a>02538   <span class="keywordtype">int</span> *order;
<a name="l02539"></a>02539   <span class="keywordtype">int</span> nSides;
<a name="l02540"></a>02540   <span class="keywordtype">int</span> i,j;
<a name="l02541"></a>02541 
<a name="l02542"></a>02542 
<a name="l02543"></a>02543 
<a name="l02544"></a>02544   <span class="comment">//defaults</span>
<a name="l02545"></a>02545   <span class="keywordflow">if</span> (neworder)
<a name="l02546"></a>02546     *neworder = NULL;
<a name="l02547"></a>02547 
<a name="l02548"></a>02548   <span class="keywordflow">if</span> (!shape || !neworder){
<a name="l02549"></a>02549     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02550"></a>02550     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02551"></a>02551   }
<a name="l02552"></a>02552 
<a name="l02553"></a>02553   <span class="comment">// log message</span>
<a name="l02554"></a>02554   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting screwshape order"</span>);
<a name="l02555"></a>02555 
<a name="l02556"></a>02556   nSides = shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l02557"></a>02557   <span class="keywordflow">if</span> (nSides != 5){
<a name="l02558"></a>02558     <span class="comment">//success but null return</span>
<a name="l02559"></a>02559     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02560"></a>02560   }
<a name="l02561"></a>02561 
<a name="l02562"></a>02562   order = (<span class="keywordtype">int</span>*)malloc(5*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02563"></a>02563   <span class="keywordflow">if</span> (!order){
<a name="l02564"></a>02564     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02565"></a>02565     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02566"></a>02566   }
<a name="l02567"></a>02567 
<a name="l02568"></a>02568   <span class="keywordflow">for</span> (i = 0; i &lt; nSides; i++){
<a name="l02569"></a>02569     <span class="keywordtype">int</span> count = 0;
<a name="l02570"></a>02570 
<a name="l02571"></a>02571     <span class="comment">//can initialize these here because endcount and othercount</span>
<a name="l02572"></a>02572     <span class="comment">//cant exceed i</span>
<a name="l02573"></a>02573     order[i] = -1;
<a name="l02574"></a>02574     endoptions[i] = -1;
<a name="l02575"></a>02575     otheroptions[i] = -1;
<a name="l02576"></a>02576 
<a name="l02577"></a>02577     <span class="keywordflow">for</span> (j = 0; j &lt; nSides; j++){ 
<a name="l02578"></a>02578       <span class="comment">//      printf(" %d",shape-&gt;adjmatrix[i][j]);</span>
<a name="l02579"></a>02579       <span class="comment">//check matrix for symmetry</span>
<a name="l02580"></a>02580       <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] != shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[j][i]){
<a name="l02581"></a>02581      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"adj matrix not symmetric"</span>);
<a name="l02582"></a>02582      free(order);
<a name="l02583"></a>02583      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>; 
<a name="l02584"></a>02584       }
<a name="l02585"></a>02585       <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j]) count++; <span class="comment">//count the adjacencies</span>
<a name="l02586"></a>02586     }
<a name="l02587"></a>02587     <span class="comment">//    printf("\n");</span>
<a name="l02588"></a>02588     <span class="keywordflow">if</span> (count == 1){
<a name="l02589"></a>02589       <span class="comment">//its the base plane or top plane</span>
<a name="l02590"></a>02590       endoptions[endcount++] = i;
<a name="l02591"></a>02591       <span class="comment">//      printf("end - %d\n",i);</span>
<a name="l02592"></a>02592     }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (count == 2){
<a name="l02593"></a>02593       <span class="comment">//its the top cylinder, base cylinder, or middle plane</span>
<a name="l02594"></a>02594       otheroptions[othercount++] = i;
<a name="l02595"></a>02595       <span class="comment">//      printf("other - %d\n",i);</span>
<a name="l02596"></a>02596     }<span class="keywordflow">else</span> {
<a name="l02597"></a>02597       <span class="comment">//this is an invalid shape</span>
<a name="l02598"></a>02598       <span class="comment">//      fc_printfErrorMessage("Invalid screw shape");</span>
<a name="l02599"></a>02599       free(order);
<a name="l02600"></a>02600       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">//not a screw, null return</span>
<a name="l02601"></a>02601     }
<a name="l02602"></a>02602   }
<a name="l02603"></a>02603       
<a name="l02604"></a>02604   <span class="keywordflow">if</span> (endcount != 2 || othercount != 3){
<a name="l02605"></a>02605     <span class="comment">//    fc_printfErrorMessage("Invalid screw shape");</span>
<a name="l02606"></a>02606     free(order);
<a name="l02607"></a>02607     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">// not a screw</span>
<a name="l02608"></a>02608   }
<a name="l02609"></a>02609 
<a name="l02610"></a>02610   <span class="comment">//determine ends</span>
<a name="l02611"></a>02611   <span class="keywordflow">for</span>(i = 0; i &lt; endcount; i++){ <span class="comment">//endcount is 2</span>
<a name="l02612"></a>02612     rc = <a class="code" href="group__GeometricRelations.html#gfd4c940dc417f742e067c8a706cd5563" title="Returns a variable with the area of the subset.">fc_getSubsetArea</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[endoptions[i]],&amp;(areas[i]));
<a name="l02613"></a>02613     <span class="keywordflow">if</span> (rc !=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02614"></a>02614       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get areas"</span>);
<a name="l02615"></a>02615       free(order);
<a name="l02616"></a>02616       <span class="keywordflow">return</span> rc;
<a name="l02617"></a>02617     }
<a name="l02618"></a>02618   }
<a name="l02619"></a>02619 
<a name="l02620"></a>02620   i = (areas[0] &gt; areas[1] ? 0:1);
<a name="l02621"></a>02621   order[0] = endoptions[i];
<a name="l02622"></a>02622   order[4] = endoptions[!i];
<a name="l02623"></a>02623 
<a name="l02624"></a>02624 
<a name="l02625"></a>02625   <span class="comment">//determine cylinders and midplane</span>
<a name="l02626"></a>02626   <span class="keywordflow">for</span> (i = 0; i &lt; othercount; i++){
<a name="l02627"></a>02627     <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[otheroptions[i]][order[0]] == 1){
<a name="l02628"></a>02628       order[1] = otheroptions[i];
<a name="l02629"></a>02629     }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[otheroptions[i]][order[4]] == 1){
<a name="l02630"></a>02630       order[3] = otheroptions[i];
<a name="l02631"></a>02631     }<span class="keywordflow">else</span> {
<a name="l02632"></a>02632       order[2] = otheroptions[i];
<a name="l02633"></a>02633     }
<a name="l02634"></a>02634   }
<a name="l02635"></a>02635 
<a name="l02636"></a>02636   <span class="comment">//check midplane adjacencies</span>
<a name="l02637"></a>02637   <span class="keywordflow">if</span> ((shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[order[2]][order[1]] != 1) ||
<a name="l02638"></a>02638       shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[order[2]][order[3]] != 1){
<a name="l02639"></a>02639     <span class="comment">//    fc_printfErrorMessage("invalid screw shape");</span>
<a name="l02640"></a>02640     free(order);
<a name="l02641"></a>02641     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; <span class="comment">//not a screw, null return</span>
<a name="l02642"></a>02642   }
<a name="l02643"></a>02643 
<a name="l02644"></a>02644   *neworder = order;
<a name="l02645"></a>02645 
<a name="l02646"></a>02646   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02647"></a>02647 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g4b10e29509f918bfe429c8c7420ea679"></a><!-- doxytag: member="shape.c::fc_createSideAdjacencyMatrix" ref="g4b10e29509f918bfe429c8c7420ea679" args="(int numSubsets, FC_Subset *subsets, int shared_dim, int ***intmatrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_createSideAdjacencyMatrix           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numSubsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int ***&nbsp;</td>
          <td class="paramname"> <em>intmatrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given an array of subsets specifying the faces of each side of a shape, returns a matrix specifying the side adjacencies. 
<p>
<b>Description:</b> <p>
Given an array n of subsets, specifying the side faces returns an nxn matrix of 1s and 0s depending on whether or not the sides are adjacenct. Have opted to make the diagonal elements 0. Note that the shapecreating methods automatically create adjacency matricies in a somewhat different way.<p>
If any of the subsets are empty or NULL, this method returns with an error.<p>
<b>Modifications:</b> <ul>
<li>02/07/06 ACG created.to handle the screw case.</li><li>02/08/06 ACG unittest added.</li><li>02/08/06 ACG found another flaw in the logic of old adjacencyMatrix test. Therefore removed old version entirely. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numSubsets</em>&nbsp;</td><td>
input - number of input subsets </td></tr>
<tr><td valign="top"><em>subsets</em>&nbsp;</td><td>
input - array of face subsets </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - shared dim for determining neighbors </td></tr>
<tr><td valign="top"><em>intmatrix</em>&nbsp;</td><td>
output - 1/0 matrix </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03142">3142</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="subset_8c-source.html#l02064">fc_addArrayMembersToSubset()</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="subset_8c-source.html#l01684">fc_doSubsetsIntersect()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02902">fc_getSubsetAssociationType()</a>, <a class="el" href="topo_8c-source.html#l00603">fc_getSubsetNeighbors()</a>, <a class="el" href="subset_8c-source.html#l02828">fc_getSubsetNumMember()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03147"></a>03147   {
<a name="l03148"></a>03148   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l03149"></a>03149   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l03150"></a>03150   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l03151"></a>03151   <span class="keywordtype">int</span> i,j,k;
<a name="l03152"></a>03152   
<a name="l03153"></a>03153   <span class="comment">//default return</span>
<a name="l03154"></a>03154   <span class="keywordflow">if</span> (intmatrix)
<a name="l03155"></a>03155     *intmatrix = NULL;
<a name="l03156"></a>03156 
<a name="l03157"></a>03157   <span class="keywordflow">if</span> (!numSubsets || !subsets || !intmatrix || !(shared_dim == 1 || shared_dim == 0)){
<a name="l03158"></a>03158     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03159"></a>03159     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03160"></a>03160   }
<a name="l03161"></a>03161 
<a name="l03162"></a>03162   <span class="comment">//check that all the subsets are valid</span>
<a name="l03163"></a>03163   <span class="keywordflow">for</span> (i = 0; i &lt; numSubsets; i++){
<a name="l03164"></a>03164     <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(subsets[i])){
<a name="l03165"></a>03165       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03166"></a>03166       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03167"></a>03167     }
<a name="l03168"></a>03168     rc = <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(subsets[i], &amp;assoc);
<a name="l03169"></a>03169     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l03170"></a>03170       <span class="keywordflow">return</span> rc;
<a name="l03171"></a>03171 
<a name="l03172"></a>03172     <span class="keywordflow">if</span> (assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>){
<a name="l03173"></a>03173       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Wrong assoc type"</span>);
<a name="l03174"></a>03174       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03175"></a>03175     }
<a name="l03176"></a>03176 
<a name="l03177"></a>03177     rc= <a class="code" href="group__Subset.html#gdf7851470403bb379426110abf7923ba" title="Get number of members in a subset.">fc_getSubsetNumMember</a>(subsets[i], &amp;k);
<a name="l03178"></a>03178     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l03179"></a>03179       <span class="keywordflow">return</span> rc;
<a name="l03180"></a>03180 
<a name="l03181"></a>03181     <span class="keywordflow">if</span> (k &lt; 1){
<a name="l03182"></a>03182       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"sides must have at least one member"</span>);
<a name="l03183"></a>03183       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03184"></a>03184     }
<a name="l03185"></a>03185     
<a name="l03186"></a>03186   }
<a name="l03187"></a>03187 
<a name="l03188"></a>03188   <span class="comment">// log message</span>
<a name="l03189"></a>03189   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing Side Adjacency Matrix"</span>);
<a name="l03190"></a>03190 
<a name="l03191"></a>03191   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(subsets[0],&amp;mesh);
<a name="l03192"></a>03192   <span class="keywordflow">if</span> (rc !=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03193"></a>03193     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get mesh from subset"</span>);
<a name="l03194"></a>03194     <span class="keywordflow">return</span> rc;
<a name="l03195"></a>03195   }
<a name="l03196"></a>03196 
<a name="l03197"></a>03197 
<a name="l03198"></a>03198   <span class="comment">// create space for the adj array, initialize to zero</span>
<a name="l03199"></a>03199   *intmatrix = calloc(numSubsets, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l03200"></a>03200   <span class="keywordflow">if</span> (*intmatrix == NULL) {
<a name="l03201"></a>03201     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03202"></a>03202     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03203"></a>03203   }
<a name="l03204"></a>03204   <span class="keywordflow">for</span> (i = 0; i &lt; numSubsets; i++) {
<a name="l03205"></a>03205     (*intmatrix)[i] = calloc(numSubsets, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03206"></a>03206     <span class="keywordflow">if</span> ((*intmatrix)[i] == NULL) {
<a name="l03207"></a>03207       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03208"></a>03208       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03209"></a>03209     }
<a name="l03210"></a>03210   }
<a name="l03211"></a>03211 
<a name="l03212"></a>03212   <span class="keywordflow">for</span> (i = 0; i &lt; numSubsets; i++){
<a name="l03213"></a>03213     <span class="keywordtype">int</span> numNbr, *nbrIDs;
<a name="l03214"></a>03214     <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> neighborfaces;
<a name="l03215"></a>03215 
<a name="l03216"></a>03216     <span class="comment">//    printf("determining adj for subset %d\n",i);</span>
<a name="l03217"></a>03217 
<a name="l03218"></a>03218     (*intmatrix)[i][i] = 0;
<a name="l03219"></a>03219 
<a name="l03220"></a>03220 
<a name="l03221"></a>03221     <span class="comment">//get the face neighbors for this subset</span>
<a name="l03222"></a>03222     <span class="comment">//    printf("getting subset neighbors\n");</span>
<a name="l03223"></a>03223     rc = <a class="code" href="group__TopologyRelations.html#g90b1b90dfd00245a14d585f3b7f0bf6d" title="Get the neighbors of a subset.">fc_getSubsetNeighbors</a>(subsets[i], 1, shared_dim, &amp;assoc, &amp;numNbr, &amp;nbrIDs);
<a name="l03224"></a>03224     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>){
<a name="l03225"></a>03225       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to get subset neighbors"</span>);
<a name="l03226"></a>03226       <span class="keywordflow">for</span> (k = 0; k &lt; numSubsets; k++){
<a name="l03227"></a>03227      free((*intmatrix)[k]);
<a name="l03228"></a>03228       }
<a name="l03229"></a>03229       free((*intmatrix));
<a name="l03230"></a>03230       (*intmatrix) = NULL;
<a name="l03231"></a>03231       <span class="keywordflow">return</span> rc;
<a name="l03232"></a>03232     }
<a name="l03233"></a>03233 
<a name="l03234"></a>03234     rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh,<span class="stringliteral">"temp"</span>,<a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>,&amp;neighborfaces);
<a name="l03235"></a>03235     <span class="keywordflow">if</span> (rc !=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03236"></a>03236       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant create subset"</span>);
<a name="l03237"></a>03237       <span class="keywordflow">for</span> (k = 0; k &lt; numSubsets; k++){
<a name="l03238"></a>03238      free((*intmatrix)[k]);
<a name="l03239"></a>03239       }
<a name="l03240"></a>03240       free((*intmatrix));
<a name="l03241"></a>03241       (*intmatrix) = NULL;
<a name="l03242"></a>03242       free(nbrIDs);
<a name="l03243"></a>03243       <span class="keywordflow">return</span> rc;
<a name="l03244"></a>03244     }
<a name="l03245"></a>03245     
<a name="l03246"></a>03246     <span class="comment">//    printf("Adding array members to subset\n");</span>
<a name="l03247"></a>03247     rc = <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(neighborfaces,numNbr,nbrIDs);
<a name="l03248"></a>03248     <span class="keywordflow">if</span> (rc !=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03249"></a>03249       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant create subset"</span>);
<a name="l03250"></a>03250       <span class="keywordflow">for</span> (k = 0; k &lt; numSubsets; k++){
<a name="l03251"></a>03251      free((*intmatrix)[k]);
<a name="l03252"></a>03252       }
<a name="l03253"></a>03253       free((*intmatrix));
<a name="l03254"></a>03254       (*intmatrix) = NULL;
<a name="l03255"></a>03255       <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(neighborfaces);
<a name="l03256"></a>03256       free(nbrIDs);
<a name="l03257"></a>03257       <span class="keywordflow">return</span> rc;
<a name="l03258"></a>03258     }
<a name="l03259"></a>03259     free(nbrIDs);
<a name="l03260"></a>03260     <span class="comment">//    printf("done adding array members to subset\n");</span>
<a name="l03261"></a>03261 
<a name="l03262"></a>03262     <span class="keywordflow">for</span> (j = i+1; j &lt; numSubsets; j++){ <span class="comment">//symmetric result</span>
<a name="l03263"></a>03263       <span class="keywordtype">int</span> retval;
<a name="l03264"></a>03264       <span class="comment">//      printf("checking intersection\n");</span>
<a name="l03265"></a>03265       rc = <a class="code" href="group__Subset.html#gb7080f044773d103b850e93c3e023a44" title="Test if two subsets intersect.">fc_doSubsetsIntersect</a>(neighborfaces,subsets[j], &amp;retval);
<a name="l03266"></a>03266       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03267"></a>03267         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to get subset intersection"</span>);
<a name="l03268"></a>03268      <span class="keywordflow">for</span> (k = 0; k &lt; numSubsets; k++){
<a name="l03269"></a>03269        free((*intmatrix)[k]);
<a name="l03270"></a>03270      }
<a name="l03271"></a>03271      free((*intmatrix));
<a name="l03272"></a>03272      (*intmatrix) = NULL;
<a name="l03273"></a>03273      <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(neighborfaces);
<a name="l03274"></a>03274      <span class="keywordflow">return</span> rc;
<a name="l03275"></a>03275       }
<a name="l03276"></a>03276       (*intmatrix)[i][j] = retval;
<a name="l03277"></a>03277       (*intmatrix)[j][i] = retval;
<a name="l03278"></a>03278     }
<a name="l03279"></a>03279     <span class="comment">//    printf("done checking intersection\n");</span>
<a name="l03280"></a>03280 
<a name="l03281"></a>03281     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(neighborfaces);
<a name="l03282"></a>03282   }
<a name="l03283"></a>03283 
<a name="l03284"></a>03284   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03285"></a>03285 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfb8474857a22e70a547b5e7875dc9c19"></a><!-- doxytag: member="shape.c::fc_freeShape" ref="gfb8474857a22e70a547b5e7875dc9c19" args="(FC_Shape *fcss)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_freeShape           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>fcss</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
frees a Shape 
<p>
<b>Description:</b> <p>
Deallocate contents of an <a class="el" href="structFC__Shape.html">FC_Shape</a>.<p>
<b>Modifications:</b> <ul>
<li>06/04/06 ACG created</li><li>07/13/06 ACG renamed from freeShape</li><li>07/16/06 removed "skin" from name </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fcss</em>&nbsp;</td><td>
input - the shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02320">2320</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>, <a class="el" href="shape_8c-source.html#l02098">fc_copyShape()</a>, <a class="el" href="shape_8c-source.html#l01725">fc_reduceShapeNumSides()</a>, <a class="el" href="tears_8c-source.html#l00624">freeShapeWOrder_ShapeOnly()</a>, and <a class="el" href="elemdeath__ex1_8c-source.html#l00147">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02322"></a>02322  {
<a name="l02323"></a>02323   <span class="keywordtype">int</span> i;
<a name="l02324"></a>02324   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02325"></a>02325 
<a name="l02326"></a>02326   <span class="keywordflow">if</span> (!fcss){
<a name="l02327"></a>02327     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02328"></a>02328     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02329"></a>02329   }
<a name="l02330"></a>02330 
<a name="l02331"></a>02331   <span class="keywordflow">for</span> (i = 0; i &lt; fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02332"></a>02332     rc = <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i]);
<a name="l02333"></a>02333     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02334"></a>02334       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't free face %d"</span>,i);
<a name="l02335"></a>02335       <span class="keywordflow">return</span> rc;
<a name="l02336"></a>02336     }
<a name="l02337"></a>02337     rc = <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i]);
<a name="l02338"></a>02338     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02339"></a>02339       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't free elems %d"</span>,i);
<a name="l02340"></a>02340       <span class="keywordflow">return</span> rc;
<a name="l02341"></a>02341     }
<a name="l02342"></a>02342     free(fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i]);
<a name="l02343"></a>02343   }
<a name="l02344"></a>02344   free(fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>);
<a name="l02345"></a>02345   free(fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>);
<a name="l02346"></a>02346   free(fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>);
<a name="l02347"></a>02347   fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>= NULL;
<a name="l02348"></a>02348   fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>= NULL;
<a name="l02349"></a>02349   fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>= NULL;
<a name="l02350"></a>02350   fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = 0;
<a name="l02351"></a>02351 
<a name="l02352"></a>02352   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02353"></a>02353 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g89c155b43d6f766ebc54f0049df31dec"></a><!-- doxytag: member="shape.c::fc_getMeshShapes" ref="g89c155b43d6f766ebc54f0049df31dec" args="(FC_Mesh mesh, double comp_angle, int shared_dim, int *numShapes, FC_Shape **shapes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getMeshShapes           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>comp_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numShapes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> **&nbsp;</td>
          <td class="paramname"> <em>shapes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a mesh, returns an array of FC_Shapes 
<p>
<b>Description:</b> <p>
given a mesh, returns an array of <a class="el" href="structFC__Shape.html">FC_Shape</a>. This is the mesh version of <a class="el" href="group__Shape.html#g390c8304bc716ff39e4ef3c63657a6f5">fc_getSubsetShapes</a>. See notes there.<p>
<b>Modifications:</b> <ul>
<li>6/04/06 ACG created</li><li>7/16/06 ACG removed "skin" in name </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>comp_angle</em>&nbsp;</td><td>
input - if two neighboring faces differ by more than this angle then they are considered to be on different surfaces. </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - the minimum dimensionality of shared part of neighbors of faces </td></tr>
<tr><td valign="top"><em>numShapes</em>&nbsp;</td><td>
output - number of shapes </td></tr>
<tr><td valign="top"><em>shapes</em>&nbsp;</td><td>
output shapes array </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l01515">1515</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="subset_8c-source.html#l02008">fc_addMemberToSubset()</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="mesh_8c-source.html#l02762">fc_getMeshName()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="shape_8c-source.html#l01339">fc_getSubsetShapes()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="elemdeath__ex1_8c-source.html#l00147">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01525"></a>01525  {
<a name="l01526"></a>01526   
<a name="l01527"></a>01527   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01528"></a>01528   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> temp_subset;
<a name="l01529"></a>01529   <span class="keywordtype">char</span> *meshname;
<a name="l01530"></a>01530 
<a name="l01531"></a>01531   <span class="comment">//---default return values</span>
<a name="l01532"></a>01532   <span class="keywordflow">if</span> (numShapes)
<a name="l01533"></a>01533     *numShapes = -1;
<a name="l01534"></a>01534   <span class="keywordflow">if</span> (shapes)
<a name="l01535"></a>01535     *shapes = NULL;
<a name="l01536"></a>01536 
<a name="l01537"></a>01537   <span class="comment">//check input - some checked in sides</span>
<a name="l01538"></a>01538   <span class="keywordflow">if</span>(!numShapes || !shapes){
<a name="l01539"></a>01539     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>,<a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01540"></a>01540     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01541"></a>01541   }
<a name="l01542"></a>01542 
<a name="l01543"></a>01543   <span class="comment">// log message</span>
<a name="l01544"></a>01544   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"getting mesh shapes"</span>);
<a name="l01545"></a>01545 
<a name="l01546"></a>01546   <span class="comment">//does all error checking except is mesh valid inside _fc_getSubsetShapes</span>
<a name="l01547"></a>01547   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh)){
<a name="l01548"></a>01548     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01549"></a>01549     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01550"></a>01550   }
<a name="l01551"></a>01551 
<a name="l01552"></a>01552   <span class="comment">// create a temp subset which is the whole mesh &amp; call fc_getSubsetShapes</span>
<a name="l01553"></a>01553   rc = <a class="code" href="group__Mesh.html#g3d701a44941883311e4940d7d3b4146a" title="Return name of a mesh.">fc_getMeshName</a>(mesh,&amp;meshname);
<a name="l01554"></a>01554   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l01555"></a>01555     <span class="keywordflow">return</span> rc;
<a name="l01556"></a>01556 
<a name="l01557"></a>01557   rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh, meshname, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>, &amp;temp_subset);
<a name="l01558"></a>01558   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01559"></a>01559      <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(temp_subset);
<a name="l01560"></a>01560      free(meshname);
<a name="l01561"></a>01561      <span class="keywordflow">return</span> rc;
<a name="l01562"></a>01562   }
<a name="l01563"></a>01563   free(meshname);
<a name="l01564"></a>01564 
<a name="l01565"></a>01565   rc = <a class="code" href="group__Subset.html#g5ed37876a6f144458716efed8cb78dbe" title="Add member to a subset.">fc_addMemberToSubset</a>(temp_subset, 0);
<a name="l01566"></a>01566   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01567"></a>01567      <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(temp_subset);
<a name="l01568"></a>01568      <span class="keywordflow">return</span> rc;
<a name="l01569"></a>01569   }
<a name="l01570"></a>01570 
<a name="l01571"></a>01571    <span class="comment">// do it</span>
<a name="l01572"></a>01572   rc = <a class="code" href="group__Shape.html#g390c8304bc716ff39e4ef3c63657a6f5" title="given a subset, returns an array of FC_Shapes">fc_getSubsetShapes</a>(temp_subset, comp_angle,shared_dim,numShapes,
<a name="l01573"></a>01573                      shapes);
<a name="l01574"></a>01574   <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(temp_subset);
<a name="l01575"></a>01575   <span class="keywordflow">return</span> rc;
<a name="l01576"></a>01576 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gc9ab86a7eb1c1ac2780f2493b9219bc3"></a><!-- doxytag: member="shape.c::fc_getPlanarSideNormal" ref="gc9ab86a7eb1c1ac2780f2493b9219bc3" args="(FC_Shape *shape, int sideid, FC_Coords *normal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getPlanarSideNormal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sideid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>normal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given a shape and the ID of a planar side, returns the outward normal to that face. 
<p>
<b>Description:</b> <p>
Given a shape and the ID of a planar side, returns the outward normal to that face. Does not actually test to see if the face is planar.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000085">Todo:</a></b></dt><dd><ul>
<li>decide if need more unittest</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>03/16/06 ACG created.</li><li>08/08/06 ACG changed interface so pass sides in terms of shape rahter than faces and elems. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - the shape </td></tr>
<tr><td valign="top"><em>sideid</em>&nbsp;</td><td>
input - the shape side id </td></tr>
<tr><td valign="top"><em>normal</em>&nbsp;</td><td>
output - normal </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03873">3873</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00750">_fc_getOutwardFaceNormal()</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="topo_8c-source.html#l00116">fc_getMeshEntityChildren()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02902">fc_getSubsetAssociationType()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03877"></a>03877    {
<a name="l03878"></a>03878   
<a name="l03879"></a>03879   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc1, rc2, rc;
<a name="l03880"></a>03880   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh1,mesh2;
<a name="l03881"></a>03881   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc1, assoc2;
<a name="l03882"></a>03882   <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> retvec;
<a name="l03883"></a>03883   <span class="keywordtype">int</span> faceID,elemID;
<a name="l03884"></a>03884   <span class="keywordtype">int</span> numItems;
<a name="l03885"></a>03885   <span class="keywordtype">int</span> *arr;
<a name="l03886"></a>03886   <span class="keywordtype">int</span> i,j;
<a name="l03887"></a>03887 
<a name="l03888"></a>03888   <span class="comment">//default</span>
<a name="l03889"></a>03889   <span class="keywordflow">if</span> (normal){
<a name="l03890"></a>03890     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l03891"></a>03891       (*normal)[i] = 0;
<a name="l03892"></a>03892     }
<a name="l03893"></a>03893   }
<a name="l03894"></a>03894     
<a name="l03895"></a>03895   <span class="keywordflow">if</span> (!shape || (sideid &lt; 0) || (sideid &gt; (shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>)-1) ||
<a name="l03896"></a>03896       !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid]) || 
<a name="l03897"></a>03897       !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid]) || !normal ){
<a name="l03898"></a>03898       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03899"></a>03899       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03900"></a>03900   }
<a name="l03901"></a>03901 
<a name="l03902"></a>03902   rc1 = <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid], &amp;assoc1);
<a name="l03903"></a>03903   rc2 = <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid], &amp;assoc2);
<a name="l03904"></a>03904   <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l03905"></a>03905     <span class="keywordflow">return</span>(rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l03906"></a>03906 
<a name="l03907"></a>03907   <span class="keywordflow">if</span> (assoc1 != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a> || assoc2 != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>){
<a name="l03908"></a>03908     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Wrong assoc type"</span>);
<a name="l03909"></a>03909     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03910"></a>03910   }
<a name="l03911"></a>03911 
<a name="l03912"></a>03912   rc1 = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid],&amp;mesh1);
<a name="l03913"></a>03913   rc2 = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid],&amp;mesh2);
<a name="l03914"></a>03914   <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l03915"></a>03915     <span class="keywordflow">return</span>(rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l03916"></a>03916 
<a name="l03917"></a>03917   <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(mesh1,mesh2)){
<a name="l03918"></a>03918     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"faces and elems must be on same mesh"</span>);
<a name="l03919"></a>03919     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03920"></a>03920   }
<a name="l03921"></a>03921 
<a name="l03922"></a>03922   
<a name="l03923"></a>03923   <span class="comment">//since its planar just pick the first face</span>
<a name="l03924"></a>03924   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid],&amp;numItems,&amp;arr);
<a name="l03925"></a>03925   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03926"></a>03926     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get faces"</span>);
<a name="l03927"></a>03927     <span class="keywordflow">return</span> rc;
<a name="l03928"></a>03928   }
<a name="l03929"></a>03929   <span class="keywordflow">if</span> (numItems &lt; 1){
<a name="l03930"></a>03930     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"must have at least 1 face"</span>);
<a name="l03931"></a>03931     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03932"></a>03932   }
<a name="l03933"></a>03933   faceID = arr[0];
<a name="l03934"></a>03934   free(arr);
<a name="l03935"></a>03935 
<a name="l03936"></a>03936   <span class="comment">//find the elem that gave rise to it - can be only one.</span>
<a name="l03937"></a>03937   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid],&amp;numItems,&amp;arr);
<a name="l03938"></a>03938   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03939"></a>03939     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get elems"</span>);
<a name="l03940"></a>03940     <span class="keywordflow">return</span> rc;
<a name="l03941"></a>03941   }
<a name="l03942"></a>03942 
<a name="l03943"></a>03943   elemID = -1;
<a name="l03944"></a>03944   <span class="keywordflow">for</span> (i = 0; i &lt; numItems; i++){
<a name="l03945"></a>03945     <span class="keywordtype">int</span> numChild, *childIDs;
<a name="l03946"></a>03946     rc = <a class="code" href="group__TopologyRelations.html#g08edc0183a4bb0e44eb226ea75177fd8" title="Get the entities which make up the specified entity.">fc_getMeshEntityChildren</a>(mesh1, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, arr[i], <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>,
<a name="l03947"></a>03947                              &amp;numChild, &amp;childIDs);
<a name="l03948"></a>03948     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03949"></a>03949       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant get elem-&gt;face data"</span>);
<a name="l03950"></a>03950       free(arr);
<a name="l03951"></a>03951       <span class="keywordflow">return</span> rc;
<a name="l03952"></a>03952     }
<a name="l03953"></a>03953     <span class="keywordflow">for</span> (j = 0; j &lt; numChild; j++){
<a name="l03954"></a>03954       <span class="keywordflow">if</span> (childIDs[j] == faceID){
<a name="l03955"></a>03955      elemID = arr[i];
<a name="l03956"></a>03956      <span class="keywordflow">break</span>;
<a name="l03957"></a>03957       }
<a name="l03958"></a>03958     }
<a name="l03959"></a>03959     free(childIDs);
<a name="l03960"></a>03960 
<a name="l03961"></a>03961     <span class="keywordflow">if</span> (elemID != -1){
<a name="l03962"></a>03962       <span class="keywordflow">break</span>;
<a name="l03963"></a>03963     }
<a name="l03964"></a>03964   }
<a name="l03965"></a>03965   free(arr);
<a name="l03966"></a>03966    
<a name="l03967"></a>03967   <span class="keywordflow">if</span> (elemID == -1){
<a name="l03968"></a>03968     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant find elem that gave rise to this face"</span>);
<a name="l03969"></a>03969     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03970"></a>03970   }
<a name="l03971"></a>03971 
<a name="l03972"></a>03972   rc =  <a class="code" href="group__PrivateShape.html#g8d520bfe173ac78fd6e253afc1393e8e" title="Returns outward normal vector for a given face on a given element.">_fc_getOutwardFaceNormal</a>(mesh1,faceID,elemID, &amp;retvec);
<a name="l03973"></a>03973   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03974"></a>03974     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant get outward face normal"</span>);
<a name="l03975"></a>03975     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03976"></a>03976   }
<a name="l03977"></a>03977 
<a name="l03978"></a>03978   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l03979"></a>03979     (*normal)[i] = retvec[i];
<a name="l03980"></a>03980   }
<a name="l03981"></a>03981 
<a name="l03982"></a>03982   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03983"></a>03983 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf49458c53989d7b1733647a5bca33754"></a><!-- doxytag: member="shape.c::fc_getShapeEnds" ref="gf49458c53989d7b1733647a5bca33754" args="(FC_Shape *shape, int *numEnds, int **endArray)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getShapeEnds           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numEnds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>endArray</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a shape returns the shape's ends. 
<p>
<b>Description:</b> <p>
Given a shape an array containing the ids of the shape's ends. The ends are those sides who are connected to only 1 other side in the shape (Determined by consideration of the adjacency matrix). The ids are those of the indicies of the sides in the order they are specified in the face array. Order of the indicies in the return array are in order from smallest (area) to largest.<p>
Note: nothing checks that the shape actually makes any sense.<p>
Returns -1 for numEnds and NULL array in case of error. If numSides == 0, it is considered an error. If numSides == 1 it is not an error and returns zero ends.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000083">Todo:</a></b></dt><dd><ul>
<li>decide if this should be expanded to ask for any adj matrix value</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>02/07/06 ACG, created</li><li>06/18/06 ACG, created - revision of old getSidesEnds</li><li>06/28/06 ACG now the official shape ends </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - shape </td></tr>
<tr><td valign="top"><em>numEnds</em>&nbsp;</td><td>
output - num of ends </td></tr>
<tr><td valign="top"><em>endArray</em>&nbsp;</td><td>
output - ids of ends </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03603">3603</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="geom_8c-source.html#l04344">fc_getSubsetArea()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>, and <a class="el" href="tears_8c-source.html#l00640">createShapeWOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03607"></a>03607   {
<a name="l03608"></a>03608 
<a name="l03609"></a>03609   <span class="keywordtype">int</span>* eholding;
<a name="l03610"></a>03610   <span class="keywordtype">int</span> nends;
<a name="l03611"></a>03611   <span class="keywordtype">int</span> numSides;
<a name="l03612"></a>03612   <span class="keywordtype">int</span> i,j;
<a name="l03613"></a>03613 
<a name="l03614"></a>03614   <span class="comment">//defaults</span>
<a name="l03615"></a>03615   <span class="keywordflow">if</span> (numEnds)
<a name="l03616"></a>03616     *numEnds = -1;
<a name="l03617"></a>03617   <span class="keywordflow">if</span> (endArray)
<a name="l03618"></a>03618     *endArray = NULL;
<a name="l03619"></a>03619 
<a name="l03620"></a>03620   <span class="keywordflow">if</span> (!shape || !numEnds || !endArray){ 
<a name="l03621"></a>03621     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03622"></a>03622     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03623"></a>03623   }
<a name="l03624"></a>03624 
<a name="l03625"></a>03625   <span class="comment">// log message</span>
<a name="l03626"></a>03626   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Getting shape ends B"</span>);
<a name="l03627"></a>03627 
<a name="l03628"></a>03628   numSides = shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l03629"></a>03629   <span class="keywordflow">if</span> (!numSides){
<a name="l03630"></a>03630     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"shape has no sides"</span>);
<a name="l03631"></a>03631     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03632"></a>03632   }
<a name="l03633"></a>03633 
<a name="l03634"></a>03634   eholding = calloc(numSides,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03635"></a>03635   <span class="keywordflow">if</span> (!eholding) {
<a name="l03636"></a>03636     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03637"></a>03637     <span class="comment">//not cleaning up matrix in case of memory error</span>
<a name="l03638"></a>03638     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03639"></a>03639   }
<a name="l03640"></a>03640 
<a name="l03641"></a>03641   nends = 0;
<a name="l03642"></a>03642   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l03643"></a>03643     <span class="keywordtype">int</span> conn = 0;
<a name="l03644"></a>03644 
<a name="l03645"></a>03645     <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][i] != 0){
<a name="l03646"></a>03646       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"non zero diagonal adj matrix"</span>);
<a name="l03647"></a>03647       free(eholding);
<a name="l03648"></a>03648       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03649"></a>03649     }
<a name="l03650"></a>03650     <span class="keywordflow">for</span> (j = 0; j &lt; numSides; j++){
<a name="l03651"></a>03651       <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] != shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[j][i]){
<a name="l03652"></a>03652      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"non symmetric adj matrix"</span>);
<a name="l03653"></a>03653      free(eholding);
<a name="l03654"></a>03654      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03655"></a>03655       }
<a name="l03656"></a>03656       <span class="keywordflow">if</span> (shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] !=0 ){
<a name="l03657"></a>03657      conn+=1;
<a name="l03658"></a>03658       }
<a name="l03659"></a>03659     }
<a name="l03660"></a>03660     <span class="keywordflow">if</span> (conn == 1){
<a name="l03661"></a>03661       eholding[nends++]=i;
<a name="l03662"></a>03662     }
<a name="l03663"></a>03663   }
<a name="l03664"></a>03664 
<a name="l03665"></a>03665   <span class="keywordflow">switch</span> (nends){
<a name="l03666"></a>03666   <span class="keywordflow">case</span> 0:
<a name="l03667"></a>03667     free(eholding);
<a name="l03668"></a>03668     eholding = NULL;
<a name="l03669"></a>03669     <span class="keywordflow">break</span>;
<a name="l03670"></a>03670   <span class="keywordflow">case</span> 1:
<a name="l03671"></a>03671     <span class="comment">//do nothing</span>
<a name="l03672"></a>03672     <span class="keywordflow">break</span>;
<a name="l03673"></a>03673   <span class="keywordflow">default</span>: 
<a name="l03674"></a>03674     {
<a name="l03675"></a>03675       <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l03676"></a>03676       <span class="keywordtype">double</span> *areas;
<a name="l03677"></a>03677 
<a name="l03678"></a>03678       areas = malloc(nends*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l03679"></a>03679       <span class="keywordflow">if</span> (!areas){
<a name="l03680"></a>03680      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03681"></a>03681      <span class="comment">//not cleaning up in case of memory error</span>
<a name="l03682"></a>03682      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03683"></a>03683       }
<a name="l03684"></a>03684     
<a name="l03685"></a>03685       <span class="keywordflow">for</span> (i = 0; i &lt; nends; i++){
<a name="l03686"></a>03686      rc= <a class="code" href="group__GeometricRelations.html#gfd4c940dc417f742e067c8a706cd5563" title="Returns a variable with the area of the subset.">fc_getSubsetArea</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[eholding[i]],&amp;areas[i]);
<a name="l03687"></a>03687      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03688"></a>03688        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get subset areas"</span>);
<a name="l03689"></a>03689        free(eholding);
<a name="l03690"></a>03690        free(areas);
<a name="l03691"></a>03691        <span class="keywordflow">return</span> rc;
<a name="l03692"></a>03692      }
<a name="l03693"></a>03693       }
<a name="l03694"></a>03694     
<a name="l03695"></a>03695     
<a name="l03696"></a>03696       <span class="comment">//order sides by area</span>
<a name="l03697"></a>03697       <span class="comment">//sort sides areas. yes i know, its bubblesort.</span>
<a name="l03698"></a>03698       {
<a name="l03699"></a>03699      <span class="keywordtype">double</span> tempa;
<a name="l03700"></a>03700      <span class="keywordtype">int</span> tempi;
<a name="l03701"></a>03701      <span class="keywordtype">int</span> test; 
<a name="l03702"></a>03702      
<a name="l03703"></a>03703      <span class="keywordflow">for</span>(i = nends - 1; i &gt; 0; i--){
<a name="l03704"></a>03704        test=0;
<a name="l03705"></a>03705        <span class="keywordflow">for</span>(j = 0; j &lt; i; j++){
<a name="l03706"></a>03706          <span class="keywordflow">if</span> (areas[j] &gt; areas[j+1]){
<a name="l03707"></a>03707            tempa = areas[j]; 
<a name="l03708"></a>03708            areas[j] = areas[j+1];
<a name="l03709"></a>03709            areas[j+1] = tempa;
<a name="l03710"></a>03710            tempi = eholding[j]; 
<a name="l03711"></a>03711            eholding[j] = eholding[j+1];
<a name="l03712"></a>03712            eholding[j+1] = tempi;
<a name="l03713"></a>03713            test=1;
<a name="l03714"></a>03714          }
<a name="l03715"></a>03715        }
<a name="l03716"></a>03716        <span class="keywordflow">if</span>(test==0) <span class="keywordflow">break</span>; <span class="comment">//exit if sorted</span>
<a name="l03717"></a>03717      }
<a name="l03718"></a>03718       }
<a name="l03719"></a>03719       free(areas);
<a name="l03720"></a>03720       <span class="keywordflow">break</span>;
<a name="l03721"></a>03721     }
<a name="l03722"></a>03722   }
<a name="l03723"></a>03723 
<a name="l03724"></a>03724   *numEnds = nends;
<a name="l03725"></a>03725   <span class="comment">//note: eholding was allocated with numSides members, not nends.</span>
<a name="l03726"></a>03726   <span class="comment">//this is ok becuase free will free the whole array</span>
<a name="l03727"></a>03727   *endArray = eholding;
<a name="l03728"></a>03728 
<a name="l03729"></a>03729   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03730"></a>03730 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gc3084dfed2f0a3c0e2f7b4e8e4ef3005"></a><!-- doxytag: member="shape.c::fc_getShapeSidesAreas" ref="gc3084dfed2f0a3c0e2f7b4e8e4ef3005" args="(FC_Shape *shape, double **area)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getShapeSidesAreas           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>area</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given a Shape, returns the (non-displaced) area for each side. 
<p>
<b>Description:</b> <p>
Given a Shape, returns the (non-displaced) area for each side. Checks to see if all the sides are on the same mesh.<p>
If there is an error in calculating this for any side, then this returns NULL for the entire array.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000084">Todo:</a></b></dt><dd><ul>
<li>may want to do a displaced version</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>01/03/06 ACG</li><li>07/17/06 ACG born out of old getSidesAreas </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - ptr to shape </td></tr>
<tr><td valign="top"><em>area</em>&nbsp;</td><td>
output - area array </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03754">3754</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="variable_8c-source.html#l04980">fc_deleteVariable()</a>, <a class="el" href="geom_8c-source.html#l03600">fc_getFaceAreas()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02902">fc_getSubsetAssociationType()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l02669">fc_createDescendingAreaOrder()</a>, and <a class="el" href="shape_8c-source.html#l02818">fc_createLargeAndNonAdjacentSidesOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03757"></a>03757  {
<a name="l03758"></a>03758   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> meshlast, meshnext;
<a name="l03759"></a>03759   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l03760"></a>03760   <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> faceareas;
<a name="l03761"></a>03761   <span class="keywordtype">double</span> *areaarray;
<a name="l03762"></a>03762   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l03763"></a>03763   <span class="keywordtype">int</span> i,j;
<a name="l03764"></a>03764 
<a name="l03765"></a>03765   <span class="comment">//default return</span>
<a name="l03766"></a>03766   <span class="keywordflow">if</span> (area)
<a name="l03767"></a>03767     *area = NULL;
<a name="l03768"></a>03768 
<a name="l03769"></a>03769   <span class="keywordflow">if</span> (!shape || !area ){
<a name="l03770"></a>03770     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03771"></a>03771     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03772"></a>03772   }
<a name="l03773"></a>03773 
<a name="l03774"></a>03774   <span class="comment">//check that all the subsets are valid</span>
<a name="l03775"></a>03775   <span class="keywordflow">for</span> (i = 0; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l03776"></a>03776     <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i])){
<a name="l03777"></a>03777       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03778"></a>03778       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03779"></a>03779     }
<a name="l03780"></a>03780     rc = <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i], &amp;assoc);
<a name="l03781"></a>03781     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03782"></a>03782       <span class="keywordflow">return</span> rc;
<a name="l03783"></a>03783     <span class="keywordflow">if</span> ( assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>){
<a name="l03784"></a>03784       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Wrong association type"</span>);
<a name="l03785"></a>03785       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03786"></a>03786     }
<a name="l03787"></a>03787   }
<a name="l03788"></a>03788 
<a name="l03789"></a>03789   <span class="comment">// log message</span>
<a name="l03790"></a>03790   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing ShapeSide Areas"</span>);
<a name="l03791"></a>03791 
<a name="l03792"></a>03792   <span class="comment">//get areas for all faces of the mesh</span>
<a name="l03793"></a>03793   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[0],&amp;meshlast);
<a name="l03794"></a>03794   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03795"></a>03795     <span class="keywordflow">return</span> rc;
<a name="l03796"></a>03796   }
<a name="l03797"></a>03797 
<a name="l03798"></a>03798   rc = <a class="code" href="group__GeometricRelations.html#gf2cc6f91505e41e5fb36d710ae2c523e" title="Return a variable with the face areas of the mesh.">fc_getFaceAreas</a>(meshlast,&amp;faceareas);
<a name="l03799"></a>03799   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03800"></a>03800     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get face areas"</span>);
<a name="l03801"></a>03801     <span class="keywordflow">return</span> rc;
<a name="l03802"></a>03802   }
<a name="l03803"></a>03803 
<a name="l03804"></a>03804   rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(faceareas,(<span class="keywordtype">void</span> **) &amp;areaarray);
<a name="l03805"></a>03805   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03806"></a>03806     <span class="keywordflow">return</span> rc;
<a name="l03807"></a>03807   }
<a name="l03808"></a>03808 
<a name="l03809"></a>03809   *area = calloc(shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l03810"></a>03810   <span class="keywordflow">if</span> (*area == NULL) {
<a name="l03811"></a>03811     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03812"></a>03812     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03813"></a>03813   }
<a name="l03814"></a>03814 
<a name="l03815"></a>03815   <span class="keywordflow">for</span> (i = 0; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l03816"></a>03816     <span class="keywordtype">int</span> numMem, *ids;
<a name="l03817"></a>03817 
<a name="l03818"></a>03818     rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],&amp;meshnext);
<a name="l03819"></a>03819     <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03820"></a>03820       free(*area);
<a name="l03821"></a>03821       *area = NULL;
<a name="l03822"></a>03822       <span class="keywordflow">return</span> rc;
<a name="l03823"></a>03823     }
<a name="l03824"></a>03824 
<a name="l03825"></a>03825     <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(meshnext, meshlast)){
<a name="l03826"></a>03826       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"all subsets must be on the same mesh"</span>);
<a name="l03827"></a>03827       free(*area);
<a name="l03828"></a>03828       *area = NULL;
<a name="l03829"></a>03829       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03830"></a>03830     }
<a name="l03831"></a>03831 
<a name="l03832"></a>03832     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i], &amp;numMem, &amp;ids);
<a name="l03833"></a>03833     <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l03834"></a>03834       free(*area);
<a name="l03835"></a>03835       *area = NULL;
<a name="l03836"></a>03836       <span class="keywordflow">return</span> rc;
<a name="l03837"></a>03837     }
<a name="l03838"></a>03838 
<a name="l03839"></a>03839     <span class="keywordflow">for</span> (j = 0; j &lt; numMem; j++){
<a name="l03840"></a>03840       (*area)[i] += areaarray[ids[j]];
<a name="l03841"></a>03841     }
<a name="l03842"></a>03842     free(ids);
<a name="l03843"></a>03843 
<a name="l03844"></a>03844     meshlast = meshnext;
<a name="l03845"></a>03845   }
<a name="l03846"></a>03846 
<a name="l03847"></a>03847 
<a name="l03848"></a>03848   <a class="code" href="group__Variable.html#g1de53216125d0074933ecf6006f1796a" title="Delete a variable.">fc_deleteVariable</a>(faceareas);
<a name="l03849"></a>03849 
<a name="l03850"></a>03850   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03851"></a>03851 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g7a2a66886ce110aa18616af7cbe7de0c"></a><!-- doxytag: member="shape.c::fc_getSideNormalMeanSdev" ref="g7a2a66886ce110aa18616af7cbe7de0c" args="(FC_Shape *shape, int sideid, FC_Vector *mean, FC_Vector *std)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSideNormalMeanSdev           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sideid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>std</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given a shape and a sideid, returns the outward normal and std in each direction to that face. 
<p>
<b>Description:</b> <p>
Given a shape and a sideid, returns the mean of the components of the outward normals and std in each direction to that face. Note that the mean is not a normal and also that for the same shape, this can retrun differnet values depending onthe sizes and shapes of the individual faces of the overall side. The hope is that in most cases, if one is using this to compare the results of different sides inthe same mesh, that the elements are sufficiently regular that a meaningful result is obtained.<p>
<b>Modifications:</b> <ul>
<li>08/04/06 ACG created.</li><li>08/08/06 ACG changed interface so takes a shape rather than the faces and elems of the side </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input - shape </td></tr>
<tr><td valign="top"><em>sideid</em>&nbsp;</td><td>
input - side id </td></tr>
<tr><td valign="top"><em>mean</em>&nbsp;</td><td>
output - mean </td></tr>
<tr><td valign="top"><em>std</em>&nbsp;</td><td>
output - std in each dir separately </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l04008">4008</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00750">_fc_getOutwardFaceNormal()</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="storage_8c-source.html#l00441">fc_addIntArrayToSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="storage_8c-source.html#l00591">fc_deleteIntFromSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="storage_8c-source.html#l00846">fc_freeSortedIntArray()</a>, <a class="el" href="topo_8c-source.html#l00116">fc_getMeshEntityChildren()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02902">fc_getSubsetAssociationType()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="storage_8c-source.html#l00095">fc_initSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>, and <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l03005">fc_createLargeAndOpposingSidesOrder()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l04013"></a>04013    {
<a name="l04014"></a>04014   
<a name="l04015"></a>04015   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc1, rc2, rc;
<a name="l04016"></a>04016   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh1, mesh2;
<a name="l04017"></a>04017   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc1, assoc2;
<a name="l04018"></a>04018   <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> sum, sumsq;
<a name="l04019"></a>04019   <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> compmean, sdev, temp;
<a name="l04020"></a>04020   <span class="keywordtype">int</span> faceID,elemID;
<a name="l04021"></a>04021   <span class="keywordtype">int</span> numFaces,numElems;
<a name="l04022"></a>04022   <span class="keywordtype">int</span> *arrf, *arre;
<a name="l04023"></a>04023   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> sia;
<a name="l04024"></a>04024   <span class="keywordtype">int</span> i,j,k;
<a name="l04025"></a>04025 
<a name="l04026"></a>04026   <span class="comment">//default</span>
<a name="l04027"></a>04027   <span class="keywordflow">if</span> (mean){
<a name="l04028"></a>04028     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l04029"></a>04029       (*mean)[i] = 0;
<a name="l04030"></a>04030     }
<a name="l04031"></a>04031   }
<a name="l04032"></a>04032 
<a name="l04033"></a>04033   <span class="keywordflow">if</span> (std){
<a name="l04034"></a>04034     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l04035"></a>04035       (*std)[i] = 0;
<a name="l04036"></a>04036     }
<a name="l04037"></a>04037   }
<a name="l04038"></a>04038 
<a name="l04039"></a>04039     
<a name="l04040"></a>04040   <span class="keywordflow">if</span> (!shape || (sideid &lt; 0) || (sideid &gt; ((shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>)-1)) ||
<a name="l04041"></a>04041       !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid]) || 
<a name="l04042"></a>04042       !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid]) || !mean  || !std){
<a name="l04043"></a>04043       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l04044"></a>04044       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l04045"></a>04045   }
<a name="l04046"></a>04046 
<a name="l04047"></a>04047   rc1 = <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid], &amp;assoc1);
<a name="l04048"></a>04048   rc2 = <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid], &amp;assoc2);
<a name="l04049"></a>04049   <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l04050"></a>04050     <span class="keywordflow">return</span>(rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l04051"></a>04051 
<a name="l04052"></a>04052   <span class="keywordflow">if</span> (assoc1 != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a> || assoc2 != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>){
<a name="l04053"></a>04053     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Wrong assoc type"</span>);
<a name="l04054"></a>04054     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l04055"></a>04055   }
<a name="l04056"></a>04056 
<a name="l04057"></a>04057   rc1 = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid],&amp;mesh1);
<a name="l04058"></a>04058   rc2 = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid],&amp;mesh2);
<a name="l04059"></a>04059   <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l04060"></a>04060     <span class="keywordflow">return</span>(rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l04061"></a>04061 
<a name="l04062"></a>04062   <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(mesh1,mesh2)){
<a name="l04063"></a>04063     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"faces and elems must be on same mesh"</span>);
<a name="l04064"></a>04064     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l04065"></a>04065   }
<a name="l04066"></a>04066 
<a name="l04067"></a>04067   
<a name="l04068"></a>04068   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[sideid],&amp;numFaces,&amp;arrf);
<a name="l04069"></a>04069   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l04070"></a>04070     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get faces"</span>);
<a name="l04071"></a>04071     <span class="keywordflow">return</span> rc;
<a name="l04072"></a>04072   }
<a name="l04073"></a>04073   <span class="keywordflow">if</span> (numFaces &lt; 1){
<a name="l04074"></a>04074     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"must have at least 1 face"</span>);
<a name="l04075"></a>04075     free(arrf);
<a name="l04076"></a>04076     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l04077"></a>04077   }
<a name="l04078"></a>04078   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[sideid],&amp;numElems,&amp;arre);
<a name="l04079"></a>04079   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l04080"></a>04080     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get elems"</span>);
<a name="l04081"></a>04081     free(arrf);
<a name="l04082"></a>04082     free(arre);
<a name="l04083"></a>04083     <span class="keywordflow">return</span> rc;
<a name="l04084"></a>04084   }
<a name="l04085"></a>04085   
<a name="l04086"></a>04086   rc = <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;sia);
<a name="l04087"></a>04087   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l04088"></a>04088     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't init sorted int array"</span>);
<a name="l04089"></a>04089     free(arrf);
<a name="l04090"></a>04090     free(arre);
<a name="l04091"></a>04091     <span class="keywordflow">return</span> rc;
<a name="l04092"></a>04092   }
<a name="l04093"></a>04093 
<a name="l04094"></a>04094   <span class="comment">//when we get the array from the subset, we know it is sorted</span>
<a name="l04095"></a>04095   i = <a class="code" href="group__SimpleDataObjects.html#gf842f060b1f39a0acfc54421bbe0865a" title="Add an array of ints to a sorted int array.">fc_addIntArrayToSortedIntArray</a>(&amp;sia,numFaces,arrf,1);
<a name="l04096"></a>04096   free(arrf);
<a name="l04097"></a>04097 
<a name="l04098"></a>04098   <span class="keywordflow">if</span> (!i){
<a name="l04099"></a>04099     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't add array to sia int array"</span>);
<a name="l04100"></a>04100     free(arre);
<a name="l04101"></a>04101     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;sia);
<a name="l04102"></a>04102     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l04103"></a>04103   }
<a name="l04104"></a>04104   
<a name="l04105"></a>04105 
<a name="l04106"></a>04106   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l04107"></a>04107     sum[i] = 0;
<a name="l04108"></a>04108     sumsq[i] = 0;
<a name="l04109"></a>04109   }
<a name="l04110"></a>04110 
<a name="l04111"></a>04111   <span class="comment">//for each elem, get its kids and match them up with the faces</span>
<a name="l04112"></a>04112   <span class="comment">//each face can come from only 1 elem.</span>
<a name="l04113"></a>04113   <span class="comment">//figure its faster to get the elems kids once and check thru a sorted</span>
<a name="l04114"></a>04114   <span class="comment">//face list than to try to go thru the face list and iterate thur all</span>
<a name="l04115"></a>04115   <span class="comment">//the elems</span>
<a name="l04116"></a>04116   <span class="comment">//then get the mean of the normals</span>
<a name="l04117"></a>04117   <span class="keywordflow">for</span> (i = 0; i &lt; numElems; i++){
<a name="l04118"></a>04118     <span class="keywordtype">int</span> numChild, *childIDs;
<a name="l04119"></a>04119     elemID = arre[i];
<a name="l04120"></a>04120     rc = <a class="code" href="group__TopologyRelations.html#g08edc0183a4bb0e44eb226ea75177fd8" title="Get the entities which make up the specified entity.">fc_getMeshEntityChildren</a>(mesh1, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, arre[i], <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>,
<a name="l04121"></a>04121                       &amp;numChild, &amp;childIDs);
<a name="l04122"></a>04122     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l04123"></a>04123       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant get elem-&gt;face data"</span>);
<a name="l04124"></a>04124       free(arre);
<a name="l04125"></a>04125       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;sia);
<a name="l04126"></a>04126       <span class="keywordflow">return</span> rc;
<a name="l04127"></a>04127     }
<a name="l04128"></a>04128 
<a name="l04129"></a>04129     <span class="keywordflow">for</span> (j = 0; j &lt; numChild; j++){
<a name="l04130"></a>04130       <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> retvec;
<a name="l04131"></a>04131       <span class="comment">//is this face in the list ?</span>
<a name="l04132"></a>04132       faceID = childIDs[j];
<a name="l04133"></a>04133       <span class="keywordflow">if</span> (<a class="code" href="group__SimpleDataObjects.html#gc800f634fb42d44a6c31d79743a6864c" title="Remove an int from a sorted int array.">fc_deleteIntFromSortedIntArray</a>(&amp;sia,faceID)){
<a name="l04134"></a>04134      rc =  <a class="code" href="group__PrivateShape.html#g8d520bfe173ac78fd6e253afc1393e8e" title="Returns outward normal vector for a given face on a given element.">_fc_getOutwardFaceNormal</a>(mesh1,faceID,elemID, &amp;retvec);
<a name="l04135"></a>04135      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l04136"></a>04136        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant get outward face normal"</span>);
<a name="l04137"></a>04137        free(arre);
<a name="l04138"></a>04138        <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;sia);
<a name="l04139"></a>04139        <span class="keywordflow">return</span> rc;
<a name="l04140"></a>04140      }
<a name="l04141"></a>04141 
<a name="l04142"></a>04142      <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++){
<a name="l04143"></a>04143        sum[k]+=retvec[k];
<a name="l04144"></a>04144        sumsq[k]+=(retvec[k]*retvec[k]);
<a name="l04145"></a>04145      }
<a name="l04146"></a>04146       }
<a name="l04147"></a>04147     }
<a name="l04148"></a>04148 
<a name="l04149"></a>04149     free(childIDs);
<a name="l04150"></a>04150   }
<a name="l04151"></a>04151 
<a name="l04152"></a>04152   free(arre);
<a name="l04153"></a>04153   <span class="comment">//make sure all the faces have been removed</span>
<a name="l04154"></a>04154   <span class="keywordflow">if</span> (sia.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>){
<a name="l04155"></a>04155     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Mismatch of faces and elems"</span>);
<a name="l04156"></a>04156     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;sia);    
<a name="l04157"></a>04157     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l04158"></a>04158   }
<a name="l04159"></a>04159   <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;sia);    
<a name="l04160"></a>04160 
<a name="l04161"></a>04161   <span class="keywordflow">for</span> (i = 0; i &lt;3; i++){
<a name="l04162"></a>04162     compmean[i] = sum[i]/(double)numFaces;
<a name="l04163"></a>04163 
<a name="l04164"></a>04164     <span class="keywordflow">if</span> (numFaces &gt; 1){
<a name="l04165"></a>04165       temp[i] = (sumsq[i] - (sum[i] * sum[i] /(double) numFaces)) /
<a name="l04166"></a>04166      (<span class="keywordtype">double</span>)(numFaces - 1);
<a name="l04167"></a>04167       sdev[i] = sqrt(fabs(temp[i]));
<a name="l04168"></a>04168       <span class="comment">// might be negative if roundoff error</span>
<a name="l04169"></a>04169     }<span class="keywordflow">else</span>{
<a name="l04170"></a>04170       sdev[i] = 0.0;
<a name="l04171"></a>04171     }
<a name="l04172"></a>04172   }
<a name="l04173"></a>04173 
<a name="l04174"></a>04174   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l04175"></a>04175     (*mean)[i] = compmean[i];
<a name="l04176"></a>04176     (*std)[i] = sdev[i];
<a name="l04177"></a>04177   }
<a name="l04178"></a>04178 
<a name="l04179"></a>04179   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l04180"></a>04180 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g390c8304bc716ff39e4ef3c63657a6f5"></a><!-- doxytag: member="shape.c::fc_getSubsetShapes" ref="g390c8304bc716ff39e4ef3c63657a6f5" args="(FC_Subset in_subset, double comp_angle, int shared_dim, int *numShapes, FC_Shape **shapes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_getSubsetShapes           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>in_subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>comp_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numShapes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> **&nbsp;</td>
          <td class="paramname"> <em>shapes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a subset, returns an array of FC_Shapes 
<p>
<b>Description:</b> <p>
Given a subset returns an array of FC_Shapes. Vals for comp_angle are limited to 0-&gt;180 degrees because of the return val of acos. The choice is tricky because for curved sides, setting this too low will result in each face along the curve will be considerd a new side, but setting it too high means that some things that should be distinct sides will be combined into one.<p>
The face and elem subsets will be named as the name of the original subset, postpended with "Shape#" followed by "_FaceSurface#" or "_ElemSurface#" where # will be the index into the array of subsets for that shape.<p>
In a given shape the indicies of the face and elem arrays correspond, that is side 0 consists of the faces in the subset face[0] and the elements in the subset elem[0]. There is no correspondence between the order of the faces and the order of the elems, within a subset, that is the first face in side 0 does not necessarily come from the first elem in side 0. In fact, the subsets may have different lengths e.g, if one element corresponds to more than one face on a side (which can happen depending on the angle chosen).<p>
Note that pieces that are touching will come out as 1 distinct shape with a lot of edges as opposed to two distinct shapes. Segment will do the same thing.<p>
Fails if NULL subset. Returns 0 shapes if empty subset.<p>
Notes:<p>
<ul>
<li>this does not use displacements.</li><li>vals for comp_angle are limited to 0-&gt;180 degrees because of the return val of acos. Similary, if the mesh angle is not in that range, it will return with an error.</li><li>becuase of the calculation of the normals, this method is limited to elements of topodim 3 who have faces of type <a class="el" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884af79268373ad06101e34987c127cb50b5">FC_ET_TRI</a> or <a class="el" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884aecaa2098167cbf0e3ee39fec88e073ca">FC_ET_QUAD</a></li><li>internally, this uses edge info between sides to build the adj matrix. In the case of a crease in the shape, two faces may appear to be on different sides at some point, but later discovered to be on the same side via neighbors that are without a crease between them. I believe this all works out fine, but I dont guarentee it. In the building of the adjacenecy matrix, the user will be warned about pairs of faces like this.</li></ul>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000077">Todo:</a></b></dt><dd><ul>
<li>want a hashtable to do the adjmatrix calc (see innards)</li><li>note, this does not clean up memory well in case of weird error (that shouldnt occur) deep within the list building</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>06/04/06 ACG created</li><li>08/19/06 ACG _fc_getSubsetSides (created 10/04/05 ACG) merged in now that that facelist processing has been separated out. (see <a class="el" href="group__PrivateShape.html#gd3eccd62e677afb1e348319a15648dbb">_fc_buildFaceInfoListFromSubset</a>)</li><li>09/18/06 ACG better subset names </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>in_subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>comp_angle</em>&nbsp;</td><td>
input - if two neighboring faces differ by more than this angle then they are considered to be on different surfaces. </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - the minimum dimensionality of shared part of neighbors of faces </td></tr>
<tr><td valign="top"><em>numShapes</em>&nbsp;</td><td>
output - number of shapes </td></tr>
<tr><td valign="top"><em>shapes</em>&nbsp;</td><td>
output shapes array </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l01339">1339</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00402">_fc_buildFaceInfoListFromSubset()</a>, <a class="el" href="shape_8c-source.html#l00893">_fc_createShapePartsFromFaceInfoList()</a>, <a class="el" href="shape_8c-source.html#l00347">_fc_freeSFI_Array()</a>, <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l01930">fc_changeSubsetName()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l02700">fc_getSubsetName()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="shape_8c-source.html#l03307">fc_segmentAdjacencyMatrix()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>, <a class="el" href="shape_8c-source.html#l01515">fc_getMeshShapes()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01349"></a>01349  {
<a name="l01350"></a>01350 
<a name="l01351"></a>01351   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01352"></a>01352   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l01353"></a>01353   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l01354"></a>01354 
<a name="l01355"></a>01355   <span class="keywordtype">char</span> *subsetName;
<a name="l01356"></a>01356   <span class="keywordtype">int</span> numMem, junk;
<a name="l01357"></a>01357 
<a name="l01358"></a>01358   <a class="code" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> faceinfo_list;
<a name="l01359"></a>01359 
<a name="l01360"></a>01360   <span class="keywordtype">int</span> numSides;              
<a name="l01361"></a>01361   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* newFaceSubsets; 
<a name="l01362"></a>01362   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* newElemSubsets; 
<a name="l01363"></a>01363   <span class="keywordtype">int</span> **adjmatrix;
<a name="l01364"></a>01364 
<a name="l01365"></a>01365   <span class="keywordtype">int</span> numParts;
<a name="l01366"></a>01366   <span class="keywordtype">int</span> *sidesPerPart;
<a name="l01367"></a>01367   <span class="keywordtype">int</span> **partSideIDS;
<a name="l01368"></a>01368   <a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a> *lshapes;
<a name="l01369"></a>01369   
<a name="l01370"></a>01370   <span class="keywordtype">int</span> i,j,k;
<a name="l01371"></a>01371 
<a name="l01372"></a>01372   <span class="comment">//defaults</span>
<a name="l01373"></a>01373   <span class="keywordflow">if</span> (numShapes)
<a name="l01374"></a>01374     *numShapes = -1;
<a name="l01375"></a>01375   <span class="keywordflow">if</span> (shapes)
<a name="l01376"></a>01376     *shapes = NULL;
<a name="l01377"></a>01377 
<a name="l01378"></a>01378   <span class="keywordflow">if</span> (!numShapes || !shapes  || !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(in_subset) ||
<a name="l01379"></a>01379   shared_dim &lt; 0 || shared_dim &gt; 1 || comp_angle &lt; 0 ||
<a name="l01380"></a>01380   comp_angle &gt; 180){
<a name="l01381"></a>01381     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>,<a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01382"></a>01382     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01383"></a>01383   }
<a name="l01384"></a>01384 
<a name="l01385"></a>01385 
<a name="l01386"></a>01386   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"get subset shapes"</span>);
<a name="l01387"></a>01387   
<a name="l01388"></a>01388   <span class="comment">// setup and more checking</span>
<a name="l01389"></a>01389   rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a> (in_subset, &amp;numMem, &amp;junk,&amp;assoc);
<a name="l01390"></a>01390   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01391"></a>01391     <span class="keywordflow">return</span> rc;
<a name="l01392"></a>01392 
<a name="l01393"></a>01393   <span class="keywordflow">if</span> (assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a> &amp;&amp; assoc != <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>){
<a name="l01394"></a>01394     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"subset must have assoc FC_AT_ELEMENT or FC_AT_WHOLE_MESH"</span>);
<a name="l01395"></a>01395     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01396"></a>01396   }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398   <span class="keywordflow">if</span> (numMem == 0){ <span class="comment">//return if empty subset</span>
<a name="l01399"></a>01399     *numShapes = 0;
<a name="l01400"></a>01400     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01401"></a>01401   }
<a name="l01402"></a>01402 
<a name="l01403"></a>01403 
<a name="l01404"></a>01404   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(in_subset, &amp;mesh);
<a name="l01405"></a>01405   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01406"></a>01406     <span class="keywordflow">return</span> rc;
<a name="l01407"></a>01407 
<a name="l01408"></a>01408   <span class="comment">//let's get all the info we need about the skin</span>
<a name="l01409"></a>01409   rc = <a class="code" href="group__PrivateShape.html#gd3eccd62e677afb1e348319a15648dbb" title="return sorted array of ptrs to faceinfos for the subset skin">_fc_buildFaceInfoListFromSubset</a>(in_subset,&amp;faceinfo_list);
<a name="l01410"></a>01410   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01411"></a>01411     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant build face info list\n"</span>);
<a name="l01412"></a>01412     <span class="keywordflow">return</span> rc;
<a name="l01413"></a>01413   }
<a name="l01414"></a>01414 
<a name="l01415"></a>01415   rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(in_subset,&amp;subsetName);
<a name="l01416"></a>01416   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01417"></a>01417     <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(&amp;faceinfo_list);
<a name="l01418"></a>01418     free(subsetName);
<a name="l01419"></a>01419     <span class="keywordflow">return</span> rc;
<a name="l01420"></a>01420   }
<a name="l01421"></a>01421 
<a name="l01422"></a>01422   rc = <a class="code" href="group__PrivateShape.html#g3e9cf7ace4ab706649116911f6ee379e" title="makes the shape parts from the faceinfolist">_fc_createShapePartsFromFaceInfoList</a>(mesh, &amp;faceinfo_list,&amp;subsetName,
<a name="l01423"></a>01423                                             comp_angle,shared_dim,&amp;numSides,
<a name="l01424"></a>01424                                             &amp;newFaceSubsets,&amp;newElemSubsets,
<a name="l01425"></a>01425                              &amp;adjmatrix);
<a name="l01426"></a>01426   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01427"></a>01427     free(subsetName);
<a name="l01428"></a>01428     <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(&amp;faceinfo_list); <span class="comment">//see note about</span>
<a name="l01429"></a>01429     <span class="comment">//deciding how to handle the freeing of this</span>
<a name="l01430"></a>01430   }
<a name="l01431"></a>01431 
<a name="l01432"></a>01432 
<a name="l01433"></a>01433   rc = <a class="code" href="group__Shape.html#g0bd777744173330b8a9d77b85eb53b0c" title="Given an adjacency matrix, returns segments of it based on connectivities.">fc_segmentAdjacencyMatrix</a>(numSides,adjmatrix,
<a name="l01434"></a>01434                      &amp;numParts, &amp;sidesPerPart, &amp;partSideIDS);
<a name="l01435"></a>01435   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01436"></a>01436     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't segment adj matrix sides"</span>);
<a name="l01437"></a>01437     free(subsetName);
<a name="l01438"></a>01438     <span class="keywordflow">return</span> rc;
<a name="l01439"></a>01439   }
<a name="l01440"></a>01440 
<a name="l01441"></a>01441   lshapes = (<a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a>*)malloc(numParts*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a>));
<a name="l01442"></a>01442   <span class="keywordflow">if</span> (lshapes == NULL){
<a name="l01443"></a>01443     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01444"></a>01444     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01445"></a>01445   }
<a name="l01446"></a>01446 
<a name="l01447"></a>01447   <span class="keywordflow">for</span>(i = 0; i &lt; numParts; i++){
<a name="l01448"></a>01448     lshapes[i].<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = sidesPerPart[i];
<a name="l01449"></a>01449     lshapes[i].<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(sidesPerPart[i]*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01450"></a>01450     lshapes[i].<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(sidesPerPart[i]*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01451"></a>01451     lshapes[i].<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a> = (<span class="keywordtype">int</span>**)malloc(sidesPerPart[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l01452"></a>01452     <span class="keywordflow">for</span> (j = 0; j &lt; sidesPerPart[i]; j++){
<a name="l01453"></a>01453       <span class="keywordtype">char</span>* temp_name;
<a name="l01454"></a>01454       temp_name = malloc((strlen(subsetName)+40)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01455"></a>01455       <span class="keywordflow">if</span> (temp_name == NULL) {
<a name="l01456"></a>01456      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01457"></a>01457      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01458"></a>01458       }
<a name="l01459"></a>01459       snprintf(temp_name, 
<a name="l01460"></a>01460             strlen(subsetName)+40,
<a name="l01461"></a>01461             <span class="stringliteral">"%s_Shape%d_FaceSurface%d"</span>,
<a name="l01462"></a>01462             subsetName, i,j);
<a name="l01463"></a>01463       lshapes[i].<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[j] = (<span class="keywordtype">int</span>*)malloc(sidesPerPart[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01464"></a>01464       lshapes[i].<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[j] = newFaceSubsets[partSideIDS[i][j]];
<a name="l01465"></a>01465       <a class="code" href="group__Subset.html#gb0b2c83895c19e4df36adae6fcba8922" title="Change the name of a subset.">fc_changeSubsetName</a>(lshapes[i].faces[j],temp_name);
<a name="l01466"></a>01466       snprintf(temp_name, 
<a name="l01467"></a>01467             strlen(subsetName)+40,
<a name="l01468"></a>01468             <span class="stringliteral">"%s_Shape%d_ElemSurface%d"</span>, 
<a name="l01469"></a>01469             subsetName,i,j);
<a name="l01470"></a>01470       lshapes[i].<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[j] = newElemSubsets[partSideIDS[i][j]];
<a name="l01471"></a>01471       <a class="code" href="group__Subset.html#gb0b2c83895c19e4df36adae6fcba8922" title="Change the name of a subset.">fc_changeSubsetName</a>(lshapes[i].elems[j],temp_name);
<a name="l01472"></a>01472       free(temp_name);
<a name="l01473"></a>01473       <span class="keywordflow">for</span> (k = 0; k &lt; sidesPerPart[i]; k++){
<a name="l01474"></a>01474      lshapes[i].<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[j][k] = adjmatrix[partSideIDS[i][j]][partSideIDS[i][k]];
<a name="l01475"></a>01475       }
<a name="l01476"></a>01476     }
<a name="l01477"></a>01477   }
<a name="l01478"></a>01478 
<a name="l01479"></a>01479 
<a name="l01480"></a>01480   free(subsetName);
<a name="l01481"></a>01481   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l01482"></a>01482     free(adjmatrix[i]);
<a name="l01483"></a>01483   }
<a name="l01484"></a>01484   free(adjmatrix);
<a name="l01485"></a>01485   free(newFaceSubsets); <span class="comment">//just the array</span>
<a name="l01486"></a>01486   free(newElemSubsets); <span class="comment">//just the array</span>
<a name="l01487"></a>01487 
<a name="l01488"></a>01488   <span class="keywordflow">for</span> (i = 0 ; i &lt;numParts; i++){
<a name="l01489"></a>01489     free(partSideIDS[i]);
<a name="l01490"></a>01490   }
<a name="l01491"></a>01491   free(partSideIDS);
<a name="l01492"></a>01492   free(sidesPerPart);
<a name="l01493"></a>01493 
<a name="l01494"></a>01494   *numShapes = numParts;
<a name="l01495"></a>01495   *shapes = lshapes;
<a name="l01496"></a>01496   
<a name="l01497"></a>01497   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01498"></a>01498 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gb8848b3711ed4db6e2fee49f5de0cd8c"></a><!-- doxytag: member="shape.c::fc_initShape" ref="gb8848b3711ed4db6e2fee49f5de0cd8c" args="(FC_Shape *fcss)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_initShape           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>fcss</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
inits a Shape 
<p>
<b>Description:</b> <p>
Blanks out a shape's fields w/o doing deallocation. This is used in cases where <a class="el" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19">fc_freeShape</a> is not feasible (e.g., can't just free a newly allocated shape becuase the numSides may be anything).<p>
In most cases the user wont need to init a shape. The shape creation methods will handle the newly instantiated shape pointer properly and after that the user will be working with the created shape.<p>
<b>Modifications:</b> <ul>
<li>09/28/06 ACG created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fcss</em>&nbsp;</td><td>
input - the shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02414">2414</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l02098">fc_copyShape()</a>, <a class="el" href="shape_8c-source.html#l01725">fc_reduceShapeNumSides()</a>, and <a class="el" href="shape_8c-source.html#l01609">fc_reshapeByAngle()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02416"></a>02416  {
<a name="l02417"></a>02417   <span class="keywordflow">if</span> (!fcss){
<a name="l02418"></a>02418     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02419"></a>02419     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02420"></a>02420   }
<a name="l02421"></a>02421 
<a name="l02422"></a>02422   fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>= NULL;
<a name="l02423"></a>02423   fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>= NULL;
<a name="l02424"></a>02424   fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>= NULL;
<a name="l02425"></a>02425   fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = 0;
<a name="l02426"></a>02426 
<a name="l02427"></a>02427   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02428"></a>02428 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g1c2ac1ebcb636d73f4c84e715e96dd83"></a><!-- doxytag: member="shape.c::fc_printShape" ref="g1c2ac1ebcb636d73f4c84e715e96dd83" args="(FC_Shape *fcss, char *label, int verb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_printShape           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>fcss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>verb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
prints a Shape 
<p>
<b>Description:</b> <p>
prints an <a class="el" href="structFC__Shape.html">FC_Shape</a><p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000080">Todo:</a></b></dt><dd><ul>
<li>test</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>06/05/06 ACG created</li><li>07/13/06 ACG dropped 'FC' in name</li><li>07/16/06 ACG dropped "skin" in name</li><li>07/18/06 ACG shape are is ptr </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fcss</em>&nbsp;</td><td>
input - the shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02449">2449</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="subset_8c-source.html#l03173">fc_printSubset()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>

<p>Referenced by <a class="el" href="elemdeath__ex1_8c-source.html#l00147">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02453"></a>02453  {
<a name="l02454"></a>02454   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02455"></a>02455   <span class="keywordtype">int</span> i,j;
<a name="l02456"></a>02456 
<a name="l02457"></a>02457   <span class="keywordflow">if</span> (!fcss){
<a name="l02458"></a>02458     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02459"></a>02459     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02460"></a>02460   }
<a name="l02461"></a>02461 
<a name="l02462"></a>02462   <span class="keywordflow">if</span> (label)
<a name="l02463"></a>02463     printf(label);
<a name="l02464"></a>02464 
<a name="l02465"></a>02465   printf(<span class="stringliteral">"Shape has %d sides\n"</span>,fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>);
<a name="l02466"></a>02466   <span class="keywordflow">if</span> (verb){
<a name="l02467"></a>02467     printf(<span class="stringliteral">"Faces:\n"</span>);
<a name="l02468"></a>02468     <span class="keywordflow">for</span> (i = 0; i &lt; fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02469"></a>02469       rc = <a class="code" href="group__Subset.html#g9e2ce19c0ca2d3f08df7f02643f82ce3" title="Print subset meta data to stdout, and optionally the member IDs.">fc_printSubset</a>(fcss-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],<span class="stringliteral">""</span>,verb);
<a name="l02470"></a>02470     }
<a name="l02471"></a>02471     printf(<span class="stringliteral">"Elems:\n"</span>);
<a name="l02472"></a>02472     <span class="keywordflow">for</span> (i = 0; i &lt; fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02473"></a>02473       rc = <a class="code" href="group__Subset.html#g9e2ce19c0ca2d3f08df7f02643f82ce3" title="Print subset meta data to stdout, and optionally the member IDs.">fc_printSubset</a>(fcss-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],<span class="stringliteral">""</span>,verb);
<a name="l02474"></a>02474     }
<a name="l02475"></a>02475   }
<a name="l02476"></a>02476 
<a name="l02477"></a>02477   printf(<span class="stringliteral">"AdjMatrix:\n"</span>);
<a name="l02478"></a>02478   <span class="keywordflow">for</span> (i = 0; i &lt; fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l02479"></a>02479     <span class="keywordflow">for</span> (j = 0; j &lt; fcss-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++){
<a name="l02480"></a>02480       printf(<span class="stringliteral">"%d "</span>,fcss-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j]);
<a name="l02481"></a>02481     }
<a name="l02482"></a>02482     printf(<span class="stringliteral">"\n"</span>);
<a name="l02483"></a>02483   }
<a name="l02484"></a>02484   printf(<span class="stringliteral">"\n"</span>);
<a name="l02485"></a>02485 
<a name="l02486"></a>02486   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02487"></a>02487 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gdaf726863fc5a2b2e07012b7ef1b392a"></a><!-- doxytag: member="shape.c::fc_reduceShapeNumSides" ref="gdaf726863fc5a2b2e07012b7ef1b392a" args="(FC_Shape *inshape, int reducedNumSides, FC_Shape *reducedshape)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_reduceShapeNumSides           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>inshape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reducedNumSides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>reducedshape</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a shape and a desired number of sides, fewer than the current number of sides, creates a new shape with the desired number of sides 
<p>
<b>Description:</b> <p>
Given a shape and a desired number of sides, fewer than the current number of sides, creates a new shape with the desired number of sides. This function is intended to be used to merge small, perhaps curved faces into a major side. For instance, if on a rectangular prism with curved edges you set the angle to determine the division between edges as large, then it may resolve into one continuous side; on the other hand, if you set it to small, then all faces along the curve may resolve into distinct sides. If you instead know that you want to end with 6 sides, then call shape with a small angle, resulting in too many sides, and then call this function to reduce the shape to a 6 sided shape, retaining the 6 largest sides.<p>
The innards iterate assigning each reduced out side to an arbitrary side of distance 1 as given by the adj matrix. The reducedout faces therefore arent elegantly distributed into the new sides, and you may end up with odd adjacency matricies as a result.<p>
The kept sides retain their same names and ordering.<p>
See <a class="el" href="group__Shape.html#ge71972e167b0795eb9875d8af2490363">fc_reshapeByAngle</a><p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000079">Todo:</a></b></dt><dd><ul>
<li>avoid the shape copy at the end</li><li>intent is to later have another function that class this one that does the shape call and somehow decides what the ideal number and IDs of sides is. this could be done for basic shapes if there is a great discrepancy in the areas of the resulting sides - e.g., 6 large sides and a zillion small ones</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>08/09/06 ACG creating</li><li>09/27/06 ACG changing algorithm </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>inshape</em>&nbsp;</td><td>
input - shape to be reduced </td></tr>
<tr><td valign="top"><em>reducedNumSides</em>&nbsp;</td><td>
input - number of sides to be in reduced shape </td></tr>
<tr><td valign="top"><em>reducedshape</em>&nbsp;</td><td>
output - the reduced shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l01725">1725</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="subset_8c-source.html#l02064">fc_addArrayMembersToSubset()</a>, <a class="el" href="storage_8c-source.html#l00397">fc_addIntToSortedIntArray()</a>, <a class="el" href="shape_8c-source.html#l03469">fc_calcDistanceMatrix()</a>, <a class="el" href="subset_8c-source.html#l01930">fc_changeSubsetName()</a>, <a class="el" href="shape_8c-source.html#l02098">fc_copyShape()</a>, <a class="el" href="subset_8c-source.html#l00351">fc_copySubset()</a>, <a class="el" href="storage_8c-source.html#l00591">fc_deleteIntFromSortedIntArray()</a>, <a class="el" href="shape_8c-source.html#l02320">fc_freeShape()</a>, <a class="el" href="storage_8c-source.html#l00846">fc_freeSortedIntArray()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="subset_8c-source.html#l02700">fc_getSubsetName()</a>, <a class="el" href="shape_8c-source.html#l02414">fc_initShape()</a>, <a class="el" href="storage_8c-source.html#l00095">fc_initSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="library_8h-source.html#l00154">fc_printfWarningMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>, <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>, and <a class="el" href="storage_8h-source.html#l00101">FC_SortedIntArray::vals</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01729"></a>01729    {
<a name="l01730"></a>01730 
<a name="l01731"></a>01731   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc, rc1, rc2;
<a name="l01732"></a>01732   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l01733"></a>01733   <span class="keywordtype">int</span> **distmatrix;
<a name="l01734"></a>01734 
<a name="l01735"></a>01735   <span class="comment">//dont need to be sorted, just taking advantage of the selfexpansion</span>
<a name="l01736"></a>01736   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> *combosides, *newlyassignedsides;
<a name="l01737"></a>01737   <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> remainingsides;
<a name="l01738"></a>01738   <a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a> newshape;
<a name="l01739"></a>01739   <span class="keywordtype">int</span> i,j,k,l;
<a name="l01740"></a>01740 
<a name="l01741"></a>01741   <span class="comment">//defaults</span>
<a name="l01742"></a>01742   <span class="keywordflow">if</span> (reducedshape){
<a name="l01743"></a>01743     <a class="code" href="group__Shape.html#gb8848b3711ed4db6e2fee49f5de0cd8c" title="inits a Shape">fc_initShape</a>(reducedshape);
<a name="l01744"></a>01744   }
<a name="l01745"></a>01745 
<a name="l01746"></a>01746   <span class="keywordflow">if</span> (!inshape || reducedNumSides &lt; 1 || 
<a name="l01747"></a>01747       reducedNumSides &gt;= inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> ||
<a name="l01748"></a>01748       !reducedshape){
<a name="l01749"></a>01749     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01750"></a>01750     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01751"></a>01751   }
<a name="l01752"></a>01752 
<a name="l01753"></a>01753   <span class="comment">//log message</span>
<a name="l01754"></a>01754   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"reduceShapeNumSides"</span>);
<a name="l01755"></a>01755 
<a name="l01756"></a>01756   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[0],&amp;mesh);
<a name="l01757"></a>01757   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01758"></a>01758     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant get mesh from subset"</span>);
<a name="l01759"></a>01759     <span class="keywordflow">return</span> rc;
<a name="l01760"></a>01760   }
<a name="l01761"></a>01761 
<a name="l01762"></a>01762   <span class="comment">//first copy the sides that we are keeping over</span>
<a name="l01763"></a>01763   combosides = (<a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a>*)malloc(reducedNumSides*
<a name="l01764"></a>01764                            <span class="keyword">sizeof</span>(<a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a>));
<a name="l01765"></a>01765   newlyassignedsides = (<a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a>*)malloc(reducedNumSides*
<a name="l01766"></a>01766                            <span class="keyword">sizeof</span>(<a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a>));
<a name="l01767"></a>01767   <span class="keywordflow">if</span> (!combosides || ! newlyassignedsides){
<a name="l01768"></a>01768     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01769"></a>01769     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01770"></a>01770   }
<a name="l01771"></a>01771 
<a name="l01772"></a>01772   <span class="keywordflow">for</span> (i = 0; i &lt; reducedNumSides; i++){
<a name="l01773"></a>01773     rc1 = <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;combosides[i]);
<a name="l01774"></a>01774     rc2 = <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;newlyassignedsides[i]);
<a name="l01775"></a>01775     <span class="keywordflow">if</span> (rc1 !=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01776"></a>01776       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't init SIA"</span>);
<a name="l01777"></a>01777       <span class="keywordflow">for</span> (j = 0; j &lt; i; j++){
<a name="l01778"></a>01778      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01779"></a>01779      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01780"></a>01780       }
<a name="l01781"></a>01781       free(combosides);
<a name="l01782"></a>01782       free(newlyassignedsides);
<a name="l01783"></a>01783       <span class="keywordflow">return</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l01784"></a>01784     }
<a name="l01785"></a>01785     rc = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;combosides[i],i);
<a name="l01786"></a>01786     <span class="keywordflow">if</span> (rc &lt; 0){
<a name="l01787"></a>01787       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't add int to SIA"</span>);
<a name="l01788"></a>01788       <span class="keywordflow">for</span> (j = 0; j &lt; i; j++){
<a name="l01789"></a>01789      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01790"></a>01790      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01791"></a>01791       }
<a name="l01792"></a>01792       free(combosides);
<a name="l01793"></a>01793       free(newlyassignedsides);
<a name="l01794"></a>01794       <span class="keywordflow">return</span> rc;
<a name="l01795"></a>01795     }
<a name="l01796"></a>01796   }
<a name="l01797"></a>01797 
<a name="l01798"></a>01798   <span class="comment">//get ids for left over faces</span>
<a name="l01799"></a>01799   rc = <a class="code" href="group__SimpleDataObjects.html#g2a977bec6f7ae75297a4dcf7ec079bb7" title="Initialize a sorted int array.">fc_initSortedIntArray</a>(&amp;remainingsides);
<a name="l01800"></a>01800   <span class="keywordflow">if</span> (rc !=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01801"></a>01801     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant init sia"</span>);
<a name="l01802"></a>01802     <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01803"></a>01803       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);   
<a name="l01804"></a>01804       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01805"></a>01805     }
<a name="l01806"></a>01806     free(combosides);
<a name="l01807"></a>01807     free(newlyassignedsides);
<a name="l01808"></a>01808     <span class="keywordflow">return</span> rc;
<a name="l01809"></a>01809   }
<a name="l01810"></a>01810 
<a name="l01811"></a>01811   <span class="keywordflow">for</span> (i = reducedNumSides; i &lt; inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l01812"></a>01812     rc = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;remainingsides,i);
<a name="l01813"></a>01813     <span class="keywordflow">if</span> (rc &lt; 0){
<a name="l01814"></a>01814       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant add int to SIA"</span>);
<a name="l01815"></a>01815       <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01816"></a>01816      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01817"></a>01817      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01818"></a>01818       }
<a name="l01819"></a>01819       free(combosides);
<a name="l01820"></a>01820       free(newlyassignedsides);
<a name="l01821"></a>01821       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;remainingsides);
<a name="l01822"></a>01822       <span class="keywordflow">return</span> rc;
<a name="l01823"></a>01823     }
<a name="l01824"></a>01824   }
<a name="l01825"></a>01825 
<a name="l01826"></a>01826   rc = <a class="code" href="group__Shape.html#g1c7648a1250fe6a2b2ff7d2dafe53a91" title="Given an nxn adjacency matrix returns the (shortestpath) distance matrix.">fc_calcDistanceMatrix</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>, inshape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>,
<a name="l01827"></a>01827                     &amp;distmatrix);
<a name="l01828"></a>01828   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01829"></a>01829     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get dist matrix"</span>);
<a name="l01830"></a>01830     <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01831"></a>01831       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01832"></a>01832       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01833"></a>01833     }
<a name="l01834"></a>01834     free(combosides);
<a name="l01835"></a>01835     free(newlyassignedsides);
<a name="l01836"></a>01836     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;remainingsides);
<a name="l01837"></a>01837     <span class="keywordflow">return</span> rc;
<a name="l01838"></a>01838   }
<a name="l01839"></a>01839 
<a name="l01840"></a>01840   <span class="keywordflow">while</span>(remainingsides.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>){
<a name="l01841"></a>01841     <span class="keywordtype">int</span> assigned = 0;
<a name="l01842"></a>01842     
<a name="l01843"></a>01843     <span class="comment">//find all sides that are distance 1 from one ofthe established sides</span>
<a name="l01844"></a>01844     <span class="comment">//only update the established sides after each pass</span>
<a name="l01845"></a>01845     <span class="keywordflow">for</span> (i = 0; i &lt; remainingsides.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; i++){
<a name="l01846"></a>01846       <span class="keywordtype">int</span> foundside = 0;
<a name="l01847"></a>01847       <span class="keywordtype">int</span> comboid;
<a name="l01848"></a>01848       <span class="keywordtype">int</span> currside = remainingsides.<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[i];
<a name="l01849"></a>01849       <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01850"></a>01850      <span class="keywordflow">for</span> (k = 0; k &lt; combosides[j].<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; k++){
<a name="l01851"></a>01851        <span class="keywordtype">int</span> compside = combosides[j].<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[k];
<a name="l01852"></a>01852        comboid = j;
<a name="l01853"></a>01853        <span class="keywordflow">if</span> (distmatrix[currside][compside] ==1){
<a name="l01854"></a>01854          foundside = 1;
<a name="l01855"></a>01855          <span class="keywordflow">break</span>;
<a name="l01856"></a>01856        }
<a name="l01857"></a>01857      }
<a name="l01858"></a>01858      <span class="keywordflow">if</span> (foundside)
<a name="l01859"></a>01859        <span class="keywordflow">break</span>;
<a name="l01860"></a>01860       }
<a name="l01861"></a>01861       <span class="keywordflow">if</span> (foundside){
<a name="l01862"></a>01862      rc1 = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;newlyassignedsides[j],currside);
<a name="l01863"></a>01863      rc2 = <a class="code" href="group__SimpleDataObjects.html#gc800f634fb42d44a6c31d79743a6864c" title="Remove an int from a sorted int array.">fc_deleteIntFromSortedIntArray</a>(&amp;remainingsides,currside);
<a name="l01864"></a>01864      <span class="keywordflow">if</span> (rc1 &lt; 0 || rc2 &lt; 0){
<a name="l01865"></a>01865        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant add/delete int to/from SIA"</span>);
<a name="l01866"></a>01866        <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01867"></a>01867          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01868"></a>01868          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01869"></a>01869        }
<a name="l01870"></a>01870        free(combosides);
<a name="l01871"></a>01871        free(newlyassignedsides);
<a name="l01872"></a>01872        <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;remainingsides);
<a name="l01873"></a>01873        <span class="keywordflow">for</span> (j = 0; j &lt; inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++){
<a name="l01874"></a>01874          free(distmatrix[j]);
<a name="l01875"></a>01875        }
<a name="l01876"></a>01876        free(distmatrix);
<a name="l01877"></a>01877        <span class="keywordflow">return</span> (rc1 &lt; 0 ? rc1 : rc2);
<a name="l01878"></a>01878      }
<a name="l01879"></a>01879      assigned++;
<a name="l01880"></a>01880       }
<a name="l01881"></a>01881     }
<a name="l01882"></a>01882     
<a name="l01883"></a>01883     <span class="keywordflow">if</span> (!assigned){
<a name="l01884"></a>01884       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"None of the remaining sides are distance 1 from any of the current sides"</span>);
<a name="l01885"></a>01885       <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01886"></a>01886      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01887"></a>01887      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01888"></a>01888       }
<a name="l01889"></a>01889       free(combosides);
<a name="l01890"></a>01890       free(newlyassignedsides);
<a name="l01891"></a>01891       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;remainingsides);
<a name="l01892"></a>01892       <span class="keywordflow">for</span> (j = 0; j &lt; inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++){
<a name="l01893"></a>01893      free(distmatrix[j]);
<a name="l01894"></a>01894       }
<a name="l01895"></a>01895       free(distmatrix);
<a name="l01896"></a>01896       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01897"></a>01897     }
<a name="l01898"></a>01898 
<a name="l01899"></a>01899     <span class="comment">//copy the newly assigned sides into the established sides</span>
<a name="l01900"></a>01900     <span class="keywordflow">for</span> (i = 0; i &lt; reducedNumSides; i++){
<a name="l01901"></a>01901       <span class="keywordflow">for</span> (j = 0; j &lt; newlyassignedsides[i].<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; j++){
<a name="l01902"></a>01902      rc = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;combosides[i],newlyassignedsides[i].vals[j]);
<a name="l01903"></a>01903      <span class="keywordflow">if</span> (rc &lt; 0){
<a name="l01904"></a>01904        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant add int to SIA"</span>);
<a name="l01905"></a>01905        <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01906"></a>01906          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01907"></a>01907          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[j]);
<a name="l01908"></a>01908        }
<a name="l01909"></a>01909        free(combosides);
<a name="l01910"></a>01910        free(newlyassignedsides);
<a name="l01911"></a>01911        <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;remainingsides);
<a name="l01912"></a>01912        <span class="keywordflow">for</span> (j = 0; j &lt; inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++){
<a name="l01913"></a>01913          free(distmatrix[j]);
<a name="l01914"></a>01914        }
<a name="l01915"></a>01915        free(distmatrix);
<a name="l01916"></a>01916        <span class="keywordflow">return</span> rc;
<a name="l01917"></a>01917      }
<a name="l01918"></a>01918       }
<a name="l01919"></a>01919       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;newlyassignedsides[i]);
<a name="l01920"></a>01920     }
<a name="l01921"></a>01921   } <span class="comment">//while</span>
<a name="l01922"></a>01922 
<a name="l01923"></a>01923   <span class="comment">//clean up some things</span>
<a name="l01924"></a>01924   <span class="keywordflow">for</span> (j = 0; j &lt; inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; j++){
<a name="l01925"></a>01925     free(distmatrix[j]);
<a name="l01926"></a>01926   }
<a name="l01927"></a>01927   free(distmatrix);
<a name="l01928"></a>01928   free(newlyassignedsides); <span class="comment">//individual ones already freed</span>
<a name="l01929"></a>01929   <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;remainingsides);
<a name="l01930"></a>01930 
<a name="l01931"></a>01931   <span class="comment">//now build the new shape</span>
<a name="l01932"></a>01932   newshape.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = reducedNumSides;
<a name="l01933"></a>01933   newshape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(reducedNumSides*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01934"></a>01934   newshape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(reducedNumSides*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01935"></a>01935   newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a> = (<span class="keywordtype">int</span>**)malloc(reducedNumSides*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l01936"></a>01936   <span class="keywordflow">if</span> (!newshape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> || !newshape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> || !newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>){
<a name="l01937"></a>01937     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01938"></a>01938     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01939"></a>01939   }
<a name="l01940"></a>01940 
<a name="l01941"></a>01941   <span class="keywordflow">for</span> (i = 0; i &lt; reducedNumSides; i++){
<a name="l01942"></a>01942     <span class="comment">//allocate them all now so can use free shape as a set later</span>
<a name="l01943"></a>01943     newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i] = (<span class="keywordtype">int</span>*)malloc(reducedNumSides*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01944"></a>01944     <span class="keywordflow">if</span> (!newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i]){
<a name="l01945"></a>01945       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01946"></a>01946       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01947"></a>01947     }
<a name="l01948"></a>01948     <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l01949"></a>01949       newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] = 0;
<a name="l01950"></a>01950     }
<a name="l01951"></a>01951   }
<a name="l01952"></a>01952 
<a name="l01953"></a>01953   <span class="keywordflow">for</span> (i = 0; i &lt; reducedNumSides; i++){
<a name="l01954"></a>01954     <span class="keywordtype">int</span> nume, numf;
<a name="l01955"></a>01955     <span class="keywordtype">int</span> *arrf, *arre;
<a name="l01956"></a>01956     <span class="keywordtype">char</span> *temp;
<a name="l01957"></a>01957 
<a name="l01958"></a>01958     <span class="comment">//assign the first item in each combo side to the new side</span>
<a name="l01959"></a>01959     rc1 = <a class="code" href="group__Subset.html#g8c233583d14e8205bbfe4aca0d196772" title="Copy subset to a new subset.">fc_copySubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[combosides[i].<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[0]],mesh,
<a name="l01960"></a>01960                <span class="stringliteral">"temp"</span>,&amp;(newshape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i]));
<a name="l01961"></a>01961     rc2 = <a class="code" href="group__Subset.html#g8c233583d14e8205bbfe4aca0d196772" title="Copy subset to a new subset.">fc_copySubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[combosides[i].<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[0]],mesh,
<a name="l01962"></a>01962                <span class="stringliteral">"temp"</span>,&amp;(newshape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i]));
<a name="l01963"></a>01963     <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01964"></a>01964       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cant copy subsets"</span>);
<a name="l01965"></a>01965       <span class="keywordflow">for</span> (j = 0; j &lt;= i; j++){
<a name="l01966"></a>01966      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l01967"></a>01967       }
<a name="l01968"></a>01968       free(combosides);
<a name="l01969"></a>01969       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;newshape);
<a name="l01970"></a>01970       <span class="keywordflow">return</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1:rc2);
<a name="l01971"></a>01971     }
<a name="l01972"></a>01972     
<a name="l01973"></a>01973     <span class="comment">//rename them to what they were in that original position</span>
<a name="l01974"></a>01974     <span class="comment">//if cant rename, just warn</span>
<a name="l01975"></a>01975     rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],&amp;temp);
<a name="l01976"></a>01976     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || temp == NULL){
<a name="l01977"></a>01977       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"fc_reduceShapeNumSides can't get name for face side %d"</span>, i);
<a name="l01978"></a>01978     }<span class="keywordflow">else</span>{
<a name="l01979"></a>01979       rc = <a class="code" href="group__Subset.html#gb0b2c83895c19e4df36adae6fcba8922" title="Change the name of a subset.">fc_changeSubsetName</a>(newshape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],temp);
<a name="l01980"></a>01980       <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01981"></a>01981      <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"fc_reduceShapeNumSides can't rename face side %d"</span>, i);
<a name="l01982"></a>01982       }
<a name="l01983"></a>01983     }
<a name="l01984"></a>01984     <span class="keywordflow">if</span> (temp) free(temp);
<a name="l01985"></a>01985        
<a name="l01986"></a>01986     rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],&amp;temp);
<a name="l01987"></a>01987     <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || temp == NULL){
<a name="l01988"></a>01988       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"fc_reduceShapeNumSides can't get name for elem side %d"</span>, i);
<a name="l01989"></a>01989     }<span class="keywordflow">else</span>{
<a name="l01990"></a>01990       rc = <a class="code" href="group__Subset.html#gb0b2c83895c19e4df36adae6fcba8922" title="Change the name of a subset.">fc_changeSubsetName</a>(newshape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],temp);
<a name="l01991"></a>01991       <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01992"></a>01992      <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"fc_reduceShapeNumSides can't rename elem side %d"</span>, i);
<a name="l01993"></a>01993       }
<a name="l01994"></a>01994     }
<a name="l01995"></a>01995     <span class="keywordflow">if</span> (temp) free(temp);
<a name="l01996"></a>01996 
<a name="l01997"></a>01997     <span class="comment">//now copy all other members over</span>
<a name="l01998"></a>01998     <span class="keywordflow">for</span> (j = 1; j &lt; combosides[i].<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; j++){
<a name="l01999"></a>01999       <span class="keywordtype">int</span> currside = combosides[i].<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[j];
<a name="l02000"></a>02000       rc1 = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[currside],
<a name="l02001"></a>02001                            &amp;numf,&amp;arrf);
<a name="l02002"></a>02002       rc2 = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[currside],
<a name="l02003"></a>02003                            &amp;nume,&amp;arre);
<a name="l02004"></a>02004       <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02005"></a>02005      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get subset members"</span>);
<a name="l02006"></a>02006      <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l02007"></a>02007        <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l02008"></a>02008      }
<a name="l02009"></a>02009      free(combosides);
<a name="l02010"></a>02010      <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;newshape);
<a name="l02011"></a>02011      <span class="keywordflow">if</span> (arrf) free (arrf);
<a name="l02012"></a>02012      <span class="keywordflow">if</span> (arre) free (arre);
<a name="l02013"></a>02013      <span class="keywordflow">return</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l02014"></a>02014       }
<a name="l02015"></a>02015 
<a name="l02016"></a>02016       <span class="comment">//make sure wont fail if add duplicates</span>
<a name="l02017"></a>02017       rc1 = <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(newshape.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],
<a name="l02018"></a>02018                            numf,arrf);
<a name="l02019"></a>02019       rc1 = <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(newshape.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],
<a name="l02020"></a>02020                            nume,arre);
<a name="l02021"></a>02021       free(arrf);
<a name="l02022"></a>02022       free(arre);
<a name="l02023"></a>02023       <span class="keywordflow">if</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || rc2 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02024"></a>02024      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't add subset members"</span>);
<a name="l02025"></a>02025      <span class="keywordflow">for</span> (j = 0; j &lt; reducedNumSides; j++){
<a name="l02026"></a>02026        <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[j]);
<a name="l02027"></a>02027      }
<a name="l02028"></a>02028      free(combosides);
<a name="l02029"></a>02029      <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;newshape);
<a name="l02030"></a>02030      <span class="keywordflow">return</span> (rc1 != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> ? rc1 : rc2);
<a name="l02031"></a>02031       }
<a name="l02032"></a>02032     } <span class="comment">//combosides.numVal</span>
<a name="l02033"></a>02033   } <span class="comment">// reducedNumSides</span>
<a name="l02034"></a>02034 
<a name="l02035"></a>02035 
<a name="l02036"></a>02036   <span class="comment">//now all the sides have been assigned and the faces and the elems put in</span>
<a name="l02037"></a>02037   <span class="comment">//the adj matrix is all zeros at this point</span>
<a name="l02038"></a>02038   <span class="keywordflow">for</span> (i = 0; i &lt; reducedNumSides; i++){
<a name="l02039"></a>02039     <span class="keywordflow">for</span> (j = i+1; j &lt; reducedNumSides; j++){
<a name="l02040"></a>02040       <span class="keywordflow">if</span> (inshape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j]){
<a name="l02041"></a>02041      <span class="comment">//if they were adj before, they still are</span>
<a name="l02042"></a>02042      newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] = 1;
<a name="l02043"></a>02043      newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[j][i] = 1;
<a name="l02044"></a>02044       }<span class="keywordflow">else</span>{
<a name="l02045"></a>02045      <span class="comment">//they may now be adj becuase of the reducing</span>
<a name="l02046"></a>02046      <span class="keywordflow">for</span> (k = 0; k &lt; combosides[i].<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; k++){
<a name="l02047"></a>02047        <span class="keywordflow">for</span> (l = 0; l &lt; combosides[j].<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>; l++){
<a name="l02048"></a>02048          <span class="keywordtype">int</span> sideA = combosides[i].<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[k];
<a name="l02049"></a>02049          <span class="keywordtype">int</span> sideB = combosides[j].<a class="code" href="structFC__SortedIntArray.html#fa5b781371ed7570eeecaac539f10426">vals</a>[l];
<a name="l02050"></a>02050          <span class="keywordflow">if</span> (inshape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[sideA][sideB]){
<a name="l02051"></a>02051            newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j] = 1;
<a name="l02052"></a>02052            newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[j][i] = 1;
<a name="l02053"></a>02053            <span class="keywordflow">break</span>;
<a name="l02054"></a>02054          }
<a name="l02055"></a>02055        }
<a name="l02056"></a>02056        <span class="keywordflow">if</span> (newshape.<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i][j]){
<a name="l02057"></a>02057          <span class="comment">//we found a match inside</span>
<a name="l02058"></a>02058          <span class="keywordflow">break</span>;
<a name="l02059"></a>02059        }
<a name="l02060"></a>02060      }
<a name="l02061"></a>02061       }
<a name="l02062"></a>02062     }
<a name="l02063"></a>02063   }
<a name="l02064"></a>02064 
<a name="l02065"></a>02065   <span class="comment">//cleanup</span>
<a name="l02066"></a>02066   <span class="keywordflow">for</span> (i = 0; i &lt; reducedNumSides; i++){
<a name="l02067"></a>02067     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;combosides[i]);
<a name="l02068"></a>02068   }
<a name="l02069"></a>02069   free(combosides);
<a name="l02070"></a>02070 
<a name="l02071"></a>02071   <span class="comment">//handle this shape better</span>
<a name="l02072"></a>02072   rc = <a class="code" href="group__Shape.html#gcf5618411fe3bf78dec5b0c8cba35766" title="Copy a shape.">fc_copyShape</a>(&amp;newshape,reducedshape);
<a name="l02073"></a>02073   <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;newshape);
<a name="l02074"></a>02074 
<a name="l02075"></a>02075   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02076"></a>02076 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2e06fed57b8dac98cac3f52481a7f21c"></a><!-- doxytag: member="shape.c::fc_reorderShape" ref="g2e06fed57b8dac98cac3f52481a7f21c" args="(int *neworder, FC_Shape *shape)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_reorderShape           </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>neworder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a new ordering of the sides, reorders a shape 
<p>
<b>Description:</b> <p>
Given a new ordering of the sides, reorders a shape. Example: given the orig sides (set0,set1,set2,set3,set4) with new order = (2,4,1,0,3) then the sides will be reordered to (set2,set4,set1,set0,set3). That is what was in place 2 has been moved to place 0, as opposed to moving what was in place 0 to place 2.<p>
This keeps the original names of the subsets to allow referring to subsets by name to still be consistent. If you want to reorder the names, you must do so manually.<p>
<b>Modifications:</b> <ul>
<li>06/18/06 ACG created</li><li>06/19/06 ACG changed reorder so the indicies are now what the new order is going to be, rather than where the old order is moving to, because its more intuitive that way. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>neworder</em>&nbsp;</td><td>
input - array of new order of indicies </td></tr>
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
output - ptr to the shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l02222">2222</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02225"></a>02225  {
<a name="l02226"></a>02226 
<a name="l02227"></a>02227   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *temp, *temp2; 
<a name="l02228"></a>02228   <span class="keywordtype">int</span> numSides;
<a name="l02229"></a>02229   <span class="keywordtype">int</span>** adjmatrix;
<a name="l02230"></a>02230   <span class="keywordtype">int</span> i,j;
<a name="l02231"></a>02231 
<a name="l02232"></a>02232   <span class="comment">//no defaults</span>
<a name="l02233"></a>02233 
<a name="l02234"></a>02234   <span class="keywordflow">if</span> (!shape || !neworder){
<a name="l02235"></a>02235     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02236"></a>02236     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02237"></a>02237   }
<a name="l02238"></a>02238 
<a name="l02239"></a>02239   <span class="comment">// log message</span>
<a name="l02240"></a>02240   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"reordering shape"</span>);
<a name="l02241"></a>02241 
<a name="l02242"></a>02242   numSides = shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>;
<a name="l02243"></a>02243 
<a name="l02244"></a>02244   <span class="comment">//make sure neworder array makes sense</span>
<a name="l02245"></a>02245   <span class="keywordtype">int</span> *test = calloc(numSides, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02246"></a>02246   <span class="keywordflow">if</span> (test == NULL) {
<a name="l02247"></a>02247     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02248"></a>02248     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02249"></a>02249   }
<a name="l02250"></a>02250 
<a name="l02251"></a>02251   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l02252"></a>02252     <span class="keywordflow">if</span> (neworder[i] &lt; 0 || neworder[i] &gt;= numSides){
<a name="l02253"></a>02253       free(test);
<a name="l02254"></a>02254       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02255"></a>02255     }
<a name="l02256"></a>02256     test[neworder[i]] = 1;
<a name="l02257"></a>02257   }
<a name="l02258"></a>02258 
<a name="l02259"></a>02259   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l02260"></a>02260     <span class="keywordflow">if</span> (!test[i]){
<a name="l02261"></a>02261       free(test);
<a name="l02262"></a>02262       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02263"></a>02263     }
<a name="l02264"></a>02264   }
<a name="l02265"></a>02265   
<a name="l02266"></a>02266   free(test);
<a name="l02267"></a>02267 
<a name="l02268"></a>02268   <span class="comment">//doesnt swap ptrs to subsets, since the subsets themselves are just handles.</span>
<a name="l02269"></a>02269   temp = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(numSides*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02270"></a>02270   temp2 = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(numSides*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02271"></a>02271   adjmatrix = (<span class="keywordtype">int</span>**)malloc(numSides*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l02272"></a>02272   <span class="keywordflow">if</span> (temp == NULL || temp2 == NULL || adjmatrix == NULL) {
<a name="l02273"></a>02273     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02274"></a>02274     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02275"></a>02275   }
<a name="l02276"></a>02276   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l02277"></a>02277     temp[i] = shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[neworder[i]];
<a name="l02278"></a>02278     temp2[i] = shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[neworder[i]];
<a name="l02279"></a>02279     adjmatrix[i] = (<span class="keywordtype">int</span>*)malloc(numSides*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02280"></a>02280     <span class="keywordflow">if</span> (adjmatrix[i] == NULL){
<a name="l02281"></a>02281       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02282"></a>02282       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02283"></a>02283     }
<a name="l02284"></a>02284   }
<a name="l02285"></a>02285 
<a name="l02286"></a>02286   free(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>);
<a name="l02287"></a>02287   free(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>);
<a name="l02288"></a>02288   shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> = temp;
<a name="l02289"></a>02289   shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> = temp2;
<a name="l02290"></a>02290 
<a name="l02291"></a>02291   <span class="keywordflow">for</span> (i =0; i &lt; numSides; i++){
<a name="l02292"></a>02292     <span class="keywordflow">for</span> (j =0; j &lt; numSides; j++){
<a name="l02293"></a>02293       adjmatrix[i][j] = shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[neworder[i]][neworder[j]];
<a name="l02294"></a>02294     }
<a name="l02295"></a>02295   }
<a name="l02296"></a>02296   <span class="keywordflow">for</span> (i =0; i &lt; numSides; i++){
<a name="l02297"></a>02297     free(shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>[i]);
<a name="l02298"></a>02298   }
<a name="l02299"></a>02299   free(shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a>);
<a name="l02300"></a>02300 
<a name="l02301"></a>02301   shape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a> = adjmatrix;
<a name="l02302"></a>02302   
<a name="l02303"></a>02303   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02304"></a>02304 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge71972e167b0795eb9875d8af2490363"></a><!-- doxytag: member="shape.c::fc_reshapeByAngle" ref="ge71972e167b0795eb9875d8af2490363" args="(FC_Shape *inshape, double newangle, int seg_dim, FC_Shape *newshape)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_reshapeByAngle           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>inshape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>newangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>seg_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>newshape</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a shape and a new angle, creates a new shape where the sides are distinguished byt he new angle 
<p>
<b>Description:</b> <p>
given a shape and a new angle, creates a new shape where the sides are distinguished by the new angle. The shared dim is used to determine neighbors for comparison when you build the sides, but since you are limited only to those sides that are in the orginal shape, you should keep this to the orignal number used. (I have no way of checking that)<p>
This function is intended to be used 1) when you get too few sides or 2) if you have too many sides, as an alternate crtieria for merging sides than <a class="el" href="group__Shape.html#gdaf726863fc5a2b2e07012b7ef1b392a">fc_reduceShapeNumSides</a> uses.<p>
The face and elem subsets will be named "Reshape" postpended with "Shape#" followed by "_FaceSurface#" or "_ElemSurface#" where # will be the index into the array of subsets for that shape.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000078">Todo:</a></b></dt><dd><ul>
<li>check if segdim is a problem or not</li><li>better new shape name</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>08/19/06 ACG creating </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>inshape</em>&nbsp;</td><td>
input - orig shape </td></tr>
<tr><td valign="top"><em>newangle</em>&nbsp;</td><td>
input - new angle used for the reshaping </td></tr>
<tr><td valign="top"><em>seg_dim</em>&nbsp;</td><td>
input - seg dim, should be that used for building the orig shape </td></tr>
<tr><td valign="top"><em>newshape</em>&nbsp;</td><td>
output - the new shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l01609">1609</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00593">_fc_buildFaceInfoListFromShape()</a>, <a class="el" href="shape_8c-source.html#l00893">_fc_createShapePartsFromFaceInfoList()</a>, <a class="el" href="shape_8c-source.html#l00347">_fc_freeSFI_Array()</a>, <a class="el" href="shape_8h-source.html#l00090">FC_Shape::adjmatrix</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="shape_8c-source.html#l02414">fc_initShape()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01614"></a>01614  {
<a name="l01615"></a>01615 
<a name="l01616"></a>01616   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01617"></a>01617   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l01618"></a>01618 
<a name="l01619"></a>01619   <a class="code" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> faceinfo_list;
<a name="l01620"></a>01620   <span class="keywordtype">int</span> numSides;
<a name="l01621"></a>01621   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* newFaceSubsets;
<a name="l01622"></a>01622   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* newElemSubsets;
<a name="l01623"></a>01623   <span class="keywordtype">int</span> **adjmatrix;
<a name="l01624"></a>01624   <span class="keywordtype">char</span>* newname = <span class="stringliteral">"Reshape"</span>;
<a name="l01625"></a>01625 
<a name="l01626"></a>01626   <span class="comment">// default return - freeing shape is not an option</span>
<a name="l01627"></a>01627   <span class="keywordflow">if</span> (newshape){
<a name="l01628"></a>01628     <a class="code" href="group__Shape.html#gb8848b3711ed4db6e2fee49f5de0cd8c" title="inits a Shape">fc_initShape</a>(newshape);
<a name="l01629"></a>01629   }
<a name="l01630"></a>01630 
<a name="l01631"></a>01631 
<a name="l01632"></a>01632   <span class="keywordflow">if</span> (!inshape || !newshape || newangle &lt; 0 ||
<a name="l01633"></a>01633       newangle &gt; 180 || seg_dim &lt; 0 || seg_dim &gt; 2 || 
<a name="l01634"></a>01634       !(inshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>)){
<a name="l01635"></a>01635     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01636"></a>01636     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01637"></a>01637   }
<a name="l01638"></a>01638 
<a name="l01639"></a>01639   <span class="comment">//log message</span>
<a name="l01640"></a>01640   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"reshape by angle"</span>);
<a name="l01641"></a>01641 
<a name="l01642"></a>01642   <span class="comment">//assume that since we have a shape already, the topology etc is correct.</span>
<a name="l01643"></a>01643   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(inshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[0],&amp;mesh);
<a name="l01644"></a>01644   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01645"></a>01645     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get mesh for shape"</span>);
<a name="l01646"></a>01646     <span class="keywordflow">return</span> rc;
<a name="l01647"></a>01647   }
<a name="l01648"></a>01648 
<a name="l01649"></a>01649   rc = <a class="code" href="group__PrivateShape.html#gcc118132a213d6b6daa6425fb571d4ed" title="given a current shape, return sorted array of ptrs to faceinfos for the shape sides...">_fc_buildFaceInfoListFromShape</a>(inshape,&amp;faceinfo_list);
<a name="l01650"></a>01650   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01651"></a>01651     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"can't build face info list\n"</span>);
<a name="l01652"></a>01652     <span class="keywordflow">return</span> rc;
<a name="l01653"></a>01653   }
<a name="l01654"></a>01654 
<a name="l01655"></a>01655   rc = <a class="code" href="group__PrivateShape.html#g3e9cf7ace4ab706649116911f6ee379e" title="makes the shape parts from the faceinfolist">_fc_createShapePartsFromFaceInfoList</a>(mesh,&amp;faceinfo_list,
<a name="l01656"></a>01656                              &amp;newname,newangle,
<a name="l01657"></a>01657                              seg_dim,
<a name="l01658"></a>01658                              &amp;numSides,
<a name="l01659"></a>01659                              &amp;newFaceSubsets,
<a name="l01660"></a>01660                              &amp;newElemSubsets,
<a name="l01661"></a>01661                              &amp;adjmatrix);
<a name="l01662"></a>01662   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01663"></a>01663     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"can't create shape parts from face info list\n"</span>);
<a name="l01664"></a>01664     <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(&amp;faceinfo_list);
<a name="l01665"></a>01665     <span class="keywordflow">return</span> rc;
<a name="l01666"></a>01666   }
<a name="l01667"></a>01667 
<a name="l01668"></a>01668   <span class="comment">//unlike subsetshapes we want to return this as one shape</span>
<a name="l01669"></a>01669   newshape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> = numSides;
<a name="l01670"></a>01670   newshape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a> = newFaceSubsets;
<a name="l01671"></a>01671   newshape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a> = newElemSubsets;
<a name="l01672"></a>01672   newshape-&gt;<a class="code" href="structFC__Shape.html#ced3c3bee8517e9b1070d152b94db672">adjmatrix</a> = adjmatrix; 
<a name="l01673"></a>01673 
<a name="l01674"></a>01674   <span class="comment">//dont free anything since theyve been assigned to the shape</span>
<a name="l01675"></a>01675   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01676"></a>01676 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g0bd777744173330b8a9d77b85eb53b0c"></a><!-- doxytag: member="shape.c::fc_segmentAdjacencyMatrix" ref="g0bd777744173330b8a9d77b85eb53b0c" args="(int matrixdim, int **adjmatrix, int *numsegments, int **sidespersegment, int ***sideids)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> fc_segmentAdjacencyMatrix           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>matrixdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>adjmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numsegments</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>sidespersegment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int ***&nbsp;</td>
          <td class="paramname"> <em>sideids</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given an adjacency matrix, returns segments of it based on connectivities. 
<p>
<b>Description:</b> <p>
Given an adjacency matrix, returns segments of it based on connectivities<p>
Note that pieces that are touching will come out as 1 distinct shape with a lot of edges as opposed to two distinct shapes. Segment will do the same thing.<p>
<b>Modifications:</b> <ul>
<li>06/01/06 ACG created.</li><li>06/23/06 ACG unittested, added defaults and input checking </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>matrixdim</em>&nbsp;</td><td>
input - dim of the adj matrix </td></tr>
<tr><td valign="top"><em>adjmatrix</em>&nbsp;</td><td>
input - adj matrix </td></tr>
<tr><td valign="top"><em>numsegments</em>&nbsp;</td><td>
output - number of distinct shapes </td></tr>
<tr><td valign="top"><em>sidespersegment</em>&nbsp;</td><td>
output - number of sides for each distinct shape </td></tr>
<tr><td valign="top"><em>sideids</em>&nbsp;</td><td>
output - array of sideids(orig matrix numbers) for each distinct shape </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l03307">3307</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l01339">fc_getSubsetShapes()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03313"></a>03313  {
<a name="l03314"></a>03314   <span class="keywordtype">int</span> numSides;
<a name="l03315"></a>03315 
<a name="l03316"></a>03316   <span class="keywordtype">int</span> **partsideids; <span class="comment">/* array of arrays, 1 for each part */</span>
<a name="l03317"></a>03317   <span class="keywordtype">int</span> *sidesperpart;
<a name="l03318"></a>03318   <span class="keywordtype">int</span> numparts;
<a name="l03319"></a>03319   <span class="keywordtype">int</span> maxparts;
<a name="l03320"></a>03320 
<a name="l03321"></a>03321   <span class="keywordtype">int</span> *search;
<a name="l03322"></a>03322   <span class="keywordtype">int</span> i,j,k;
<a name="l03323"></a>03323 
<a name="l03324"></a>03324   <span class="comment">//defaults</span>
<a name="l03325"></a>03325   <span class="keywordflow">if</span> (numsegments)
<a name="l03326"></a>03326     *numsegments = -1;
<a name="l03327"></a>03327   <span class="keywordflow">if</span> (sidespersegment)
<a name="l03328"></a>03328     *sidespersegment = NULL;
<a name="l03329"></a>03329   <span class="keywordflow">if</span> (sideids)
<a name="l03330"></a>03330     *sideids = NULL;
<a name="l03331"></a>03331 
<a name="l03332"></a>03332 
<a name="l03333"></a>03333   <span class="keywordflow">if</span> (matrixdim &lt; 1 || !adjmatrix || !numsegments || !sidespersegment ||
<a name="l03334"></a>03334       !sideids){
<a name="l03335"></a>03335     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03336"></a>03336     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03337"></a>03337   }
<a name="l03338"></a>03338 
<a name="l03339"></a>03339   <span class="comment">// log message</span>
<a name="l03340"></a>03340   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Segmenting Adj Matrix"</span>);
<a name="l03341"></a>03341 
<a name="l03342"></a>03342   <span class="comment">//test that the matrix is symm and only has 0 &amp; 1</span>
<a name="l03343"></a>03343   <span class="keywordflow">for</span> (i = 0; i &lt; matrixdim; i++){
<a name="l03344"></a>03344     <span class="keywordflow">if</span> (adjmatrix[i][i] != 0){
<a name="l03345"></a>03345       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"adj matrix diag elem must be zero"</span>);
<a name="l03346"></a>03346       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03347"></a>03347     }
<a name="l03348"></a>03348     <span class="keywordflow">for</span> (j = 0; j &lt; matrixdim; j++){
<a name="l03349"></a>03349       <span class="keywordflow">if</span> (adjmatrix[i][j] != adjmatrix[j][i] || 
<a name="l03350"></a>03350        (adjmatrix[i][j] != 1 &amp;&amp; adjmatrix[i][j] != 0)){
<a name="l03351"></a>03351      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"adj matrix must be symm and elems must be 0 or 1"</span>);
<a name="l03352"></a>03352      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03353"></a>03353       }
<a name="l03354"></a>03354     }
<a name="l03355"></a>03355   }
<a name="l03356"></a>03356 
<a name="l03357"></a>03357   numSides = matrixdim;
<a name="l03358"></a>03358 
<a name="l03359"></a>03359   partsideids = (<span class="keywordtype">int</span>**)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l03360"></a>03360   sidesperpart = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03361"></a>03361   search = (<span class="keywordtype">int</span>*)malloc(numSides*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));  
<a name="l03362"></a>03362   <span class="keywordflow">if</span> (partsideids == NULL || sidesperpart == NULL || search == NULL){
<a name="l03363"></a>03363       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03364"></a>03364       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03365"></a>03365   }
<a name="l03366"></a>03366   <span class="keywordflow">for</span>(i = 0; i &lt; numSides; i++){
<a name="l03367"></a>03367     search[i] = 1;
<a name="l03368"></a>03368   }
<a name="l03369"></a>03369   numparts = 0;
<a name="l03370"></a>03370   maxparts = 1;
<a name="l03371"></a>03371 
<a name="l03372"></a>03372   <span class="keywordflow">for</span> (i = 0; i &lt; numSides; i++){
<a name="l03373"></a>03373     <span class="keywordflow">if</span> (search[i]){<span class="comment">//start a new part</span>
<a name="l03374"></a>03374       <span class="keywordtype">int</span>* currpartids;
<a name="l03375"></a>03375       <span class="keywordtype">int</span> currmax, currnum;
<a name="l03376"></a>03376 
<a name="l03377"></a>03377       currpartids = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03378"></a>03378       <span class="keywordflow">if</span>(currpartids == NULL){ 
<a name="l03379"></a>03379      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03380"></a>03380      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03381"></a>03381       }
<a name="l03382"></a>03382       currpartids[0] = i;
<a name="l03383"></a>03383       currnum = 1;
<a name="l03384"></a>03384       currmax = 1;
<a name="l03385"></a>03385       search[i] = 0;
<a name="l03386"></a>03386 
<a name="l03387"></a>03387 
<a name="l03388"></a>03388       <span class="keywordflow">for</span> (j = 0; j &lt; currnum; j++){
<a name="l03389"></a>03389      <span class="comment">//find all the adj of this member</span>
<a name="l03390"></a>03390      <span class="keywordflow">for</span> (k = 0; k &lt; numSides; k++){
<a name="l03391"></a>03391        <span class="keywordflow">if</span> (search[k] &amp;&amp; adjmatrix[currpartids[j]][k] == 1){
<a name="l03392"></a>03392          <span class="comment">//add to the currpart ids</span>
<a name="l03393"></a>03393          <span class="keywordflow">if</span> (currnum == currmax){
<a name="l03394"></a>03394            <span class="keywordtype">int</span> *temp;
<a name="l03395"></a>03395            temp = (<span class="keywordtype">int</span>*)realloc(currpartids,(2*currmax)*<span class="keyword">sizeof</span>(int));
<a name="l03396"></a>03396            <span class="keywordflow">if</span> (temp == NULL){
<a name="l03397"></a>03397           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03398"></a>03398           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03399"></a>03399            }
<a name="l03400"></a>03400            currmax*=2;
<a name="l03401"></a>03401            currpartids = temp;
<a name="l03402"></a>03402          }
<a name="l03403"></a>03403          currpartids[currnum] = k; <span class="comment">//add this side to the current part</span>
<a name="l03404"></a>03404          currnum++;
<a name="l03405"></a>03405          search[k] = 0; <span class="comment">//take it out of the options</span>
<a name="l03406"></a>03406        }
<a name="l03407"></a>03407      }
<a name="l03408"></a>03408       }
<a name="l03409"></a>03409 
<a name="l03410"></a>03410       <span class="comment">//now hand it off</span>
<a name="l03411"></a>03411       <span class="keywordflow">if</span> (numparts == maxparts){
<a name="l03412"></a>03412      <span class="keywordtype">int</span> **temp;
<a name="l03413"></a>03413      <span class="keywordtype">int</span> *temp2;
<a name="l03414"></a>03414      temp = (<span class="keywordtype">int</span>**)realloc(partsideids,(2*maxparts)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l03415"></a>03415      <span class="keywordflow">if</span> (temp == NULL){
<a name="l03416"></a>03416        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03417"></a>03417        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03418"></a>03418      }
<a name="l03419"></a>03419      temp2 = (<span class="keywordtype">int</span>*)realloc(sidesperpart,(2*maxparts)*<span class="keyword">sizeof</span>(int));
<a name="l03420"></a>03420      <span class="keywordflow">if</span> (temp == NULL){
<a name="l03421"></a>03421        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03422"></a>03422        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03423"></a>03423      }
<a name="l03424"></a>03424      maxparts*=2;
<a name="l03425"></a>03425      partsideids = temp;
<a name="l03426"></a>03426      sidesperpart = temp2;
<a name="l03427"></a>03427       }
<a name="l03428"></a>03428       partsideids[numparts] = currpartids;
<a name="l03429"></a>03429       sidesperpart[numparts] = currnum;
<a name="l03430"></a>03430       numparts++;
<a name="l03431"></a>03431     }
<a name="l03432"></a>03432   }
<a name="l03433"></a>03433 
<a name="l03434"></a>03434   *numsegments = numparts;
<a name="l03435"></a>03435   *sidespersegment =sidesperpart;
<a name="l03436"></a>03436   *sideids = partsideids;
<a name="l03437"></a>03437 
<a name="l03438"></a>03438   free(search);
<a name="l03439"></a>03439 
<a name="l03440"></a>03440   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03441"></a>03441 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:19 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
