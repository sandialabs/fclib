<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>FCLib: tools/fc2ensight.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>tools/fc2ensight.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Conversion program. 
<p>
<dl class="rcs" compact><dt><b>Source</b></dt><dd>/usr/local/Repositories/fcdmf/fclib/tools/fc2ensight.c,v </dd></dl>
<dl class="rcs" compact><dt><b>Revision</b></dt><dd>1.20 </dd></dl>
<dl class="rcs" compact><dt><b>Date</b></dt><dd>2006/10/19 03:14:52 </dd></dl>
<p>
<b>Description:</b> <p>
Opens a dataset &amp; then writes ensight gold files with same root file name but different extensions in directory named rootname_ens in the current directory. (E.g. starting with can.saf you get can_ens/can.case, can_ens/can.geo, etc.)<p>
Currently necessary because ensight cannot read the type of saf files produced by fclib. Also, ensight automatically clips dead elements when reading LsDyna files so this is a helpful workaround if you don't want that to happen.<p>
Subsets are promoted to parts. Global variabls are not written unless explicitly asked for with the -g option.<p>
<b>Modifications:</b> <ul>
<li>4/13/05 WSK Created to replace the saf only version.</li></ul>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000118">Todo:</a></b></dt><dd>? prefix subset names so it's obvious they are a subset? </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000118">Todo:</a></b></dt><dd>haven't test cases with subsets or variables with association whole </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000118">Todo:</a></b></dt><dd>a bunch more stuff indicated in comments throughout code. </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000118">Todo:</a></b></dt><dd><ul>
<li>do we need this anymore? 10/15/07 ACG. I am not doing anything to this file becuase I dont knwo what the issues are </li></ul>
</dd></dl>

<p>
Definition in file <a class="el" href="fc2ensight_8c-source.html">fc2ensight.c</a>.
<p>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;<a class="el" href="fc_8h-source.html">fc.h</a>&gt;</code><br>

<p>
Include dependency graph for fc2ensight.c:
<p>
<a href="fc2ensight_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a> (<a class="el" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fc2ensight_8c.html#24e6ce6d053864cf5fb7af941457bb0e">main</a> (int argc, char **argv)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="cb98dfb5b61432005edfdee3e7e59ea4"></a><!-- doxytag: member="fc2ensight.c::getEnsightElementType" ref="cb98dfb5b61432005edfdee3e7e59ea4" args="(FC_ElementType elemType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* getEnsightElementType           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a>&nbsp;</td>
          <td class="paramname"> <em>elemType</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="fc2ensight_8c-source.html#l00073">73</a> of file <a class="el" href="fc2ensight_8c-source.html">fc2ensight.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>, <a class="el" href="base_8h-source.html#l00129">FC_ET_MIXED</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4011f9f91ef1e03bf40940c68b44f4c30">FC_ET_POINT</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>, and <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b482f13396326035faaa6778b457101a3e">FC_ET_UNKNOWN</a>.
<p>
Referenced by <a class="el" href="fc2ensight_8c-source.html#l00090">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00073"></a>00073                                                             {
<a name="l00074"></a>00074   <span class="keywordflow">switch</span>(elemType) {
<a name="l00075"></a>00075   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4011f9f91ef1e03bf40940c68b44f4c30">FC_ET_POINT</a>:    <span class="keywordflow">return</span> <span class="stringliteral">"point"</span>;
<a name="l00076"></a>00076   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>:     <span class="keywordflow">return</span> <span class="stringliteral">"bar2"</span>;
<a name="l00077"></a>00077   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>:      <span class="keywordflow">return</span> <span class="stringliteral">"tria3"</span>;
<a name="l00078"></a>00078   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>:     <span class="keywordflow">return</span> <span class="stringliteral">"quad4"</span>;
<a name="l00079"></a>00079   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a>:      <span class="keywordflow">return</span> <span class="stringliteral">"tetra4"</span>;
<a name="l00080"></a>00080   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a>:  <span class="keywordflow">return</span> <span class="stringliteral">"pyramid5"</span>;
<a name="l00081"></a>00081   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a>:    <span class="keywordflow">return</span> <span class="stringliteral">"penta6"</span>;
<a name="l00082"></a>00082   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>:      <span class="keywordflow">return</span> <span class="stringliteral">"hexa8"</span>;
<a name="l00083"></a>00083   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4b477e20533563cf70ccd322b0e21afa4">FC_ET_MIXED</a>:    <span class="keywordflow">return</span> <span class="stringliteral">"mixed"</span>;
<a name="l00084"></a>00084   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b482f13396326035faaa6778b457101a3e">FC_ET_UNKNOWN</a>:  <span class="keywordflow">return</span> <span class="stringliteral">"unknown"</span>;
<a name="l00085"></a>00085   }
<a name="l00086"></a>00086   <span class="keywordflow">return</span> <span class="stringliteral">"unknown"</span>;
<a name="l00087"></a>00087 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="24e6ce6d053864cf5fb7af941457bb0e"></a><!-- doxytag: member="fc2ensight.c::main" ref="24e6ce6d053864cf5fb7af941457bb0e" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="fc2ensight_8c-source.html#l00090">90</a> of file <a class="el" href="fc2ensight_8c-source.html">fc2ensight.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00129">FC_ET_MIXED</a>, <a class="el" href="error_8h-source.html#l00080">fc_exitIfError</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e41dd0a2fc17e1c521fa4a96cfd412708">FC_FILE_IO_ERROR</a>, <a class="el" href="library_8c-source.html#l00220">fc_finalLibrary()</a>, <a class="el" href="base_8c-source.html#l00476">fc_getAssociationTypeText()</a>, <a class="el" href="base_8c-source.html#l00418">fc_getDataTypeText()</a>, <a class="el" href="base_8c-source.html#l00549">fc_getElementTypeNumVertex()</a>, <a class="el" href="base_8c-source.html#l00447">fc_getMathTypeText()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02790">fc_getMeshEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02981">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02590">fc_getMeshEntityElementType()</a>, <a class="el" href="mesh_8c-source.html#l01432">fc_getMeshes()</a>, <a class="el" href="mesh_8c-source.html#l02910">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="mesh_8c-source.html#l01981">fc_getMeshName()</a>, <a class="el" href="sequence_8c-source.html#l01725">fc_getSequenceCoordsPtr()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="sequence_8c-source.html#l01600">fc_getSequenceInfo()</a>, <a class="el" href="sequence_8c-source.html#l01138">fc_getSequences()</a>, <a class="el" href="variable_8c-source.html#l03295">fc_getSeqVariableByName()</a>, <a class="el" href="variable_8c-source.html#l02567">fc_getSeqVariables()</a>, <a class="el" href="subset_8c-source.html#l01874">fc_getSubsetAssociationType()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="subset_8c-source.html#l01672">fc_getSubsetName()</a>, <a class="el" href="subset_8c-source.html#l00695">fc_getSubsets()</a>, <a class="el" href="variable_8c-source.html#l02982">fc_getVariableByName()</a>, <a class="el" href="variable_8c-source.html#l04649">fc_getVariableDataAsDataType()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="variable_8c-source.html#l04152">fc_getVariableName()</a>, <a class="el" href="variable_8c-source.html#l04543">fc_getVariableNumDataPoint()</a>, <a class="el" href="variable_8c-source.html#l02503">fc_getVariables()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="library_8c-source.html#l00172">fc_initLibrary()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="fileio_8c-source.html#l01565">fc_loadDataset()</a>, <a class="el" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a395a6192ba586cd970dd36a49cd8862714">FC_LOG_MESSAGES</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="library_8h-source.html#l00129">fc_printfWarningMessage</a>, <a class="el" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a399cb0ad9c1f97775f8954860a08d78144">FC_QUIET</a>, <a class="el" href="mesh_8c-source.html#l01665">fc_releaseMesh()</a>, <a class="el" href="variable_8c-source.html#l03755">fc_releaseVariable()</a>, <a class="el" href="library_8c-source.html#l00110">fc_setLibraryVerbosity()</a>, <a class="el" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a3995521f4f1526a6565b08e663106dd6e7">FC_WARNING_MESSAGES</a>, <a class="el" href="fc2ensight_8c-source.html#l00073">getEnsightElementType()</a>, and <a class="el" href="sierra_8c-source.html#l00141">temp_string</a>.<div class="fragment"><pre class="fragment"><a name="l00091"></a>00091 {
<a name="l00092"></a>00092   <a class="code" href="group__DataTypes.html#g6c0891f21e34bad1d8b2bc7c76193a39">FC_VerbosityLevel</a> verbose_level = <a class="code" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a399cb0ad9c1f97775f8954860a08d78144">FC_QUIET</a>; 
<a name="l00093"></a>00093   <span class="keywordtype">int</span> i, j, k, m, n, p;
<a name="l00094"></a>00094   <span class="keywordtype">int</span> flag;
<a name="l00095"></a>00095   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00096"></a>00096   <span class="keywordtype">char</span>* orig_file_name;
<a name="l00097"></a>00097   <span class="keywordtype">char</span>* <a class="code" href="group__PrivateSierra.html#g3226dc2ac4ecce1447ced54532d380cd">temp_string</a>, *temp_string2;
<a name="l00098"></a>00098   <span class="keywordtype">char</span>* path_base_file_name; <span class="comment">// path + base file name</span>
<a name="l00099"></a>00099   <span class="keywordtype">char</span>* base_file_name;      <span class="comment">// points into path_base_file_name</span>
<a name="l00100"></a>00100   <span class="keywordtype">int</span> path_base_length;      <span class="comment">// length of path_base_file_name</span>
<a name="l00101"></a>00101   <span class="keywordtype">int</span> base_length;           <span class="comment">// length of base_file_name</span>
<a name="l00102"></a>00102   <span class="keywordtype">int</span> path_length;           <span class="comment">// used to cut off path -&gt; index to start of name</span>
<a name="l00103"></a>00103   <span class="keywordtype">char</span>* case_file_name; <span class="comment">// name for the case file</span>
<a name="l00104"></a>00104   <span class="keywordtype">char</span>* geom_file_name; <span class="comment">// name for the case file</span>
<a name="l00105"></a>00105   <span class="keywordtype">char</span>* var_file_name;   <span class="comment">// name for the case file</span>
<a name="l00106"></a>00106   <span class="keywordtype">char</span>* seqVar_file_name; <span class="comment">// name for the case file</span>
<a name="l00107"></a>00107   FILE* case_file;
<a name="l00108"></a>00108   FILE* geom_file;
<a name="l00109"></a>00109   FILE* var_file;
<a name="l00110"></a>00110   FILE* seqVar_file;
<a name="l00111"></a>00111   <span class="keywordtype">int</span> doGlobals = 0;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l00114"></a>00114   <span class="keywordtype">int</span> numSequence;
<a name="l00115"></a>00115   <a class="code" href="structFC__Sequence.html">FC_Sequence</a>* sequences;
<a name="l00116"></a>00116   <span class="keywordtype">int</span> numMesh;
<a name="l00117"></a>00117   <a class="code" href="structFC__Mesh.html">FC_Mesh</a>* meshes;
<a name="l00118"></a>00118   <span class="keywordtype">int</span>* numSubsetPerMesh;
<a name="l00119"></a>00119   <a class="code" href="structFC__Subset.html">FC_Subset</a>** subsetsPerMesh;  
<a name="l00120"></a>00120   <span class="keywordtype">int</span> numVar, numSeqVar, *numStepPerSeqVar, numStep;
<a name="l00121"></a>00121   <a class="code" href="structFC__Variable.html">FC_Variable</a> var, *variables, *seqVar, **seqVariables;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> *meshElemTypes;    <span class="comment">// numMesh long</span>
<a name="l00124"></a>00124   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> **subsetAssocsPerMesh; <span class="comment">// numMesh long, numSubsetPerMesh</span>
<a name="l00125"></a>00125   <span class="keywordtype">int</span>** numSubsetVertsPerMesh, ***subsetVertIDsPerMesh; <span class="comment">// numMesh, numSubsetPerMesh</span>
<a name="l00126"></a>00126   <span class="keywordtype">int</span>** numMemberPerMesh, ***memberIDsPerMesh; <span class="comment">// numMesh x numSubsetPerMesh</span>
<a name="l00127"></a>00127   <span class="keywordtype">int</span> numTotalVar, numTotalSeqVar;
<a name="l00128"></a>00128   <span class="keywordtype">char</span> **varNames, **seqVarNames; <span class="comment">// numTotalVar, numTotalSeqVar long</span>
<a name="l00129"></a>00129   <span class="keywordtype">int</span> *varNumComps, *seqVarNumComps; <span class="comment">// numTotalVar, numTotalSeqVar long</span>
<a name="l00130"></a>00130   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> *varAssocs, *seqVarAssocs; <span class="comment">// "</span>
<a name="l00131"></a>00131   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> *varMathTypes, *seqVarMathTypes;  <span class="comment">// "</span>
<a name="l00132"></a>00132   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> *varDataTypes, *seqVarDataTypes;  <span class="comment">// "</span>
<a name="l00133"></a>00133   <span class="keywordtype">int</span> *seqVarNumSteps; <span class="comment">// numTotalSeqVar long</span>
<a name="l00134"></a>00134   <span class="keywordtype">int</span> *seqVarSeqIDs; <span class="comment">// numTotalSeqVar long</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="keywordtype">int</span> partID;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00139"></a>00139   <span class="comment">//  process command line args</span>
<a name="l00140"></a>00140   <span class="comment">//------------------------------------------------------------------  </span>
<a name="l00141"></a>00141   <span class="comment">// FIX? to specify output base_file_name?</span>
<a name="l00142"></a>00142   <span class="keywordflow">if</span> (argc &lt; 2) {
<a name="l00143"></a>00143   usage:
<a name="l00144"></a>00144     printf(<span class="stringliteral">"usage:  %s [options] dataset_file\n"</span>, argv[0]);
<a name="l00145"></a>00145     printf(<span class="stringliteral">"options: \n"</span>);
<a name="l00146"></a>00146     printf(<span class="stringliteral">"    -g    : output the global values (default is not to)\n"</span>);
<a name="l00147"></a>00147     printf(<span class="stringliteral">"    -h    : print this help message\n"</span>);
<a name="l00148"></a>00148     printf(<span class="stringliteral">"    -v    : verbose: print warning and error messages\n"</span>);
<a name="l00149"></a>00149     printf(<span class="stringliteral">"    -V    : very verbose: print log and error message\n"</span>);
<a name="l00150"></a>00150     printf(<span class="stringliteral">"  Creates ensight files in the directory the command is\n"</span>);
<a name="l00151"></a>00151     printf(<span class="stringliteral">"executed from. The created files will have the same base\n"</span>);
<a name="l00152"></a>00152     printf(<span class="stringliteral">"name as the dataset file.\n"</span>); 
<a name="l00153"></a>00153     fflush(NULL);
<a name="l00154"></a>00154     exit(-1);
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156   <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {
<a name="l00157"></a>00157     <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-v"</span>)) {
<a name="l00158"></a>00158       verbose_level = <a class="code" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a3995521f4f1526a6565b08e663106dd6e7">FC_WARNING_MESSAGES</a>;
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-V"</span>)) {
<a name="l00161"></a>00161       verbose_level = <a class="code" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a395a6192ba586cd970dd36a49cd8862714">FC_LOG_MESSAGES</a>;
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-g"</span>)) {
<a name="l00164"></a>00164       doGlobals = 1;
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166     <span class="keywordflow">else</span> {
<a name="l00167"></a>00167       <span class="keywordflow">if</span> (i != argc-1)
<a name="l00168"></a>00168         <span class="keywordflow">goto</span> usage;
<a name="l00169"></a>00169       orig_file_name = argv[i];
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171   }
<a name="l00172"></a>00172   
<a name="l00173"></a>00173   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00174"></a>00174   <span class="comment">//  determine base file name</span>
<a name="l00175"></a>00175   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00176"></a>00176   <span class="comment">// make a directory and put all files in it</span>
<a name="l00177"></a>00177   temp_string = (<span class="keywordtype">char</span>*)malloc((strlen(orig_file_name) + 1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));       
<a name="l00178"></a>00178   strcpy(temp_string, orig_file_name);
<a name="l00179"></a>00179   <span class="comment">// take off outer extension</span>
<a name="l00180"></a>00180   <span class="keywordflow">for</span> (i = strlen(temp_string); i &gt;= 0; i--) {
<a name="l00181"></a>00181     <span class="keywordflow">if</span> (temp_string[i] == <span class="charliteral">'/'</span>) { <span class="comment">// there was no extension</span>
<a name="l00182"></a>00182       <span class="keywordflow">break</span>;
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184     <span class="keywordflow">if</span> (temp_string[i] == <span class="charliteral">'.'</span>) {
<a name="l00185"></a>00185       temp_string[i] = <span class="charliteral">'\0'</span>;
<a name="l00186"></a>00186       <span class="keywordflow">break</span>;
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188   } <span class="comment">// if no early breaks, then no extension  </span>
<a name="l00189"></a>00189   <span class="comment">// take off leading directories (2nd pointer points into first string)</span>
<a name="l00190"></a>00190   temp_string2 = temp_string;
<a name="l00191"></a>00191   <span class="keywordflow">for</span> (i = strlen(temp_string); i &gt;= 0; i--) {
<a name="l00192"></a>00192     <span class="keywordflow">if</span> (temp_string[i] == <span class="charliteral">'/'</span>) {
<a name="l00193"></a>00193       temp_string2 = &amp;temp_string[i+1];
<a name="l00194"></a>00194       <span class="keywordflow">break</span>;
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196   }
<a name="l00197"></a>00197   <span class="comment">// make base_name w &amp; w/o path</span>
<a name="l00198"></a>00198   base_length = strlen(temp_string2);
<a name="l00199"></a>00199   path_length = base_length + 5;
<a name="l00200"></a>00200   path_base_length = path_length + base_length;
<a name="l00201"></a>00201   path_base_file_name = (<span class="keywordtype">char</span>*)malloc((path_base_length+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00202"></a>00202   sprintf(path_base_file_name, <span class="stringliteral">"%s_ens/%s"</span>, temp_string2, temp_string2);
<a name="l00203"></a>00203   base_file_name = &amp;path_base_file_name[path_length];
<a name="l00204"></a>00204   free(temp_string);
<a name="l00205"></a>00205   <span class="comment">// debug</span>
<a name="l00206"></a>00206   <span class="comment">//printf("path_base_file_name = '%s'\n", path_base_file_name);</span>
<a name="l00207"></a>00207   <span class="comment">//printf("base_file_name = '%s'\n", base_file_name);</span>
<a name="l00208"></a>00208   <span class="comment">// make directory</span>
<a name="l00209"></a>00209   temp_string = (<span class="keywordtype">char</span>*)malloc((base_length + 20)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00210"></a>00210   sprintf(temp_string, <span class="stringliteral">"mkdir %s_ens"</span>, base_file_name);
<a name="l00211"></a>00211   flag = system(temp_string);
<a name="l00212"></a>00212   <span class="keywordflow">if</span> (flag != 0) 
<a name="l00213"></a>00213     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <span class="stringliteral">"Cannot create directory '%s_ens'"</span>, 
<a name="l00214"></a>00214                          base_file_name);
<a name="l00215"></a>00215   free(temp_string);
<a name="l00216"></a>00216 
<a name="l00217"></a>00217   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00218"></a>00218   <span class="comment">//  Initialize FCLib &amp; open dataset</span>
<a name="l00219"></a>00219   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00220"></a>00220   rc = <a class="code" href="group__Library.html#gf13f047de6d44c9028d4944bc29867db">fc_setLibraryVerbosity</a>(verbose_level);
<a name="l00221"></a>00221   <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to set library verbosity level"</span>);
<a name="l00222"></a>00222   rc = <a class="code" href="group__Library.html#g355d03ffe3f8c560e9343716f78af097">fc_initLibrary</a>();
<a name="l00223"></a>00223   <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to initialize library"</span>);
<a name="l00224"></a>00224   rc = <a class="code" href="group__FileIO.html#g953a8c4a7feb785e0091b7cf58626092">fc_loadDataset</a>(orig_file_name, &amp;dataset);
<a name="l00225"></a>00225   <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to load dataset '%s'"</span>, orig_file_name);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00228"></a>00228   <span class="comment">//  Get handles to sequences, meshes &amp; subsets</span>
<a name="l00229"></a>00229   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00230"></a>00230   rc = <a class="code" href="group__Sequence.html#g4e9e6506fc7e6ce22310105003a21789">fc_getSequences</a>(dataset, &amp;numSequence, &amp;sequences);
<a name="l00231"></a>00231   <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get sequences"</span>);
<a name="l00232"></a>00232   rc = <a class="code" href="group__Mesh.html#ge71cd0e179143c6d82d58b9cc78cc436">fc_getMeshes</a>(dataset, &amp;numMesh, &amp;meshes);
<a name="l00233"></a>00233   <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get meshes"</span>);
<a name="l00234"></a>00234   numSubsetPerMesh = (<span class="keywordtype">int</span>*)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00235"></a>00235   subsetsPerMesh = (<a class="code" href="structFC__Subset.html">FC_Subset</a>**)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html">FC_Subset</a>*));
<a name="l00236"></a>00236   <span class="keywordflow">if</span> (!numSubsetPerMesh || !subsetsPerMesh)
<a name="l00237"></a>00237     <a class="code" href="group__ErrorHandling.html#g4a09c0024ecd45d5d63c8b9ec333a717">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>);
<a name="l00238"></a>00238   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00239"></a>00239     rc = <a class="code" href="group__Subset.html#g5c0185b0cab5ac7256fec095a98c3bd0">fc_getSubsets</a>(meshes[i], &amp;numSubsetPerMesh[i], &amp;subsetsPerMesh[i]);
<a name="l00240"></a>00240     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get subsets"</span>);
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242   <span class="comment">// FIX remove any empty subsets from list</span>
<a name="l00243"></a>00243  
<a name="l00244"></a>00244   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00245"></a>00245   <span class="comment">//  Make master list of all variable and sequence variable names </span>
<a name="l00246"></a>00246   <span class="comment">//  (Also collect info about vars)</span>
<a name="l00247"></a>00247   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00248"></a>00248   <span class="comment">// FIX! this assumes that all variables of the same name will be</span>
<a name="l00249"></a>00249   <span class="comment">//        of the same type (i.e. nodal or elemental).</span>
<a name="l00250"></a>00250   numTotalVar = numTotalSeqVar = 0;
<a name="l00251"></a>00251   varNames = seqVarNames = NULL;
<a name="l00252"></a>00252   varNumComps = seqVarNumComps = NULL;
<a name="l00253"></a>00253   varAssocs = seqVarAssocs = NULL;
<a name="l00254"></a>00254   varMathTypes = seqVarMathTypes = NULL;
<a name="l00255"></a>00255   varDataTypes = seqVarDataTypes = NULL;
<a name="l00256"></a>00256   seqVarNumSteps = NULL;
<a name="l00257"></a>00257   seqVarSeqIDs = NULL;
<a name="l00258"></a>00258   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00259"></a>00259     rc = <a class="code" href="group__Variable.html#g74cf87c790d013532d9451af1b5f1fbb">fc_getVariables</a>(meshes[i], &amp;numVar, &amp;variables);
<a name="l00260"></a>00260     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get variables"</span>);
<a name="l00261"></a>00261     <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l00262"></a>00262       rc = <a class="code" href="group__Variable.html#g3ec29251d717c5d0ca4ecfd9824f67b1">fc_getVariableName</a>(variables[j], &amp;temp_string);
<a name="l00263"></a>00263       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get variable name"</span>);
<a name="l00264"></a>00264       <span class="keywordflow">for</span> (k = 0; k &lt; numTotalVar; k++) {
<a name="l00265"></a>00265         <span class="keywordflow">if</span> (!strcmp(temp_string, varNames[k])) {
<a name="l00266"></a>00266           free(temp_string);
<a name="l00267"></a>00267           <span class="keywordflow">break</span>; <span class="comment">// found a match</span>
<a name="l00268"></a>00268         }
<a name="l00269"></a>00269       }
<a name="l00270"></a>00270       <span class="keywordflow">if</span> (k == numTotalVar) { <span class="comment">// didn't find match</span>
<a name="l00271"></a>00271         <span class="keywordtype">char</span>** temp_char = realloc(varNames, (numTotalVar+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00272"></a>00272         <span class="keywordtype">int</span> *temp_comp = realloc(varNumComps, (numTotalVar+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00273"></a>00273         <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> *temp_assoc = realloc(varAssocs, (numTotalVar+1)*
<a name="l00274"></a>00274                                                  <span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a>));
<a name="l00275"></a>00275         <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a>* temp_math = realloc(varMathTypes, (numTotalVar+1)*
<a name="l00276"></a>00276                                          <span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a>));
<a name="l00277"></a>00277         <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>* temp_data = realloc(varDataTypes, (numTotalVar+1)*
<a name="l00278"></a>00278                                          <span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>));
<a name="l00279"></a>00279         <span class="keywordflow">if</span> (!temp_char || !temp_comp || !temp_assoc || !temp_math || !temp_data)
<a name="l00280"></a>00280           <a class="code" href="group__ErrorHandling.html#g4a09c0024ecd45d5d63c8b9ec333a717">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>);
<a name="l00281"></a>00281         varNames = temp_char;
<a name="l00282"></a>00282         varNumComps = temp_comp;
<a name="l00283"></a>00283         varAssocs = temp_assoc;
<a name="l00284"></a>00284         varMathTypes = temp_math;
<a name="l00285"></a>00285         varDataTypes =temp_data;
<a name="l00286"></a>00286         varNames[k] = temp_string;
<a name="l00287"></a>00287         rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(variables[j], NULL, &amp;varNumComps[k],
<a name="l00288"></a>00288                                 &amp;varAssocs[k], &amp;varMathTypes[k],
<a name="l00289"></a>00289                                 &amp;varDataTypes[k]);
<a name="l00290"></a>00290         numTotalVar++;
<a name="l00291"></a>00291       }
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293     free(variables);
<a name="l00294"></a>00294   }
<a name="l00295"></a>00295   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00296"></a>00296     rc = <a class="code" href="group__Variable.html#g93185e07dcdf01ffc87fc28a69ee96ae">fc_getSeqVariables</a>(meshes[i], &amp;numSeqVar, &amp;numStepPerSeqVar, 
<a name="l00297"></a>00297                             &amp;seqVariables);
<a name="l00298"></a>00298     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get seq variables"</span>);
<a name="l00299"></a>00299     <span class="keywordflow">for</span> (j = 0; j &lt; numSeqVar; j++) {
<a name="l00300"></a>00300       rc = <a class="code" href="group__Variable.html#g3ec29251d717c5d0ca4ecfd9824f67b1">fc_getVariableName</a>(seqVariables[j][0], &amp;temp_string);
<a name="l00301"></a>00301       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get seq variable name"</span>);
<a name="l00302"></a>00302       <span class="keywordflow">for</span> (k = 0; k &lt; numTotalSeqVar; k++) {
<a name="l00303"></a>00303         <span class="keywordflow">if</span> (!strcmp(temp_string, seqVarNames[k])) {
<a name="l00304"></a>00304           free(temp_string);
<a name="l00305"></a>00305           <span class="keywordflow">break</span>; <span class="comment">// found a match</span>
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307       }
<a name="l00308"></a>00308       <span class="keywordflow">if</span> (k == numTotalSeqVar) { <span class="comment">// didn't find match, so add</span>
<a name="l00309"></a>00309         <a class="code" href="structFC__Sequence.html">FC_Sequence</a> sequence;
<a name="l00310"></a>00310         <span class="keywordtype">int</span> temp_ID = -1;
<a name="l00311"></a>00311         <span class="keywordtype">char</span>** temp_char = realloc(seqVarNames, (numTotalSeqVar+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00312"></a>00312         <span class="keywordtype">int</span> *temp_comp = realloc(seqVarNumComps, (numTotalSeqVar+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00313"></a>00313         <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> *temp_assoc = realloc(seqVarAssocs, (numTotalSeqVar+1)*
<a name="l00314"></a>00314                                                  <span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a>));
<a name="l00315"></a>00315         <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a>* temp_math = realloc(seqVarMathTypes, (numTotalSeqVar+1)*
<a name="l00316"></a>00316                                          <span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a>));
<a name="l00317"></a>00317         <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>* temp_data = realloc(seqVarDataTypes, (numTotalSeqVar+1)*
<a name="l00318"></a>00318                                          <span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>));
<a name="l00319"></a>00319         <span class="keywordtype">int</span>* temp_numStep = realloc(seqVarNumSteps, (numTotalSeqVar+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00320"></a>00320         <span class="keywordtype">int</span>* temp_seqID = realloc(seqVarSeqIDs, (numTotalSeqVar+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00321"></a>00321         <span class="keywordflow">if</span> (!temp_char || !temp_comp || !temp_assoc || !temp_math || 
<a name="l00322"></a>00322             !temp_data || !temp_numStep || !temp_seqID)
<a name="l00323"></a>00323           <a class="code" href="group__ErrorHandling.html#g4a09c0024ecd45d5d63c8b9ec333a717">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>);
<a name="l00324"></a>00324         seqVarNames = temp_char;
<a name="l00325"></a>00325         seqVarNumComps = temp_comp;
<a name="l00326"></a>00326         seqVarAssocs = temp_assoc;
<a name="l00327"></a>00327         seqVarMathTypes = temp_math;
<a name="l00328"></a>00328         seqVarDataTypes = temp_data;
<a name="l00329"></a>00329         seqVarNames[k] = temp_string;
<a name="l00330"></a>00330         seqVarNumSteps = temp_numStep;
<a name="l00331"></a>00331         seqVarSeqIDs = temp_seqID;
<a name="l00332"></a>00332         rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(seqVariables[j][0], NULL, &amp;seqVarNumComps[k],
<a name="l00333"></a>00333                                 &amp;seqVarAssocs[k], &amp;seqVarMathTypes[k],
<a name="l00334"></a>00334                                 &amp;seqVarDataTypes[k]);
<a name="l00335"></a>00335         seqVarNumSteps[k] = numStepPerSeqVar[j];
<a name="l00336"></a>00336         rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStepPerSeqVar[j],
<a name="l00337"></a>00337                                            seqVariables[j], &amp;sequence);
<a name="l00338"></a>00338         <span class="keywordflow">for</span> (m = 0; m &lt; numSequence; m++) {
<a name="l00339"></a>00339           <span class="keywordflow">if</span> (<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(sequence, sequences[m])) {
<a name="l00340"></a>00340             temp_ID = m;
<a name="l00341"></a>00341             <span class="keywordflow">break</span>;
<a name="l00342"></a>00342           }
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344         <span class="keywordflow">if</span> (temp_ID &lt; 0) 
<a name="l00345"></a>00345           <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <span class="stringliteral">"failed to find matching sequence"</span>);
<a name="l00346"></a>00346         seqVarSeqIDs[k] = temp_ID;
<a name="l00347"></a>00347         numTotalSeqVar++;
<a name="l00348"></a>00348       }
<a name="l00349"></a>00349     }
<a name="l00350"></a>00350     free(numStepPerSeqVar);
<a name="l00351"></a>00351     <span class="keywordflow">for</span> (j = 0; j &lt; numSeqVar; j++)
<a name="l00352"></a>00352       free(seqVariables[j]);
<a name="l00353"></a>00353     free(seqVariables);
<a name="l00354"></a>00354   }
<a name="l00355"></a>00355   <span class="comment">// debug</span>
<a name="l00356"></a>00356   <span class="comment">//printf("vars\n");</span>
<a name="l00357"></a>00357   <span class="comment">//for (i = 0; i &lt; numTotalVar; i++)</span>
<a name="l00358"></a>00358   <span class="comment">//printf("%d: %s\n", i, varNames[i]);</span>
<a name="l00359"></a>00359   <span class="comment">//printf("seq vars\n");</span>
<a name="l00360"></a>00360   <span class="comment">//for (i = 0; i &lt; numTotalSeqVar; i++)</span>
<a name="l00361"></a>00361   <span class="comment">//printf("%d: %s\n", i, seqVarNames[i]);</span>
<a name="l00362"></a>00362 
<a name="l00363"></a>00363   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00364"></a>00364   <span class="comment">//  create case file - keep this file open throughout entire process</span>
<a name="l00365"></a>00365   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00366"></a>00366   <span class="comment">// create file names</span>
<a name="l00367"></a>00367   temp_string = malloc((path_base_length + 6)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00368"></a>00368   case_file_name = malloc((base_length + 6)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00369"></a>00369   <span class="keywordflow">if</span> (!temp_string || !case_file_name)
<a name="l00370"></a>00370     <a class="code" href="group__ErrorHandling.html#g4a09c0024ecd45d5d63c8b9ec333a717">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>);
<a name="l00371"></a>00371   sprintf(temp_string, <span class="stringliteral">"%s.case"</span>, path_base_file_name);
<a name="l00372"></a>00372   sprintf(case_file_name, <span class="stringliteral">"%s.case"</span>, base_file_name);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374   <span class="comment">// open</span>
<a name="l00375"></a>00375   case_file = fopen(temp_string, <span class="stringliteral">"w"</span>);
<a name="l00376"></a>00376   <span class="keywordflow">if</span> (!case_file)
<a name="l00377"></a>00377     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e41dd0a2fc17e1c521fa4a96cfd412708">FC_FILE_IO_ERROR</a>, <span class="stringliteral">"Failed to open file '%s'"</span>, 
<a name="l00378"></a>00378                          temp_string);
<a name="l00379"></a>00379   free(temp_string);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381   <span class="comment">// header</span>
<a name="l00382"></a>00382   fprintf(case_file, <span class="stringliteral">"#\n"</span>);
<a name="l00383"></a>00383   fprintf(case_file, <span class="stringliteral">"# Generated by fc2ensight\n"</span>);
<a name="l00384"></a>00384   fprintf(case_file, <span class="stringliteral">"# Case File: %s\n"</span>, case_file_name);
<a name="l00385"></a>00385   fprintf(case_file, <span class="stringliteral">"\nFORMAT\n\n"</span>);
<a name="l00386"></a>00386   fprintf(case_file, <span class="stringliteral">"type:    ensight gold\n"</span>);
<a name="l00387"></a>00387   free(case_file_name);
<a name="l00388"></a>00388   fflush(NULL);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390   fprintf(case_file, <span class="stringliteral">"\nGEOMETRY\n\n"</span>);
<a name="l00391"></a>00391   fflush(NULL);
<a name="l00392"></a>00392 
<a name="l00393"></a>00393   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00394"></a>00394   <span class="comment">//  create geom file</span>
<a name="l00395"></a>00395   <span class="comment">//------------------------------------------------------------------</span>
<a name="l00396"></a>00396   <span class="comment">// create file names</span>
<a name="l00397"></a>00397   temp_string = malloc((path_base_length + 5)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00398"></a>00398   geom_file_name = malloc((base_length + 5)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));\
<a name="l00399"></a>00399   <span class="keywordflow">if</span> (!temp_string || ! geom_file_name)
<a name="l00400"></a>00400     <a class="code" href="group__ErrorHandling.html#g4a09c0024ecd45d5d63c8b9ec333a717">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>);
<a name="l00401"></a>00401   sprintf(temp_string, <span class="stringliteral">"%s.geo"</span>, path_base_file_name);
<a name="l00402"></a>00402   sprintf(geom_file_name, <span class="stringliteral">"%s.geo"</span>, base_file_name);
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   <span class="comment">// --- Aside: Write geom file name to case file</span>
<a name="l00405"></a>00405   fprintf(case_file, <span class="stringliteral">"model:   %s\n"</span>, geom_file_name);
<a name="l00406"></a>00406   fflush(NULL);
<a name="l00407"></a>00407     
<a name="l00408"></a>00408   <span class="comment">// open geom file</span>
<a name="l00409"></a>00409   geom_file = fopen(temp_string, <span class="stringliteral">"w"</span>);
<a name="l00410"></a>00410   <span class="keywordflow">if</span> (!geom_file)
<a name="l00411"></a>00411     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e41dd0a2fc17e1c521fa4a96cfd412708">FC_FILE_IO_ERROR</a>, <span class="stringliteral">"Failed to open file '%s'"</span>,
<a name="l00412"></a>00412                          temp_string);
<a name="l00413"></a>00413   free(temp_string);
<a name="l00414"></a>00414   
<a name="l00415"></a>00415   <span class="comment">// geom file header</span>
<a name="l00416"></a>00416   fprintf(geom_file, <span class="stringliteral">"%s\n"</span>, base_file_name);
<a name="l00417"></a>00417   fprintf(geom_file, <span class="stringliteral">"\n"</span>);
<a name="l00418"></a>00418   fprintf(geom_file, <span class="stringliteral">"node id given\n"</span>);
<a name="l00419"></a>00419   fprintf(geom_file, <span class="stringliteral">"element id given\n"</span>);
<a name="l00420"></a>00420   fflush(NULL);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   <span class="comment">// Write part info (put some in arrays to keep for handling vars later)</span>
<a name="l00423"></a>00423   meshElemTypes = malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a>));
<a name="l00424"></a>00424   subsetAssocsPerMesh = malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a>*));
<a name="l00425"></a>00425   numSubsetVertsPerMesh = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l00426"></a>00426   numMemberPerMesh = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l00427"></a>00427   subsetVertIDsPerMesh = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>**));
<a name="l00428"></a>00428   memberIDsPerMesh = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>**));
<a name="l00429"></a>00429   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00430"></a>00430     subsetAssocsPerMesh[i] = malloc(numSubsetPerMesh[i]*<span class="keyword">sizeof</span>(<a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a>));
<a name="l00431"></a>00431     numSubsetVertsPerMesh[i] = malloc(numSubsetPerMesh[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00432"></a>00432     numMemberPerMesh[i] = malloc(numSubsetPerMesh[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00433"></a>00433     subsetVertIDsPerMesh[i] = malloc(numSubsetPerMesh[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l00434"></a>00434     memberIDsPerMesh[i] = malloc(numSubsetPerMesh[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436   partID = 0;
<a name="l00437"></a>00437   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00438"></a>00438     <span class="keywordtype">int</span> numDim, numVert, numElem, numVertPerElem;
<a name="l00439"></a>00439     <span class="keywordtype">int</span>* conns;
<a name="l00440"></a>00440     <span class="keywordtype">double</span>* coords;
<a name="l00441"></a>00441     
<a name="l00442"></a>00442     <span class="comment">// mesh query</span>
<a name="l00443"></a>00443     rc = <a class="code" href="group__Mesh.html#g9f5a1b484e4b5ab4e0e137bfe34e10d6">fc_getMeshName</a>(meshes[i], &amp;temp_string);
<a name="l00444"></a>00444     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh name"</span>);
<a name="l00445"></a>00445     rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(meshes[i], NULL, &amp;numDim, &amp;numVert, &amp;numElem, 
<a name="l00446"></a>00446                         &amp;meshElemTypes[i]);
<a name="l00447"></a>00447     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh info"</span>);
<a name="l00448"></a>00448     numVertPerElem = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(meshElemTypes[i]);
<a name="l00449"></a>00449     rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(meshes[i], &amp;coords);
<a name="l00450"></a>00450     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh coords"</span>);
<a name="l00451"></a>00451     rc = <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(meshes[i], &amp;conns);
<a name="l00452"></a>00452     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh elem conns"</span>);
<a name="l00453"></a>00453     
<a name="l00454"></a>00454     <span class="comment">// special cases</span>
<a name="l00455"></a>00455     <span class="comment">// FIX! Could handle this, just have to do a lot of work</span>
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (meshElemTypes[i] == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4b477e20533563cf70ccd322b0e21afa4">FC_ET_MIXED</a>)
<a name="l00457"></a>00457       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Cannot yet handle mixed element types"</span>);
<a name="l00458"></a>00458     
<a name="l00459"></a>00459     <span class="comment">// write metadata</span>
<a name="l00460"></a>00460     fprintf(geom_file, <span class="stringliteral">"part\n"</span>);
<a name="l00461"></a>00461     fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, partID+1);  <span class="comment">// index from 1, not 0</span>
<a name="l00462"></a>00462     fprintf(geom_file, <span class="stringliteral">"%s\n"</span>, temp_string);
<a name="l00463"></a>00463     fflush(NULL);
<a name="l00464"></a>00464     free(temp_string);
<a name="l00465"></a>00465     
<a name="l00466"></a>00466     <span class="comment">// write vertex ids &amp; coords</span>
<a name="l00467"></a>00467     fprintf(geom_file, <span class="stringliteral">"coordinates\n"</span>);
<a name="l00468"></a>00468     fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, numVert);
<a name="l00469"></a>00469     fflush(NULL);
<a name="l00470"></a>00470     <span class="keywordflow">for</span> (j = 0; j &lt; numVert; j++) 
<a name="l00471"></a>00471       fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, j);
<a name="l00472"></a>00472     <span class="comment">// print coords as all x's, then all y's, then all z's </span>
<a name="l00473"></a>00473     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++) 
<a name="l00474"></a>00474       <span class="keywordflow">for</span> (k = 0; k &lt; numVert; k++)
<a name="l00475"></a>00475         fprintf(geom_file, <span class="stringliteral">"%12.5e\n"</span>, coords[k*numDim+j]);
<a name="l00476"></a>00476     <span class="keywordflow">for</span> (j = numDim; j &lt; 3; j++)
<a name="l00477"></a>00477       <span class="keywordflow">for</span> (k = 0; k &lt; numVert; k++)
<a name="l00478"></a>00478         fprintf(geom_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l00479"></a>00479     fflush(NULL);
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="comment">// write element ids &amp; conns</span>
<a name="l00482"></a>00482     fprintf(geom_file, <span class="stringliteral">"%s\n"</span>, <a class="code" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a>(meshElemTypes[i]));
<a name="l00483"></a>00483     fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, numElem);
<a name="l00484"></a>00484     fflush(NULL);
<a name="l00485"></a>00485     <span class="keywordflow">for</span> (j = 0; j &lt; numElem; j++) 
<a name="l00486"></a>00486       fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, j);
<a name="l00487"></a>00487     <span class="comment">// have to add one because ensight indices start at 1 not 0</span>
<a name="l00488"></a>00488     <span class="keywordflow">for</span> (j = 0; j &lt; numElem; j++) {
<a name="l00489"></a>00489       <span class="keywordflow">for</span> (k = 0; k &lt; numVertPerElem; k++)
<a name="l00490"></a>00490         fprintf(geom_file, <span class="stringliteral">"%10d"</span>, conns[j*numVertPerElem+k] + 1);
<a name="l00491"></a>00491       fprintf(geom_file, <span class="stringliteral">"\n"</span>);
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493     fflush(NULL);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495     <span class="comment">// finished a part</span>
<a name="l00496"></a>00496     partID++;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     <span class="keywordflow">for</span> (j = 0; j &lt; numSubsetPerMesh[i]; j++) {
<a name="l00499"></a>00499       <span class="keywordtype">int</span> numMember, *memberIDs;
<a name="l00500"></a>00500       FC_AssociationType assoc;
<a name="l00501"></a>00501       <span class="keywordtype">int</span> numSubsetVert, *subsetVertIDs, numVertPerSubsetElem;
<a name="l00502"></a>00502       <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> subsetElemType;
<a name="l00503"></a>00503       <span class="keywordtype">int</span> *vertLU;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505       <span class="comment">// subset query</span>
<a name="l00506"></a>00506       rc = <a class="code" href="group__Subset.html#gf8d751f06ea68d6944e19816147d35a9">fc_getSubsetName</a>(subsetsPerMesh[i][j], &amp;temp_string);
<a name="l00507"></a>00507       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get subset name"</span>);
<a name="l00508"></a>00508       rc = <a class="code" href="group__Subset.html#gd546b0c5303f4c8a0f256662aff729a4">fc_getSubsetAssociationType</a>(subsetsPerMesh[i][j], &amp;assoc);
<a name="l00509"></a>00509       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get subset assoc"</span>);
<a name="l00510"></a>00510       
<a name="l00511"></a>00511       rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subsetsPerMesh[i][j], &amp;numMember,
<a name="l00512"></a>00512                                       &amp;memberIDs);
<a name="l00513"></a>00513       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get subset members"</span>);
<a name="l00514"></a>00514       rc = <a class="code" href="group__Mesh.html#g1c733c775b0e381dec888b5879f1c7f5">fc_getMeshEntityElementType</a>(meshes[i], assoc, memberIDs[0],
<a name="l00515"></a>00515                                        &amp;subsetElemType);
<a name="l00516"></a>00516       numVertPerSubsetElem = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(subsetElemType);
<a name="l00517"></a>00517       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get entity element type"</span>);
<a name="l00518"></a>00518       rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(meshes[i], assoc, numMember, memberIDs,
<a name="l00519"></a>00519                                    <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numSubsetVert,
<a name="l00520"></a>00520                                    &amp;subsetVertIDs);
<a name="l00521"></a>00521       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get subset vertices"</span>);
<a name="l00522"></a>00522       vertLU = (<span class="keywordtype">int</span>*)malloc(numVert*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00523"></a>00523       <span class="keywordflow">if</span> (!vertLU)
<a name="l00524"></a>00524         <a class="code" href="group__ErrorHandling.html#g4a09c0024ecd45d5d63c8b9ec333a717">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>);
<a name="l00525"></a>00525       <span class="keywordflow">for</span> (k = 0; k &lt; numSubsetVert; k++)
<a name="l00526"></a>00526         vertLU[subsetVertIDs[k]] = k;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528       <span class="comment">// special cases</span>
<a name="l00529"></a>00529       <span class="comment">// FIX! Could handle this, just have to do a lot of work</span>
<a name="l00530"></a>00530       <span class="keywordflow">if</span> (subsetElemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4b477e20533563cf70ccd322b0e21afa4">FC_ET_MIXED</a>)
<a name="l00531"></a>00531         <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Cannot yet handle mixed element types"</span>);
<a name="l00532"></a>00532       <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) {
<a name="l00533"></a>00533         <span class="keywordtype">int</span> num, *IDs;
<a name="l00534"></a>00534         rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(meshes[i], assoc, numMember, memberIDs,
<a name="l00535"></a>00535                                      <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, 1, &amp;num, &amp;IDs);
<a name="l00536"></a>00536         <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get subset whole"</span>);
<a name="l00537"></a>00537         free(memberIDs);
<a name="l00538"></a>00538         numMember = num;
<a name="l00539"></a>00539         memberIDs = IDs;
<a name="l00540"></a>00540         assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>;
<a name="l00541"></a>00541       }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543       <span class="comment">// save for later</span>
<a name="l00544"></a>00544       subsetAssocsPerMesh[i][j] = assoc;
<a name="l00545"></a>00545       numSubsetVertsPerMesh[i][j] = numSubsetVert;
<a name="l00546"></a>00546       subsetVertIDsPerMesh[i][j] = subsetVertIDs;
<a name="l00547"></a>00547       numMemberPerMesh[i][j] = numMember;
<a name="l00548"></a>00548       memberIDsPerMesh[i][j] = memberIDs;
<a name="l00549"></a>00549       
<a name="l00550"></a>00550       <span class="comment">// write metadata</span>
<a name="l00551"></a>00551       fprintf(geom_file, <span class="stringliteral">"part\n"</span>);
<a name="l00552"></a>00552       fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, partID+1); <span class="comment">// index from 1 not 0</span>
<a name="l00553"></a>00553       fprintf(geom_file, <span class="stringliteral">"%s\n"</span>, temp_string);
<a name="l00554"></a>00554       fflush(NULL);
<a name="l00555"></a>00555       free(temp_string);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557       <span class="comment">// write vertex ids &amp; coords</span>
<a name="l00558"></a>00558       fprintf(geom_file, <span class="stringliteral">"coordinates\n"</span>);
<a name="l00559"></a>00559       fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, numSubsetVert);
<a name="l00560"></a>00560       <span class="keywordflow">for</span> (k = 0; k &lt; numSubsetVert; k++)
<a name="l00561"></a>00561         fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, subsetVertIDs[k]); 
<a name="l00562"></a>00562       <span class="comment">// print coords as all x's, then all y's, then all z's</span>
<a name="l00563"></a>00563       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++)
<a name="l00564"></a>00564         <span class="keywordflow">for</span> (n = 0; n &lt; numSubsetVert; n++)
<a name="l00565"></a>00565           fprintf(geom_file, <span class="stringliteral">"%12.5e\n"</span>, coords[subsetVertIDs[n]*numDim + k]);
<a name="l00566"></a>00566       <span class="keywordflow">for</span> (k = numDim; k &lt; 3; k++)
<a name="l00567"></a>00567         <span class="keywordflow">for</span> (n = 0; n &lt; numSubsetVert; n++)
<a name="l00568"></a>00568           fprintf(geom_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l00569"></a>00569       fflush(NULL);
<a name="l00570"></a>00570 
<a name="l00571"></a>00571       <span class="comment">// write element ids &amp; conns</span>
<a name="l00572"></a>00572       fprintf(geom_file, <span class="stringliteral">"%s\n"</span>, <a class="code" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a>(subsetElemType));
<a name="l00573"></a>00573       fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, numMember);
<a name="l00574"></a>00574       fflush(NULL);
<a name="l00575"></a>00575       <span class="keywordflow">for</span> (k = 0; k &lt; numMember; k++)
<a name="l00576"></a>00576         fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, memberIDs[k]);
<a name="l00577"></a>00577       fflush(NULL);
<a name="l00578"></a>00578       <span class="comment">// have to add one because ensight indices start at 1 not 0</span>
<a name="l00579"></a>00579       <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>) {
<a name="l00580"></a>00580         <span class="keywordflow">for</span> (k = 0; k &lt; numMember; k++)
<a name="l00581"></a>00581           fprintf(geom_file, <span class="stringliteral">"%10d\n"</span>, k+1);
<a name="l00582"></a>00582       } 
<a name="l00583"></a>00583       <span class="keywordflow">else</span> {
<a name="l00584"></a>00584         <span class="keywordtype">int</span>* tempConns;
<a name="l00585"></a>00585         <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a>) {
<a name="l00586"></a>00586           rc = <a class="code" href="group__Mesh.html#gf2e80f30f86823573a2a2e516234eab8">fc_getMeshEdgeConnsPtr</a>(meshes[i], &amp;tempConns);
<a name="l00587"></a>00587           <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get edge conns"</span>);
<a name="l00588"></a>00588         }
<a name="l00589"></a>00589         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>) {
<a name="l00590"></a>00590           rc = <a class="code" href="group__Mesh.html#g216435eac0f72ad3ccb35e44b2df6ca5">fc_getMeshFaceConnsPtr</a>(meshes[i], NULL, &amp;numVertPerSubsetElem,
<a name="l00591"></a>00591                                       &amp;tempConns);
<a name="l00592"></a>00592           <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get face conns"</span>);
<a name="l00593"></a>00593         }
<a name="l00594"></a>00594         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>) {
<a name="l00595"></a>00595           tempConns = conns;
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597         <span class="keywordflow">for</span> (k = 0; k &lt; numMember; k++) {
<a name="l00598"></a>00598           <span class="keywordflow">for</span> (n = 0; n &lt; numVertPerSubsetElem; n++)
<a name="l00599"></a>00599             fprintf(geom_file, <span class="stringliteral">"%10d"</span>, 
<a name="l00600"></a>00600                     vertLU[tempConns[memberIDs[k]*numVertPerSubsetElem+n]] + 1);
<a name="l00601"></a>00601           fprintf(geom_file, <span class="stringliteral">"\n"</span>);
<a name="l00602"></a>00602         }
<a name="l00603"></a>00603       }
<a name="l00604"></a>00604       fflush(NULL);
<a name="l00605"></a>00605       
<a name="l00606"></a>00606       <span class="comment">// finished a part</span>
<a name="l00607"></a>00607       free(vertLU);
<a name="l00608"></a>00608       partID++;
<a name="l00609"></a>00609     }
<a name="l00610"></a>00610     <a class="code" href="group__Mesh.html#g794ab95c549f52f5a7ae932ff450923b">fc_releaseMesh</a>(meshes[i]);
<a name="l00611"></a>00611   }
<a name="l00612"></a>00612   fclose(geom_file);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614   <span class="comment">// --- Aside: write to case file, beginning of variable section</span>
<a name="l00615"></a>00615   fprintf(case_file, <span class="stringliteral">"\nVARIABLE\n\n"</span>);
<a name="l00616"></a>00616   fflush(NULL);
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00619"></a>00619   <span class="comment">//  Write variable files</span>
<a name="l00620"></a>00620   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00621"></a>00621   <span class="keywordflow">for</span> (i = 0; i &lt; numTotalVar; i++) {
<a name="l00622"></a>00622     <span class="comment">// make name w/o spaces</span>
<a name="l00623"></a>00623     temp_string = malloc((strlen(varNames[i])+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00624"></a>00624     strcpy(temp_string, varNames[i]);
<a name="l00625"></a>00625     <span class="keywordflow">for</span> (j = 0; j &lt; (int)strlen(temp_string); j++)
<a name="l00626"></a>00626       <span class="keywordflow">if</span> (temp_string[j] == <span class="charliteral">' '</span>)
<a name="l00627"></a>00627         temp_string[j] = <span class="charliteral">'_'</span>;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     <span class="comment">// FIX? for now, punt if variables are on edges or face -- but we</span>
<a name="l00630"></a>00630     <span class="comment">//        could put those on edge or face subsets if we really want to</span>
<a name="l00631"></a>00631     <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a> || varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>) {
<a name="l00632"></a>00632       printf(<span class="stringliteral">"Skipping variable '%s' because ensight can't handle assoc of "</span>
<a name="l00633"></a>00633              <span class="stringliteral">" type %s\n"</span>, varNames[i], 
<a name="l00634"></a>00634              <a class="code" href="group__DataTypes.html#gdb7ce28f8a85a1cc1e68b55f64eb54f5">fc_getAssociationTypeText</a>(varAssocs[i]));
<a name="l00635"></a>00635       fflush(NULL);
<a name="l00636"></a>00636     }
<a name="l00637"></a>00637     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varDataTypes[i] != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; varDataTypes[i] != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp;
<a name="l00638"></a>00638         varDataTypes[i] != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l00639"></a>00639       printf(<span class="stringliteral">"Skipping variable '%s' because ensight can't handle data of "</span>
<a name="l00640"></a>00640              <span class="stringliteral">" type %s\n"</span>, varNames[i], <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(varDataTypes[i]));
<a name="l00641"></a>00641       fflush(NULL);
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varMathTypes[i] != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a> &amp;&amp; varMathTypes[i] != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>) {
<a name="l00644"></a>00644       printf(<span class="stringliteral">"Skipping variable '%s' because this function can't yet handle "</span>
<a name="l00645"></a>00645              <span class="stringliteral">"data of math type %s\n"</span>, varNames[i], 
<a name="l00646"></a>00646              <a class="code" href="group__DataTypes.html#g75a3d1b2b701f9ee9cf45b5ea350ee3e">fc_getMathTypeText</a>(varMathTypes[i]));
<a name="l00647"></a>00647       fflush(NULL);
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649     <span class="comment">// constants</span>
<a name="l00650"></a>00650     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a> &amp;&amp; varNumComps[i] == 1) {
<a name="l00651"></a>00651       <span class="keywordflow">if</span> (doGlobals) {
<a name="l00652"></a>00652      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l00653"></a>00653        <a class="code" href="structFC__Variable.html">FC_Variable</a> *returnVariables;
<a name="l00654"></a>00654        <span class="keywordtype">int</span> numReturnVariables;
<a name="l00655"></a>00655        <span class="keywordtype">double</span>* data;
<a name="l00656"></a>00656 
<a name="l00657"></a>00657        rc = <a class="code" href="group__Mesh.html#g9f5a1b484e4b5ab4e0e137bfe34e10d6">fc_getMeshName</a>(meshes[j], &amp;temp_string2);
<a name="l00658"></a>00658        <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh name"</span>);
<a name="l00659"></a>00659        <span class="keywordflow">for</span> (k = 0; k &lt; (int)strlen(temp_string2); k++)
<a name="l00660"></a>00660          <span class="keywordflow">if</span> (temp_string2[k] == <span class="charliteral">' '</span>)
<a name="l00661"></a>00661            temp_string2[k] = <span class="charliteral">'_'</span>;
<a name="l00662"></a>00662        rc = <a class="code" href="group__Variable.html#g53d2967ed4e38d57d0852ab5e4cfef80">fc_getVariableByName</a>(meshes[j], varNames[i],
<a name="l00663"></a>00663                         &amp;numReturnVariables,
<a name="l00664"></a>00664                         &amp;returnVariables);
<a name="l00665"></a>00665        <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get variable by name"</span>);
<a name="l00666"></a>00666        <span class="keywordflow">if</span> (numReturnVariables != 1){
<a name="l00667"></a>00667          <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>,<span class="stringliteral">"Failed to get unique variable '%s' - found %d matches"</span>,
<a name="l00668"></a>00668                      varNames[i],numReturnVariables);
<a name="l00669"></a>00669        }
<a name="l00670"></a>00670        var = returnVariables[0];
<a name="l00671"></a>00671        free(returnVariables);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673        rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(var, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, (<span class="keywordtype">void</span>**)&amp;data);
<a name="l00674"></a>00674        <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get variable data"</span>);
<a name="l00675"></a>00675 
<a name="l00676"></a>00676        <span class="comment">// --- Aside: write to case file</span>
<a name="l00677"></a>00677        fprintf(case_file, <span class="stringliteral">"constant per case:   %s_on_%s "</span>,
<a name="l00678"></a>00678             temp_string, temp_string2);
<a name="l00679"></a>00679        fprintf(case_file, <span class="stringliteral">"%g\n"</span>, data[0]);
<a name="l00680"></a>00680        fflush(NULL);
<a name="l00681"></a>00681        
<a name="l00682"></a>00682        free(temp_string2);
<a name="l00683"></a>00683        free(data);
<a name="l00684"></a>00684        <a class="code" href="group__Variable.html#gb575d3f6365288a17c1117311fd99dce">fc_releaseVariable</a>(var);
<a name="l00685"></a>00685      }
<a name="l00686"></a>00686       }
<a name="l00687"></a>00687     } 
<a name="l00688"></a>00688     <span class="comment">// stuff that will require a file</span>
<a name="l00689"></a>00689     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a> || varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>) {
<a name="l00690"></a>00690       <span class="keywordtype">int</span> trunc_numComp = varNumComps[i];
<a name="l00691"></a>00691       <span class="comment">// check vector variables</span>
<a name="l00692"></a>00692       <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; varNumComps[i] &lt; 3) {
<a name="l00693"></a>00693         printf(<span class="stringliteral">"Warning, vector variable '%s' has less than three components, "</span>
<a name="l00694"></a>00694                <span class="stringliteral">"the remaining components will be padded with zeros\n"</span>,
<a name="l00695"></a>00695                varNames[i]);
<a name="l00696"></a>00696         fflush(NULL);
<a name="l00697"></a>00697       }
<a name="l00698"></a>00698       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; varNumComps[i] &gt; 3) {
<a name="l00699"></a>00699         printf(<span class="stringliteral">"Warning, vector variable '%s' has %d components, but will be "</span>
<a name="l00700"></a>00700                <span class="stringliteral">"truncated to just three components\n"</span>, varNames[i], 
<a name="l00701"></a>00701                varNumComps[i]);
<a name="l00702"></a>00702         fflush(NULL);
<a name="l00703"></a>00703         trunc_numComp = 3;
<a name="l00704"></a>00704       }
<a name="l00705"></a>00705       
<a name="l00706"></a>00706       <span class="comment">// names</span>
<a name="l00707"></a>00707       temp_string2 = malloc((path_base_length + strlen(varNames[i]) + 2)*
<a name="l00708"></a>00708                             <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00709"></a>00709       var_file_name = malloc((base_length + strlen(varNames[i]) + 2)*
<a name="l00710"></a>00710                              <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00711"></a>00711       sprintf(temp_string2, <span class="stringliteral">"%s.%s"</span>, path_base_file_name, temp_string);
<a name="l00712"></a>00712       sprintf(var_file_name, <span class="stringliteral">"%s.%s"</span>, base_file_name, temp_string);
<a name="l00713"></a>00713 
<a name="l00714"></a>00714       <span class="comment">// --- Aside: Write var file info to case file</span>
<a name="l00715"></a>00715       <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>)
<a name="l00716"></a>00716         fprintf(case_file, <span class="stringliteral">"scalar "</span>);
<a name="l00717"></a>00717       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>)
<a name="l00718"></a>00718         fprintf(case_file, <span class="stringliteral">"vector "</span>);
<a name="l00719"></a>00719       <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>)
<a name="l00720"></a>00720         fprintf(case_file, <span class="stringliteral">"per node:    "</span>);
<a name="l00721"></a>00721       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>)
<a name="l00722"></a>00722         fprintf(case_file, <span class="stringliteral">"per element:    "</span>);
<a name="l00723"></a>00723       fprintf(case_file, <span class="stringliteral">"%s  %s\n"</span>, temp_string, var_file_name);
<a name="l00724"></a>00724       fflush(NULL);
<a name="l00725"></a>00725       free(var_file_name);
<a name="l00726"></a>00726  
<a name="l00727"></a>00727       <span class="comment">// open var file</span>
<a name="l00728"></a>00728       var_file = fopen(temp_string2, <span class="stringliteral">"w"</span>);
<a name="l00729"></a>00729       <span class="keywordflow">if</span> (!var_file)
<a name="l00730"></a>00730         <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e41dd0a2fc17e1c521fa4a96cfd412708">FC_FILE_IO_ERROR</a>, <span class="stringliteral">"Failed to open file '%s'"</span>,
<a name="l00731"></a>00731                              temp_string);
<a name="l00732"></a>00732       free(temp_string2);
<a name="l00733"></a>00733       
<a name="l00734"></a>00734       <span class="comment">// var file header</span>
<a name="l00735"></a>00735       fprintf(var_file, <span class="stringliteral">"%s\n"</span>, temp_string);
<a name="l00736"></a>00736       fflush(NULL);
<a name="l00737"></a>00737 
<a name="l00738"></a>00738       <span class="comment">// Write part info</span>
<a name="l00739"></a>00739       partID = 0;
<a name="l00740"></a>00740       <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l00741"></a>00741      <a class="code" href="structFC__Variable.html">FC_Variable</a> *returnVariables;
<a name="l00742"></a>00742      <span class="keywordtype">int</span> numReturnVariables;
<a name="l00743"></a>00743         <span class="keywordtype">int</span> numDataPoint;
<a name="l00744"></a>00744         <span class="keywordtype">double</span>* data;
<a name="l00745"></a>00745         <a class="code" href="group__Variable.html#g53d2967ed4e38d57d0852ab5e4cfef80">fc_getVariableByName</a>(meshes[j], varNames[i], 
<a name="l00746"></a>00746                       &amp;numReturnVariables,
<a name="l00747"></a>00747                       &amp;returnVariables);
<a name="l00748"></a>00748         <span class="comment">// skip this mesh &amp; its subsets if this variable doesn't exist</span>
<a name="l00749"></a>00749      <span class="keywordflow">if</span> (numReturnVariables != 1){
<a name="l00750"></a>00750        <span class="keywordflow">if</span> (numReturnVariables &gt; 1){
<a name="l00751"></a>00751          <a class="code" href="group__Library.html#gbf7b424a5a96a9887547a6545f03e3e2">fc_printfWarningMessage</a>(<span class="stringliteral">"Problems finding (unique) variable '%s' - found %d matches"</span>,
<a name="l00752"></a>00752                         varNames[i],numReturnVariables);
<a name="l00753"></a>00753          <span class="keywordflow">if</span> (returnVariables) free(returnVariables);
<a name="l00754"></a>00754        }
<a name="l00755"></a>00755           partID += 1 + numSubsetPerMesh[j];
<a name="l00756"></a>00756           <span class="keywordflow">continue</span>;
<a name="l00757"></a>00757      }
<a name="l00758"></a>00758      var = returnVariables[0];
<a name="l00759"></a>00759      free(returnVariables);
<a name="l00760"></a>00760         rc = <a class="code" href="group__Variable.html#gca6fc2e25075838bc8b2ef3a347efb20">fc_getVariableNumDataPoint</a>(var, &amp;numDataPoint);
<a name="l00761"></a>00761         <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get numDataPoint"</span>);
<a name="l00762"></a>00762         rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(var, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, (<span class="keywordtype">void</span>**)&amp;data);
<a name="l00763"></a>00763         <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get variable data"</span>);
<a name="l00764"></a>00764         <span class="comment">// mesh part </span>
<a name="l00765"></a>00765         fprintf(var_file, <span class="stringliteral">"part\n"</span>);
<a name="l00766"></a>00766         fprintf(var_file, <span class="stringliteral">"%10d\n"</span>, partID + 1);  <span class="comment">// index from 1</span>
<a name="l00767"></a>00767         fflush(NULL);
<a name="l00768"></a>00768         <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>)
<a name="l00769"></a>00769           fprintf(var_file, <span class="stringliteral">"coordinates\n"</span>);
<a name="l00770"></a>00770         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>)
<a name="l00771"></a>00771           fprintf(var_file, <span class="stringliteral">"%s\n"</span>, <a class="code" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a>(meshElemTypes[j]));
<a name="l00772"></a>00772         <span class="keywordflow">for</span> (k = 0; k &lt; trunc_numComp; k++) 
<a name="l00773"></a>00773           <span class="keywordflow">for</span> (n = 0; n &lt; numDataPoint; n++)
<a name="l00774"></a>00774             fprintf(var_file, <span class="stringliteral">"%12.5e\n"</span>, data[n*varNumComps[i]+k]);
<a name="l00775"></a>00775         <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; varNumComps[i] &lt; 3) {
<a name="l00776"></a>00776           <span class="keywordflow">for</span> (k = trunc_numComp; k &lt; 3; k++)
<a name="l00777"></a>00777             <span class="keywordflow">for</span> (n = 0; n &lt; numDataPoint; n++)
<a name="l00778"></a>00778               fprintf(var_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l00779"></a>00779         }
<a name="l00780"></a>00780         fflush(NULL);
<a name="l00781"></a>00781         partID++;
<a name="l00782"></a>00782         <span class="comment">// subset parts</span>
<a name="l00783"></a>00783         <span class="keywordflow">for</span> (k = 0; k &lt; numSubsetPerMesh[j]; k++) {
<a name="l00784"></a>00784           <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>) {
<a name="l00785"></a>00785             fprintf(var_file, <span class="stringliteral">"part\n"</span>);
<a name="l00786"></a>00786             fprintf(var_file, <span class="stringliteral">"%10d\n"</span>, partID + 1);  <span class="comment">// index from 1</span>
<a name="l00787"></a>00787             fprintf(var_file, <span class="stringliteral">"coordinates\n"</span>);
<a name="l00788"></a>00788             <span class="keywordflow">for</span> (m = 0; m &lt; trunc_numComp; m++) 
<a name="l00789"></a>00789               <span class="keywordflow">for</span> (n = 0; n &lt; numSubsetVertsPerMesh[j][k]; n++)
<a name="l00790"></a>00790                 fprintf(var_file, <span class="stringliteral">"%12.5e\n"</span>, 
<a name="l00791"></a>00791                         data[subsetVertIDsPerMesh[j][k][n]*varNumComps[i]+m]);
<a name="l00792"></a>00792             <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; varNumComps[i] &lt; 3) {
<a name="l00793"></a>00793               <span class="keywordflow">for</span> (m = trunc_numComp; m &lt; 3; m++)
<a name="l00794"></a>00794                 <span class="keywordflow">for</span> (n = 0; n &lt; numSubsetVertsPerMesh[j][k]; n++)
<a name="l00795"></a>00795                   fprintf(var_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l00796"></a>00796             }
<a name="l00797"></a>00797           }
<a name="l00798"></a>00798           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a> &amp;&amp;
<a name="l00799"></a>00799                    subsetAssocsPerMesh[j][k] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>) {
<a name="l00800"></a>00800             fprintf(var_file, <span class="stringliteral">"part\n"</span>);
<a name="l00801"></a>00801             fprintf(var_file, <span class="stringliteral">"%10d\n"</span>, partID + 1);  <span class="comment">// index from 1</span>
<a name="l00802"></a>00802             fprintf(var_file, <span class="stringliteral">"%s\n"</span>, <a class="code" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a>(meshElemTypes[j]));
<a name="l00803"></a>00803             <span class="keywordflow">for</span> (m = 0; m &lt; trunc_numComp; m++)
<a name="l00804"></a>00804               <span class="keywordflow">for</span> (n = 0; n &lt; numMemberPerMesh[j][k]; n++)
<a name="l00805"></a>00805                 fprintf(var_file, <span class="stringliteral">"%12.5e\n"</span>,
<a name="l00806"></a>00806                         data[memberIDsPerMesh[j][k][n]*varNumComps[i]+m]);
<a name="l00807"></a>00807             <span class="keywordflow">if</span> (varMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; varNumComps[i] &lt; 3) {
<a name="l00808"></a>00808               <span class="keywordflow">for</span> (m = trunc_numComp; m &lt; 3; m++)
<a name="l00809"></a>00809                 <span class="keywordflow">for</span> (n = 0; n &lt; numMemberPerMesh[j][k]; n++)
<a name="l00810"></a>00810                   fprintf(var_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l00811"></a>00811             }
<a name="l00812"></a>00812           }
<a name="l00813"></a>00813           fflush(NULL);     
<a name="l00814"></a>00814           partID++;
<a name="l00815"></a>00815         } <span class="comment">// end of loop over subsets</span>
<a name="l00816"></a>00816         free(data);
<a name="l00817"></a>00817         <a class="code" href="group__Variable.html#gb575d3f6365288a17c1117311fd99dce">fc_releaseVariable</a>(var);
<a name="l00818"></a>00818       } <span class="comment">// end of loop over meshes</span>
<a name="l00819"></a>00819       fclose(var_file);
<a name="l00820"></a>00820     } <span class="comment">// end of stuff that requires a file</span>
<a name="l00821"></a>00821     <span class="keywordflow">else</span> {
<a name="l00822"></a>00822       printf(<span class="stringliteral">"Skipping variable '%s' because ensight can't handle it:\n"</span>, 
<a name="l00823"></a>00823              varNames[i]);
<a name="l00824"></a>00824       printf(<span class="stringliteral">" numComp = %d, assoc = %s, mathType = %s, dataType = %s\n"</span>,
<a name="l00825"></a>00825              varNumComps[i], <a class="code" href="group__DataTypes.html#gdb7ce28f8a85a1cc1e68b55f64eb54f5">fc_getAssociationTypeText</a>(varAssocs[i]),
<a name="l00826"></a>00826              <a class="code" href="group__DataTypes.html#g75a3d1b2b701f9ee9cf45b5ea350ee3e">fc_getMathTypeText</a>(varMathTypes[i]),
<a name="l00827"></a>00827              <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(varDataTypes[i]));
<a name="l00828"></a>00828       fflush(NULL);
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830     free(temp_string);
<a name="l00831"></a>00831   } <span class="comment">// loop over variables</span>
<a name="l00832"></a>00832 
<a name="l00833"></a>00833   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00834"></a>00834   <span class="comment">//  Write seq variable files</span>
<a name="l00835"></a>00835   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l00836"></a>00836   <span class="keywordflow">for</span> (i = 0; i &lt; numTotalSeqVar; i++) {
<a name="l00837"></a>00837     <span class="comment">// make name w/o spaces</span>
<a name="l00838"></a>00838     temp_string = malloc((strlen(seqVarNames[i])+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00839"></a>00839     strcpy(temp_string, seqVarNames[i]);
<a name="l00840"></a>00840     <span class="keywordflow">for</span> (j = 0; j &lt; (int)strlen(temp_string); j++)
<a name="l00841"></a>00841       <span class="keywordflow">if</span> (temp_string[j] == <span class="charliteral">' '</span>)
<a name="l00842"></a>00842         temp_string[j] = <span class="charliteral">'_'</span>;
<a name="l00843"></a>00843 
<a name="l00844"></a>00844     <span class="comment">// FIX? for now, punt if variables are on edges or face -- but we</span>
<a name="l00845"></a>00845     <span class="comment">//        could put those on edge or face subsets if we really want to</span>
<a name="l00846"></a>00846     <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a> || seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>) {
<a name="l00847"></a>00847       printf(<span class="stringliteral">"Skipping seqVariable '%s' because ensight can't handle assoc of "</span>
<a name="l00848"></a>00848              <span class="stringliteral">" type %s\n"</span>, seqVarNames[i], 
<a name="l00849"></a>00849              <a class="code" href="group__DataTypes.html#gdb7ce28f8a85a1cc1e68b55f64eb54f5">fc_getAssociationTypeText</a>(seqVarAssocs[i]));
<a name="l00850"></a>00850       fflush(NULL);
<a name="l00851"></a>00851     }
<a name="l00852"></a>00852     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarDataTypes[i] != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; seqVarDataTypes[i] != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp;
<a name="l00853"></a>00853         seqVarDataTypes[i] != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l00854"></a>00854       printf(<span class="stringliteral">"Skipping seqVariable '%s' because ensight can't handle data of "</span>
<a name="l00855"></a>00855              <span class="stringliteral">" type %s\n"</span>, seqVarNames[i], <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(seqVarDataTypes[i]));
<a name="l00856"></a>00856       fflush(NULL);
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarMathTypes[i] != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a> &amp;&amp; seqVarMathTypes[i] != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>) {
<a name="l00859"></a>00859       printf(<span class="stringliteral">"Skipping seqVariable '%s' because this function can't yet handle "</span>
<a name="l00860"></a>00860              <span class="stringliteral">"data of math type %s\n"</span>, seqVarNames[i], 
<a name="l00861"></a>00861              <a class="code" href="group__DataTypes.html#g75a3d1b2b701f9ee9cf45b5ea350ee3e">fc_getMathTypeText</a>(seqVarMathTypes[i]));
<a name="l00862"></a>00862       fflush(NULL);
<a name="l00863"></a>00863     }
<a name="l00864"></a>00864     <span class="comment">// constants</span>
<a name="l00865"></a>00865     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a> &amp;&amp; seqVarNumComps[i] == 1) {
<a name="l00866"></a>00866       <span class="keywordflow">if</span> (doGlobals) {
<a name="l00867"></a>00867      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l00868"></a>00868        <a class="code" href="structFC__Variable.html">FC_Variable</a> **returnSeqVars;
<a name="l00869"></a>00869        <span class="keywordtype">int</span> numReturnVars,*returnSteps;
<a name="l00870"></a>00870        <span class="keywordtype">double</span>* data;
<a name="l00871"></a>00871        rc = <a class="code" href="group__Mesh.html#g9f5a1b484e4b5ab4e0e137bfe34e10d6">fc_getMeshName</a>(meshes[j], &amp;temp_string2);
<a name="l00872"></a>00872        <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh name"</span>);
<a name="l00873"></a>00873        <span class="keywordflow">for</span> (k = 0; k &lt; (int)strlen(temp_string2); k++)
<a name="l00874"></a>00874          <span class="keywordflow">if</span> (temp_string2[k] == <span class="charliteral">' '</span>)
<a name="l00875"></a>00875            temp_string2[k] = <span class="charliteral">'_'</span>;
<a name="l00876"></a>00876        rc = <a class="code" href="group__Variable.html#g81f06442d2acc47bf9cf8ebbd94be75d">fc_getSeqVariableByName</a>(meshes[j], seqVarNames[i],
<a name="l00877"></a>00877                            &amp;numReturnVars,
<a name="l00878"></a>00878                            &amp;returnSteps,&amp;returnSeqVars);
<a name="l00879"></a>00879        <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get seqVariable by name"</span>);
<a name="l00880"></a>00880        <span class="keywordflow">if</span> (numReturnVars != 1){
<a name="l00881"></a>00881          <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, 
<a name="l00882"></a>00882                      <span class="stringliteral">"Failed to get (unique) seqVariable '%s' by name - found %d matches"</span>,
<a name="l00883"></a>00883                      seqVarNames[i],numReturnVars);
<a name="l00884"></a>00884        }
<a name="l00885"></a>00885        numStep = returnSteps[0];
<a name="l00886"></a>00886        seqVar = returnSeqVars[0];
<a name="l00887"></a>00887        free(returnSteps);
<a name="l00888"></a>00888        free(returnSeqVars);
<a name="l00889"></a>00889        
<a name="l00890"></a>00890        <span class="comment">// --- Aside: write to case file</span>
<a name="l00891"></a>00891        fprintf(case_file, <span class="stringliteral">"constant per case:   %d  %s_on_%s "</span>, 
<a name="l00892"></a>00892             seqVarSeqIDs[i]+1, temp_string, temp_string2);
<a name="l00893"></a>00893        fflush(NULL);
<a name="l00894"></a>00894        <span class="keywordflow">for</span> (k = 0; k &lt; numStep; k++) {
<a name="l00895"></a>00895          <span class="comment">// put in some line breaks, ensight chokes if too long a line</span>
<a name="l00896"></a>00896          <span class="keywordflow">if</span> (k != 0 &amp;&amp; k%5 == 0)
<a name="l00897"></a>00897            fprintf(case_file, <span class="stringliteral">"\n"</span>);
<a name="l00898"></a>00898          rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(seqVar[k], <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, 
<a name="l00899"></a>00899                                (<span class="keywordtype">void</span>**)&amp;data);
<a name="l00900"></a>00900          <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get seqVariable data"</span>);
<a name="l00901"></a>00901          fprintf(case_file, <span class="stringliteral">" %g"</span>, data[0]);
<a name="l00902"></a>00902          <a class="code" href="group__Variable.html#gb575d3f6365288a17c1117311fd99dce">fc_releaseVariable</a>(seqVar[k]);
<a name="l00903"></a>00903          free(data);
<a name="l00904"></a>00904        }
<a name="l00905"></a>00905        fprintf(case_file, <span class="stringliteral">"\n"</span>);
<a name="l00906"></a>00906        fflush(NULL);
<a name="l00907"></a>00907        
<a name="l00908"></a>00908        <span class="comment">// cleanup</span>
<a name="l00909"></a>00909        free(temp_string2);
<a name="l00910"></a>00910        free(seqVar);
<a name="l00911"></a>00911      }
<a name="l00912"></a>00912       }
<a name="l00913"></a>00913     } 
<a name="l00914"></a>00914     <span class="comment">// stuff that will require a file</span>
<a name="l00915"></a>00915     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a> || 
<a name="l00916"></a>00916              seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>) {
<a name="l00917"></a>00917       <span class="keywordtype">int</span> temp_int;
<a name="l00918"></a>00918       <span class="keywordtype">int</span> trunc_numComp = seqVarNumComps[i];
<a name="l00919"></a>00919       <span class="keywordtype">int</span> number_len; <span class="comment">// length of the step number field in name</span>
<a name="l00920"></a>00920       <span class="keywordtype">char</span>* number_p;  <span class="comment">// char pointer to start of number field in name</span>
<a name="l00921"></a>00921       <span class="keywordtype">char</span> controlStr[50];
<a name="l00922"></a>00922       <span class="comment">// check vector seqVariables</span>
<a name="l00923"></a>00923       <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; seqVarNumComps[i] &lt; 3) {
<a name="l00924"></a>00924         printf(<span class="stringliteral">"Warning, vector seqVariable '%s' has less than three components, "</span>
<a name="l00925"></a>00925                <span class="stringliteral">"the remaining components will be padded with zeros\n"</span>,
<a name="l00926"></a>00926                seqVarNames[i]);
<a name="l00927"></a>00927         fflush(NULL);
<a name="l00928"></a>00928       }
<a name="l00929"></a>00929       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; seqVarNumComps[i] &gt; 3) {
<a name="l00930"></a>00930         printf(<span class="stringliteral">"Warning, vector seqVariable '%s' has %d components, but will be "</span>
<a name="l00931"></a>00931                <span class="stringliteral">"truncated to just three components\n"</span>, seqVarNames[i], 
<a name="l00932"></a>00932                seqVarNumComps[i]);
<a name="l00933"></a>00933         fflush(NULL);
<a name="l00934"></a>00934         trunc_numComp = 3;
<a name="l00935"></a>00935       }
<a name="l00936"></a>00936       
<a name="l00937"></a>00937       <span class="comment">// names</span>
<a name="l00938"></a>00938       number_len = 1;
<a name="l00939"></a>00939       temp_int = seqVarNumSteps[i];
<a name="l00940"></a>00940       <span class="keywordflow">while</span>(temp_int /= 10)
<a name="l00941"></a>00941         number_len++;
<a name="l00942"></a>00942       temp_string2 = malloc((path_base_length + strlen(seqVarNames[i]) + 
<a name="l00943"></a>00943                              number_len + 3)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00944"></a>00944       seqVar_file_name = malloc((base_length + strlen(seqVarNames[i]) + 
<a name="l00945"></a>00945                                  number_len + 3)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00946"></a>00946       sprintf(temp_string2, <span class="stringliteral">"%s.%s_"</span>, path_base_file_name, temp_string);
<a name="l00947"></a>00947       sprintf(seqVar_file_name, <span class="stringliteral">"%s.%s_"</span>, base_file_name, temp_string);
<a name="l00948"></a>00948       number_p = &amp;seqVar_file_name[base_length + strlen(seqVarNames[i]) + 2];
<a name="l00949"></a>00949       <span class="keywordflow">for</span> (j = 0; j &lt; number_len; j++)
<a name="l00950"></a>00950         number_p[j] = <span class="charliteral">'*'</span>;
<a name="l00951"></a>00951       number_p[number_len] = <span class="charliteral">'\0'</span>;
<a name="l00952"></a>00952       number_p = &amp;temp_string2[path_base_length + strlen(seqVarNames[i]) + 2];
<a name="l00953"></a>00953       sprintf(controlStr, <span class="stringliteral">"%%0%dd"</span>, number_len);
<a name="l00954"></a>00954       <span class="comment">//printf("controlStr = %s\n", controlStr);</span>
<a name="l00955"></a>00955 
<a name="l00956"></a>00956       <span class="comment">// --- Aside: Write seqVar file info to case file</span>
<a name="l00957"></a>00957       <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>)
<a name="l00958"></a>00958         fprintf(case_file, <span class="stringliteral">"scalar "</span>);
<a name="l00959"></a>00959       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>)
<a name="l00960"></a>00960         fprintf(case_file, <span class="stringliteral">"vector "</span>);
<a name="l00961"></a>00961       <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>)
<a name="l00962"></a>00962         fprintf(case_file, <span class="stringliteral">"per node:    "</span>);
<a name="l00963"></a>00963       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>)
<a name="l00964"></a>00964         fprintf(case_file, <span class="stringliteral">"per element:    "</span>);
<a name="l00965"></a>00965       fprintf(case_file, <span class="stringliteral">"%d  %s  %s\n"</span>, seqVarSeqIDs[i]+1, temp_string, 
<a name="l00966"></a>00966               seqVar_file_name);
<a name="l00967"></a>00967       fflush(NULL);
<a name="l00968"></a>00968       free(seqVar_file_name);
<a name="l00969"></a>00969 
<a name="l00970"></a>00970       <span class="comment">// loop over steps</span>
<a name="l00971"></a>00971       <span class="keywordflow">for</span> (p = 0; p &lt; seqVarNumSteps[i]; p++) {
<a name="l00972"></a>00972         
<a name="l00973"></a>00973         <span class="comment">// open seqVar file</span>
<a name="l00974"></a>00974         sprintf(number_p, controlStr, p+1);
<a name="l00975"></a>00975         seqVar_file = fopen(temp_string2, <span class="stringliteral">"w"</span>);
<a name="l00976"></a>00976         <span class="keywordflow">if</span> (!seqVar_file)
<a name="l00977"></a>00977           <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e41dd0a2fc17e1c521fa4a96cfd412708">FC_FILE_IO_ERROR</a>, <span class="stringliteral">"Failed to open file '%s'"</span>,
<a name="l00978"></a>00978                                temp_string2);
<a name="l00979"></a>00979       
<a name="l00980"></a>00980         <span class="comment">// seqVar file header</span>
<a name="l00981"></a>00981         fprintf(seqVar_file, <span class="stringliteral">"%s\n"</span>, temp_string);
<a name="l00982"></a>00982         fflush(NULL);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984         <span class="comment">// Write part info</span>
<a name="l00985"></a>00985         partID = 0;
<a name="l00986"></a>00986         <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l00987"></a>00987        <a class="code" href="structFC__Variable.html">FC_Variable</a> **returnVars;
<a name="l00988"></a>00988        <span class="keywordtype">int</span> numReturnVars, *returnVarsSteps;
<a name="l00989"></a>00989           <span class="keywordtype">int</span> numDataPoint;
<a name="l00990"></a>00990           <span class="keywordtype">double</span>* data;
<a name="l00991"></a>00991           <a class="code" href="group__Variable.html#g81f06442d2acc47bf9cf8ebbd94be75d">fc_getSeqVariableByName</a>(meshes[j], seqVarNames[i],
<a name="l00992"></a>00992                            &amp;numReturnVars,
<a name="l00993"></a>00993                            &amp;returnVarsSteps, &amp;returnVars);
<a name="l00994"></a>00994           <span class="comment">// skip this mesh &amp; its subsets if this seqVariable doesn't exist</span>
<a name="l00995"></a>00995        <span class="keywordflow">if</span> (numReturnVars != 1){
<a name="l00996"></a>00996          <span class="keywordflow">if</span> (numReturnVars &gt; 1){
<a name="l00997"></a>00997            <a class="code" href="group__Library.html#gbf7b424a5a96a9887547a6545f03e3e2">fc_printfWarningMessage</a>(<span class="stringliteral">"Problems finding (unique) variable '%s' - found %d matches"</span>,
<a name="l00998"></a>00998                           seqVarNames[i],numReturnVars);
<a name="l00999"></a>00999            <span class="keywordflow">for</span> (k = 0; k &lt; numReturnVars; k++){
<a name="l01000"></a>01000           free(returnVars[k]);
<a name="l01001"></a>01001            }
<a name="l01002"></a>01002            free(returnVars);
<a name="l01003"></a>01003            free(returnVarsSteps);
<a name="l01004"></a>01004          }
<a name="l01005"></a>01005             partID += 1 + numSubsetPerMesh[j];
<a name="l01006"></a>01006             <span class="keywordflow">continue</span>;
<a name="l01007"></a>01007        }
<a name="l01008"></a>01008        seqVar = returnVars[0];
<a name="l01009"></a>01009        numStep = returnVarsSteps[0];
<a name="l01010"></a>01010        free(returnVars);
<a name="l01011"></a>01011        free(returnVarsSteps);
<a name="l01012"></a>01012 
<a name="l01013"></a>01013           rc = <a class="code" href="group__Variable.html#gca6fc2e25075838bc8b2ef3a347efb20">fc_getVariableNumDataPoint</a>(seqVar[p], &amp;numDataPoint);
<a name="l01014"></a>01014           <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get numDataPoint"</span>);
<a name="l01015"></a>01015           rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(seqVar[p], <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, 
<a name="l01016"></a>01016                                             (<span class="keywordtype">void</span>**)&amp;data);
<a name="l01017"></a>01017           <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get seqVariable data"</span>);
<a name="l01018"></a>01018           <span class="comment">// mesh part </span>
<a name="l01019"></a>01019           fprintf(seqVar_file, <span class="stringliteral">"part\n"</span>);
<a name="l01020"></a>01020           fprintf(seqVar_file, <span class="stringliteral">"%10d\n"</span>, partID + 1);  <span class="comment">// index from 1</span>
<a name="l01021"></a>01021           <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>)
<a name="l01022"></a>01022             fprintf(seqVar_file, <span class="stringliteral">"coordinates\n"</span>);
<a name="l01023"></a>01023           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>)
<a name="l01024"></a>01024             fprintf(seqVar_file, <span class="stringliteral">"%s\n"</span>, <a class="code" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a>(meshElemTypes[j]));
<a name="l01025"></a>01025           <span class="keywordflow">for</span> (k = 0; k &lt; trunc_numComp; k++) 
<a name="l01026"></a>01026             <span class="keywordflow">for</span> (n = 0; n &lt; numDataPoint; n++)
<a name="l01027"></a>01027               fprintf(seqVar_file, <span class="stringliteral">"%12.5e\n"</span>, data[n*seqVarNumComps[i]+k]);
<a name="l01028"></a>01028           <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; seqVarNumComps[i] &lt; 3) {
<a name="l01029"></a>01029             <span class="keywordflow">for</span> (k = trunc_numComp; k &lt; 3; k++)
<a name="l01030"></a>01030               <span class="keywordflow">for</span> (n = 0; n &lt; numDataPoint; n++)
<a name="l01031"></a>01031                 fprintf(seqVar_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l01032"></a>01032           }
<a name="l01033"></a>01033           fflush(NULL);
<a name="l01034"></a>01034           partID++;
<a name="l01035"></a>01035           <span class="comment">// subset parts</span>
<a name="l01036"></a>01036           <span class="keywordflow">for</span> (k = 0; k &lt; numSubsetPerMesh[j]; k++) {
<a name="l01037"></a>01037             <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>) {
<a name="l01038"></a>01038               fprintf(seqVar_file, <span class="stringliteral">"part\n"</span>);
<a name="l01039"></a>01039               fprintf(seqVar_file, <span class="stringliteral">"%10d\n"</span>, partID + 1);  <span class="comment">// index from 1</span>
<a name="l01040"></a>01040               fprintf(seqVar_file, <span class="stringliteral">"coordinates\n"</span>);
<a name="l01041"></a>01041               <span class="keywordflow">for</span> (m = 0; m &lt; trunc_numComp; m++) 
<a name="l01042"></a>01042                 <span class="keywordflow">for</span> (n = 0; n &lt; numSubsetVertsPerMesh[j][k]; n++)
<a name="l01043"></a>01043                   fprintf(seqVar_file, <span class="stringliteral">"%12.5e\n"</span>, 
<a name="l01044"></a>01044                           data[subsetVertIDsPerMesh[j][k][n]*seqVarNumComps[i]+m]);
<a name="l01045"></a>01045               <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; seqVarNumComps[i] &lt; 3) {
<a name="l01046"></a>01046                 <span class="keywordflow">for</span> (m = trunc_numComp; m &lt; 3; m++)
<a name="l01047"></a>01047                   <span class="keywordflow">for</span> (n = 0; n &lt; numSubsetVertsPerMesh[j][k]; n++)
<a name="l01048"></a>01048                     fprintf(seqVar_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l01049"></a>01049               }
<a name="l01050"></a>01050             }
<a name="l01051"></a>01051             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqVarAssocs[i] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a> &amp;&amp;
<a name="l01052"></a>01052                      subsetAssocsPerMesh[j][k] == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>) {
<a name="l01053"></a>01053               fprintf(seqVar_file, <span class="stringliteral">"part\n"</span>);
<a name="l01054"></a>01054               fprintf(seqVar_file, <span class="stringliteral">"%10d\n"</span>, partID + 1);  <span class="comment">// index from 1</span>
<a name="l01055"></a>01055               fprintf(seqVar_file, <span class="stringliteral">"%s\n"</span>, <a class="code" href="fc2ensight_8c.html#cb98dfb5b61432005edfdee3e7e59ea4">getEnsightElementType</a>(meshElemTypes[j]));
<a name="l01056"></a>01056               <span class="keywordflow">for</span> (m = 0; m &lt; trunc_numComp; m++)
<a name="l01057"></a>01057                 <span class="keywordflow">for</span> (n = 0; n &lt; numMemberPerMesh[j][k]; n++)
<a name="l01058"></a>01058                   fprintf(seqVar_file, <span class="stringliteral">"%12.5e\n"</span>,
<a name="l01059"></a>01059                           data[memberIDsPerMesh[j][k][n]*seqVarNumComps[i]+m]);
<a name="l01060"></a>01060               <span class="keywordflow">if</span> (seqVarMathTypes[i] == <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> &amp;&amp; seqVarNumComps[i] &lt; 3) {
<a name="l01061"></a>01061                 <span class="keywordflow">for</span> (m = trunc_numComp; m &lt; 3; m++)
<a name="l01062"></a>01062                   <span class="keywordflow">for</span> (n = 0; n &lt; numMemberPerMesh[j][k]; n++)
<a name="l01063"></a>01063                     fprintf(seqVar_file, <span class="stringliteral">"%12.5e\n"</span>, 0.);
<a name="l01064"></a>01064               }
<a name="l01065"></a>01065             }       
<a name="l01066"></a>01066             fflush(NULL);
<a name="l01067"></a>01067             partID++;
<a name="l01068"></a>01068           } <span class="comment">// end of loop over subsets</span>
<a name="l01069"></a>01069           free(data);
<a name="l01070"></a>01070           <a class="code" href="group__Variable.html#gb575d3f6365288a17c1117311fd99dce">fc_releaseVariable</a>(seqVar[p]);
<a name="l01071"></a>01071           free(seqVar);
<a name="l01072"></a>01072         } <span class="comment">// end of loop over meshes</span>
<a name="l01073"></a>01073         fclose(seqVar_file);
<a name="l01074"></a>01074       } <span class="comment">// end of loop over steps</span>
<a name="l01075"></a>01075       free(temp_string2);
<a name="l01076"></a>01076     } <span class="comment">// end of stuff that requires a file</span>
<a name="l01077"></a>01077     <span class="keywordflow">else</span> {
<a name="l01078"></a>01078       printf(<span class="stringliteral">"Skipping seqVariable '%s' because ensight can't handle it:\n"</span>, 
<a name="l01079"></a>01079              seqVarNames[i]);
<a name="l01080"></a>01080       printf(<span class="stringliteral">" numComp = %d, assoc = %s, mathType = %s, dataType = %s\n"</span>,
<a name="l01081"></a>01081              seqVarNumComps[i], <a class="code" href="group__DataTypes.html#gdb7ce28f8a85a1cc1e68b55f64eb54f5">fc_getAssociationTypeText</a>(seqVarAssocs[i]),
<a name="l01082"></a>01082              <a class="code" href="group__DataTypes.html#g75a3d1b2b701f9ee9cf45b5ea350ee3e">fc_getMathTypeText</a>(seqVarMathTypes[i]),
<a name="l01083"></a>01083              <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(seqVarDataTypes[i]));
<a name="l01084"></a>01084       fflush(NULL);
<a name="l01085"></a>01085     }
<a name="l01086"></a>01086     free(temp_string);
<a name="l01087"></a>01087   } <span class="comment">// loop over seqVariables</span>
<a name="l01088"></a>01088 
<a name="l01089"></a>01089   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l01090"></a>01090   <span class="comment">//  Write sequences to case file</span>
<a name="l01091"></a>01091   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l01092"></a>01092   <span class="keywordflow">if</span> (numSequence &gt; 0) {
<a name="l01093"></a>01093 
<a name="l01094"></a>01094     fprintf(case_file, <span class="stringliteral">"\nTIME\n\n"</span>);
<a name="l01095"></a>01095     fflush(NULL);
<a name="l01096"></a>01096 
<a name="l01097"></a>01097     <span class="keywordflow">for</span> (i = 0; i &lt; numSequence; i++) {
<a name="l01098"></a>01098       <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> dataType;
<a name="l01099"></a>01099       <span class="keywordtype">void</span>* coords;
<a name="l01100"></a>01100 
<a name="l01101"></a>01101       rc = <a class="code" href="group__Sequence.html#ge7289ce45a13855f48a0b5de93c68101">fc_getSequenceInfo</a>(sequences[i], &amp;numStep, &amp;dataType);
<a name="l01102"></a>01102       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get sequence numStep"</span>);
<a name="l01103"></a>01103       <span class="keywordflow">if</span> (dataType != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; dataType != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp;
<a name="l01104"></a>01104           dataType != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>)
<a name="l01105"></a>01105         <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Cannot handle sequende with data type "</span>
<a name="l01106"></a>01106                              <span class="stringliteral">"%s\n"</span>, <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(dataType));
<a name="l01107"></a>01107       rc = <a class="code" href="group__Sequence.html#g38e90553b530ed6e4ebeb28df20eade8">fc_getSequenceCoordsPtr</a>(sequences[i], &amp;coords);
<a name="l01108"></a>01108       <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get sequence coords"</span>);
<a name="l01109"></a>01109       
<a name="l01110"></a>01110       fprintf(case_file, <span class="stringliteral">"time set:          %d\n"</span>, i + 1);
<a name="l01111"></a>01111       fprintf(case_file, <span class="stringliteral">"number of steps:       %d\n"</span>, numStep);
<a name="l01112"></a>01112       fprintf(case_file, <span class="stringliteral">"filename start number: 1\n"</span>);
<a name="l01113"></a>01113       fprintf(case_file, <span class="stringliteral">"filename increment:    1\n"</span>);
<a name="l01114"></a>01114       fprintf(case_file, <span class="stringliteral">"time values:\n"</span>);
<a name="l01115"></a>01115       fflush(NULL);
<a name="l01116"></a>01116       <span class="keywordflow">for</span> (j = 0; j &lt; numStep; j++) {
<a name="l01117"></a>01117         <span class="keywordflow">switch</span>(dataType) {
<a name="l01118"></a>01118         <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l01119"></a>01119           fprintf(case_file, <span class="stringliteral">"     %d\n"</span>, ((<span class="keywordtype">int</span>*)coords)[j]);     <span class="keywordflow">break</span>;
<a name="l01120"></a>01120         <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l01121"></a>01121           fprintf(case_file, <span class="stringliteral">"     %g\n"</span>, ((<span class="keywordtype">float</span>*)coords)[j]);   <span class="keywordflow">break</span>;
<a name="l01122"></a>01122         <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l01123"></a>01123           fprintf(case_file, <span class="stringliteral">"     %g\n"</span>, ((<span class="keywordtype">double</span>*)coords)[j]);  <span class="keywordflow">break</span>;
<a name="l01124"></a>01124         <span class="keywordflow">default</span>:
<a name="l01125"></a>01125           printf(<span class="stringliteral">"Can't reach this!!!!\n"</span>);
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127       }
<a name="l01128"></a>01128       fflush(NULL);
<a name="l01129"></a>01129     }
<a name="l01130"></a>01130   }
<a name="l01131"></a>01131 
<a name="l01132"></a>01132   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l01133"></a>01133   <span class="comment">//  Finish the case file</span>
<a name="l01134"></a>01134   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l01135"></a>01135   fclose(case_file);
<a name="l01136"></a>01136 
<a name="l01137"></a>01137   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l01138"></a>01138   <span class="comment">//  Finalize FCLib</span>
<a name="l01139"></a>01139   <span class="comment">//---------------------------------------------------------------------</span>
<a name="l01140"></a>01140   rc = <a class="code" href="group__Library.html#g68cec1422dde03b636cf039faafa7baa">fc_finalLibrary</a>();
<a name="l01141"></a>01141   <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to finalize library"</span>);
<a name="l01142"></a>01142 
<a name="l01143"></a>01143   <span class="comment">//------------------------------------------------------------------</span>
<a name="l01144"></a>01144   <span class="comment">//   cleanup &amp; exit</span>
<a name="l01145"></a>01145   <span class="comment">//------------------------------------------------------------------</span>
<a name="l01146"></a>01146   free(path_base_file_name);
<a name="l01147"></a>01147   free(sequences);
<a name="l01148"></a>01148   free(meshes);
<a name="l01149"></a>01149   free(numSubsetPerMesh);
<a name="l01150"></a>01150   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++)
<a name="l01151"></a>01151     free(subsetsPerMesh[i]);
<a name="l01152"></a>01152   free(subsetsPerMesh);
<a name="l01153"></a>01153   exit(0);
<a name="l01154"></a>01154 }
</pre></div>
<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Wed Oct 31 11:10:00 2007 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
