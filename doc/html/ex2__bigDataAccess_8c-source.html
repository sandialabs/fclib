<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>FCLib: examples/ex2_bigDataAccess.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>examples/ex2_bigDataAccess.c</h1><a href="ex2__bigDataAccess_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (2000) Sandia Corporation. Under the terms of Contract</span>
<a name="l00003"></a>00003 <span class="comment"> * DE-AC04-94AL85000 with Sandia Corporation, the U.S. Government retains</span>
<a name="l00004"></a>00004 <span class="comment"> * certain rights in this software.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00007"></a>00007 <span class="comment"> * modification, are permitted provided that the following conditions are met:</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *   * Redistributions of source code must retain the above copyright</span>
<a name="l00010"></a>00010 <span class="comment"> *     notice, this list of conditions and the following disclaimer.</span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> *   * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00013"></a>00013 <span class="comment"> *     notice, this list of conditions and the following disclaimer in the</span>
<a name="l00014"></a>00014 <span class="comment"> *     documentation and/or other materials provided with the</span>
<a name="l00015"></a>00015 <span class="comment"> *     distribution.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> *   * Neither the name of Sandia nor the names of any contributors may</span>
<a name="l00018"></a>00018 <span class="comment"> *     be used to endorse or promote products derived from this software</span>
<a name="l00019"></a>00019 <span class="comment"> *     without specific prior written permission.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> *   * Modified source versions must be plainly marked as such, and must</span>
<a name="l00022"></a>00022 <span class="comment"> *     not be misrepresented as being the original software.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span>
<a name="l00025"></a>00025 <span class="comment"> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="l00026"></a>00026 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<a name="l00027"></a>00027 <span class="comment"> * ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE LIABLE FOR</span>
<a name="l00028"></a>00028 <span class="comment"> * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="l00029"></a>00029 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<a name="l00030"></a>00030 <span class="comment"> * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<a name="l00031"></a>00031 <span class="comment"> * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
<a name="l00032"></a>00032 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
<a name="l00033"></a>00033 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH</span>
<a name="l00034"></a>00034 <span class="comment"> * DAMAGE.</span>
<a name="l00035"></a>00035 <span class="comment"> */</span>
<a name="l00036"></a>00036 <span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">/**</span>
<a name="l00038"></a>00038 <span class="comment"> * \file ex2_bigDataAccess.c</span>
<a name="l00039"></a>00039 <span class="comment"> * \brief Example of accessing big data.</span>
<a name="l00040"></a>00040 <span class="comment"> *</span>
<a name="l00041"></a>00041 <span class="comment"> * \description</span>
<a name="l00042"></a>00042 <span class="comment"> *    </span>
<a name="l00043"></a>00043 <span class="comment"> *    This is an annotated example that walks through the use of basic aspects</span>
<a name="l00044"></a>00044 <span class="comment"> *    of the Feature Characterization Library (FCLib).  It covers big data</span>
<a name="l00045"></a>00045 <span class="comment"> *    access (mesh coordinates, variable data values).</span>
<a name="l00046"></a>00046 <span class="comment"> *</span>
<a name="l00047"></a>00047 <span class="comment"> *    Please see ex1_intro.c first for an example of basic data access</span>
<a name="l00048"></a>00048 <span class="comment"> *    and using built-in FCLib characterizations. See also</span>
<a name="l00049"></a>00049 <span class="comment"> *    ex3_createCharactrztn.c for details bout creating your own</span>
<a name="l00050"></a>00050 <span class="comment"> *    characterization. </span>
<a name="l00051"></a>00051 <span class="comment"> *</span>
<a name="l00052"></a>00052 <span class="comment"> *    NOTE: If you are looking at this file through the Doxygen interface,</span>
<a name="l00053"></a>00053 <span class="comment"> *    all objects and functions are linked to their documentation--so </span>
<a name="l00054"></a>00054 <span class="comment"> *    follow the links for more details!</span>
<a name="l00055"></a>00055 <span class="comment"> *</span>
<a name="l00056"></a>00056 <span class="comment"> *    NOTE: Don't forget to try running the program while looking at this file.</span>
<a name="l00057"></a>00057 <span class="comment"> *</span>
<a name="l00058"></a>00058 <span class="comment"> * $Source: /usr/local/Repositories/fcdmf/fclib/examples/ex2_bigDataAccess.c,v $</span>
<a name="l00059"></a>00059 <span class="comment"> * $Revision: 1.6 $ </span>
<a name="l00060"></a>00060 <span class="comment"> * $Date: 2006/09/26 21:31:32 $</span>
<a name="l00061"></a>00061 <span class="comment"> *</span>
<a name="l00062"></a>00062 <span class="comment"> * \modifications</span>
<a name="l00063"></a>00063 <span class="comment"> *    - 12/06/04 WSK, created.</span>
<a name="l00064"></a>00064 <span class="comment"> *    - 10/12/05 WSD, moved making a characterization to it's own file</span>
<a name="l00065"></a>00065 <span class="comment"> *      because gcc 4.0 didn't like function declarations within functions.</span>
<a name="l00066"></a>00066 <span class="comment"> */</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &lt;<a class="code" href="fc_8h.html">fc.h</a>&gt;</span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="ex2__bigDataAccess_8c.html#5ad1c26f00c2399d3a5c7850100212d0">00071</a> <span class="keywordtype">int</span> <a class="code" href="analyzeSpotWelds_8c.html#24e6ce6d053864cf5fb7af941457bb0e">main</a>(<span class="keywordtype">void</span>)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00074"></a>00074   <span class="keywordtype">int</span> i, j;
<a name="l00075"></a>00075   <span class="keywordtype">int</span> numStep, topodim, dim, numVertex, numElement, numVertexPerElement;
<a name="l00076"></a>00076   <span class="keywordtype">int</span> numMember, maxNumMember, numDataPoint, <a class="code" href="seriesAnalyzer_8c.html#6ec7f8d4daae55f80c5164c2e235e339">numComponent</a>, *memberIDs;
<a name="l00077"></a>00077   <span class="keywordtype">int</span> numMeshes;
<a name="l00078"></a>00078   <span class="keywordtype">int</span> numReturnSeqVars, *numStepPerReturnSeqVar, numReturnSubsets;
<a name="l00079"></a>00079   <span class="keywordtype">int</span> *conns;
<a name="l00080"></a>00080   <span class="keywordtype">double</span> *coords;
<a name="l00081"></a>00081   <span class="keywordtype">void</span>* seqCoords, *data;
<a name="l00082"></a>00082   <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l00083"></a>00083   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> sequence;
<a name="l00084"></a>00084   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh, *meshes;
<a name="l00085"></a>00085   <a class="code" href="structFC__Subset.html">FC_Subset</a> subset, *returnSubsets;
<a name="l00086"></a>00086   <a class="code" href="structFC__Variable.html">FC_Variable</a> *seqVariable, **returnSeqVars;
<a name="l00087"></a>00087   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> dataType;
<a name="l00088"></a>00088   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l00089"></a>00089   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assocType;
<a name="l00090"></a>00090   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathType;
<a name="l00091"></a>00091   <span class="keywordtype">char</span> dataset_name[1024];
<a name="l00092"></a>00092   <span class="keywordtype">char</span> mesh_name[1024];
<a name="l00093"></a>00093   <span class="keywordtype">char</span> seqVariable_name[1024];
<a name="l00094"></a>00094   <span class="keywordtype">char</span> sequence_name[1024];
<a name="l00095"></a>00095   <span class="keywordtype">char</span> subset_name[1024];
<a name="l00096"></a>00096   <span class="keywordtype">char</span>* temp_name;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   printf(<span class="stringliteral">"Running ex2_bigDataAccess ...\n"</span>);
<a name="l00099"></a>00099   printf(<span class="stringliteral">"\n"</span>);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   <span class="comment">// --- Init library and get Data Object handles</span>
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="comment">// The code to get the data object handles is taken directly from</span>
<a name="l00104"></a>00104   <span class="comment">// ex1_intro.c which we assume the reader has read.</span>
<a name="l00105"></a>00105   <span class="comment">// Get the hex mesh, the temperature sequence variable, and the sequence</span>
<a name="l00106"></a>00106   rc = <a class="code" href="group__Library.html#gf13f047de6d44c9028d4944bc29867db">fc_setLibraryVerbosity</a>(<a class="code" href="group__DataTypes.html#gg6c0891f21e34bad1d8b2bc7c76193a3995521f4f1526a6565b08e663106dd6e7">FC_WARNING_MESSAGES</a>);
<a name="l00107"></a>00107   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00108"></a>00108     exit(rc);
<a name="l00109"></a>00109   rc = <a class="code" href="group__Library.html#g355d03ffe3f8c560e9343716f78af097">fc_initLibrary</a>();
<a name="l00110"></a>00110   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00111"></a>00111     exit(rc);
<a name="l00112"></a>00112   strcpy(dataset_name, <span class="stringliteral">"../data/gen_multivar_seq.ex2"</span>);
<a name="l00113"></a>00113   rc = <a class="code" href="group__FileIO.html#g953a8c4a7feb785e0091b7cf58626092">fc_loadDataset</a>(dataset_name, &amp;dataset);
<a name="l00114"></a>00114   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00115"></a>00115     exit(rc);
<a name="l00116"></a>00116   strcpy(mesh_name, <span class="stringliteral">"hex mesh"</span>);
<a name="l00117"></a>00117   rc = <a class="code" href="group__Mesh.html#g8f35371531555da3b336a94d7ce3053d">fc_getMeshByName</a>(dataset, mesh_name, &amp;numMeshes, &amp;meshes);
<a name="l00118"></a>00118   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00119"></a>00119     exit(rc);
<a name="l00120"></a>00120   <span class="keywordflow">if</span> (numMeshes != 1){
<a name="l00121"></a>00121     rc = <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00122"></a>00122     <a class="code" href="error_8h.html#42c09317184affa18e70826cb35f3f04">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to find mesh '%s'"</span>,mesh_name);
<a name="l00123"></a>00123   }
<a name="l00124"></a>00124   mesh = meshes[0];
<a name="l00125"></a>00125   free(meshes);
<a name="l00126"></a>00126   strcpy(subset_name, <span class="stringliteral">"every 5th element"</span>);
<a name="l00127"></a>00127   rc = <a class="code" href="group__Subset.html#g01a47f999da4ef36f72702e52837ecb0">fc_getSubsetByName</a>(mesh, subset_name, &amp;numReturnSubsets, &amp;returnSubsets);
<a name="l00128"></a>00128   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00129"></a>00129     exit(rc);
<a name="l00130"></a>00130   <span class="keywordflow">if</span> (numReturnSubsets != 1)
<a name="l00131"></a>00131     exit(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>);
<a name="l00132"></a>00132   subset = returnSubsets[0];
<a name="l00133"></a>00133   free(returnSubsets);
<a name="l00134"></a>00134   strcpy(seqVariable_name, <span class="stringliteral">"temperature per vertex"</span>);
<a name="l00135"></a>00135   rc = <a class="code" href="group__Variable.html#g81f06442d2acc47bf9cf8ebbd94be75d">fc_getSeqVariableByName</a>(mesh, seqVariable_name, &amp;numReturnSeqVars,
<a name="l00136"></a>00136                       &amp;numStepPerReturnSeqVar,&amp;returnSeqVars);
<a name="l00137"></a>00137   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a> || numReturnSeqVars != 1)
<a name="l00138"></a>00138     exit(rc);
<a name="l00139"></a>00139   numStep = numStepPerReturnSeqVar[0];
<a name="l00140"></a>00140   seqVariable = returnSeqVars[0];
<a name="l00141"></a>00141   free(numStepPerReturnSeqVar);
<a name="l00142"></a>00142   free(returnSeqVars);
<a name="l00143"></a>00143   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seqVariable, &amp;sequence);
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00145"></a>00145     exit(rc);
<a name="l00146"></a>00146   <a class="code" href="group__Sequence.html#gc810d7a86c70a251ea10a90e9c59b710">fc_getSequenceName</a>(sequence, &amp;temp_name);
<a name="l00147"></a>00147   strcpy(sequence_name, temp_name);
<a name="l00148"></a>00148   free(temp_name);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <span class="comment">// --- NOTE: differences between meta data and big data</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">// For the major data objects, the data is separated into two categories:</span>
<a name="l00153"></a>00153   <span class="comment">// meta data and big data. In general the big data tends to be big arrays</span>
<a name="l00154"></a>00154   <span class="comment">// and the meta data provides the info for decoding the big data.</span>
<a name="l00155"></a>00155   <span class="comment">// Meta data for data objects can be gotten using the fc_getXInfo() routines.</span>
<a name="l00156"></a>00156   <span class="comment">// Meta data and most data returned from routines is copied from the library</span>
<a name="l00157"></a>00157   <span class="comment">// and the caller is responsible for freeing any arrays. Big data is different</span>
<a name="l00158"></a>00158   <span class="comment">// in the the library passes a pointer to its data and the caller is NOT</span>
<a name="l00159"></a>00159   <span class="comment">// supposed to free it. Any routines that return a pointer to an array that</span>
<a name="l00160"></a>00160   <span class="comment">// is NOT to be freed has 'Ptr' appended to it (e.g. fc_getMeshCoordsPtr()).</span>
<a name="l00161"></a>00161   <span class="comment">// These distinctions will pointed out again in the example below.</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163   <span class="comment">// Aside: Lazy loading of big data. If you load load from a file, all meta</span>
<a name="l00164"></a>00164   <span class="comment">// data is loaded into memory, but the big data is not loaded until it is</span>
<a name="l00165"></a>00165   <span class="comment">// actually needed. </span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167   <span class="comment">// --- Accessing Sequence big data : sequence coords</span>
<a name="l00168"></a>00168   
<a name="l00169"></a>00169   <span class="comment">// A sequence is a 1D series of values that are the coordinates of the</span>
<a name="l00170"></a>00170   <span class="comment">// sequence "space" (usually time). These can be stored as char, int,</span>
<a name="l00171"></a>00171   <span class="comment">// float or double. The following code gets the meta data and uses</span>
<a name="l00172"></a>00172   <span class="comment">// it to decode the big data. Note that seqCoords is declared as (void*)</span>
<a name="l00173"></a>00173   <span class="comment">// and the 'Ptr' in the name of the big data call: fc_getSequenceCoordsPtr().</span>
<a name="l00174"></a>00174   printf(<span class="stringliteral">"Sequence '%s':\n"</span>, sequence_name);
<a name="l00175"></a>00175   <a class="code" href="group__Sequence.html#ge7289ce45a13855f48a0b5de93c68101">fc_getSequenceInfo</a>(sequence, &amp;numStep, &amp;dataType);
<a name="l00176"></a>00176   printf(<span class="stringliteral">"    Meta data: numStep = %d, dataType = %s\n"</span>, numStep,
<a name="l00177"></a>00177          <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(dataType));
<a name="l00178"></a>00178   printf(<span class="stringliteral">"    Big data:\n"</span>);
<a name="l00179"></a>00179   <span class="comment">// Use the dataType to cast coords array to appropriate type</span>
<a name="l00180"></a>00180   <a class="code" href="group__Sequence.html#g38e90553b530ed6e4ebeb28df20eade8">fc_getSequenceCoordsPtr</a>(sequence, &amp;seqCoords);
<a name="l00181"></a>00181   printf(<span class="stringliteral">"        Coords:\n"</span>);
<a name="l00182"></a>00182   <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>) {
<a name="l00183"></a>00183     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00184"></a>00184       printf(<span class="stringliteral">"            %c\n"</span>, ((<span class="keywordtype">char</span>*)seqCoords)[i]);
<a name="l00185"></a>00185   }
<a name="l00186"></a>00186   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l00187"></a>00187     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00188"></a>00188       printf(<span class="stringliteral">"            %d\n"</span>, ((<span class="keywordtype">int</span>*)seqCoords)[i]);
<a name="l00189"></a>00189   }
<a name="l00190"></a>00190   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l00191"></a>00191     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00192"></a>00192       printf(<span class="stringliteral">"            %f\n"</span>, ((<span class="keywordtype">float</span>*)seqCoords)[i]);
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l00195"></a>00195     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00196"></a>00196       printf(<span class="stringliteral">"            %f\n"</span>, ((<span class="keywordtype">double</span>*)seqCoords)[i]);
<a name="l00197"></a>00197   }
<a name="l00198"></a>00198   <span class="keywordflow">else</span>
<a name="l00199"></a>00199     exit(-1);
<a name="l00200"></a>00200   <span class="comment">// Don't free seqCoords!! But do clear pointer if we're done with it.</span>
<a name="l00201"></a>00201   seqCoords = NULL;
<a name="l00202"></a>00202   printf(<span class="stringliteral">"\n"</span>);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204   <span class="comment">// --- Accessing Mesh big data : mesh coords &amp; connectivity</span>
<a name="l00205"></a>00205 
<a name="l00206"></a>00206   <span class="comment">// The big data for a mesh are the spatial coordinate of the vertices</span>
<a name="l00207"></a>00207   <span class="comment">// and the connectivity array which describes how the vertices make up</span>
<a name="l00208"></a>00208   <span class="comment">// the elements.</span>
<a name="l00209"></a>00209   printf(<span class="stringliteral">"Mesh '%s':\n"</span>, mesh_name);
<a name="l00210"></a>00210   <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, &amp;topodim, &amp;dim, &amp;numVertex, &amp;numElement, &amp;elemType);
<a name="l00211"></a>00211   printf(<span class="stringliteral">"    Meta data: topodim = %d, dim = %d\n"</span>, topodim, dim);
<a name="l00212"></a>00212   printf(<span class="stringliteral">"               numVertex = %d, numElement = %d, elemType = %s\n"</span>,
<a name="l00213"></a>00213          numVertex, numElement, <a class="code" href="group__DataTypes.html#gb3fcc2417d4e38eb3cbd511a42048acd">fc_getElementTypeText</a>(elemType));
<a name="l00214"></a>00214   printf(<span class="stringliteral">"    Big data:\n"</span>);
<a name="l00215"></a>00215   <span class="comment">// The vertex coordinates are always doubles and are ordered as the coords</span>
<a name="l00216"></a>00216   <span class="comment">// for the first vertex, then the coords for the next vertex, etc.</span>
<a name="l00217"></a>00217   <span class="comment">// The number values that make up each set of coordinates is 'dim', the</span>
<a name="l00218"></a>00218   <span class="comment">// dimensionality of the space the dataset occupies.</span>
<a name="l00219"></a>00219   <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l00220"></a>00220   printf(<span class="stringliteral">"        Vertex Coords (only for first 10 vertices):\n"</span>);
<a name="l00221"></a>00221   <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++) { <span class="comment">// would normally loop over numVertex</span>
<a name="l00222"></a>00222     printf(<span class="stringliteral">"            %d: "</span>, i);
<a name="l00223"></a>00223     <span class="keywordflow">for</span> (j = 0; j &lt; dim; j++)
<a name="l00224"></a>00224       printf(<span class="stringliteral">"%f "</span>, coords[i*dim + j]); 
<a name="l00225"></a>00225     printf(<span class="stringliteral">"\n"</span>);
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227   printf(<span class="stringliteral">"               ...\n"</span>);
<a name="l00228"></a>00228   <span class="comment">// The connectivities are always ints (they are the IDs of the vertices that</span>
<a name="l00229"></a>00229   <span class="comment">// make up the elements) and ordered as the vertices that make up the first</span>
<a name="l00230"></a>00230   <span class="comment">// element, then the vertices that make up the second element, etc.</span>
<a name="l00231"></a>00231   <span class="comment">// To decode, we also need to know the number of vertices in a element</span>
<a name="l00232"></a>00232   <span class="comment">// which can be queried from the element type. </span>
<a name="l00233"></a>00233   <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(mesh, &amp;conns);
<a name="l00234"></a>00234   numVertexPerElement = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(elemType);
<a name="l00235"></a>00235   printf(<span class="stringliteral">"        Elements Conns (only for first 10 elements):\n"</span>);
<a name="l00236"></a>00236   <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++) { <span class="comment">// would normally loop over numElement</span>
<a name="l00237"></a>00237     printf(<span class="stringliteral">"            %d: "</span>, i);
<a name="l00238"></a>00238     <span class="keywordflow">for</span> (j = 0; j &lt; numVertexPerElement; j++)
<a name="l00239"></a>00239       printf(<span class="stringliteral">"%d "</span>, conns[i*numVertexPerElement + j]); 
<a name="l00240"></a>00240     printf(<span class="stringliteral">"\n"</span>);
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242   printf(<span class="stringliteral">"               ...\n"</span>);
<a name="l00243"></a>00243   <span class="comment">// Don't free coords or conns! But do clear pointer if done with them.</span>
<a name="l00244"></a>00244   coords = NULL;
<a name="l00245"></a>00245   conns = NULL;
<a name="l00246"></a>00246   printf(<span class="stringliteral">"\n"</span>);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248   <span class="comment">// --- Accessing Variable big data : data values</span>
<a name="l00249"></a>00249 
<a name="l00250"></a>00250   <span class="comment">// A variable has a number of data points corresponding to the number of</span>
<a name="l00251"></a>00251   <span class="comment">// entities it is associated with (e.g. a variable associated with the</span>
<a name="l00252"></a>00252   <span class="comment">// vertices of a mesh must have numDataPoint = numVertex). The number of</span>
<a name="l00253"></a>00253   <span class="comment">// components is how many values per data point make up the variable.</span>
<a name="l00254"></a>00254   <span class="comment">// For example, a 3D vector variable has 3 components. The mathtype </span>
<a name="l00255"></a>00255   <span class="comment">// gives the user a little more information about how the components are</span>
<a name="l00256"></a>00256   <span class="comment">// ordered and what they mean. For example, a 3D vector and a 2D</span>
<a name="l00257"></a>00257   <span class="comment">// symtensor would both have numComponent = 3 (the symmetric tensor only</span>
<a name="l00258"></a>00258   <span class="comment">// needs to store the upper part of the matrix) so the math type is</span>
<a name="l00259"></a>00259   <span class="comment">// needed to properly use the data.</span>
<a name="l00260"></a>00260   <span class="comment">//</span>
<a name="l00261"></a>00261   <span class="comment">// The data is ordered as all data values for the first data point,</span>
<a name="l00262"></a>00262   <span class="comment">// then all data values for the next data point, etc.</span>
<a name="l00263"></a>00263   printf(<span class="stringliteral">"Sequence Variable '%s', Step #0:\n"</span>, seqVariable_name);
<a name="l00264"></a>00264   <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(seqVariable[0], &amp;numDataPoint, &amp;numComponent, &amp;assocType,
<a name="l00265"></a>00265                      &amp;mathType, &amp;dataType);
<a name="l00266"></a>00266   printf(<span class="stringliteral">"    Meta data: numDataPoint = %d, numComponent = %d, assoc = %s\n"</span>,
<a name="l00267"></a>00267          numDataPoint, numComponent, <a class="code" href="group__DataTypes.html#gdb7ce28f8a85a1cc1e68b55f64eb54f5">fc_getAssociationTypeText</a>(assocType));
<a name="l00268"></a>00268   printf(<span class="stringliteral">"                mathType = %s, dataType = %s\n"</span>, 
<a name="l00269"></a>00269          <a class="code" href="group__DataTypes.html#g75a3d1b2b701f9ee9cf45b5ea350ee3e">fc_getMathTypeText</a>(mathType), <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(dataType));
<a name="l00270"></a>00270   printf(<span class="stringliteral">"    Big data:\n"</span>);
<a name="l00271"></a>00271   <span class="comment">// Use the dataType to cast data array to appropriate type</span>
<a name="l00272"></a>00272   <span class="comment">// (Note, it'd be more efficient to test for data type outside of the loop,</span>
<a name="l00273"></a>00273   <span class="comment">// but it makes the sample more cluttered).</span>
<a name="l00274"></a>00274   <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(seqVariable[0], &amp;data);
<a name="l00275"></a>00275   printf(<span class="stringliteral">"        Data (only for first 10 data points):\n"</span>);
<a name="l00276"></a>00276   <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++) { <span class="comment">// would normally loop over numDataPoint</span>
<a name="l00277"></a>00277     printf(<span class="stringliteral">"            %d: "</span>, i);
<a name="l00278"></a>00278     <span class="keywordflow">for</span> (j = 0; j &lt; numComponent; j++) {
<a name="l00279"></a>00279       <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>)
<a name="l00280"></a>00280         printf(<span class="stringliteral">"%c "</span>, ((<span class="keywordtype">char</span>*)data)[i*numComponent + j]);
<a name="l00281"></a>00281       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>)
<a name="l00282"></a>00282         printf(<span class="stringliteral">"%d "</span>, ((<span class="keywordtype">int</span>*)data)[i*numComponent + j]);
<a name="l00283"></a>00283       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>)
<a name="l00284"></a>00284         printf(<span class="stringliteral">"%f "</span>, ((<span class="keywordtype">float</span>*)data)[i*numComponent + j]);
<a name="l00285"></a>00285       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>)
<a name="l00286"></a>00286         printf(<span class="stringliteral">"%f "</span>, ((<span class="keywordtype">double</span>*)data)[i*numComponent + j]);
<a name="l00287"></a>00287       <span class="keywordflow">else</span>
<a name="l00288"></a>00288         exit(-1);
<a name="l00289"></a>00289     } 
<a name="l00290"></a>00290     printf(<span class="stringliteral">"\n"</span>);
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292   printf(<span class="stringliteral">"               ...\n"</span>);
<a name="l00293"></a>00293   <span class="comment">// Don't free data!! But do clear pointer if we're done with it.</span>
<a name="l00294"></a>00294   data = NULL;
<a name="l00295"></a>00295   printf(<span class="stringliteral">"\n"</span>);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297   <span class="comment">// --- Accessing Subset "big data" : member IDs</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   <span class="comment">// Accessing the "big data" for a subset is a little different than</span>
<a name="l00300"></a>00300   <span class="comment">// for the other data types because subsets are a lot less static</span>
<a name="l00301"></a>00301   <span class="comment">// than the other data types (meshes can't change the number of</span>
<a name="l00302"></a>00302   <span class="comment">// vertices they have, but you can change how many vertices in a subset).</span>
<a name="l00303"></a>00303   <span class="comment">// The "big data" for subsets is the IDs of the members of the</span>
<a name="l00304"></a>00304   <span class="comment">// subset, but it is not treated as big data in that it is always</span>
<a name="l00305"></a>00305   <span class="comment">// returned as a copy instead of a pointer. That is, you get a snapshot</span>
<a name="l00306"></a>00306   <span class="comment">// of the state of a subset (if the subset changes, your snapshot is</span>
<a name="l00307"></a>00307   <span class="comment">// out of date) and you are responsible for freeing the arrays.</span>
<a name="l00308"></a>00308   printf(<span class="stringliteral">"Subset '%s':\n"</span>, subset_name);
<a name="l00309"></a>00309   <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, &amp;maxNumMember, &amp;assocType);
<a name="l00310"></a>00310   printf(<span class="stringliteral">"    Meta data: numMember = %d, maxNumMember = %d, assoc = %s\n"</span>,
<a name="l00311"></a>00311          numMember, maxNumMember, <a class="code" href="group__DataTypes.html#gdb7ce28f8a85a1cc1e68b55f64eb54f5">fc_getAssociationTypeText</a>(assocType)); 
<a name="l00312"></a>00312   printf(<span class="stringliteral">"    \"Big data\":\n"</span>);
<a name="l00313"></a>00313   <span class="comment">// Note: no 'Ptr' in this function name, so remember to free!</span>
<a name="l00314"></a>00314   <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l00315"></a>00315   printf(<span class="stringliteral">"        Member IDs (only the first 10):\n"</span>);
<a name="l00316"></a>00316   <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++)  <span class="comment">// would normall loop over numMember</span>
<a name="l00317"></a>00317     printf(<span class="stringliteral">"            %d: %d\n"</span>, i, memberIDs[i]);
<a name="l00318"></a>00318   printf(<span class="stringliteral">"               ...\n"</span>);
<a name="l00319"></a>00319   <span class="comment">// Special case: for subsets we do free the "big data"</span>
<a name="l00320"></a>00320   free(memberIDs);
<a name="l00321"></a>00321   printf(<span class="stringliteral">"\n"</span>);
<a name="l00322"></a>00322   
<a name="l00323"></a>00323   <span class="comment">// Depending on what you want to do with the IDs after you get them, you</span>
<a name="l00324"></a>00324   <span class="comment">// may also retrieve them as a linked list (helpful if growing a list) or</span>
<a name="l00325"></a>00325   <span class="comment">// a mask (quicker for indexing).</span>
<a name="l00326"></a>00326 
<a name="l00327"></a>00327   <span class="comment">// --- All done</span>
<a name="l00328"></a>00328 
<a name="l00329"></a>00329   <span class="comment">// Memory cleanup - Arrays of small data and data objects not managed</span>
<a name="l00330"></a>00330   <span class="comment">// by the library.</span>
<a name="l00331"></a>00331   free(seqVariable);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="comment">// When you are all done it is a good idea to finalize the library.</span>
<a name="l00334"></a>00334   <span class="comment">// This will automatically delete all datasets (and deleting a</span>
<a name="l00335"></a>00335   <span class="comment">// dataset automatically deletes all of its sequences &amp; meshes &amp; etc.)</span>
<a name="l00336"></a>00336   <a class="code" href="group__Library.html#g68cec1422dde03b636cf039faafa7baa">fc_finalLibrary</a>();
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   <span class="comment">// Bye!</span>
<a name="l00339"></a>00339   printf(<span class="stringliteral">"... finished running ex2_bigDataAccess\n"</span>);
<a name="l00340"></a>00340   exit(0);
<a name="l00341"></a>00341 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Oct 31 11:09:58 2007 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
