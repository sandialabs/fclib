<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: (Private Exodus IO)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>(Private Exodus IO)<br>
<small>
[<a class="el" href="group__FileIO.html">File IO</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for (Private Exodus IO):</div>
<div class="dynsection">
<center><table><tr><td><img src="group__ExodusFileIO.gif" border="0" alt="" usemap="#group____ExodusFileIO_map">
<map name="group____ExodusFileIO_map">
<area shape="rect" href="group__FileIO.html" title="Generic file IO." alt="" coords="7,5,71,32"></map></td></tr></table></center>
</div>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Exodus II file IO. 
<p>
<b>Description:</b> <p>
Be aware that if you open copy, and rewrite an exodus file using FCLib, THE BLOCK/NODESET/SIDESET IDS MAY CHANGE!<p>
Exodus restricts the lengths of names of objects to 32 chars.<p>
This file format stores a single global vertex array, and all vertex associated variables (nodal variables) are stored on that single vertex array instead of per mesh as they are in FCLib. When the file is written, if a nodal variable does not exist on every mesh, the global array will be padded with zeros.<p>
Only recently has Exodus II written arbitrary edge and face We still currently stick with the convention of writing "sidesets" which will be edge subsets for 2D topologies and face subsets for 3D topologies.<p>
Exodus II has global node, element, and sides sets. This reader breaks the subsets into per mesh subsets. They are not put back together again upon writing. The optional orientation array for sets not read in (and thus not written out).<p>
Exodus II does not support multicomponent variables or attributes. When reading and writing, each multicomponent variable or attribute is broken into components and renamed varname_x, varname_y, varname_z for vectors or varname_c1, varname_c2 ... for tensors.<p>
This reader does not support time-changing mesh geometry.<p>
During reading, Exodus info, records, number maps, order maps, and distribution factors are discarded.<p>
<ul>
<li>Exodus variables are seq variables with FC_DT_DOUBLE (when writing, other data types are converted to double).</li><li>Exodus properties are FC_AT_WHOLE_MESH and FC_DT_INT (when writing, other data types of FC_AT_WHOLE are discarded). NOTE: 'ID' is a name already used by Exodus.</li><li>Exodus attributes are non seq variables. We support these for FC_AT_ELEMENT and FC_AT_VERTEX as element and nodal attributes with data type FC_DT_DOUBLE (when writing, all other data types on elements are converted to double, and all other assoc types are discarded). </li></ul>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__FC__DsExodusIOInfo.html">_FC_DsExodusIOInfo</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Struct hold info about the file format for dataset.  <a href="struct__FC__DsExodusIOInfo.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__FC__MeshExodusIOInfo.html">_FC_MeshExodusIOInfo</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Struct hold info about the file format for mesh.  <a href="struct__FC__MeshExodusIOInfo.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__FC__SubExodusIOInfo.html">_FC_SubExodusIOInfo</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Struct hold info about the file format for subset.  <a href="struct__FC__SubExodusIOInfo.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__FC__VarExodusIOInfo.html">_FC_VarExodusIOInfo</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Struct hold info about the file format for variable.  <a href="struct__FC__VarExodusIOInfo.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#g8665aefc96fcacfeff464a210f1e1fb3">_fc_exo_seqVar_cmp</a> (const void *a, const void *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compare algorithm for sorting seq vars.  <a href="#g8665aefc96fcacfeff464a210f1e1fb3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gbccd96e8e4b129c566597245fc7b36f3">_fc_exo_seqVar_meshID_cmp</a> (const void *a, const void *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compare algorithm for sorting seq vars including the meshID.  <a href="#gbccd96e8e4b129c566597245fc7b36f3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#g2c3f4682201e3afdf8e2d18fe02e6675">_fc_createExoVarCompName</a> (char *name, int numComp, <a class="el" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20">FC_MathType</a> mathType, int compID, char **compName)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create the name for a component of a variable to use in Exodus file.  <a href="#g2c3f4682201e3afdf8e2d18fe02e6675"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#g36d1ca8abe36ddd5d3086ed10e7fadcb">_fc_getMeshExodusGlobalNodalIDsPtr</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int **LUTable)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return LU map for local to exodus global nodal IDs.  <a href="#g36d1ca8abe36ddd5d3086ed10e7fadcb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gc739f95de0a68f777684bcbb8e690135">_fc_getMeshExodusGlobalElementIDOffset</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int *offset)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return offset for local to exodus global element IDs.  <a href="#gc739f95de0a68f777684bcbb8e690135"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gd0225da3749999233e69dc66e5082e82">_fc_initExodus</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize for Exodus IO.  <a href="#gd0225da3749999233e69dc66e5082e82"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#ga24e128921b05fa69faecd3219c40135">_fc_loadExodusDataset</a> (char *filename, <a class="el" href="structFC__Dataset.html">FC_Dataset</a> *dataset)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Load an Exodus II dataset from a file.  <a href="#ga24e128921b05fa69faecd3219c40135"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gccb80670c54f713d0546b6fa779af150">_fc_readExodusSequenceCoords</a> (<a class="el" href="structFC__Sequence.html">FC_Sequence</a> sequence)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from Exodus file into a sequence.  <a href="#gccb80670c54f713d0546b6fa779af150"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#g552ca932d62828fdedb4561a02c94a51">_fc_readExodusMeshCoords</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from Exodus file into a mesh.  <a href="#g552ca932d62828fdedb4561a02c94a51"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gfa43b49bccf83d3454349892a2fdf800">_fc_readExodusMeshElemConns</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from Exodus file into a mesh.  <a href="#gfa43b49bccf83d3454349892a2fdf800"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#g1fb7acca15741da6a991172a374b72ab">_fc_readExodusSubsetMembers</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from Exodus file into a subset.  <a href="#g1fb7acca15741da6a991172a374b72ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#ge7a29d6ed0a3c554a884c8eddbe974c9">_fc_readExodusVariableData</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> variable)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from Exodus file into a basic or one step of a seq variable.  <a href="#ge7a29d6ed0a3c554a884c8eddbe974c9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gd7165f2bfd1391ed0214b5e76ae6156f">_fc_readExodusOneStepVariableData</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> variable)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from Exodus file into one step of a seq variable.  <a href="#gd7165f2bfd1391ed0214b5e76ae6156f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gdee0424e9d65ee7546d14aaa8f0ea376">_fc_readExodusAttributeData</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> variable)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read attribute data from Exodus file into a basic variable.  <a href="#gdee0424e9d65ee7546d14aaa8f0ea376"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gdf8bbffda1fb0c3fd88df9bd6c2a995a">_fc_writeExodusDataset</a> (<a class="el" href="structFC__Dataset.html">FC_Dataset</a> dataset, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a dataset.  <a href="#gdf8bbffda1fb0c3fd88df9bd6c2a995a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExodusFileIO.html#gf5553f021b7342fe80621c6aaef2838e">_fc_closeExodusDataset</a> (<a class="el" href="structFC__Dataset.html">FC_Dataset</a> dataset)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close a dataset.  <a href="#gf5553f021b7342fe80621c6aaef2838e"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gf5553f021b7342fe80621c6aaef2838e"></a><!-- doxytag: member="exodusio.c::_fc_closeExodusDataset" ref="gf5553f021b7342fe80621c6aaef2838e" args="(FC_Dataset dataset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_closeExodusDataset           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Dataset.html">FC_Dataset</a>&nbsp;</td>
          <td class="paramname"> <em>dataset</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close a dataset. 
<p>
<b>Description:</b> <p>
Do any necessary file related cleanup for the Dataset.<p>
<b>Modifications:</b> <ul>
<li>8/1/2005 WSD. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dataset</em>&nbsp;</td><td>
input - the dataset </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l03652">3652</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00154">fc_printfWarningMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00078">_FC_DsSlot::header</a>, and <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l02209">_fc_closeDataset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l03654"></a>03654   {
<a name="l03655"></a>03655   <span class="keywordtype">int</span> error;
<a name="l03656"></a>03656   <span class="keywordtype">int</span> i;
<a name="l03657"></a>03657   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l03658"></a>03658 
<a name="l03659"></a>03659   <span class="comment">// check input</span>
<a name="l03660"></a>03660   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(dataset);
<a name="l03661"></a>03661   <span class="keywordflow">if</span> (dsSlot == NULL) {
<a name="l03662"></a>03662     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l03663"></a>03663     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l03664"></a>03664   }
<a name="l03665"></a>03665 
<a name="l03666"></a>03666   <span class="comment">// free dynamically allocate memory in db</span>
<a name="l03667"></a>03667   <span class="keywordflow">for</span> (i = 0; i &lt; dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numMesh; i++)
<a name="l03668"></a>03668     free(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[i]);
<a name="l03669"></a>03669   free(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs);
<a name="l03670"></a>03670 
<a name="l03671"></a>03671   <span class="comment">// close any files associated with this dataset</span>
<a name="l03672"></a>03672   error = ex_close(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid);
<a name="l03673"></a>03673   <span class="keywordflow">if</span> (error != 0) 
<a name="l03674"></a>03674     <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Exodus database for dataset '%s' did not close "</span>
<a name="l03675"></a>03675                             <span class="stringliteral">"properly"</span>, dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#4339e69fe30b05ede4dc06248a0e883b">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l03676"></a>03676 
<a name="l03677"></a>03677   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03678"></a>03678 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2c3f4682201e3afdf8e2d18fe02e6675"></a><!-- doxytag: member="exodusio.c::_fc_createExoVarCompName" ref="g2c3f4682201e3afdf8e2d18fe02e6675" args="(char *name, int numComp, FC_MathType mathType, int compID, char **compName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_createExoVarCompName           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20">FC_MathType</a>&nbsp;</td>
          <td class="paramname"> <em>mathType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>compID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>compName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create the name for a component of a variable to use in Exodus file. 
<p>
<b>Description:</b> <p>
Given a name, the number of components, the math type and the component index, return a new string that is a name for that component.<p>
<ul>
<li>If it's a scalar: comp_name = name</li><li>If it's a vector: comp_name = name_x or name_y or name_z</li><li>If it's any other multi-component = name_c0 or name_c1 or ...</li></ul>
<p>
This functions returns malloc memory that must be freed by the caller.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Promote this to the fileio module so that all IO writers can use the same naming conventions.</dd></dl>
<b>Modifications:</b> <ul>
<li>2006-11-27 WSK. Created because common code was cropping up in multiple places.</li><li>10-11-1007 ACG restrict to MAX_STRLEN length </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>name</em>&nbsp;</td><td>
input - the name of the variable </td></tr>
<tr><td valign="top"><em>numComp</em>&nbsp;</td><td>
input - the number of components of the variable </td></tr>
<tr><td valign="top"><em>mathType</em>&nbsp;</td><td>
input - the math type of the variable </td></tr>
<tr><td valign="top"><em>compID</em>&nbsp;</td><td>
input - the index of this particular component </td></tr>
<tr><td valign="top"><em>compName</em>&nbsp;</td><td>
output - the created component name (must be freed by the caller). </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00270">270</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00263">fc_isMathTypeValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8h-source.html#l00169">FC_MT_UNKNOWN</a>, <a class="el" href="base_8h-source.html#l00171">FC_MT_VECTOR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="exodusio_8c-source.html#l01933">_fc_writeExodusDataset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00278"></a>00278 {
<a name="l00279"></a>00279   <span class="keywordtype">char</span> *tempName;
<a name="l00280"></a>00280   <span class="keywordtype">char</span> vector_endings[3][2] = { <span class="stringliteral">"x"</span>, <span class="stringliteral">"y"</span>, <span class="stringliteral">"z"</span> }; 
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   <span class="comment">// default return</span>
<a name="l00283"></a>00283   <span class="keywordflow">if</span> (compName)
<a name="l00284"></a>00284     *compName = NULL;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286   <span class="comment">// check input</span>
<a name="l00287"></a>00287   <span class="keywordflow">if</span> (!name || numComp &lt; 1 || compID &lt; 0 || compID &gt;= numComp || 
<a name="l00288"></a>00288       !<a class="code" href="group__DataTypes.html#g8111b811b3159b9f82a271fa9c923e9e" title="Verify that the given value is valid for this enum.">fc_isMathTypeValid</a>(mathType) || mathType == <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb2064ff077a965e5351bcfafd26ac08236f">FC_MT_UNKNOWN</a>  || !compName) {
<a name="l00289"></a>00289     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00290"></a>00290     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293   <span class="comment">// make space</span>
<a name="l00294"></a>00294   
<a name="l00295"></a>00295   tempName = (<span class="keywordtype">char</span>*)malloc(MAX_STR_LENGTH*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00296"></a>00296   <span class="keywordflow">if</span> (!tempName) {
<a name="l00297"></a>00297     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00298"></a>00298     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00299"></a>00299   }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301   <span class="comment">// do it</span>
<a name="l00302"></a>00302   <span class="keywordflow">if</span> (numComp == 1){
<a name="l00303"></a>00303     strncpy(tempName, name, MAX_STR_LENGTH-1);
<a name="l00304"></a>00304     tempName[MAX_STR_LENGTH-1] = <span class="charliteral">'\0'</span>;
<a name="l00305"></a>00305   }
<a name="l00306"></a>00306   <span class="keywordflow">else</span> {
<a name="l00307"></a>00307     <span class="keywordtype">char</span> clippedname[MAX_STR_LENGTH-4];
<a name="l00308"></a>00308     snprintf(clippedname, MAX_STR_LENGTH-4,name);
<a name="l00309"></a>00309     <span class="keywordflow">if</span> (numComp &lt; 4 &amp;&amp; mathType == <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb207f48fe9fd9efb7bc772bbb41106e217f">FC_MT_VECTOR</a>){
<a name="l00310"></a>00310       sprintf(tempName, <span class="stringliteral">"%s_%s"</span>, clippedname, vector_endings[compID]);
<a name="l00311"></a>00311     }  <span class="keywordflow">else</span> {
<a name="l00312"></a>00312       sprintf(tempName, <span class="stringliteral">"%s_c%d"</span>, clippedname, compID);
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314   }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316   *compName = tempName;
<a name="l00317"></a>00317   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00318"></a>00318 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8665aefc96fcacfeff464a210f1e1fb3"></a><!-- doxytag: member="exodusio.c::_fc_exo_seqVar_cmp" ref="g8665aefc96fcacfeff464a210f1e1fb3" args="(const void *a, const void *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _fc_exo_seqVar_cmp           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compare algorithm for sorting seq vars. 
<p>
<b>Description:</b> <p>
Compare two sequence variables (using only the first step).<p>
Most important thing is that we sort first by association type. Will also sort by name, numComp, and mathType, and dataType (numDataPoint can be ignored).<p>
Only used in this file -- helper for writing files. Sort by assoc first since different types treated much differently by exodus.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd><ul>
<li>ACG is using this for non-seq vars as well. I may rename this. It is used in writing out non-seq-vars as attributes.</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>9/14/2005 WSD Created.</li><li>8/11/2006 WSD. Changed to use seqVars directly instead of via a linked list node object. </li></ul>

<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00147">147</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="variableP_8h-source.html#l00091">_FC_VarSlot::assoc</a>, <a class="el" href="variableP_8h-source.html#l00095">_FC_VarSlot::datatype</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="variableP_8h-source.html#l00093">_FC_VarSlot::mathtype</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="variableP_8h-source.html#l00088">_FC_VarSlot::numComponent</a>.</p>

<p>Referenced by <a class="el" href="exodusio_8c-source.html#l00220">_fc_exo_seqVar_meshID_cmp()</a>, and <a class="el" href="exodusio_8c-source.html#l01933">_fc_writeExodusDataset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00147"></a>00147                                                      {
<a name="l00148"></a>00148   <span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* seqVar_a = (<span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)a;
<a name="l00149"></a>00149   <span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* seqVar_b = (<span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)b;
<a name="l00150"></a>00150   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a> *varSlot_a = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqVar_a[0]);
<a name="l00151"></a>00151   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a> *varSlot_b = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqVar_b[0]);
<a name="l00152"></a>00152   
<a name="l00153"></a>00153   <span class="comment">// Compare by association type</span>
<a name="l00154"></a>00154   <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a> &gt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a>)
<a name="l00155"></a>00155     <span class="keywordflow">return</span> 1;
<a name="l00156"></a>00156   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a> &lt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a>)
<a name="l00157"></a>00157     <span class="keywordflow">return</span> -1;
<a name="l00158"></a>00158   <span class="keywordflow">else</span> {
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <span class="comment">// Compare by names</span>
<a name="l00161"></a>00161     <span class="comment">// (Note: strcmp is not restricted to returning 1 and -1)</span>
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (strcmp(varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) &gt; 0)
<a name="l00163"></a>00163       <span class="keywordflow">return</span> 1;
<a name="l00164"></a>00164     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) &lt; 0)
<a name="l00165"></a>00165       <span class="keywordflow">return</span> -1;
<a name="l00166"></a>00166     <span class="keywordflow">else</span> {
<a name="l00167"></a>00167 
<a name="l00168"></a>00168       <span class="comment">// Compare by numComp</span>
<a name="l00169"></a>00169       <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> &gt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a>)
<a name="l00170"></a>00170         <span class="keywordflow">return</span> 1;
<a name="l00171"></a>00171       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> &lt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a>)
<a name="l00172"></a>00172         <span class="keywordflow">return</span> -1;
<a name="l00173"></a>00173       <span class="keywordflow">else</span> {
<a name="l00174"></a>00174 
<a name="l00175"></a>00175         <span class="comment">// Compare by mathType</span>
<a name="l00176"></a>00176         <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a> &gt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a>)
<a name="l00177"></a>00177           <span class="keywordflow">return</span> 1;
<a name="l00178"></a>00178         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a> &lt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a>)
<a name="l00179"></a>00179           <span class="keywordflow">return</span> -1;
<a name="l00180"></a>00180         <span class="keywordflow">else</span> {
<a name="l00181"></a>00181           
<a name="l00182"></a>00182           <span class="comment">// Compare by dataType</span>
<a name="l00183"></a>00183           <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a> &gt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a>)
<a name="l00184"></a>00184             <span class="keywordflow">return</span> 1;
<a name="l00185"></a>00185           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a> &lt; varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a>)
<a name="l00186"></a>00186             <span class="keywordflow">return</span> -1;
<a name="l00187"></a>00187           <span class="keywordflow">else</span> 
<a name="l00188"></a>00188             <span class="keywordflow">return</span> 0;
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190       }
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192   }
<a name="l00193"></a>00193 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gbccd96e8e4b129c566597245fc7b36f3"></a><!-- doxytag: member="exodusio.c::_fc_exo_seqVar_meshID_cmp" ref="gbccd96e8e4b129c566597245fc7b36f3" args="(const void *a, const void *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _fc_exo_seqVar_meshID_cmp           </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compare algorithm for sorting seq vars including the meshID. 
<p>
<b>Description:</b> <p>
Compare two sequence variables (using only the first step).<p>
Most important thing is that we sort first by association type and last by which mesh (i.e. exodus meshID). Will also sort by name, numComp, and mathType, and dataType (numDataPoint can be ignored).<p>
Only used in this file -- helper for writing files. Sort by assoc first since different types treated much differently by exodus. Sort by meshID last because that is easiest way to see the groupings over all meshes. The order of other things that denote different variables doesn't matter.<p>
<b>Modifications:</b> <ul>
<li>9/2/2005 WSD Created.</li><li>9/14/2005 WSD. Core code moved to simpler compare. This is a more complex wrapper.</li><li>8/11/2006 WSD. Changed to use seqVars directly instead of via a linked list node object. </li></ul>

<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00220">220</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="exodusio_8c-source.html#l00147">_fc_exo_seqVar_cmp()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, and <a class="el" href="variableP_8h-source.html#l00077">_FC_VarSlot::mesh</a>.</p>

<p>Referenced by <a class="el" href="exodusio_8c-source.html#l01933">_fc_writeExodusDataset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00220"></a>00220                                                             {
<a name="l00221"></a>00221   <span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* seqVar_a = (<span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)a;
<a name="l00222"></a>00222   <span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* seqVar_b = (<span class="keyword">const</span> <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)b;
<a name="l00223"></a>00223   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a> *varSlot_a = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqVar_a[0]);
<a name="l00224"></a>00224   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a> *varSlot_b = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqVar_b[0]);
<a name="l00225"></a>00225   <span class="keywordtype">int</span> cmp;
<a name="l00226"></a>00226   
<a name="l00227"></a>00227   <span class="comment">// Compare everything else first</span>
<a name="l00228"></a>00228   cmp = <a class="code" href="group__ExodusFileIO.html#g8665aefc96fcacfeff464a210f1e1fb3" title="Compare algorithm for sorting seq vars.">_fc_exo_seqVar_cmp</a>(a, b);
<a name="l00229"></a>00229   <span class="keywordflow">if</span> (cmp != 0)
<a name="l00230"></a>00230     <span class="keywordflow">return</span> cmp;
<a name="l00231"></a>00231   <span class="keywordflow">else</span> {
<a name="l00232"></a>00232     <span class="comment">// Compare by meshID</span>
<a name="l00233"></a>00233     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a> *meshSlot_a = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(varSlot_a-&gt;<a class="code" href="struct__FC__VarSlot.html#7afb59f267464c49b3546acca51e985c">mesh</a>);
<a name="l00234"></a>00234     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a> *meshSlot_b = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(varSlot_b-&gt;<a class="code" href="struct__FC__VarSlot.html#7afb59f267464c49b3546acca51e985c">mesh</a>);
<a name="l00235"></a>00235     <span class="keywordflow">if</span> (meshSlot_a-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID &gt;
<a name="l00236"></a>00236         meshSlot_b-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID) 
<a name="l00237"></a>00237       <span class="keywordflow">return</span> 1;
<a name="l00238"></a>00238     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (meshSlot_a-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID &lt; 
<a name="l00239"></a>00239              meshSlot_b-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID)
<a name="l00240"></a>00240       <span class="keywordflow">return</span> -1;
<a name="l00241"></a>00241     <span class="keywordflow">else</span>
<a name="l00242"></a>00242       <span class="keywordflow">return</span> 0;
<a name="l00243"></a>00243   }
<a name="l00244"></a>00244 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gc739f95de0a68f777684bcbb8e690135"></a><!-- doxytag: member="exodusio.c::_fc_getMeshExodusGlobalElementIDOffset" ref="gc739f95de0a68f777684bcbb8e690135" args="(FC_Mesh mesh, int *offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getMeshExodusGlobalElementIDOffset           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>offset</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return offset for local to exodus global element IDs. 
<p>
<b>Description:</b> <p>
To use, add the offset to the element ID. This value is the index you would use to access a global array of element values. Add 1 to get the actual Exodus ID.<p>
Only works if the owning dataset is tied to an Exodus file.<p>
<b>Modifications:</b> <ul>
<li>2006-01-23 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh </td></tr>
<tr><td valign="top"><em>offset</em>&nbsp;</td><td>
output - offset </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00383">383</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="meshP_8h-source.html#l00096">_FC_MeshSlot::ds</a>, <a class="el" href="fileio_8h-source.html#l00081">FC_FT_EXODUS</a>, <a class="el" href="fileio_8c-source.html#l01418">fc_getFileIOTypeText()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, and <a class="el" href="datasetP_8h-source.html#l00080">_FC_DsSlot::fileType</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00386"></a>00386   {
<a name="l00387"></a>00387   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l00388"></a>00388   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l00389"></a>00389   
<a name="l00390"></a>00390   <span class="comment">// default return</span>
<a name="l00391"></a>00391   <span class="keywordflow">if</span> (offset)
<a name="l00392"></a>00392     *offset = -1;
<a name="l00393"></a>00393 
<a name="l00394"></a>00394   <span class="comment">// check input</span>
<a name="l00395"></a>00395   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || !offset) {
<a name="l00396"></a>00396     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00397"></a>00397     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00398"></a>00398   }
<a name="l00399"></a>00399   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(mesh);
<a name="l00400"></a>00400   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8e636c6228614117c3f0632c33b01554">ds</a>);
<a name="l00401"></a>00401   <span class="keywordflow">if</span> (dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#5da6a240b511f5d9e266c2c16b4d998c">fileType</a> != <a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>) {
<a name="l00402"></a>00402     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Dataset is not of type %s"</span>,
<a name="l00403"></a>00403                  <a class="code" href="group__FileIO.html#gc3f11d75ee01e21d5be5b03885891978" title="Return name of the FC_FileIOType&amp;#39;s value.">fc_getFileIOTypeText</a>(<a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>));
<a name="l00404"></a>00404     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00405"></a>00405   }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <span class="comment">// do it</span>
<a name="l00408"></a>00408   *offset = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00411"></a>00411 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g36d1ca8abe36ddd5d3086ed10e7fadcb"></a><!-- doxytag: member="exodusio.c::_fc_getMeshExodusGlobalNodalIDsPtr" ref="g36d1ca8abe36ddd5d3086ed10e7fadcb" args="(FC_Mesh mesh, int **LUTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getMeshExodusGlobalNodalIDsPtr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>LUTable</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return LU map for local to exodus global nodal IDs. 
<p>
<b>Description:</b> <p>
To use, index into the lookup table with the vertex ID. The returned value is the index you work use to access a global array of nodal values. Add 1 to get the actual Exodus ID.<p>
Do NOT free the returned array.<p>
Only works if the owning dataset is tied to an Exodus file.<p>
<b>Modifications:</b> <ul>
<li>2006-01-23 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh </td></tr>
<tr><td valign="top"><em>LUTable</em>&nbsp;</td><td>
output - ptr to local to global ID map, Do NOT free! </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00337">337</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="meshP_8h-source.html#l00096">_FC_MeshSlot::ds</a>, <a class="el" href="fileio_8h-source.html#l00081">FC_FT_EXODUS</a>, <a class="el" href="fileio_8c-source.html#l01418">fc_getFileIOTypeText()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, and <a class="el" href="datasetP_8h-source.html#l00080">_FC_DsSlot::fileType</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00341"></a>00341   {
<a name="l00342"></a>00342   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l00343"></a>00343   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l00344"></a>00344   
<a name="l00345"></a>00345   <span class="comment">// default return</span>
<a name="l00346"></a>00346   <span class="keywordflow">if</span> (LUTable)
<a name="l00347"></a>00347     *LUTable = NULL;
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   <span class="comment">// check input</span>
<a name="l00350"></a>00350   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || !LUTable) {
<a name="l00351"></a>00351     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00352"></a>00352     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(mesh);
<a name="l00355"></a>00355   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8e636c6228614117c3f0632c33b01554">ds</a>);
<a name="l00356"></a>00356   <span class="keywordflow">if</span> (dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#5da6a240b511f5d9e266c2c16b4d998c">fileType</a> != <a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>) {
<a name="l00357"></a>00357     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Dataset is not of type %s"</span>,
<a name="l00358"></a>00358                  <a class="code" href="group__FileIO.html#gc3f11d75ee01e21d5be5b03885891978" title="Return name of the FC_FileIOType&amp;#39;s value.">fc_getFileIOTypeText</a>(<a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>));
<a name="l00359"></a>00359     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00360"></a>00360   }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362   <span class="comment">// do it</span>
<a name="l00363"></a>00363   *LUTable = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID];
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00366"></a>00366 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd0225da3749999233e69dc66e5082e82"></a><!-- doxytag: member="exodusio.c::_fc_initExodus" ref="gd0225da3749999233e69dc66e5082e82" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_initExodus           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize for Exodus IO. 
<p>
<b>Description:</b> <p>
Uses the setting of the library verbosity at the time of call.<p>
<b>Modifications:</b> <ul>
<li>8/2/2005 WSD Created </li></ul>

<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00424">424</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00085">FC_DEBUG_MESSAGES</a>, <a class="el" href="base_8h-source.html#l00082">FC_ERROR_MESSAGES</a>, <a class="el" href="library_8c-source.html#l00178">fc_getLibraryVerbosity()</a>, <a class="el" href="base_8h-source.html#l00084">FC_LOG_MESSAGES</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00081">FC_QUIET</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="base_8h-source.html#l00083">FC_WARNING_MESSAGES</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l01898">_fc_initFileIO()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00425"></a>00425 {
<a name="l00426"></a>00426   <span class="comment">// log message</span>
<a name="l00427"></a>00427   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Initializing Exodus II"</span>);
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <span class="comment">// Set exodus messages</span>
<a name="l00430"></a>00430   <span class="keywordflow">switch</span> (<a class="code" href="group__Library.html#gd5ab439275b301213065adfc55e04798" title="Get the current verbosity level of the library.">fc_getLibraryVerbosity</a>()) {
<a name="l00431"></a>00431   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a> :             ex_opts(0); <span class="keywordflow">break</span>;
<a name="l00432"></a>00432   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323974dc37f57b2f17ad516b4238b909fea">FC_ERROR_MESSAGES</a> :    <span class="comment">// fall through</span>
<a name="l00433"></a>00433   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323d5f8d0b704dba62980776bac1283a741">FC_WARNING_MESSAGES</a> :  ex_opts(EX_VERBOSE); <span class="keywordflow">break</span>;
<a name="l00434"></a>00434   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb932395535fc1e83f1faa426c80811de6c55e">FC_LOG_MESSAGES</a> :      <span class="comment">// fall through</span>
<a name="l00435"></a>00435   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323c6fc9f94d4fb3c3397d5f82645259c0a">FC_DEBUG_MESSAGES</a> :    ex_opts(EX_VERBOSE | EX_DEBUG); <span class="keywordflow">break</span>;
<a name="l00436"></a>00436   }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438   <span class="comment">// can't check for errors</span>
<a name="l00439"></a>00439   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00440"></a>00440 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ga24e128921b05fa69faecd3219c40135"></a><!-- doxytag: member="exodusio.c::_fc_loadExodusDataset" ref="ga24e128921b05fa69faecd3219c40135" args="(char *filename, FC_Dataset *dataset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_loadExodusDataset           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Dataset.html">FC_Dataset</a> *&nbsp;</td>
          <td class="paramname"> <em>dataset</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load an Exodus II dataset from a file. 
<p>
<b>Description:</b> <p>
Given a name of an Exodus II file, this routine loads the dataset and makes all of its members available for use. Members are loaded lazily: that is all of their metadata is loaded immediately, but the big data arrays are not loaded until needed (this happens automatically).<p>
Currently we support reading in empty node, elem, and side sets. these will be placed on all meshes.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd><ul>
<li>make elem sets lazy load</li><li>should we automatically take out the exodus ID named items (props)?</li><li>should FC_ELEMENTMAP and FC_VERTEXMAP be changed to ints?</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>8/1/05 WSD Created.</li><li>9/4/07 ACG. Commencing reading elem and nodal attr</li><li>10/3/07 ACG Nodal attr</li><li>10/X/07 ACG Elem sets</li><li>10/17/07 ACG removed names support</li><li>02/02/08 ACG empty node and elem set support.</li><li>05/12/08 ACG empty side set support </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>filename</em>&nbsp;</td><td>
input - name of Exodus dataset to open. </td></tr>
<tr><td valign="top"><em>dataset</em>&nbsp;</td><td>
output - handle for this dataset. </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l00472">472</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="sequence_8c-source.html#l02142">_fc_getSeqSlot()</a>, <a class="el" href="subset_8c-source.html#l03800">_fc_getSubSlot()</a>, <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="library_8c-source.html#l00326">_fc_isLibraryInit()</a>, <a class="el" href="variableP_8h-source.html#l00091">_FC_VarSlot::assoc</a>, <a class="el" href="datasetP_8h-source.html#l00081">_FC_DsSlot::baseFile</a>, <a class="el" href="tableP_8h-source.html#l00104">_FC_SlotHeader::committed</a>, <a class="el" href="sequenceP_8h-source.html#l00082">_FC_SeqSlot::datatype</a>, <a class="el" href="variableP_8h-source.html#l00095">_FC_VarSlot::datatype</a>, <a class="el" href="meshP_8h-source.html#l00100">_FC_MeshSlot::dim</a>, <a class="el" href="meshP_8h-source.html#l00105">_FC_MeshSlot::elemType</a>, <a class="el" href="subset_8c-source.html#l02008">fc_addMemberToSubset()</a>, <a class="el" href="base_8h-source.html#l00192">FC_AT_EDGE</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00198">FC_AT_WHOLE_DATASET</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="dataset_8c-source.html#l00116">fc_createDataset()</a>, <a class="el" href="variable_8c-source.html#l00187">fc_createGlobalSeqVariable()</a>, <a class="el" href="mesh_8c-source.html#l00119">fc_createMesh()</a>, <a class="el" href="sequence_8c-source.html#l00113">fc_createSequence()</a>, <a class="el" href="variable_8c-source.html#l00350">fc_createSeqVariable()</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="variable_8c-source.html#l00286">fc_createVariable()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00127">FC_ET_HEX</a>, <a class="el" href="base_8h-source.html#l00121">FC_ET_LINE</a>, <a class="el" href="base_8h-source.html#l00120">FC_ET_POINT</a>, <a class="el" href="base_8h-source.html#l00126">FC_ET_PRISM</a>, <a class="el" href="base_8h-source.html#l00125">FC_ET_PYRAMID</a>, <a class="el" href="base_8h-source.html#l00123">FC_ET_QUAD</a>, <a class="el" href="base_8h-source.html#l00124">FC_ET_TET</a>, <a class="el" href="base_8h-source.html#l00122">FC_ET_TRI</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="fileio_8h-source.html#l00081">FC_FT_EXODUS</a>, <a class="el" href="base_8c-source.html#l00514">fc_getElementTypeTopoDim()</a>, <a class="el" href="mesh_8c-source.html#l03061">fc_getMeshElementType()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="base_8h-source.html#l00170">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00764">FC_NULL_DATASET</a>, <a class="el" href="base_8c-source.html#l00784">FC_NULL_SUBSET</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00469">fc_setVariableData()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="variableP_8h-source.html#l00082">_FC_VarSlot::fileInfo</a>, <a class="el" href="subsetP_8h-source.html#l00079">_FC_SubSlot::fileInfo</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00080">_FC_DsSlot::fileType</a>, <a class="el" href="sequenceP_8h-source.html#l00075">_FC_SeqSlot::header</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="subsetP_8h-source.html#l00074">_FC_SubSlot::header</a>, <a class="el" href="meshP_8h-source.html#l00095">_FC_MeshSlot::header</a>, <a class="el" href="datasetP_8h-source.html#l00078">_FC_DsSlot::header</a>, <a class="el" href="fileioP_8h-source.html#l00185">_FC_MeshFileIOInfo::id</a>, <a class="el" href="variableP_8h-source.html#l00093">_FC_VarSlot::mathtype</a>, <a class="el" href="variableP_8h-source.html#l00088">_FC_VarSlot::numComponent</a>, <a class="el" href="variableP_8h-source.html#l00084">_FC_VarSlot::numDataPoint</a>, <a class="el" href="meshP_8h-source.html#l00104">_FC_MeshSlot::numElement</a>, <a class="el" href="subsetP_8h-source.html#l00082">_FC_SubSlot::numMember</a>, <a class="el" href="sequenceP_8h-source.html#l00080">_FC_SeqSlot::numStep</a>, <a class="el" href="meshP_8h-source.html#l00103">_FC_MeshSlot::numVertex</a>, <a class="el" href="variableP_8h-source.html#l00080">_FC_VarSlot::stepID</a>, <a class="el" href="meshP_8h-source.html#l00101">_FC_MeshSlot::topodim</a>, and <a class="el" href="datasetP_8h-source.html#l00084">_FC_DsSlot::writable</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l01607">fc_loadDatasetWithFormat()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00475"></a>00475   {
<a name="l00476"></a>00476   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00477"></a>00477   <span class="keywordtype">int</span> i, j, k, m;
<a name="l00478"></a>00478   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l00479"></a>00479   <a class="code" href="struct__FC__SeqSlot.html" title="Sequence Slot Structure for the Sequence Table.">_FC_SeqSlot</a>* seqSlot;
<a name="l00480"></a>00480   <span class="keywordtype">int</span> error, exoid, cpu_word_size, io_word_size, *blk_ids;
<a name="l00481"></a>00481   <span class="keywordtype">float</span> version;
<a name="l00482"></a>00482   <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a> sequence;
<a name="l00483"></a>00483   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> *meshes;
<a name="l00484"></a>00484   <span class="keywordtype">int</span> numMesh, numTotalVert, numTotalElem, numDim, numNodeSet, numSideSet, numElemSet;
<a name="l00485"></a>00485   <span class="keywordtype">int</span> numStep, *numVerts, *numElems, numProp;
<a name="l00486"></a>00486   <span class="keywordtype">int</span> *numElemAttr;
<a name="l00487"></a>00487   <span class="keywordtype">int</span> numNodalAttr;
<a name="l00488"></a>00488   <span class="keywordtype">int</span> **hasVerts;
<a name="l00489"></a>00489   <span class="comment">//some question if this should be MAX_STR_LENGTH or MAX_LINE_LENGTH</span>
<a name="l00490"></a>00490   <span class="keywordtype">char</span> title[MAX_LINE_LENGTH+1], namebuf[MAX_STR_LENGTH+1];
<a name="l00491"></a>00491   <span class="keywordtype">char</span> *temp_name;
<a name="l00492"></a>00492   <span class="keywordtype">float</span> fdum;
<a name="l00493"></a>00493   <span class="keywordtype">char</span>* cdum;
<a name="l00494"></a>00494   <span class="keywordtype">int</span> numVarType = 3;
<a name="l00495"></a>00495   <span class="keywordtype">char</span>* exoVarTypes[3] = { <span class="stringliteral">"g"</span>, <span class="stringliteral">"n"</span>, <span class="stringliteral">"e"</span> };
<a name="l00496"></a>00496   ex_init_params exoParams;
<a name="l00497"></a>00497   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> fcVarTypes[3] = { <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6ac55a57488add4ea9f01eac5c9eab232">FC_AT_WHOLE_DATASET</a>, 
<a name="l00498"></a>00498                                        <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, 
<a name="l00499"></a>00499                                        <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a> };
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="comment">// default return value</span>
<a name="l00502"></a>00502   <span class="keywordflow">if</span> (dataset != NULL)
<a name="l00503"></a>00503     *dataset = <a class="code" href="group__Handles.html#g0d93385a2d1df06b1bcc4b9764aa0941" title="Null (default) dataset handle.">FC_NULL_DATASET</a>;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505   <span class="comment">// check input</span>
<a name="l00506"></a>00506   <span class="keywordflow">if</span> (!filename || !dataset) {
<a name="l00507"></a>00507     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00508"></a>00508     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00509"></a>00509   }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <span class="comment">// FIX? move this from all io helpers into fileio?</span>
<a name="l00512"></a>00512   <span class="comment">// make sure library is ready, return error if it's not</span>
<a name="l00513"></a>00513   <span class="keywordflow">if</span> (!<a class="code" href="group__PrivateLibrary.html#gf9f265c931b08a543728abc285ac61ac" title="Check initialization state of library.">_fc_isLibraryInit</a>()) {
<a name="l00514"></a>00514     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cannot load a dataset until library is initialized."</span>);
<a name="l00515"></a>00515     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00516"></a>00516   }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <span class="comment">// log message</span>
<a name="l00519"></a>00519   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Loading Exodus dataset '%s'"</span>, filename);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521   <span class="comment">// Open the file</span>
<a name="l00522"></a>00522   cpu_word_size = 8;
<a name="l00523"></a>00523   io_word_size = 0;
<a name="l00524"></a>00524   exoid = ex_open(filename, EX_READ, &amp;cpu_word_size, &amp;io_word_size, &amp;version);
<a name="l00525"></a>00525   <span class="keywordflow">if</span> (exoid &lt; 0) {
<a name="l00526"></a>00526     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to open database '%s'"</span>, filename);
<a name="l00527"></a>00527     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00528"></a>00528   }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530   <span class="comment">// Get file parameters</span>
<a name="l00531"></a>00531   error = ex_get_init_ext(exoid, &amp;exoParams);
<a name="l00532"></a>00532   <span class="keywordflow">if</span> (error != 0) {
<a name="l00533"></a>00533     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to read file parameters"</span>);
<a name="l00534"></a>00534     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00535"></a>00535   }
<a name="l00536"></a>00536   strncpy(title, exoParams.title, MAX_STR_LENGTH+1);
<a name="l00537"></a>00537   title[MAX_STR_LENGTH] = <span class="charliteral">'\0'</span>;
<a name="l00538"></a>00538   numDim = exoParams.num_dim;
<a name="l00539"></a>00539   numTotalVert = exoParams.num_nodes;
<a name="l00540"></a>00540   numTotalElem = exoParams.num_elem;
<a name="l00541"></a>00541   numMesh = exoParams.num_elem_blk;
<a name="l00542"></a>00542   numNodeSet = exoParams.num_node_sets;
<a name="l00543"></a>00543   numSideSet = exoParams.num_side_sets;
<a name="l00544"></a>00544   numElemSet = exoParams.num_elem_sets;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546   <span class="comment">// create a dataset</span>
<a name="l00547"></a>00547   rc = <a class="code" href="group__Dataset.html#g14025fd46757f6fd2943b3bcdcab39d0" title="Create a new dataset.">fc_createDataset</a>(title, dataset);
<a name="l00548"></a>00548   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l00549"></a>00549     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create dataset"</span>);
<a name="l00550"></a>00550     <span class="keywordflow">return</span> rc;
<a name="l00551"></a>00551   }
<a name="l00552"></a>00552   <span class="comment">// twiddle writable flag so we don't acciently clobber</span>
<a name="l00553"></a>00553   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(*dataset);
<a name="l00554"></a>00554   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#4339e69fe30b05ede4dc06248a0e883b">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l00555"></a>00555   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#45bf720ce29415d5e8ef0c826647c811">writable</a> = 0;
<a name="l00556"></a>00556   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#5da6a240b511f5d9e266c2c16b4d998c">fileType</a> = <a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>;
<a name="l00557"></a>00557   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#8f0f6f1fa422a12522151135709df56a">baseFile</a> = (<span class="keywordtype">char</span>*)malloc((strlen(filename)+1)*<span class="keyword">sizeof</span>(char));
<a name="l00558"></a>00558   <span class="keywordflow">if</span> (!dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#8f0f6f1fa422a12522151135709df56a">baseFile</a>) {
<a name="l00559"></a>00559     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00560"></a>00560     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00561"></a>00561   }
<a name="l00562"></a>00562   strcpy(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#8f0f6f1fa422a12522151135709df56a">baseFile</a>, filename);
<a name="l00563"></a>00563   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid = exoid;
<a name="l00564"></a>00564   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.cpu_word_size = cpu_word_size;
<a name="l00565"></a>00565   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.io_word_size = io_word_size;
<a name="l00566"></a>00566   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numTotalVert = numTotalVert;
<a name="l00567"></a>00567   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numMesh = numMesh;
<a name="l00568"></a>00568   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs = (<span class="keywordtype">int</span>**)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l00569"></a>00569   <span class="keywordflow">if</span> (!dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs) {
<a name="l00570"></a>00570     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00571"></a>00571     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00572"></a>00572   }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574   <span class="comment">// Create meshes</span>
<a name="l00575"></a>00575   meshes = (<a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>*)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>));
<a name="l00576"></a>00576   numVerts = (<span class="keywordtype">int</span>*)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00577"></a>00577   numElems = (<span class="keywordtype">int</span>*)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00578"></a>00578   numElemAttr = (<span class="keywordtype">int</span>*)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00579"></a>00579   blk_ids = (<span class="keywordtype">int</span>*)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00580"></a>00580   hasVerts = (<span class="keywordtype">int</span>**)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>**));
<a name="l00581"></a>00581   <span class="keywordflow">if</span> (!meshes || !numVerts || !numElems || !numElemAttr ||
<a name="l00582"></a>00582       !blk_ids || !hasVerts) {
<a name="l00583"></a>00583     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00584"></a>00584     free(meshes);
<a name="l00585"></a>00585     free(blk_ids);
<a name="l00586"></a>00586    <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00587"></a>00587   }
<a name="l00588"></a>00588   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00589"></a>00589     hasVerts[i] = (<span class="keywordtype">int</span>*)malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l00590"></a>00590     <span class="keywordflow">if</span> (!hasVerts[i]) {
<a name="l00591"></a>00591       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00592"></a>00592       <span class="keywordflow">for</span> (j = i - 1; j &gt;= 0; j++)
<a name="l00593"></a>00593         free(hasVerts[j]);
<a name="l00594"></a>00594       free(meshes); free(blk_ids); free(hasVerts);
<a name="l00595"></a>00595       free(numElems); free(numElemAttr);
<a name="l00596"></a>00596       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00597"></a>00597     }
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599   error = ex_get_elem_blk_ids(exoid, blk_ids);
<a name="l00600"></a>00600   <span class="keywordflow">if</span> (error != 0) {
<a name="l00601"></a>00601     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem blk ids"</span>);
<a name="l00602"></a>00602     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00603"></a>00603   }
<a name="l00604"></a>00604   numTotalElem = 0;  <span class="comment">// keep a running count</span>
<a name="l00605"></a>00605   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l00606"></a>00606     <span class="keywordtype">int</span> *conns, *vertIDs;
<a name="l00607"></a>00607     <span class="keywordtype">int</span> numElem, numVert, numVertPerElem;
<a name="l00608"></a>00608     <span class="keywordtype">char</span> exoElemType[MAX_STR_LENGTH+1];
<a name="l00609"></a>00609     <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l00610"></a>00610     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l00611"></a>00611 
<a name="l00612"></a>00612     <span class="comment">// Read &amp; process meta data</span>
<a name="l00613"></a>00613     error = ex_get_elem_block(exoid, blk_ids[i], exoElemType, &amp;numElem,
<a name="l00614"></a>00614                               &amp;numVertPerElem, &amp;numElemAttr[i]);
<a name="l00615"></a>00615     <span class="keywordflow">if</span> (error != 0) {
<a name="l00616"></a>00616       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem block meta data"</span>);
<a name="l00617"></a>00617       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619     <span class="keywordflow">if</span> (numVertPerElem == 1)
<a name="l00620"></a>00620       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a76571df5a6db31cae09dfe11dd291fd8">FC_ET_POINT</a>;
<a name="l00621"></a>00621     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 2)
<a name="l00622"></a>00622       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a80b8143aeefa54756df4ea881fb21fea">FC_ET_LINE</a>;
<a name="l00623"></a>00623     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 3 &amp;&amp; !strncasecmp(exoElemType, <span class="stringliteral">"tri"</span>, 3))
<a name="l00624"></a>00624       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884af79268373ad06101e34987c127cb50b5">FC_ET_TRI</a>;
<a name="l00625"></a>00625     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 4 &amp;&amp; !strncasecmp(exoElemType, <span class="stringliteral">"quad"</span>, 4))
<a name="l00626"></a>00626       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884aecaa2098167cbf0e3ee39fec88e073ca">FC_ET_QUAD</a>;
<a name="l00627"></a>00627     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 4 &amp;&amp; !strncasecmp(exoElemType, <span class="stringliteral">"tet"</span>, 3))
<a name="l00628"></a>00628       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884ab804e31376ed4e06e0bad0f4af1d4ed3">FC_ET_TET</a>;
<a name="l00629"></a>00629     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 5)
<a name="l00630"></a>00630       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884ac13209dbf3db3732a42ca48a668dc8e7">FC_ET_PYRAMID</a>;
<a name="l00631"></a>00631     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 6 &amp;&amp; 
<a name="l00632"></a>00632              (!strncasecmp(exoElemType, <span class="stringliteral">"prism"</span>, 5) || 
<a name="l00633"></a>00633               !strncasecmp(exoElemType, <span class="stringliteral">"wedge"</span>, 5)))
<a name="l00634"></a>00634       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a183a114a124ce2ed96589373642a63d6">FC_ET_PRISM</a>;
<a name="l00635"></a>00635     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numVertPerElem == 8 &amp;&amp; !strncasecmp(exoElemType, <span class="stringliteral">"hex"</span>, 3))
<a name="l00636"></a>00636       elemType = <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a3d933c1932ea3f8dcc2968395e68767b">FC_ET_HEX</a>;
<a name="l00637"></a>00637     <span class="keywordflow">else</span> {
<a name="l00638"></a>00638       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Cannot handle exodus element type of '%s' "</span>
<a name="l00639"></a>00639                             <span class="stringliteral">"with %d verts per element"</span>, exoElemType,
<a name="l00640"></a>00640                             numVertPerElem);
<a name="l00641"></a>00641       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644     <span class="comment">// read &amp; process conns</span>
<a name="l00645"></a>00645     conns = (<span class="keywordtype">int</span>*)malloc(numElem*numVertPerElem*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00646"></a>00646     <span class="keywordflow">if</span> (!conns) {
<a name="l00647"></a>00647       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00648"></a>00648       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00649"></a>00649     }      
<a name="l00650"></a>00650     error = ex_get_elem_conn(exoid, blk_ids[i], conns);
<a name="l00651"></a>00651     <span class="keywordflow">if</span> (error != 0) {
<a name="l00652"></a>00652       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem conns"</span>);
<a name="l00653"></a>00653       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655     <span class="keywordflow">for</span> (j = 0; j &lt; numTotalVert; j++)
<a name="l00656"></a>00656       hasVerts[i][j] = -1;
<a name="l00657"></a>00657     <span class="keywordflow">for</span> (j = 0; j &lt; numElem*numVertPerElem; j++) 
<a name="l00658"></a>00658       hasVerts[i][conns[j]-1] = 1; <span class="comment">//exodus numbering starts at 1</span>
<a name="l00659"></a>00659     free(conns);
<a name="l00660"></a>00660     numVert = 0;
<a name="l00661"></a>00661     <span class="keywordflow">for</span> (j = 0; j &lt; numTotalVert; j++) {
<a name="l00662"></a>00662       <span class="keywordflow">if</span> (hasVerts[i][j] &gt; -1) {
<a name="l00663"></a>00663         hasVerts[i][j] = numVert; 
<a name="l00664"></a>00664         numVert++;
<a name="l00665"></a>00665       }
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667     <span class="comment">// hasVerts [mesh][exonumber-1] = either the vert id on this mesh (uniquely numbered</span>
<a name="l00668"></a>00668     <span class="comment">// starting at zero) for all those participating verts in the mesh, -1 otherwise.</span>
<a name="l00669"></a>00669     vertIDs = (<span class="keywordtype">int</span>*)malloc(numVert*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00670"></a>00670     <span class="keywordflow">if</span> (!vertIDs) {
<a name="l00671"></a>00671       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00672"></a>00672       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00673"></a>00673     }
<a name="l00674"></a>00674     <span class="keywordflow">for</span> (j = 0; j &lt; numTotalVert; j++)
<a name="l00675"></a>00675       <span class="keywordflow">if</span> (hasVerts[i][j] &gt; -1) 
<a name="l00676"></a>00676         vertIDs[hasVerts[i][j]] = j; 
<a name="l00677"></a>00677     <span class="comment">// vertIDs[local_per_mesh_number(beginning at zero)] = exonumber</span>
<a name="l00678"></a>00678     numVerts[i] = numVert;
<a name="l00679"></a>00679     numElems[i] = numElem;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681     <span class="comment">// Create mesh &amp; save info</span>
<a name="l00682"></a>00682     <span class="comment">// Try to get exo name</span>
<a name="l00683"></a>00683     namebuf[0] = <span class="charliteral">'\0'</span>;
<a name="l00684"></a>00684     error = ex_get_name(exoid, EX_ELEM_BLOCK, blk_ids[i], namebuf);
<a name="l00685"></a>00685     <span class="keywordflow">if</span> (error != 0) {
<a name="l00686"></a>00686       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem block name"</span>);
<a name="l00687"></a>00687       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00688"></a>00688     }
<a name="l00689"></a>00689     <span class="keywordflow">if</span> (strcmp(namebuf,<span class="stringliteral">""</span>)) {
<a name="l00690"></a>00690       temp_name = namebuf;
<a name="l00691"></a>00691     } <span class="keywordflow">else</span> {
<a name="l00692"></a>00692       temp_name = (<span class="keywordtype">char</span>*)malloc(20*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00693"></a>00693       sprintf(temp_name, <span class="stringliteral">"block_%d"</span>, blk_ids[i]);
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695     rc = <a class="code" href="group__Mesh.html#g3928a328006617330e735ca1644e7cb3" title="Create a new mesh.">fc_createMesh</a>(*dataset, temp_name, &amp;meshes[i]);
<a name="l00696"></a>00696     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l00697"></a>00697       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create mesh #%d '%s'"</span>, i, temp_name);
<a name="l00698"></a>00698       <span class="keywordflow">return</span> rc;
<a name="l00699"></a>00699     }
<a name="l00700"></a>00700     <span class="keywordflow">if</span> (!strcmp(namebuf, <span class="stringliteral">""</span>)) 
<a name="l00701"></a>00701       free(temp_name);
<a name="l00702"></a>00702     meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[i]);
<a name="l00703"></a>00703     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a> = blk_ids[i];
<a name="l00704"></a>00704     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID = i;
<a name="l00705"></a>00705     <span class="comment">//offset to go from fclib id to exodus id - num Elem up til this mesh</span>
<a name="l00706"></a>00706     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset = numTotalElem;
<a name="l00707"></a>00707     numTotalElem += numElem;
<a name="l00708"></a>00708     dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[i] = vertIDs;
<a name="l00709"></a>00709     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8a59779a8f5f511a1fff4c886e8897ec">dim</a> = numDim;
<a name="l00710"></a>00710     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#049ca8ef52b92d19b06858e8a1cc2ea5">numVertex</a> = numVert;
<a name="l00711"></a>00711     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a> = numElem;
<a name="l00712"></a>00712     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a> = elemType;
<a name="l00713"></a>00713     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#b621647a95b1a86b85d543583e666af2">topodim</a> = <a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType);
<a name="l00714"></a>00714     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l00715"></a>00715   }
<a name="l00716"></a>00716  
<a name="l00717"></a>00717   <span class="comment">// Create node sets</span>
<a name="l00718"></a>00718   <span class="comment">// NOTE: becuase this cannot be lazily loaded, the committed flag is</span>
<a name="l00719"></a>00719   <span class="comment">// not set. This is so that this data will not be released in a release</span>
<a name="l00720"></a>00720   <span class="comment">// call since it cannot be reloaded. This has the side effect though of </span>
<a name="l00721"></a>00721   <span class="comment">// allowing this subset to be altered from what is on the disk</span>
<a name="l00722"></a>00722   <span class="keywordflow">if</span> (numNodeSet &gt; 0) {
<a name="l00723"></a>00723     <span class="keywordtype">int</span>* nodeset_ids = (<span class="keywordtype">int</span>*)malloc(numNodeSet*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00724"></a>00724     <span class="keywordflow">if</span> (!nodeset_ids) {
<a name="l00725"></a>00725       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00726"></a>00726       free(meshes);
<a name="l00727"></a>00727       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729     error = ex_get_node_set_ids(exoid, nodeset_ids);
<a name="l00730"></a>00730     <span class="keywordflow">if</span> (error != 0) {
<a name="l00731"></a>00731       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get node set ids"</span>);
<a name="l00732"></a>00732       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00733"></a>00733     }
<a name="l00734"></a>00734     <span class="keywordflow">for</span> (i = 0; i &lt; numNodeSet; i++) {
<a name="l00735"></a>00735       <span class="keywordtype">int</span> numNode, numDistFactor;
<a name="l00736"></a>00736       
<a name="l00737"></a>00737       <span class="comment">// Read &amp; process members</span>
<a name="l00738"></a>00738       error = ex_get_node_set_param(exoid, nodeset_ids[i], &amp;numNode,
<a name="l00739"></a>00739                                     &amp;numDistFactor);
<a name="l00740"></a>00740       <span class="keywordflow">if</span> (error != 0) {
<a name="l00741"></a>00741         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get node set param"</span>);
<a name="l00742"></a>00742         free(meshes); free(nodeset_ids);
<a name="l00743"></a>00743         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00744"></a>00744       }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746       namebuf[0] = <span class="charliteral">'\0'</span>;
<a name="l00747"></a>00747       error = ex_get_name(exoid, EX_NODE_SET, nodeset_ids[i], namebuf);
<a name="l00748"></a>00748       <span class="keywordflow">if</span> (error != 0) {
<a name="l00749"></a>00749      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get node set name"</span>);
<a name="l00750"></a>00750      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00751"></a>00751       }
<a name="l00752"></a>00752       <span class="keywordflow">if</span> (strcmp(namebuf, <span class="stringliteral">""</span>)) {
<a name="l00753"></a>00753      temp_name = namebuf;
<a name="l00754"></a>00754       } <span class="keywordflow">else</span> {
<a name="l00755"></a>00755      temp_name = (<span class="keywordtype">char</span>*)malloc(20*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00756"></a>00756      sprintf(temp_name, <span class="stringliteral">"nodeset_%d"</span>, nodeset_ids[i]);
<a name="l00757"></a>00757       }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759       <span class="keywordflow">if</span> (numNode &gt; 0){
<a name="l00760"></a>00760      <span class="keywordtype">int</span> *nodes = (<span class="keywordtype">int</span>*)malloc(numNode*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00761"></a>00761      <span class="keywordflow">if</span> (!nodes) {
<a name="l00762"></a>00762        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00763"></a>00763        free(meshes); free(nodeset_ids);
<a name="l00764"></a>00764        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00765"></a>00765      }
<a name="l00766"></a>00766      error = ex_get_node_set(exoid, nodeset_ids[i], nodes);
<a name="l00767"></a>00767      <span class="keywordflow">if</span> (error != 0) {
<a name="l00768"></a>00768        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get nodes in node set"</span>);
<a name="l00769"></a>00769        free(meshes); free(nodeset_ids); free(nodes);
<a name="l00770"></a>00770        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00771"></a>00771      }
<a name="l00772"></a>00772      
<a name="l00773"></a>00773      <span class="keywordflow">for</span> (j = 0; j &lt; numNode; j++){
<a name="l00774"></a>00774        <span class="keywordflow">if</span> (nodes[j] &gt; numTotalVert){
<a name="l00775"></a>00775          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"node[%d]=%d in nodeset %s has invalid id (numtotalverts = %d)\n"</span>,j,nodes[j],temp_name,numTotalVert);
<a name="l00776"></a>00776          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00777"></a>00777        }
<a name="l00778"></a>00778      }
<a name="l00779"></a>00779      
<a name="l00780"></a>00780      <span class="comment">// Create subset &amp; save info &amp; data</span>
<a name="l00781"></a>00781      <span class="comment">// (Each node set might span meshes and will be multiple subsets)</span>
<a name="l00782"></a>00782      <span class="comment">// Have to save too much info or do too much work for lazy read,</span>
<a name="l00783"></a>00783      <span class="comment">// so, do it all here</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785      <span class="comment">//split the subset into per-mesh subsets containing only the ids that</span>
<a name="l00786"></a>00786      <span class="comment">//exist on that mesh</span>
<a name="l00787"></a>00787      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l00788"></a>00788        <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> subset = <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>;
<a name="l00789"></a>00789        <span class="keywordflow">for</span> (k = 0; k &lt; numNode; k++) {
<a name="l00790"></a>00790          <span class="keywordflow">if</span> (hasVerts[j][nodes[k]-1] &gt; -1) {
<a name="l00791"></a>00791            <span class="keywordflow">if</span> (<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(subset, <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>)) {
<a name="l00792"></a>00792           rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(meshes[j],  temp_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>,
<a name="l00793"></a>00793                          &amp;subset);
<a name="l00794"></a>00794           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l00795"></a>00795             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create nodeset #%d '%s' "</span> 
<a name="l00796"></a>00796                          <span class="stringliteral">" on mesh #%d"</span>, i, temp_name, j);
<a name="l00797"></a>00797             <span class="keywordflow">return</span> rc;
<a name="l00798"></a>00798           }
<a name="l00799"></a>00799            }
<a name="l00800"></a>00800            <span class="comment">//this can be on more than 1 mesh</span>
<a name="l00801"></a>00801            <a class="code" href="group__Subset.html#g5ed37876a6f144458716efed8cb78dbe" title="Add member to a subset.">fc_addMemberToSubset</a>(subset, hasVerts[j][nodes[k]-1]);
<a name="l00802"></a>00802          }
<a name="l00803"></a>00803        }
<a name="l00804"></a>00804      }
<a name="l00805"></a>00805      free(nodes);
<a name="l00806"></a>00806       } <span class="keywordflow">else</span> {
<a name="l00807"></a>00807      <span class="comment">// if the node set is empty put it on all meshes</span>
<a name="l00808"></a>00808      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++){
<a name="l00809"></a>00809        <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> subset = <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>;
<a name="l00810"></a>00810        rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(meshes[j], temp_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, &amp;subset);
<a name="l00811"></a>00811        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00812"></a>00812          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create empty nodeset '%s' on mesh #%d\n"</span>,
<a name="l00813"></a>00813                       temp_name,j);
<a name="l00814"></a>00814          <span class="keywordflow">return</span> rc;
<a name="l00815"></a>00815        }
<a name="l00816"></a>00816      }
<a name="l00817"></a>00817       }
<a name="l00818"></a>00818       <span class="keywordflow">if</span> (!strcmp(namebuf, <span class="stringliteral">""</span>))
<a name="l00819"></a>00819      free(temp_name);
<a name="l00820"></a>00820     } <span class="comment">//loop over nodesets</span>
<a name="l00821"></a>00821     free(nodeset_ids);
<a name="l00822"></a>00822   } <span class="comment">//if numNodeSet</span>
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 
<a name="l00825"></a>00825   <span class="comment">// Create elem sets. not doing this as lazy load since</span>
<a name="l00826"></a>00826   <span class="comment">// we have to process through all the elements anyway (see</span>
<a name="l00827"></a>00827   <span class="comment">// how the count is retained in sideset). This means</span>
<a name="l00828"></a>00828   <span class="comment">// we cant release this data -- see if that becomes</span>
<a name="l00829"></a>00829   <span class="comment">// desireable</span>
<a name="l00830"></a>00830   <span class="comment">// NOTE: becuase this cannot be lazily loaded, the committed flag is</span>
<a name="l00831"></a>00831   <span class="comment">// not set. This is so that this data will not be released in a release</span>
<a name="l00832"></a>00832   <span class="comment">// call since it cannot be reloaded. This has the side effect though of </span>
<a name="l00833"></a>00833   <span class="comment">// allowing this subset to be altered from what is on the disk</span>
<a name="l00834"></a>00834   <span class="keywordflow">if</span> (numElemSet &gt; 0) {
<a name="l00835"></a>00835     <span class="keywordtype">int</span>* elemset_ids = (<span class="keywordtype">int</span>*)malloc(numElemSet*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00836"></a>00836     <span class="keywordflow">if</span> (!elemset_ids) {
<a name="l00837"></a>00837       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00838"></a>00838       free(meshes);
<a name="l00839"></a>00839       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00840"></a>00840     }
<a name="l00841"></a>00841     error = ex_get_ids(exoid, EX_ELEM_SET, elemset_ids);
<a name="l00842"></a>00842     <span class="keywordflow">if</span> (error != 0) {
<a name="l00843"></a>00843       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem set ids"</span>);
<a name="l00844"></a>00844       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00845"></a>00845     }
<a name="l00846"></a>00846     <span class="keywordflow">for</span> (i = 0; i &lt; numElemSet; i++) {
<a name="l00847"></a>00847       <span class="keywordtype">int</span> numElem, numDistFactor, *elems;
<a name="l00848"></a>00848       
<a name="l00849"></a>00849       <span class="comment">// Read &amp; process members</span>
<a name="l00850"></a>00850       error = ex_get_set_param(exoid, EX_ELEM_SET, elemset_ids[i], &amp;numElem,
<a name="l00851"></a>00851                                     &amp;numDistFactor);
<a name="l00852"></a>00852       <span class="keywordflow">if</span> (error != 0) {
<a name="l00853"></a>00853         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem set param"</span>);
<a name="l00854"></a>00854         free(meshes); free(elemset_ids);
<a name="l00855"></a>00855         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00856"></a>00856       }
<a name="l00857"></a>00857       namebuf[0] = <span class="charliteral">'\0'</span>;
<a name="l00858"></a>00858       error = ex_get_name(exoid, EX_ELEM_SET, elemset_ids[i], namebuf);
<a name="l00859"></a>00859       <span class="keywordflow">if</span> (error != 0) {
<a name="l00860"></a>00860      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem set name"</span>);
<a name="l00861"></a>00861      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00862"></a>00862       }
<a name="l00863"></a>00863       <span class="keywordflow">if</span> (strcmp(namebuf, <span class="stringliteral">""</span>)) {
<a name="l00864"></a>00864      temp_name = namebuf;
<a name="l00865"></a>00865       } <span class="keywordflow">else</span> {
<a name="l00866"></a>00866      temp_name = (<span class="keywordtype">char</span>*)malloc(20*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00867"></a>00867      sprintf(temp_name, <span class="stringliteral">"elemset_%d"</span>, elemset_ids[i]);
<a name="l00868"></a>00868       }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870       <span class="keywordflow">if</span> (numElem &gt; 0){
<a name="l00871"></a>00871      elems = (<span class="keywordtype">int</span>*)malloc(numElem*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00872"></a>00872      <span class="keywordflow">if</span> (!elems) {
<a name="l00873"></a>00873        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00874"></a>00874        free(meshes); free(elemset_ids);
<a name="l00875"></a>00875        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00876"></a>00876      }
<a name="l00877"></a>00877      error = ex_get_set(exoid, EX_ELEM_SET, elemset_ids[i], elems, NULL);
<a name="l00878"></a>00878      <span class="keywordflow">if</span> (error != 0) {
<a name="l00879"></a>00879        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elems in elem set"</span>);
<a name="l00880"></a>00880        free(meshes); free(elemset_ids); free(elems);
<a name="l00881"></a>00881        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00882"></a>00882      }
<a name="l00883"></a>00883      
<a name="l00884"></a>00884      <span class="comment">// Create subset &amp; save info &amp; data</span>
<a name="l00885"></a>00885      <span class="comment">// (Each elem set might span meshes and will be multiple subsets)</span>
<a name="l00886"></a>00886 
<a name="l00887"></a>00887      <span class="comment">//split the subset into per-mesh subsets containing only the ids that</span>
<a name="l00888"></a>00888      <span class="comment">//exist on that mesh</span>
<a name="l00889"></a>00889      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l00890"></a>00890        <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> subset = <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>;
<a name="l00891"></a>00891        <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[j]);
<a name="l00892"></a>00892        <span class="keywordflow">for</span> (k = 0; k &lt; numElem; k++) {
<a name="l00893"></a>00893          <span class="keywordflow">if</span> (elems[k] - 1 &gt;=  meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset &amp;&amp;
<a name="l00894"></a>00894           elems[k] - 1 &lt;  meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset + meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a>) {
<a name="l00895"></a>00895            <span class="keywordflow">if</span> (<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(subset, <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>)) {
<a name="l00896"></a>00896           rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(meshes[j],  temp_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>,
<a name="l00897"></a>00897                          &amp;subset);
<a name="l00898"></a>00898           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l00899"></a>00899             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create elemset #%d '%s' "</span> 
<a name="l00900"></a>00900                          <span class="stringliteral">" on mesh #%d"</span>, i, temp_name, j);
<a name="l00901"></a>00901             <span class="keywordflow">return</span> rc;
<a name="l00902"></a>00902           }
<a name="l00903"></a>00903            }
<a name="l00904"></a>00904            <a class="code" href="group__Subset.html#g5ed37876a6f144458716efed8cb78dbe" title="Add member to a subset.">fc_addMemberToSubset</a>(subset,elems[k]-1-meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset);
<a name="l00905"></a>00905          } <span class="comment">//elem on this mesh</span>
<a name="l00906"></a>00906        }
<a name="l00907"></a>00907      }
<a name="l00908"></a>00908      free(elems);
<a name="l00909"></a>00909       } <span class="keywordflow">else</span> {
<a name="l00910"></a>00910      <span class="comment">//if the elem set is empty put on all meshes</span>
<a name="l00911"></a>00911      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++){
<a name="l00912"></a>00912        <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> subset = <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>;
<a name="l00913"></a>00913        rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(meshes[j], temp_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, &amp;subset);
<a name="l00914"></a>00914        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00915"></a>00915          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create empty nodeset '%s' on mesh #%d\n"</span>,
<a name="l00916"></a>00916                       temp_name,j);
<a name="l00917"></a>00917          <span class="keywordflow">return</span> rc;
<a name="l00918"></a>00918        }
<a name="l00919"></a>00919      }
<a name="l00920"></a>00920       }
<a name="l00921"></a>00921       <span class="keywordflow">if</span> (!strcmp(namebuf, <span class="stringliteral">""</span>))
<a name="l00922"></a>00922      free(temp_name);
<a name="l00923"></a>00923     } <span class="comment">//loop over elemsets</span>
<a name="l00924"></a>00924     free(elemset_ids);
<a name="l00925"></a>00925   } <span class="comment">//if numElemSet</span>
<a name="l00926"></a>00926 
<a name="l00927"></a>00927   
<a name="l00928"></a>00928   <span class="comment">// Create side sets</span>
<a name="l00929"></a>00929   <span class="keywordflow">if</span> (numSideSet &gt; 0) {
<a name="l00930"></a>00930     <span class="keywordtype">int</span>* sideset_ids = (<span class="keywordtype">int</span>*)malloc(numSideSet*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00931"></a>00931     <span class="keywordflow">if</span> (!sideset_ids) {
<a name="l00932"></a>00932       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00933"></a>00933       free(meshes);
<a name="l00934"></a>00934       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936     error = ex_get_side_set_ids(exoid, sideset_ids);
<a name="l00937"></a>00937     <span class="keywordflow">if</span> (error != 0) {
<a name="l00938"></a>00938       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem blk ids"</span>);
<a name="l00939"></a>00939       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00940"></a>00940     }
<a name="l00941"></a>00941     <span class="keywordflow">for</span> (i = 0; i &lt; numSideSet; i++) {
<a name="l00942"></a>00942       <span class="keywordtype">int</span> numSide, numDistFactor, *elems, *sides;
<a name="l00943"></a>00943       <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> subsets[numMesh];
<a name="l00944"></a>00944       <span class="keywordtype">int</span> elemOffsets[numMesh];
<a name="l00945"></a>00945       
<a name="l00946"></a>00946       <span class="comment">// Read &amp; process members</span>
<a name="l00947"></a>00947       error = ex_get_side_set_param(exoid, sideset_ids[i], &amp;numSide,
<a name="l00948"></a>00948                                     &amp;numDistFactor);
<a name="l00949"></a>00949       <span class="keywordflow">if</span> (error != 0) {
<a name="l00950"></a>00950         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get sides in side set"</span>);
<a name="l00951"></a>00951         free(meshes); free(sideset_ids);
<a name="l00952"></a>00952         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00953"></a>00953       }
<a name="l00954"></a>00954       <span class="keywordflow">if</span> (numSide &gt; 0){
<a name="l00955"></a>00955      elems = (<span class="keywordtype">int</span>*)malloc(numSide*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00956"></a>00956      sides = (<span class="keywordtype">int</span>*)malloc(numSide*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00957"></a>00957      <span class="keywordflow">if</span> (!elems || !sides) {
<a name="l00958"></a>00958        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00959"></a>00959        free(meshes); free(sideset_ids); free(elems); free(sides);
<a name="l00960"></a>00960        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00961"></a>00961      }
<a name="l00962"></a>00962      error = ex_get_side_set(exoid, sideset_ids[i], elems, sides);
<a name="l00963"></a>00963      <span class="keywordflow">if</span> (error != 0) {
<a name="l00964"></a>00964        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get sides in side set"</span>);
<a name="l00965"></a>00965        free(meshes); free(sideset_ids); free(elems); free(sides);
<a name="l00966"></a>00966        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00967"></a>00967      }
<a name="l00968"></a>00968      free(sides); <span class="comment">// don't need this right now</span>
<a name="l00969"></a>00969       
<a name="l00970"></a>00970      <span class="comment">// Create subset &amp; save info</span>
<a name="l00971"></a>00971      <span class="comment">// (Each side set might span meshes and will be multiple subsets)</span>
<a name="l00972"></a>00972      <span class="comment">// Unlike node sets, will be lazily read.</span>
<a name="l00973"></a>00973      namebuf[0] = <span class="charliteral">'\0'</span>;
<a name="l00974"></a>00974      error = ex_get_name(exoid, EX_SIDE_SET, sideset_ids[i], namebuf);
<a name="l00975"></a>00975      <span class="keywordflow">if</span> (error != 0) {
<a name="l00976"></a>00976        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get side set name"</span>);
<a name="l00977"></a>00977        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l00978"></a>00978      }
<a name="l00979"></a>00979      <span class="keywordflow">if</span> (strcmp(namebuf, <span class="stringliteral">""</span>)) {
<a name="l00980"></a>00980        temp_name = namebuf;
<a name="l00981"></a>00981      } <span class="keywordflow">else</span> {
<a name="l00982"></a>00982        temp_name = (<span class="keywordtype">char</span>*)malloc(20*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00983"></a>00983        sprintf(temp_name, <span class="stringliteral">"sideset_%d"</span>, sideset_ids[i]);
<a name="l00984"></a>00984      }
<a name="l00985"></a>00985      <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) { 
<a name="l00986"></a>00986        subsets[j] = <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>;
<a name="l00987"></a>00987        elemOffsets[j] = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[j])-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset;
<a name="l00988"></a>00988      }
<a name="l00989"></a>00989      <span class="keywordflow">for</span> (j = 0; j &lt; numSide; j++) {
<a name="l00990"></a>00990        <a class="code" href="struct__FC__SubSlot.html" title="Struct describing subset elements.">_FC_SubSlot</a>* subSlot;
<a name="l00991"></a>00991        <span class="comment">// Figure out which mesh this side is on  - compare exo id to offset which is the running count of the total up till that point</span>
<a name="l00992"></a>00992        <span class="keywordflow">for</span> (k = numMesh-1; k &gt;= 0; k--) 
<a name="l00993"></a>00993          <span class="keywordflow">if</span> (elems[j] - 1 &gt;= elemOffsets[k])
<a name="l00994"></a>00994            <span class="keywordflow">break</span>;
<a name="l00995"></a>00995        subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(subsets[k]);
<a name="l00996"></a>00996        <span class="comment">// If first time we've seen a side for this mesh, make a subset</span>
<a name="l00997"></a>00997        <span class="keywordflow">if</span> (!subSlot) {
<a name="l00998"></a>00998          <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l00999"></a>00999          <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l01000"></a>01000          <span class="keywordtype">int</span> topoDim;
<a name="l01001"></a>01001          
<a name="l01002"></a>01002          rc = <a class="code" href="group__Mesh.html#g1c1684ecf98e82a0ab18f7f9dbdddfc5" title="Returns type of elements in the mesh.">fc_getMeshElementType</a>(meshes[k], &amp;elemType);
<a name="l01003"></a>01003          <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01004"></a>01004            <span class="keywordflow">return</span> rc;
<a name="l01005"></a>01005          topoDim = <a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType);
<a name="l01006"></a>01006          <span class="keywordflow">if</span> (topoDim == 3)
<a name="l01007"></a>01007            assoc = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>;
<a name="l01008"></a>01008          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topoDim == 2)
<a name="l01009"></a>01009            assoc = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>;
<a name="l01010"></a>01010          <span class="keywordflow">else</span> {
<a name="l01011"></a>01011            <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Encountered unexpected element topology"</span>);
<a name="l01012"></a>01012            <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01013"></a>01013          }
<a name="l01014"></a>01014          <span class="comment">//create the subset but dont fill in the ids</span>
<a name="l01015"></a>01015          rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(meshes[k],  temp_name, assoc, &amp;subsets[k]);
<a name="l01016"></a>01016          <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01017"></a>01017            <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create sideset #%d '%s' "</span> 
<a name="l01018"></a>01018                         <span class="stringliteral">" on mesh #%d"</span>, i, temp_name, j);
<a name="l01019"></a>01019            <span class="keywordflow">return</span> rc;
<a name="l01020"></a>01020          }
<a name="l01021"></a>01021          subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(subsets[k]);
<a name="l01022"></a>01022          subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.assoc_flag = 1;
<a name="l01023"></a>01023          subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid = sideset_ids[i];
<a name="l01024"></a>01024          <span class="comment">//Because this data exists on disk and can be reloaded, set the committed flag</span>
<a name="l01025"></a>01025          subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l01026"></a>01026        }
<a name="l01027"></a>01027        <span class="comment">// count the side</span>
<a name="l01028"></a>01028        subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#42e80e2eaa2cfcf5c3e8b3dfa22f8cfe">numMember</a>++;
<a name="l01029"></a>01029      }
<a name="l01030"></a>01030      free(elems);
<a name="l01031"></a>01031      <span class="keywordflow">if</span> (!strcmp(namebuf, <span class="stringliteral">""</span>))
<a name="l01032"></a>01032        free(temp_name);
<a name="l01033"></a>01033       } <span class="keywordflow">else</span> {
<a name="l01034"></a>01034      <span class="comment">//empty side set - put on all meshes</span>
<a name="l01035"></a>01035      namebuf[0] = <span class="charliteral">'\0'</span>;
<a name="l01036"></a>01036      error = ex_get_name(exoid, EX_SIDE_SET, sideset_ids[i], namebuf);
<a name="l01037"></a>01037      <span class="keywordflow">if</span> (error != 0) {
<a name="l01038"></a>01038        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get side set name"</span>);
<a name="l01039"></a>01039        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01040"></a>01040      }
<a name="l01041"></a>01041      <span class="keywordflow">if</span> (strcmp(namebuf, <span class="stringliteral">""</span>)) {
<a name="l01042"></a>01042        temp_name = namebuf;
<a name="l01043"></a>01043      } <span class="keywordflow">else</span> {
<a name="l01044"></a>01044        temp_name = (<span class="keywordtype">char</span>*)malloc(20*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01045"></a>01045        sprintf(temp_name, <span class="stringliteral">"sideset_%d"</span>, sideset_ids[i]);
<a name="l01046"></a>01046      }
<a name="l01047"></a>01047      <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++) {
<a name="l01048"></a>01048        <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l01049"></a>01049        <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l01050"></a>01050        <a class="code" href="struct__FC__SubSlot.html" title="Struct describing subset elements.">_FC_SubSlot</a>* subSlot;
<a name="l01051"></a>01051        <span class="keywordtype">int</span> topoDim;
<a name="l01052"></a>01052        
<a name="l01053"></a>01053        rc = <a class="code" href="group__Mesh.html#g1c1684ecf98e82a0ab18f7f9dbdddfc5" title="Returns type of elements in the mesh.">fc_getMeshElementType</a>(meshes[k], &amp;elemType);
<a name="l01054"></a>01054        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01055"></a>01055          <span class="keywordflow">return</span> rc;
<a name="l01056"></a>01056        topoDim = <a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType);
<a name="l01057"></a>01057        <span class="keywordflow">if</span> (topoDim == 3)
<a name="l01058"></a>01058          assoc = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>;
<a name="l01059"></a>01059        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topoDim == 2)
<a name="l01060"></a>01060          assoc = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>;
<a name="l01061"></a>01061        <span class="keywordflow">else</span> {
<a name="l01062"></a>01062          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Encountered unexpected element topology"</span>);
<a name="l01063"></a>01063          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01064"></a>01064        }
<a name="l01065"></a>01065        <span class="comment">//create the subset, with no members</span>
<a name="l01066"></a>01066        rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(meshes[k],  temp_name, assoc, &amp;subsets[k]);
<a name="l01067"></a>01067        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01068"></a>01068          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create sideset #%d '%s' "</span> 
<a name="l01069"></a>01069                       <span class="stringliteral">" on mesh #%d"</span>, i, temp_name, j);
<a name="l01070"></a>01070          <span class="keywordflow">return</span> rc;
<a name="l01071"></a>01071        }
<a name="l01072"></a>01072        subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(subsets[k]);
<a name="l01073"></a>01073        subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.assoc_flag = 1;
<a name="l01074"></a>01074        subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid = sideset_ids[i];
<a name="l01075"></a>01075        <span class="comment">//Because this data exists on disk and can be reloaded, set the committed flag</span>
<a name="l01076"></a>01076        subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l01077"></a>01077      }
<a name="l01078"></a>01078      <span class="keywordflow">if</span> (!strcmp(namebuf, <span class="stringliteral">""</span>))
<a name="l01079"></a>01079        free(temp_name);
<a name="l01080"></a>01080       }
<a name="l01081"></a>01081     } <span class="comment">// end of loop over side sets</span>
<a name="l01082"></a>01082     free(sideset_ids);
<a name="l01083"></a>01083   }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085   <span class="comment">// Create vars</span>
<a name="l01086"></a>01086   <span class="comment">// Get element block properties = FC_AT_WHOLE_MESH &amp; FC_DT_INT vars</span>
<a name="l01087"></a>01087   error = ex_inquire(exoid, EX_INQ_EB_PROP, &amp;numProp, &amp;fdum, cdum);
<a name="l01088"></a>01088   <span class="keywordflow">if</span> (error != 0) {
<a name="l01089"></a>01089     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get number of elem block props"</span>);
<a name="l01090"></a>01090     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01091"></a>01091   }
<a name="l01092"></a>01092   <span class="keywordflow">if</span> (numProp &gt; 0) {
<a name="l01093"></a>01093     <span class="keywordtype">char</span>** prop_names = (<span class="keywordtype">char</span>**)malloc(numProp*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l01094"></a>01094     <span class="keywordflow">if</span> (!prop_names) {
<a name="l01095"></a>01095       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01096"></a>01096       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01097"></a>01097     }
<a name="l01098"></a>01098     <span class="keywordflow">for</span> (i = 0; i &lt; numProp; i++) {
<a name="l01099"></a>01099       prop_names[i] = (<span class="keywordtype">char</span>*)malloc((MAX_STR_LENGTH+1)*<span class="keyword">sizeof</span>(char));
<a name="l01100"></a>01100       <span class="keywordflow">if</span> (!prop_names[i]) {
<a name="l01101"></a>01101         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01102"></a>01102         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01103"></a>01103       }
<a name="l01104"></a>01104     }
<a name="l01105"></a>01105     error = ex_get_prop_names(exoid, EX_ELEM_BLOCK, prop_names);
<a name="l01106"></a>01106     <span class="keywordflow">if</span> (error != 0) {
<a name="l01107"></a>01107       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem block prop names"</span>);
<a name="l01108"></a>01108       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01109"></a>01109     }
<a name="l01110"></a>01110     <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l01111"></a>01111       <span class="keywordflow">for</span> (j = 0; j &lt; numProp; j++) {
<a name="l01112"></a>01112         <span class="keywordtype">int</span> prop_value;
<a name="l01113"></a>01113         <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> var;
<a name="l01114"></a>01114         error = ex_get_prop(exoid, EX_ELEM_BLOCK, blk_ids[i], prop_names[j],
<a name="l01115"></a>01115                             &amp;prop_value);
<a name="l01116"></a>01116         <span class="keywordflow">if</span> (error != 0) {
<a name="l01117"></a>01117           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get prop '%s' for mesh #%d"</span>,
<a name="l01118"></a>01118                                 prop_names[j], i);
<a name="l01119"></a>01119           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01120"></a>01120         }
<a name="l01121"></a>01121         rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(meshes[i], prop_names[j], &amp;var);
<a name="l01122"></a>01122         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01123"></a>01123           <span class="keywordflow">return</span> rc;
<a name="l01124"></a>01124      <span class="comment">//Property data is set here and is not reloadable, so do not set committed flag</span>
<a name="l01125"></a>01125         rc = <a class="code" href="group__Variable.html#g3f958d3b630c9df78a4e7fbca287b039" title="Set the variable data by copy.">fc_setVariableData</a>(var, 1, 1, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>, <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb206d3b58fc952172de6c4a1b3f75b8b5b2">FC_MT_SCALAR</a>,
<a name="l01126"></a>01126                                 <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>, (<span class="keywordtype">void</span>*)&amp;prop_value);
<a name="l01127"></a>01127         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01128"></a>01128           <span class="keywordflow">return</span> rc;
<a name="l01129"></a>01129       }
<a name="l01130"></a>01130     }
<a name="l01131"></a>01131     <span class="keywordflow">for</span> (i = 0; i &lt; numProp; i++)
<a name="l01132"></a>01132       free(prop_names[i]);
<a name="l01133"></a>01133     free(prop_names);
<a name="l01134"></a>01134   }
<a name="l01135"></a>01135 
<a name="l01136"></a>01136   <span class="comment">// Blk Attributes (currently only elem)</span>
<a name="l01137"></a>01137   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++){
<a name="l01138"></a>01138     <span class="keywordflow">if</span> (numElemAttr[i] &gt; 0){
<a name="l01139"></a>01139       <span class="keywordtype">char</span>** attr_names = (<span class="keywordtype">char</span>**)malloc(numElemAttr[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l01140"></a>01140       <span class="keywordflow">if</span> (!attr_names){
<a name="l01141"></a>01141         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01142"></a>01142         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01143"></a>01143       }
<a name="l01144"></a>01144 
<a name="l01145"></a>01145       <span class="keywordflow">for</span> (j = 0; j &lt; numElemAttr[i]; j++){
<a name="l01146"></a>01146      attr_names[j] = (<span class="keywordtype">char</span>*)malloc((MAX_STR_LENGTH+1)*<span class="keyword">sizeof</span>(char));
<a name="l01147"></a>01147         <span class="keywordflow">if</span> (!attr_names[j]){
<a name="l01148"></a>01148        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01149"></a>01149        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01150"></a>01150         }
<a name="l01151"></a>01151       }
<a name="l01152"></a>01152 
<a name="l01153"></a>01153       error = ex_get_elem_attr_names(exoid, blk_ids[i], attr_names);
<a name="l01154"></a>01154       <span class="keywordflow">if</span> (error != 0){
<a name="l01155"></a>01155      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get attribute names"</span>);
<a name="l01156"></a>01156      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01157"></a>01157       }
<a name="l01158"></a>01158       <span class="keywordflow">for</span> (j = 0; j &lt; numElemAttr[i]; j++){
<a name="l01159"></a>01159           <span class="comment">//does not set var data</span>
<a name="l01160"></a>01160      <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> var;
<a name="l01161"></a>01161      <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01162"></a>01162      rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(meshes[i], attr_names[j], &amp;var);
<a name="l01163"></a>01163      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01164"></a>01164        <span class="keywordflow">return</span> rc;
<a name="l01165"></a>01165      varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(var);
<a name="l01166"></a>01166      strcpy(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType, <span class="stringliteral">"e"</span>);
<a name="l01167"></a>01167      <span class="comment">//need attr index for reading data later (starts at 1)</span>
<a name="l01168"></a>01168      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.attrIndex = j + 1;
<a name="l01169"></a>01169      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#ad6e1772eae1748e6277591ab8bd0f13">stepID</a> = -1;
<a name="l01170"></a>01170         varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a> = numElems[i];
<a name="l01171"></a>01171      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> = 1;
<a name="l01172"></a>01172      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a> = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>;
<a name="l01173"></a>01173      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a> = <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb206d3b58fc952172de6c4a1b3f75b8b5b2">FC_MT_SCALAR</a>;
<a name="l01174"></a>01174      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a> = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>;
<a name="l01175"></a>01175      <span class="comment">//EB attributes exist on disk and are lazily loaded, so set committed flag</span>
<a name="l01176"></a>01176      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l01177"></a>01177 
<a name="l01178"></a>01178      free(attr_names[j]);
<a name="l01179"></a>01179       }
<a name="l01180"></a>01180       free(attr_names);
<a name="l01181"></a>01181     }
<a name="l01182"></a>01182   }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184   free(numElemAttr);
<a name="l01185"></a>01185   free(blk_ids);
<a name="l01186"></a>01186 
<a name="l01187"></a>01187 
<a name="l01188"></a>01188   <span class="comment">//nodal attr (exist on all meshes)</span>
<a name="l01189"></a>01189   numNodalAttr = 0;
<a name="l01190"></a>01190   error = ex_get_attr_param(exoid, EX_NODAL, 0, &amp;numNodalAttr);
<a name="l01191"></a>01191   <span class="keywordflow">if</span> (error != 0){
<a name="l01192"></a>01192     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get num nodal attributes"</span>);
<a name="l01193"></a>01193     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01194"></a>01194   }
<a name="l01195"></a>01195   
<a name="l01196"></a>01196   <span class="keywordflow">if</span> (numNodalAttr &gt; 0){
<a name="l01197"></a>01197     <span class="keywordtype">char</span>** attr_names = (<span class="keywordtype">char</span>**)malloc(numNodalAttr*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l01198"></a>01198     <span class="keywordflow">if</span> (!attr_names){
<a name="l01199"></a>01199       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01200"></a>01200       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01201"></a>01201     }
<a name="l01202"></a>01202     <span class="keywordflow">for</span> (i = 0; i &lt; numNodalAttr; i++){
<a name="l01203"></a>01203       attr_names[i] = (<span class="keywordtype">char</span>*)calloc((MAX_STR_LENGTH+1), <span class="keyword">sizeof</span>(char));
<a name="l01204"></a>01204       <span class="keywordflow">if</span> (!attr_names[i]){
<a name="l01205"></a>01205      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01206"></a>01206      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01207"></a>01207       }
<a name="l01208"></a>01208     }
<a name="l01209"></a>01209     error = ex_get_attr_names (exoid, EX_NODAL, 0, attr_names);
<a name="l01210"></a>01210     <span class="keywordflow">if</span> (error != 0){
<a name="l01211"></a>01211       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get nodal attribute names"</span>);
<a name="l01212"></a>01212       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01213"></a>01213     }
<a name="l01214"></a>01214 
<a name="l01215"></a>01215     <span class="keywordflow">for</span> (i = 0; i &lt; numNodalAttr; i++){
<a name="l01216"></a>01216       <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++){
<a name="l01217"></a>01217           <span class="comment">//does not set var data</span>
<a name="l01218"></a>01218      <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> var;
<a name="l01219"></a>01219      <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01220"></a>01220      rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(meshes[j], attr_names[i], &amp;var);
<a name="l01221"></a>01221      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01222"></a>01222        <span class="keywordflow">return</span> rc;
<a name="l01223"></a>01223      varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(var);
<a name="l01224"></a>01224      strcpy(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType, <span class="stringliteral">"n"</span>);
<a name="l01225"></a>01225      <span class="comment">//need attr index for reading data later (starts at 1)</span>
<a name="l01226"></a>01226      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.attrIndex = i + 1;
<a name="l01227"></a>01227      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#ad6e1772eae1748e6277591ab8bd0f13">stepID</a> = -1;
<a name="l01228"></a>01228         varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a> = numVerts[j];
<a name="l01229"></a>01229      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> = 1;
<a name="l01230"></a>01230      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a> = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>;
<a name="l01231"></a>01231      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a> = <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb206d3b58fc952172de6c4a1b3f75b8b5b2">FC_MT_SCALAR</a>;
<a name="l01232"></a>01232      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a> = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>;
<a name="l01233"></a>01233      <span class="comment">//Nodal attributes exist on disk and are lazily loaded so set committed flag</span>
<a name="l01234"></a>01234      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l01235"></a>01235       }
<a name="l01236"></a>01236       free(attr_names[i]);
<a name="l01237"></a>01237     }
<a name="l01238"></a>01238     free(attr_names);
<a name="l01239"></a>01239   }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241   
<a name="l01242"></a>01242   <span class="comment">// Create the sequence</span>
<a name="l01243"></a>01243   error = ex_inquire(exoid, EX_INQ_TIME, &amp;numStep, &amp;fdum, cdum);
<a name="l01244"></a>01244   <span class="keywordflow">if</span> (error != 0) {
<a name="l01245"></a>01245     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get numStep"</span>);
<a name="l01246"></a>01246     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01247"></a>01247   }
<a name="l01248"></a>01248   rc = <a class="code" href="group__Sequence.html#g52215110a3bf2f4bd1aa74437ce89c54" title="Create a new sequence.">fc_createSequence</a>(*dataset, <span class="stringliteral">"time"</span>, &amp;sequence);
<a name="l01249"></a>01249   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01250"></a>01250     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create sequence"</span>);
<a name="l01251"></a>01251     <span class="keywordflow">return</span> rc;
<a name="l01252"></a>01252   }
<a name="l01253"></a>01253   seqSlot = <a class="code" href="group__PrivateSequence.html#g311b52c3aa6307afba63b26ad035afe5" title="Get a sequence slot from a sequence handle.">_fc_getSeqSlot</a>(sequence);
<a name="l01254"></a>01254   seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#ca6023886cf92e3f25c09d9a315e3631">numStep</a> = numStep;
<a name="l01255"></a>01255   seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c6a4bdad57705f33fe78820efa2f1c75">datatype</a> = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>;
<a name="l01256"></a>01256   <span class="comment">//seq exists on disk and is lazily loaded so set committed flag</span>
<a name="l01257"></a>01257   seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c5e5166b76af0f8c08946df88105d729">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l01258"></a>01258 
<a name="l01259"></a>01259   <span class="comment">// Create Seq Vars</span>
<a name="l01260"></a>01260   <span class="comment">// FIX? automatically stitch up vectors? could do this after creating --</span>
<a name="l01261"></a>01261   <span class="comment">// use fc_mergeComponents()</span>
<a name="l01262"></a>01262   <span class="keywordflow">for</span> (i = 0; i &lt; numVarType; i++) {
<a name="l01263"></a>01263     <span class="keywordtype">char</span>** var_names;
<a name="l01264"></a>01264     <span class="keywordtype">int</span> numVar;
<a name="l01265"></a>01265     <span class="keywordtype">int</span>* numDatas;
<a name="l01266"></a>01266     <span class="keywordtype">int</span>* elem_truth_tab = NULL;
<a name="l01267"></a>01267 
<a name="l01268"></a>01268     <span class="comment">// get number of seq vars of this type</span>
<a name="l01269"></a>01269     error = ex_get_var_param(exoid, exoVarTypes[i], &amp;numVar);
<a name="l01270"></a>01270     <span class="keywordflow">if</span> (error != 0) {
<a name="l01271"></a>01271       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get num of vars"</span>);
<a name="l01272"></a>01272       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01273"></a>01273     }
<a name="l01274"></a>01274     <span class="keywordflow">if</span> (numVar &lt; 1)
<a name="l01275"></a>01275       <span class="keywordflow">continue</span>; <span class="comment">// done if there are none</span>
<a name="l01276"></a>01276 
<a name="l01277"></a>01277     <span class="comment">// Setup</span>
<a name="l01278"></a>01278     <span class="keywordflow">if</span> (i == 1)
<a name="l01279"></a>01279       numDatas = numVerts;
<a name="l01280"></a>01280     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 2)
<a name="l01281"></a>01281       numDatas = numElems;
<a name="l01282"></a>01282     var_names = (<span class="keywordtype">char</span>**)malloc(numVar*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l01283"></a>01283     <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++)
<a name="l01284"></a>01284       var_names[j] = (<span class="keywordtype">char</span>*)malloc((MAX_STR_LENGTH+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01285"></a>01285     error = ex_get_var_names(exoid, exoVarTypes[i], numVar, var_names);
<a name="l01286"></a>01286     <span class="keywordflow">if</span> (error != 0) {
<a name="l01287"></a>01287       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get '%s' var names"</span>,
<a name="l01288"></a>01288                             exoVarTypes[i]);
<a name="l01289"></a>01289       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01290"></a>01290     }
<a name="l01291"></a>01291     <span class="keywordflow">if</span> (i == 2) { <span class="comment">//no truth tab for nodal</span>
<a name="l01292"></a>01292       elem_truth_tab = (<span class="keywordtype">int</span>*)malloc(numMesh*numVar*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01293"></a>01293       <span class="keywordflow">if</span> (!elem_truth_tab) {
<a name="l01294"></a>01294         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01295"></a>01295         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01296"></a>01296       }
<a name="l01297"></a>01297       error = ex_get_elem_var_tab(exoid, numMesh, numVar, elem_truth_tab);
<a name="l01298"></a>01298       <span class="keywordflow">if</span> (error != 0) {
<a name="l01299"></a>01299       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to read element truth table"</span>);
<a name="l01300"></a>01300       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01301"></a>01301       }
<a name="l01302"></a>01302     }
<a name="l01303"></a>01303 
<a name="l01304"></a>01304     <span class="comment">// Make seq vars </span>
<a name="l01305"></a>01305     <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l01306"></a>01306       <span class="keywordtype">double</span>* data = NULL;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308       <span class="comment">// Globals</span>
<a name="l01309"></a>01309       <span class="comment">// (go ahead and get global data, probably easier not to do lazy)</span>
<a name="l01310"></a>01310       <span class="keywordflow">if</span> (i == 0) {                                     
<a name="l01311"></a>01311         <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *seqVar;
<a name="l01312"></a>01312         rc = <a class="code" href="group__Variable.html#g7cb59e75c9e63c1dcc09b42787b57227" title="Create a new global sequence variable.">fc_createGlobalSeqVariable</a>(*dataset, sequence, var_names[j],
<a name="l01313"></a>01313                                         &amp;numStep, &amp;seqVar);
<a name="l01314"></a>01314         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01315"></a>01315           <span class="keywordflow">return</span> rc;
<a name="l01316"></a>01316         data = (<span class="keywordtype">double</span>*)malloc(numStep*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01317"></a>01317         error = ex_get_glob_var_time(exoid, j+1, 1, -1, data);
<a name="l01318"></a>01318         <span class="keywordflow">if</span> (error != 0) {
<a name="l01319"></a>01319           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get global var '%s'"</span>,
<a name="l01320"></a>01320                                 var_names[j]);
<a name="l01321"></a>01321           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01322"></a>01322         }
<a name="l01323"></a>01323         <span class="keywordflow">for</span> (m = 0; m &lt; numStep; m++) {
<a name="l01324"></a>01324        <span class="comment">//not lazily loaded so do not set committed flag</span>
<a name="l01325"></a>01325           rc = <a class="code" href="group__Variable.html#g3f958d3b630c9df78a4e7fbca287b039" title="Set the variable data by copy.">fc_setVariableData</a>(seqVar[m], 1, 1, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6ac55a57488add4ea9f01eac5c9eab232">FC_AT_WHOLE_DATASET</a>, 
<a name="l01326"></a>01326                       <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb206d3b58fc952172de6c4a1b3f75b8b5b2">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>, (<span class="keywordtype">void</span>**)&amp;data[m]);
<a name="l01327"></a>01327           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01328"></a>01328             <span class="keywordflow">return</span> rc;
<a name="l01329"></a>01329         }
<a name="l01330"></a>01330         free(seqVar);
<a name="l01331"></a>01331       }
<a name="l01332"></a>01332       <span class="comment">// Non-globals</span>
<a name="l01333"></a>01333       <span class="keywordflow">else</span> {
<a name="l01334"></a>01334         <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++) {
<a name="l01335"></a>01335           <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *seqVar;
<a name="l01336"></a>01336           
<a name="l01337"></a>01337           <span class="comment">// skip zero entries in truth table (don't really exist)</span>
<a name="l01338"></a>01338           <span class="keywordflow">if</span> (elem_truth_tab &amp;&amp; elem_truth_tab[k*numVar+j] == 0)
<a name="l01339"></a>01339             <span class="keywordflow">continue</span>;
<a name="l01340"></a>01340           <span class="comment">//does not set var data</span>
<a name="l01341"></a>01341           rc = <a class="code" href="group__Variable.html#g05d5098e68c1761ac851b2509dfbea70" title="Create a new sequence variable.">fc_createSeqVariable</a>(meshes[k], sequence, var_names[j], &amp;numStep,
<a name="l01342"></a>01342                                     &amp;seqVar);
<a name="l01343"></a>01343           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01344"></a>01344             <span class="keywordflow">return</span> rc;
<a name="l01345"></a>01345           <span class="keywordflow">for</span> (m = 0; m &lt; numStep; m++) {
<a name="l01346"></a>01346             <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(seqVar[m]);
<a name="l01347"></a>01347             strcpy(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType, exoVarTypes[i]);
<a name="l01348"></a>01348             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varIndex = j + 1;
<a name="l01349"></a>01349             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a> = numDatas[k];
<a name="l01350"></a>01350             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> = 1;
<a name="l01351"></a>01351             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#c9e804c6a08dd9757651d15d09963015">assoc</a> = fcVarTypes[i];
<a name="l01352"></a>01352             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#dc53e54a808b2a065c1c8965ab240b7e">mathtype</a> = <a class="code" href="group__DataTypes.html#gg60d16c50c365cd12f1f61ce8f4cebb206d3b58fc952172de6c4a1b3f75b8b5b2">FC_MT_SCALAR</a>;
<a name="l01353"></a>01353             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#d008d3f8bcab7eafced67cbb267b5cbc">datatype</a> = <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>;
<a name="l01354"></a>01354          <span class="comment">//non-globals are laily loaded so set committed flag</span>
<a name="l01355"></a>01355             varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l01356"></a>01356           }
<a name="l01357"></a>01357           free(seqVar);
<a name="l01358"></a>01358         } <span class="comment">// end of loop over meshes</span>
<a name="l01359"></a>01359       }
<a name="l01360"></a>01360       free(var_names[j]);
<a name="l01361"></a>01361       free(data);
<a name="l01362"></a>01362     } <span class="comment">// end of loop over vars for type i</span>
<a name="l01363"></a>01363     free(elem_truth_tab);
<a name="l01364"></a>01364     free(var_names);
<a name="l01365"></a>01365   } <span class="comment">// end of creating vars</span>
<a name="l01366"></a>01366   
<a name="l01367"></a>01367   <span class="comment">// cleanup</span>
<a name="l01368"></a>01368   free(meshes);
<a name="l01369"></a>01369   free(numVerts);
<a name="l01370"></a>01370   free(numElems);
<a name="l01371"></a>01371   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++)
<a name="l01372"></a>01372     free(hasVerts[i]);
<a name="l01373"></a>01373   free(hasVerts);
<a name="l01374"></a>01374   
<a name="l01375"></a>01375   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01376"></a>01376 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gdee0424e9d65ee7546d14aaa8f0ea376"></a><!-- doxytag: member="exodusio.c::_fc_readExodusAttributeData" ref="gdee0424e9d65ee7546d14aaa8f0ea376" args="(FC_Variable variable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusAttributeData           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>variable</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read attribute data from Exodus file into a basic variable. 
<p>
<b>Modifications:</b> <ul>
<li>09/04/2007 ACG Commencing.</li><li>10/03/2007 adding nodal attr </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>variable</em>&nbsp;</td><td>
input - variable to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01796">1796</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="variableP_8h-source.html#l00096">_FC_VarSlot::data</a>, <a class="el" href="variableP_8h-source.html#l00076">_FC_VarSlot::ds</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="variableP_8h-source.html#l00082">_FC_VarSlot::fileInfo</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="fileioP_8h-source.html#l00185">_FC_MeshFileIOInfo::id</a>, <a class="el" href="variableP_8h-source.html#l00077">_FC_VarSlot::mesh</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, <a class="el" href="variableP_8h-source.html#l00088">_FC_VarSlot::numComponent</a>, <a class="el" href="variableP_8h-source.html#l00084">_FC_VarSlot::numDataPoint</a>, <a class="el" href="meshP_8h-source.html#l00103">_FC_MeshSlot::numVertex</a>, and <a class="el" href="variableP_8h-source.html#l00080">_FC_VarSlot::stepID</a>.</p>

<p>Referenced by <a class="el" href="exodusio_8c-source.html#l01678">_fc_readExodusVariableData()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01798"></a>01798   {
<a name="l01799"></a>01799 
<a name="l01800"></a>01800   <span class="keywordtype">int</span> error;
<a name="l01801"></a>01801   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01802"></a>01802   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l01803"></a>01803   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01804"></a>01804   <span class="keywordtype">double</span>* data;
<a name="l01805"></a>01805   <span class="keywordtype">int</span> exoid;
<a name="l01806"></a>01806 
<a name="l01807"></a>01807   <span class="comment">// check input</span>
<a name="l01808"></a>01808   varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(variable);
<a name="l01809"></a>01809   <span class="keywordflow">if</span> (!varSlot || !varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01810"></a>01810     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>)); 
<a name="l01811"></a>01811     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01812"></a>01812   }
<a name="l01813"></a>01813   <span class="keywordflow">if</span> (varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> &gt; 1) {
<a name="l01814"></a>01814     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"lazy read of exodus data can't handle multicomp"</span>);
<a name="l01815"></a>01815     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01816"></a>01816   }
<a name="l01817"></a>01817   <span class="keywordflow">if</span> (varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#ad6e1772eae1748e6277591ab8bd0f13">stepID</a> &gt;= 0) {
<a name="l01818"></a>01818     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error? shouldn't call this on "</span>
<a name="l01819"></a>01819                           <span class="stringliteral">"sequence variables"</span>);
<a name="l01820"></a>01820     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01821"></a>01821   }
<a name="l01822"></a>01822   
<a name="l01823"></a>01823   <span class="comment">// log message</span>
<a name="l01824"></a>01824   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Reading data for variable '%s'"</span>,
<a name="l01825"></a>01825                       varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01826"></a>01826 
<a name="l01827"></a>01827 
<a name="l01828"></a>01828   <span class="comment">//only works on elem or nodal attr for now</span>
<a name="l01829"></a>01829 
<a name="l01830"></a>01830   <span class="keywordflow">if</span> ( strcmp(<span class="stringliteral">"e"</span>, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType) &amp;&amp;
<a name="l01831"></a>01831        strcmp(<span class="stringliteral">"n"</span>, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType) ){
<a name="l01832"></a>01832     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01833"></a>01833   }
<a name="l01834"></a>01834 
<a name="l01835"></a>01835   <span class="comment">// setup</span>
<a name="l01836"></a>01836   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7bbfd42034d39ff3b44f750f50b2382f">ds</a>);
<a name="l01837"></a>01837   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7afb59f267464c49b3546acca51e985c">mesh</a>);
<a name="l01838"></a>01838   exoid = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid;
<a name="l01839"></a>01839 
<a name="l01840"></a>01840   <span class="comment">// for Element variables, just get this block's data</span>
<a name="l01841"></a>01841   <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">"e"</span>, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType)) {
<a name="l01842"></a>01842     data = (<span class="keywordtype">double</span>*)malloc(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01843"></a>01843     <span class="keywordflow">if</span> (!data){
<a name="l01844"></a>01844       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01845"></a>01845       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01846"></a>01846     }
<a name="l01847"></a>01847     error = ex_get_one_elem_attr(exoid, 
<a name="l01848"></a>01848                      meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>,
<a name="l01849"></a>01849                      varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.attrIndex,
<a name="l01850"></a>01850                      data);
<a name="l01851"></a>01851     <span class="keywordflow">if</span> (error != 0) {
<a name="l01852"></a>01852       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get element var data"</span>);
<a name="l01853"></a>01853       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01854"></a>01854     }
<a name="l01855"></a>01855 
<a name="l01856"></a>01856   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">"n"</span>, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType)) {
<a name="l01857"></a>01857     <span class="comment">// For nodal attr have to read data for all nodes </span>
<a name="l01858"></a>01858     <span class="keywordtype">double</span>* global_data;
<a name="l01859"></a>01859     <span class="keywordtype">int</span> numTotalVert;
<a name="l01860"></a>01860     <span class="keywordtype">int</span> *vertIDs;
<a name="l01861"></a>01861     <span class="keywordtype">int</span> i;
<a name="l01862"></a>01862     
<a name="l01863"></a>01863     numTotalVert = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numTotalVert;
<a name="l01864"></a>01864     vertIDs = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID];
<a name="l01865"></a>01865 
<a name="l01866"></a>01866     data = (<span class="keywordtype">double</span>*)malloc(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01867"></a>01867     global_data = (<span class="keywordtype">double</span>*)malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01868"></a>01868     <span class="keywordflow">if</span> (!data || !global_data) {
<a name="l01869"></a>01869       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01870"></a>01870       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01871"></a>01871     }
<a name="l01872"></a>01872 
<a name="l01873"></a>01873     error = ex_get_one_attr(exoid, EX_NODAL, 0, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.attrIndex,
<a name="l01874"></a>01874                              global_data);
<a name="l01875"></a>01875     <span class="keywordflow">if</span> (error != 0) {
<a name="l01876"></a>01876       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get nodal var data"</span>);
<a name="l01877"></a>01877       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01878"></a>01878     }
<a name="l01879"></a>01879 
<a name="l01880"></a>01880     <span class="keywordflow">for</span> (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#049ca8ef52b92d19b06858e8a1cc2ea5">numVertex</a>; i++)
<a name="l01881"></a>01881       data[i] = global_data[vertIDs[i]];
<a name="l01882"></a>01882     free(global_data);
<a name="l01883"></a>01883 
<a name="l01884"></a>01884   } <span class="keywordflow">else</span> {
<a name="l01885"></a>01885     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Unknown exoVarType encountered"</span>);
<a name="l01886"></a>01886     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01887"></a>01887   }
<a name="l01888"></a>01888 
<a name="l01889"></a>01889   <span class="comment">// all done</span>
<a name="l01890"></a>01890   varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#b9cf193ccf780bc94dfa5af56fc33ab2">data</a> = data;
<a name="l01891"></a>01891 
<a name="l01892"></a>01892   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01893"></a>01893 
<a name="l01894"></a>01894 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g552ca932d62828fdedb4561a02c94a51"></a><!-- doxytag: member="exodusio.c::_fc_readExodusMeshCoords" ref="g552ca932d62828fdedb4561a02c94a51" args="(FC_Mesh mesh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusMeshCoords           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from Exodus file into a mesh. 
<p>
<b>Modifications:</b> <ul>
<li>8/8/2005 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01426">1426</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="meshP_8h-source.html#l00112">_FC_MeshSlot::coords</a>, <a class="el" href="meshP_8h-source.html#l00100">_FC_MeshSlot::dim</a>, <a class="el" href="meshP_8h-source.html#l00096">_FC_MeshSlot::ds</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="meshP_8h-source.html#l00095">_FC_MeshSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="meshP_8h-source.html#l00103">_FC_MeshSlot::numVertex</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l02006">_fc_readMeshCoords()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01428"></a>01428   {
<a name="l01429"></a>01429   <span class="keywordtype">int</span> error;
<a name="l01430"></a>01430   <span class="keywordtype">int</span> i, j;
<a name="l01431"></a>01431   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l01432"></a>01432   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01433"></a>01433   <span class="keywordtype">int</span>* vertIDs; 
<a name="l01434"></a>01434   <span class="keywordtype">double</span> *global_coords[3];
<a name="l01435"></a>01435 
<a name="l01436"></a>01436   <span class="comment">// check input</span>
<a name="l01437"></a>01437   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(mesh);
<a name="l01438"></a>01438   <span class="keywordflow">if</span> (!meshSlot || !meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01439"></a>01439     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01440"></a>01440     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01441"></a>01441   }
<a name="l01442"></a>01442   
<a name="l01443"></a>01443   <span class="comment">// log message</span>
<a name="l01444"></a>01444   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Reading coords for mesh '%s'"</span>, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01445"></a>01445 
<a name="l01446"></a>01446   <span class="comment">// setup</span>
<a name="l01447"></a>01447   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8e636c6228614117c3f0632c33b01554">ds</a>);
<a name="l01448"></a>01448   vertIDs = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID];
<a name="l01449"></a>01449   
<a name="l01450"></a>01450   <span class="comment">// get global coords</span>
<a name="l01451"></a>01451   <span class="keywordflow">for</span> (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8a59779a8f5f511a1fff4c886e8897ec">dim</a>; i++)
<a name="l01452"></a>01452     global_coords[i] = (<span class="keywordtype">double</span>*)malloc(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01453"></a>01453   error = ex_get_coord(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid, global_coords[0],
<a name="l01454"></a>01454                        global_coords[1], global_coords[2]);
<a name="l01455"></a>01455   <span class="keywordflow">if</span> (error != 0) {
<a name="l01456"></a>01456     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get global coords"</span>);
<a name="l01457"></a>01457     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01458"></a>01458   }
<a name="l01459"></a>01459 
<a name="l01460"></a>01460   <span class="comment">// Make local coords array</span>
<a name="l01461"></a>01461   meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#382cfacaa5639ea6dabe6347dc21e440">coords</a> = (<span class="keywordtype">double</span>*)malloc(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#049ca8ef52b92d19b06858e8a1cc2ea5">numVertex</a>*meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8a59779a8f5f511a1fff4c886e8897ec">dim</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01462"></a>01462   <span class="keywordflow">if</span> (!meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#382cfacaa5639ea6dabe6347dc21e440">coords</a>) {
<a name="l01463"></a>01463     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01464"></a>01464     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01465"></a>01465   }
<a name="l01466"></a>01466   <span class="keywordflow">for</span> (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#049ca8ef52b92d19b06858e8a1cc2ea5">numVertex</a>; i++)
<a name="l01467"></a>01467     <span class="keywordflow">for</span> (j = 0; j &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8a59779a8f5f511a1fff4c886e8897ec">dim</a>; j++)
<a name="l01468"></a>01468       meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#382cfacaa5639ea6dabe6347dc21e440">coords</a>[i*meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8a59779a8f5f511a1fff4c886e8897ec">dim</a> + j] = global_coords[j][vertIDs[i]];
<a name="l01469"></a>01469   <span class="comment">// vertIDs[local_per_mesh_number(beginning at zero)] = exonumber</span>
<a name="l01470"></a>01470 
<a name="l01471"></a>01471   <span class="comment">// cleanup</span>
<a name="l01472"></a>01472   for (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8a59779a8f5f511a1fff4c886e8897ec">dim</a>; i++)
<a name="l01473"></a>01473     free(global_coords[i]);
<a name="l01474"></a>01474 
<a name="l01475"></a>01475   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01476"></a>01476 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfa43b49bccf83d3454349892a2fdf800"></a><!-- doxytag: member="exodusio.c::_fc_readExodusMeshElemConns" ref="gfa43b49bccf83d3454349892a2fdf800" args="(FC_Mesh mesh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusMeshElemConns           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from Exodus file into a mesh. 
<p>
<b>Modifications:</b> <ul>
<li>8/8/2005 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01485">1485</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="meshP_8h-source.html#l00096">_FC_MeshSlot::ds</a>, <a class="el" href="meshP_8h-source.html#l00116">_FC_MeshSlot::elemToVertConns</a>, <a class="el" href="meshP_8h-source.html#l00105">_FC_MeshSlot::elemType</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="base_8c-source.html#l00550">fc_getElementTypeNumVertex()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="meshP_8h-source.html#l00095">_FC_MeshSlot::header</a>, <a class="el" href="fileioP_8h-source.html#l00185">_FC_MeshFileIOInfo::id</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, <a class="el" href="meshP_8h-source.html#l00104">_FC_MeshSlot::numElement</a>, and <a class="el" href="meshP_8h-source.html#l00103">_FC_MeshSlot::numVertex</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l02057">_fc_readMeshElemConns()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01487"></a>01487   {
<a name="l01488"></a>01488   <span class="keywordtype">int</span> error;
<a name="l01489"></a>01489   <span class="keywordtype">int</span> i;
<a name="l01490"></a>01490   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l01491"></a>01491   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01492"></a>01492   <span class="keywordtype">int</span> numVertPerElem, numVert, numTotalVert;
<a name="l01493"></a>01493   <span class="keywordtype">int</span>* hasVert, *conns;
<a name="l01494"></a>01494 
<a name="l01495"></a>01495   <span class="comment">// check input</span>
<a name="l01496"></a>01496   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(mesh);
<a name="l01497"></a>01497   <span class="keywordflow">if</span> (!meshSlot || !meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01498"></a>01498     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01499"></a>01499     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01500"></a>01500   }
<a name="l01501"></a>01501   
<a name="l01502"></a>01502   <span class="comment">// log message</span>
<a name="l01503"></a>01503   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Reading coords for mesh '%s'"</span>, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01504"></a>01504 
<a name="l01505"></a>01505   <span class="comment">// setup</span>
<a name="l01506"></a>01506   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8e636c6228614117c3f0632c33b01554">ds</a>);
<a name="l01507"></a>01507   numTotalVert = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numTotalVert;
<a name="l01508"></a>01508   numVertPerElem = <a class="code" href="group__DataTypes.html#g2a400f7126e79f149032162c87c4eee8" title="Returns number of vertices in a type of element.">fc_getElementTypeNumVertex</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a>);
<a name="l01509"></a>01509   
<a name="l01510"></a>01510   <span class="comment">// read global conns (conns for just this blk, but has global ids)</span>
<a name="l01511"></a>01511   conns = (<span class="keywordtype">int</span>*)malloc(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a>*numVertPerElem*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01512"></a>01512   <span class="keywordflow">if</span> (!conns) {
<a name="l01513"></a>01513     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01514"></a>01514     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01515"></a>01515   }      
<a name="l01516"></a>01516   error = ex_get_elem_conn(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid, 
<a name="l01517"></a>01517                            meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>, conns);
<a name="l01518"></a>01518   <span class="keywordflow">if</span> (error != 0) {
<a name="l01519"></a>01519     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get elem conns"</span>);
<a name="l01520"></a>01520     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01521"></a>01521   }
<a name="l01522"></a>01522   
<a name="l01523"></a>01523   <span class="comment">// Make a vertLU table</span>
<a name="l01524"></a>01524   hasVert = (<span class="keywordtype">int</span>*)malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01525"></a>01525   <span class="keywordflow">if</span> (!hasVert) {
<a name="l01526"></a>01526     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01527"></a>01527     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01528"></a>01528   }
<a name="l01529"></a>01529   <span class="keywordflow">for</span> (i = 0; i &lt; numTotalVert; i++)
<a name="l01530"></a>01530     hasVert[i] = -1;
<a name="l01531"></a>01531   <span class="keywordflow">for</span> (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a>*numVertPerElem; i++)
<a name="l01532"></a>01532     hasVert[conns[i]-1] = 1;
<a name="l01533"></a>01533   numVert = 0;
<a name="l01534"></a>01534   <span class="keywordflow">for</span> (i = 0; i &lt; numTotalVert; i++) {
<a name="l01535"></a>01535     <span class="keywordflow">if</span> (hasVert[i] &gt; 0) {
<a name="l01536"></a>01536       hasVert[i] = numVert;
<a name="l01537"></a>01537       numVert++;
<a name="l01538"></a>01538     }
<a name="l01539"></a>01539   }
<a name="l01540"></a>01540   <span class="keywordflow">if</span> (numVert != meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#049ca8ef52b92d19b06858e8a1cc2ea5">numVertex</a>) {
<a name="l01541"></a>01541     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error!"</span>);
<a name="l01542"></a>01542     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01543"></a>01543   }
<a name="l01544"></a>01544 
<a name="l01545"></a>01545   <span class="comment">// Convert global conns to local conns</span>
<a name="l01546"></a>01546   <span class="keywordflow">for</span> (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a>*numVertPerElem; i++) 
<a name="l01547"></a>01547     conns[i] = hasVert[conns[i]-1];
<a name="l01548"></a>01548   meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#16994ed8faff29b6b21ccb053ab45ba5">elemToVertConns</a> = conns;
<a name="l01549"></a>01549 
<a name="l01550"></a>01550   <span class="comment">// cleanup</span>
<a name="l01551"></a>01551   free(hasVert);
<a name="l01552"></a>01552 
<a name="l01553"></a>01553   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01554"></a>01554 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd7165f2bfd1391ed0214b5e76ae6156f"></a><!-- doxytag: member="exodusio.c::_fc_readExodusOneStepVariableData" ref="gd7165f2bfd1391ed0214b5e76ae6156f" args="(FC_Variable variable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusOneStepVariableData           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>variable</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from Exodus file into one step of a seq variable. 
<p>
<b>Modifications:</b> <ul>
<li>9/2/2005 WSD Created.</li><li>9/9/2007 ACG renamed to this from _fc_readExodusVariableData </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>variable</em>&nbsp;</td><td>
input - variable to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01706">1706</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="variableP_8h-source.html#l00096">_FC_VarSlot::data</a>, <a class="el" href="variableP_8h-source.html#l00076">_FC_VarSlot::ds</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="variableP_8h-source.html#l00082">_FC_VarSlot::fileInfo</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="fileioP_8h-source.html#l00185">_FC_MeshFileIOInfo::id</a>, <a class="el" href="variableP_8h-source.html#l00077">_FC_VarSlot::mesh</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, <a class="el" href="variableP_8h-source.html#l00088">_FC_VarSlot::numComponent</a>, <a class="el" href="variableP_8h-source.html#l00084">_FC_VarSlot::numDataPoint</a>, <a class="el" href="meshP_8h-source.html#l00104">_FC_MeshSlot::numElement</a>, <a class="el" href="meshP_8h-source.html#l00103">_FC_MeshSlot::numVertex</a>, and <a class="el" href="variableP_8h-source.html#l00080">_FC_VarSlot::stepID</a>.</p>

<p>Referenced by <a class="el" href="exodusio_8c-source.html#l01678">_fc_readExodusVariableData()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01708"></a>01708   {
<a name="l01709"></a>01709   <span class="keywordtype">int</span> error;
<a name="l01710"></a>01710   <span class="keywordtype">int</span> i;
<a name="l01711"></a>01711   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01712"></a>01712   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l01713"></a>01713   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01714"></a>01714   <span class="keywordtype">double</span>* global_data, *data;
<a name="l01715"></a>01715   <span class="keywordtype">int</span> exoid, exoStepID, *vertIDs, numTotalVert;
<a name="l01716"></a>01716 
<a name="l01717"></a>01717 
<a name="l01718"></a>01718   <span class="comment">// check input</span>
<a name="l01719"></a>01719   varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(variable);
<a name="l01720"></a>01720   <span class="keywordflow">if</span> (!varSlot || !varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01721"></a>01721     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01722"></a>01722     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01723"></a>01723   }
<a name="l01724"></a>01724   <span class="keywordflow">if</span> (varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7c8e3668b0bc0c037d671ee75af96279">numComponent</a> &gt; 1) {
<a name="l01725"></a>01725     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"lazy read of exodus data can't handle multicomp"</span>);
<a name="l01726"></a>01726     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01727"></a>01727   }
<a name="l01728"></a>01728   <span class="keywordflow">if</span> (varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#ad6e1772eae1748e6277591ab8bd0f13">stepID</a> &lt; 0) {
<a name="l01729"></a>01729     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error? shouldn't call this on non "</span>
<a name="l01730"></a>01730                  <span class="stringliteral">"sequence variables"</span>);
<a name="l01731"></a>01731     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01732"></a>01732   }
<a name="l01733"></a>01733   
<a name="l01734"></a>01734   <span class="comment">// log message</span>
<a name="l01735"></a>01735   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Reading data for variable '%s'"</span>,
<a name="l01736"></a>01736                       varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01737"></a>01737 
<a name="l01738"></a>01738   <span class="comment">// setup</span>
<a name="l01739"></a>01739   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7bbfd42034d39ff3b44f750f50b2382f">ds</a>);
<a name="l01740"></a>01740   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#7afb59f267464c49b3546acca51e985c">mesh</a>);
<a name="l01741"></a>01741   exoid = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid;
<a name="l01742"></a>01742   exoStepID = varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#ad6e1772eae1748e6277591ab8bd0f13">stepID</a> + 1;
<a name="l01743"></a>01743   numTotalVert = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numTotalVert;
<a name="l01744"></a>01744   vertIDs = dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID];
<a name="l01745"></a>01745 
<a name="l01746"></a>01746   <span class="comment">// Read the step's data</span>
<a name="l01747"></a>01747   <span class="comment">// For nodal variables, have to read data for all nodes </span>
<a name="l01748"></a>01748   <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">"n"</span>, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType)) {
<a name="l01749"></a>01749     data = (<span class="keywordtype">double</span>*)malloc(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01750"></a>01750     global_data = (<span class="keywordtype">double</span>*)malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01751"></a>01751     <span class="keywordflow">if</span> (!data || !global_data) {
<a name="l01752"></a>01752       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01753"></a>01753       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01754"></a>01754     }
<a name="l01755"></a>01755     error = ex_get_nodal_var(exoid, exoStepID, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varIndex,
<a name="l01756"></a>01756                              numTotalVert, global_data);
<a name="l01757"></a>01757     <span class="keywordflow">if</span> (error != 0) {
<a name="l01758"></a>01758       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get nodal var data"</span>);
<a name="l01759"></a>01759       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01760"></a>01760     }
<a name="l01761"></a>01761     <span class="keywordflow">for</span> (i = 0; i &lt; meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#049ca8ef52b92d19b06858e8a1cc2ea5">numVertex</a>; i++)
<a name="l01762"></a>01762       data[i] = global_data[vertIDs[i]];
<a name="l01763"></a>01763     free(global_data);
<a name="l01764"></a>01764   }
<a name="l01765"></a>01765   <span class="comment">// for Element variables, just get this block's data</span>
<a name="l01766"></a>01766   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">"e"</span>, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varType)) {
<a name="l01767"></a>01767     data = (<span class="keywordtype">double</span>*)malloc(varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#f2987ccafac1c49c016fc2e3fcd218ac">numDataPoint</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01768"></a>01768     error = ex_get_elem_var(exoid, exoStepID, varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#2aac8de3eb10b6da62f9a444879237f2">fileInfo</a>.exoInfo.varIndex,
<a name="l01769"></a>01769                             meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>,
<a name="l01770"></a>01770                             meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a>, data);
<a name="l01771"></a>01771     <span class="keywordflow">if</span> (error != 0) {
<a name="l01772"></a>01772       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get element var data"</span>);
<a name="l01773"></a>01773       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01774"></a>01774     }
<a name="l01775"></a>01775   }
<a name="l01776"></a>01776   <span class="keywordflow">else</span> {
<a name="l01777"></a>01777     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Unknown exoVarType encountered"</span>);
<a name="l01778"></a>01778     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01779"></a>01779   }
<a name="l01780"></a>01780 
<a name="l01781"></a>01781   <span class="comment">// all done</span>
<a name="l01782"></a>01782   varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#b9cf193ccf780bc94dfa5af56fc33ab2">data</a> = data;
<a name="l01783"></a>01783 
<a name="l01784"></a>01784   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01785"></a>01785 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gccb80670c54f713d0546b6fa779af150"></a><!-- doxytag: member="exodusio.c::_fc_readExodusSequenceCoords" ref="gccb80670c54f713d0546b6fa779af150" args="(FC_Sequence sequence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusSequenceCoords           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Sequence.html">FC_Sequence</a>&nbsp;</td>
          <td class="paramname"> <em>sequence</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from Exodus file into a sequence. 
<p>
<b>Modifications:</b> <ul>
<li>8/8/2005 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>sequence</em>&nbsp;</td><td>
input - sequence to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01385">1385</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="sequence_8c-source.html#l02142">_fc_getSeqSlot()</a>, <a class="el" href="sequenceP_8h-source.html#l00084">_FC_SeqSlot::coords</a>, <a class="el" href="sequenceP_8h-source.html#l00076">_FC_SeqSlot::ds</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="sequenceP_8h-source.html#l00075">_FC_SeqSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="sequenceP_8h-source.html#l00080">_FC_SeqSlot::numStep</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l01956">_fc_readSequenceCoords()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01387"></a>01387   {
<a name="l01388"></a>01388   <span class="keywordtype">int</span> error;
<a name="l01389"></a>01389   <a class="code" href="struct__FC__SeqSlot.html" title="Sequence Slot Structure for the Sequence Table.">_FC_SeqSlot</a>* seqSlot;
<a name="l01390"></a>01390   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01391"></a>01391   <span class="keywordtype">double</span>* times;
<a name="l01392"></a>01392 
<a name="l01393"></a>01393   <span class="comment">// check input</span>
<a name="l01394"></a>01394   seqSlot = <a class="code" href="group__PrivateSequence.html#g311b52c3aa6307afba63b26ad035afe5" title="Get a sequence slot from a sequence handle.">_fc_getSeqSlot</a>(sequence);
<a name="l01395"></a>01395   <span class="keywordflow">if</span> (!seqSlot || !seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c5e5166b76af0f8c08946df88105d729">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01396"></a>01396     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01397"></a>01397     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01398"></a>01398   }
<a name="l01399"></a>01399   
<a name="l01400"></a>01400   <span class="comment">// log message</span>
<a name="l01401"></a>01401   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Reading coords for sequence '%s'"</span>, seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#c5e5166b76af0f8c08946df88105d729">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01402"></a>01402   
<a name="l01403"></a>01403   <span class="comment">// setup</span>
<a name="l01404"></a>01404   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#2897f87e3063786bb2375f3b98342738">ds</a>);
<a name="l01405"></a>01405   
<a name="l01406"></a>01406   <span class="comment">// get the sequence coords</span>
<a name="l01407"></a>01407   times = malloc(seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#ca6023886cf92e3f25c09d9a315e3631">numStep</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l01408"></a>01408   error = ex_get_all_times(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid, times);
<a name="l01409"></a>01409   <span class="keywordflow">if</span> (error != 0) {
<a name="l01410"></a>01410     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get time values"</span>);
<a name="l01411"></a>01411     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01412"></a>01412   }
<a name="l01413"></a>01413   
<a name="l01414"></a>01414   <span class="comment">// don't have to do anything!</span>
<a name="l01415"></a>01415   seqSlot-&gt;<a class="code" href="struct__FC__SeqSlot.html#41434461d092594ae5c6f7475bfe05fd">coords</a> = times;
<a name="l01416"></a>01416   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01417"></a>01417 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g1fb7acca15741da6a991172a374b72ab"></a><!-- doxytag: member="exodusio.c::_fc_readExodusSubsetMembers" ref="g1fb7acca15741da6a991172a374b72ab" args="(FC_Subset subset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusSubsetMembers           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from Exodus file into a subset. 
<p>
<b>Description:</b> <p>
Lazy read only for side sets. Node and elem sets are handled on initial load.<p>
<b>Modifications:</b> <ul>
<li>8/30/2005 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01567">1567</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="subset_8c-source.html#l03800">_fc_getSubSlot()</a>, <a class="el" href="meshP_8h-source.html#l00096">_FC_MeshSlot::ds</a>, <a class="el" href="storage_8c-source.html#l00397">fc_addIntToSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="base_8c-source.html#l00586">fc_getElementTypeNumEdge()</a>, <a class="el" href="base_8c-source.html#l00622">fc_getElementTypeNumFace()</a>, <a class="el" href="base_8c-source.html#l00514">fc_getElementTypeTopoDim()</a>, <a class="el" href="mesh_8c-source.html#l03821">fc_getMeshElementToEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03880">fc_getMeshElementToFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03061">fc_getMeshElementType()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="subsetP_8h-source.html#l00079">_FC_SubSlot::fileInfo</a>, <a class="el" href="subsetP_8h-source.html#l00074">_FC_SubSlot::header</a>, <a class="el" href="subsetP_8h-source.html#l00075">_FC_SubSlot::mesh</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, <a class="el" href="meshP_8h-source.html#l00104">_FC_MeshSlot::numElement</a>, <a class="el" href="subsetP_8h-source.html#l00082">_FC_SubSlot::numMember</a>, <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>, and <a class="el" href="subsetP_8h-source.html#l00087">_FC_SubSlot::sia</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l02108">_fc_readSubsetMembers()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01569"></a>01569   {
<a name="l01570"></a>01570   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01571"></a>01571   <span class="keywordtype">int</span> error, ret;
<a name="l01572"></a>01572   <span class="keywordtype">int</span> i;
<a name="l01573"></a>01573   <a class="code" href="struct__FC__SubSlot.html" title="Struct describing subset elements.">_FC_SubSlot</a>* subSlot;
<a name="l01574"></a>01574   <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l01575"></a>01575   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01576"></a>01576   <span class="keywordtype">int</span> elemOffset;
<a name="l01577"></a>01577   <span class="keywordtype">int</span> numSide, numDistFactor, topoDim;
<a name="l01578"></a>01578   <span class="keywordtype">int</span> *elemIDs, *sideIDs;
<a name="l01579"></a>01579   <span class="keywordtype">int</span> numEntityPerElem, *elemToEntityConns;
<a name="l01580"></a>01580   <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l01581"></a>01581 
<a name="l01582"></a>01582   <span class="comment">// check input</span>
<a name="l01583"></a>01583   subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(subset);
<a name="l01584"></a>01584   <span class="keywordflow">if</span> (!subSlot || !subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01585"></a>01585     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01586"></a>01586     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01587"></a>01587   }
<a name="l01588"></a>01588   <span class="keywordflow">if</span> (subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.assoc_flag != 1) {
<a name="l01589"></a>01589     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error? can only lazy read side sets ("</span>
<a name="l01590"></a>01590                           <span class="stringliteral">"edges or faces)"</span>);
<a name="l01591"></a>01591     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01592"></a>01592   }
<a name="l01593"></a>01593   
<a name="l01594"></a>01594   <span class="comment">// log message</span>
<a name="l01595"></a>01595   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Reading members for subset '%s'"</span>, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01596"></a>01596 
<a name="l01597"></a>01597   <span class="comment">// setup</span>
<a name="l01598"></a>01598   meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>);
<a name="l01599"></a>01599   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#8e636c6228614117c3f0632c33b01554">ds</a>);
<a name="l01600"></a>01600   elemOffset = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset;
<a name="l01601"></a>01601   rc = <a class="code" href="group__Mesh.html#g1c1684ecf98e82a0ab18f7f9dbdddfc5" title="Returns type of elements in the mesh.">fc_getMeshElementType</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;elemType);
<a name="l01602"></a>01602   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01603"></a>01603     <span class="keywordflow">return</span> rc;
<a name="l01604"></a>01604   topoDim = <a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType);
<a name="l01605"></a>01605   <span class="keywordflow">if</span> (topoDim == 2) {
<a name="l01606"></a>01606     numEntityPerElem = <a class="code" href="group__DataTypes.html#gf2ce1082614c4a5cd5481c00c89a7e67" title="Returns number of edges in a type of element.">fc_getElementTypeNumEdge</a>(elemType);
<a name="l01607"></a>01607     rc = <a class="code" href="group__Mesh.html#gcc3f8cb48b0c2673d9e0ce0d4eba2878" title="Return element to edge connectivities.">fc_getMeshElementToEdgeConnsPtr</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;elemToEntityConns);
<a name="l01608"></a>01608     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01609"></a>01609       <span class="keywordflow">return</span> rc;
<a name="l01610"></a>01610   }
<a name="l01611"></a>01611   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topoDim == 3) {
<a name="l01612"></a>01612     numEntityPerElem = <a class="code" href="group__DataTypes.html#g1cffd2eb82ec74e749ca93a6cb623e4a" title="Returns number of faces in a type of element.">fc_getElementTypeNumFace</a>(elemType);
<a name="l01613"></a>01613     rc = <a class="code" href="group__Mesh.html#g7f17910148b4237e84ca374845688cfc" title="Return element to face connectivities.">fc_getMeshElementToFaceConnsPtr</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;elemToEntityConns);
<a name="l01614"></a>01614     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01615"></a>01615       <span class="keywordflow">return</span> rc;
<a name="l01616"></a>01616   }
<a name="l01617"></a>01617   <span class="keywordflow">else</span> {
<a name="l01618"></a>01618     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error? unexpected topo dim"</span>);
<a name="l01619"></a>01619     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01620"></a>01620   }
<a name="l01621"></a>01621 
<a name="l01622"></a>01622   <span class="comment">// Read members</span>
<a name="l01623"></a>01623   error = ex_get_side_set_param(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid, 
<a name="l01624"></a>01624                                 subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid, &amp;numSide,
<a name="l01625"></a>01625                                 &amp;numDistFactor);
<a name="l01626"></a>01626   <span class="keywordflow">if</span> (error != 0) {
<a name="l01627"></a>01627     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get sides in side set"</span>);
<a name="l01628"></a>01628     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01629"></a>01629   }
<a name="l01630"></a>01630   elemIDs = (<span class="keywordtype">int</span>*)malloc(numSide*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01631"></a>01631   sideIDs = (<span class="keywordtype">int</span>*)malloc(numSide*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01632"></a>01632   <span class="keywordflow">if</span> (!elemIDs || !sideIDs) {
<a name="l01633"></a>01633     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01634"></a>01634     free(elemIDs); free(sideIDs);
<a name="l01635"></a>01635     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01636"></a>01636   }
<a name="l01637"></a>01637   error = ex_get_side_set(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid, 
<a name="l01638"></a>01638                           subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid, elemIDs, sideIDs);
<a name="l01639"></a>01639   <span class="keywordflow">if</span> (error != 0) {
<a name="l01640"></a>01640     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to get sides in side set"</span>);
<a name="l01641"></a>01641     free(elemIDs); free(sideIDs);
<a name="l01642"></a>01642     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01643"></a>01643   }
<a name="l01644"></a>01644 
<a name="l01645"></a>01645   <span class="comment">// Process just the sides for this mesh &amp; collect appropriate entity IDs</span>
<a name="l01646"></a>01646   <span class="keywordflow">for</span> (i = 0; i &lt; numSide; i++) {
<a name="l01647"></a>01647     <span class="keywordflow">if</span> (elemIDs[i] - 1 &gt;= elemOffset &amp;&amp; 
<a name="l01648"></a>01648         elemIDs[i] - 1 &lt;  elemOffset + meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#914b51c6fb5bd0c761db89c1486b9e78">numElement</a>) {
<a name="l01649"></a>01649       <span class="keywordtype">int</span> elemID = elemIDs[i] - 1 - elemOffset;
<a name="l01650"></a>01650       ret = <a class="code" href="group__SimpleDataObjects.html#gb73f9478dbfb63fadf5e93f8bdfe8c42" title="Add an int to a sorted int array.">fc_addIntToSortedIntArray</a>(&amp;subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#c1075cb184da39370ebf466be2ace9f1">sia</a>, 
<a name="l01651"></a>01651                elemToEntityConns[elemID*numEntityPerElem+sideIDs[i]-1]);
<a name="l01652"></a>01652       <span class="keywordflow">if</span> (ret &lt; 0) {
<a name="l01653"></a>01653         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to add ID to sia"</span>);
<a name="l01654"></a>01654         <span class="keywordflow">return</span> ret;
<a name="l01655"></a>01655       }
<a name="l01656"></a>01656     }
<a name="l01657"></a>01657   }
<a name="l01658"></a>01658   free(elemIDs);
<a name="l01659"></a>01659   free(sideIDs);
<a name="l01660"></a>01660   <span class="keywordflow">if</span> (subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#c1075cb184da39370ebf466be2ace9f1">sia</a>.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a> != subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#42e80e2eaa2cfcf5c3e8b3dfa22f8cfe">numMember</a>) {
<a name="l01661"></a>01661     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Error collecting mesh ids from global ids"</span>);
<a name="l01662"></a>01662     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l01663"></a>01663   }
<a name="l01664"></a>01664 
<a name="l01665"></a>01665   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01666"></a>01666 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge7a29d6ed0a3c554a884c8eddbe974c9"></a><!-- doxytag: member="exodusio.c::_fc_readExodusVariableData" ref="ge7a29d6ed0a3c554a884c8eddbe974c9" args="(FC_Variable variable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_readExodusVariableData           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>variable</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from Exodus file into a basic or one step of a seq variable. 
<p>
<b>Modifications:</b> <ul>
<li>9/2/2005 WSD Created.</li><li>9/9/2007 ACG turned into wrapper to split into basic or one step of seq var </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>variable</em>&nbsp;</td><td>
input - variable to be read into </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01678">1678</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="exodusio_8c-source.html#l01796">_fc_readExodusAttributeData()</a>, <a class="el" href="exodusio_8c-source.html#l01706">_fc_readExodusOneStepVariableData()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="variableP_8h-source.html#l00075">_FC_VarSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, and <a class="el" href="variableP_8h-source.html#l00080">_FC_VarSlot::stepID</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l02158">_fc_readVariableData()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01680"></a>01680   {
<a name="l01681"></a>01681   <a class="code" href="struct__FC__VarSlot.html" title="Variable Slot Structure for the Variable Table.">_FC_VarSlot</a>* varSlot;
<a name="l01682"></a>01682 
<a name="l01683"></a>01683   <span class="comment">// check input</span>
<a name="l01684"></a>01684   varSlot = <a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(variable);
<a name="l01685"></a>01685   <span class="keywordflow">if</span> (!varSlot || !varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#50d222efb8783e524916e62071f595c7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) {
<a name="l01686"></a>01686     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01687"></a>01687     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01688"></a>01688   }
<a name="l01689"></a>01689 
<a name="l01690"></a>01690   <span class="keywordflow">if</span> (varSlot-&gt;<a class="code" href="struct__FC__VarSlot.html#ad6e1772eae1748e6277591ab8bd0f13">stepID</a> &lt; 0) {
<a name="l01691"></a>01691     <span class="keywordflow">return</span> <a class="code" href="group__ExodusFileIO.html#gdee0424e9d65ee7546d14aaa8f0ea376" title="Read attribute data from Exodus file into a basic variable.">_fc_readExodusAttributeData</a>(variable);
<a name="l01692"></a>01692   } <span class="keywordflow">else</span> {
<a name="l01693"></a>01693     <span class="keywordflow">return</span> <a class="code" href="group__ExodusFileIO.html#gd7165f2bfd1391ed0214b5e76ae6156f" title="Read data from Exodus file into one step of a seq variable.">_fc_readExodusOneStepVariableData</a>(variable);
<a name="l01694"></a>01694   }
<a name="l01695"></a>01695 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gdf8bbffda1fb0c3fd88df9bd6c2a995a"></a><!-- doxytag: member="exodusio.c::_fc_writeExodusDataset" ref="gdf8bbffda1fb0c3fd88df9bd6c2a995a" args="(FC_Dataset dataset, char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_writeExodusDataset           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Dataset.html">FC_Dataset</a>&nbsp;</td>
          <td class="paramname"> <em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>filename</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write a dataset. 
<p>
<b>Description:</b> <p>
Writes out dataset to exodus file. Note: We do not combine node, elem, side sets by names -- why not? SequenceSubsets are first converted to normal subsets with postpended step number and then written out in the same way that subsets are written. Note that if the name is too long for exodus, this may get clipped. Note: currently ex_put_set only does anything if the set has numMember &gt; 0 therefore only doing this if numMember &gt; 0. If that changes, the call will have to be reinstantiated for non-empty subsets. I am bypassing the call currently becuase I cannot check the return on it because the return for an empty subset is EX_WARN which is defined in exodus's internal headers<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd><ul>
<li>Committed flag for seq vars and now non-seqvars. see what the issue is there.</li><li>perhaps shorten the seqsubset name before appending numbers</li><li>check empty side set write out</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>08/01/2005 WSD Created.</li><li>07/31/2007 ACG added elemblk attr writeouts for elem non seq vars</li><li>08/10/2007 ACG added nodal attr writeouts for vertex non seq vars</li><li>10/05/2007 ACG write out elem sets</li><li>10/17/2007 ACG removed names file</li><li>03/14/2007 ACG convert seqSubsets to subsets and write out</li><li>04/12/2008 ACG empty node and elem sets (not side set) writeout</li><li>05/12/2008 ACG empty side set writeout </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dataset</em>&nbsp;</td><td>
input - the dataset to be written </td></tr>
<tr><td valign="top"><em>filename</em>&nbsp;</td><td>
input - the file name (including path) to write into. </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="exodusio_8c-source.html#l01933">1933</a> of file <a class="el" href="exodusio_8c-source.html">exodusio.c</a>.</p>

<p>References <a class="el" href="exodusio_8c-source.html#l00270">_fc_createExoVarCompName()</a>, <a class="el" href="exodusio_8c-source.html#l00147">_fc_exo_seqVar_cmp()</a>, <a class="el" href="exodusio_8c-source.html#l00220">_fc_exo_seqVar_meshID_cmp()</a>, <a class="el" href="dataset_8c-source.html#l01029">_fc_getDsSlot()</a>, <a class="el" href="mesh_8c-source.html#l04444">_fc_getMeshElementParentsOfEdgesPtr()</a>, <a class="el" href="mesh_8c-source.html#l04509">_fc_getMeshElementParentsOfFacesPtr()</a>, <a class="el" href="mesh_8c-source.html#l06054">_fc_getMeshSlot()</a>, <a class="el" href="subset_8c-source.html#l03800">_fc_getSubSlot()</a>, <a class="el" href="variable_8c-source.html#l06536">_fc_getVarSlot()</a>, <a class="el" href="subsetP_8h-source.html#l00081">_FC_SubSlot::assoc</a>, <a class="el" href="datasetP_8h-source.html#l00081">_FC_DsSlot::baseFile</a>, <a class="el" href="storage_8h-source.html#l00128">FC_SortedBlobArray::blobs</a>, <a class="el" href="tableP_8h-source.html#l00104">_FC_SlotHeader::committed</a>, <a class="el" href="meshP_8h-source.html#l00105">_FC_MeshSlot::elemType</a>, <a class="el" href="storage_8c-source.html#l01115">fc_addBlobToSortedBlobArray()</a>, <a class="el" href="base_8h-source.html#l00192">FC_AT_EDGE</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00190">FC_AT_UNKNOWN</a>, <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00198">FC_AT_WHOLE_DATASET</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00747">fc_convertSeqSubsetToSubsets()</a>, <a class="el" href="base_8h-source.html#l00139">FC_DT_CHAR</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00138">FC_DT_UNKNOWN</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8h-source.html#l00127">FC_ET_HEX</a>, <a class="el" href="base_8h-source.html#l00121">FC_ET_LINE</a>, <a class="el" href="base_8h-source.html#l00120">FC_ET_POINT</a>, <a class="el" href="base_8h-source.html#l00126">FC_ET_PRISM</a>, <a class="el" href="base_8h-source.html#l00125">FC_ET_PYRAMID</a>, <a class="el" href="base_8h-source.html#l00123">FC_ET_QUAD</a>, <a class="el" href="base_8h-source.html#l00124">FC_ET_TET</a>, <a class="el" href="base_8h-source.html#l00122">FC_ET_TRI</a>, <a class="el" href="base_8h-source.html#l00108">FC_FILE_IO_ERROR</a>, <a class="el" href="storage_8c-source.html#l01245">fc_freeSortedBlobArray()</a>, <a class="el" href="fileio_8h-source.html#l00081">FC_FT_EXODUS</a>, <a class="el" href="base_8c-source.html#l00477">fc_getAssociationTypeText()</a>, <a class="el" href="dataset_8c-source.html#l00784">fc_getDatasetName()</a>, <a class="el" href="base_8c-source.html#l00419">fc_getDataTypeText()</a>, <a class="el" href="base_8c-source.html#l00586">fc_getElementTypeNumEdge()</a>, <a class="el" href="base_8c-source.html#l00622">fc_getElementTypeNumFace()</a>, <a class="el" href="base_8c-source.html#l00550">fc_getElementTypeNumVertex()</a>, <a class="el" href="base_8c-source.html#l00385">fc_getElementTypeText()</a>, <a class="el" href="base_8c-source.html#l00514">fc_getElementTypeTopoDim()</a>, <a class="el" href="variable_8c-source.html#l03492">fc_getGlobalSeqVariables()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03762">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03821">fc_getMeshElementToEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03880">fc_getMeshElementToFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02183">fc_getMeshes()</a>, <a class="el" href="mesh_8c-source.html#l02848">fc_getMeshInfo()</a>, <a class="el" href="subset_8c-source.html#l01420">fc_getNumSeqSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01313">fc_getSeqSubsets()</a>, <a class="el" href="sequence_8c-source.html#l01737">fc_getSequenceCoordsPtr()</a>, <a class="el" href="variable_8c-source.html#l05317">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="sequence_8c-source.html#l01612">fc_getSequenceInfo()</a>, <a class="el" href="sequence_8c-source.html#l01527">fc_getSequenceName()</a>, <a class="el" href="sequence_8c-source.html#l01150">fc_getSequences()</a>, <a class="el" href="variable_8c-source.html#l03637">fc_getSeqVariables()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="subset_8c-source.html#l02700">fc_getSubsetName()</a>, <a class="el" href="subset_8c-source.html#l01253">fc_getSubsets()</a>, <a class="el" href="variable_8c-source.html#l05539">fc_getVariableAssociationType()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05498">fc_getVariableDataType()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="variable_8c-source.html#l05624">fc_getVariableMathType()</a>, <a class="el" href="variable_8c-source.html#l05276">fc_getVariableName()</a>, <a class="el" href="variable_8c-source.html#l05582">fc_getVariableNumComponent()</a>, <a class="el" href="variable_8c-source.html#l05667">fc_getVariableNumDataPoint()</a>, <a class="el" href="variable_8c-source.html#l03573">fc_getVariables()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="storage_8c-source.html#l00944">fc_initSortedBlobArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00286">fc_isAssociationTypeValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="library_8h-source.html#l00154">fc_printfWarningMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="subsetP_8h-source.html#l00079">_FC_SubSlot::fileInfo</a>, <a class="el" href="meshP_8h-source.html#l00098">_FC_MeshSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00082">_FC_DsSlot::fileInfo</a>, <a class="el" href="datasetP_8h-source.html#l00080">_FC_DsSlot::fileType</a>, <a class="el" href="subsetP_8h-source.html#l00074">_FC_SubSlot::header</a>, <a class="el" href="meshP_8h-source.html#l00095">_FC_MeshSlot::header</a>, <a class="el" href="datasetP_8h-source.html#l00078">_FC_DsSlot::header</a>, <a class="el" href="fileioP_8h-source.html#l00185">_FC_MeshFileIOInfo::id</a>, <a class="el" href="variableP_8h-source.html#l00077">_FC_VarSlot::mesh</a>, <a class="el" href="subsetP_8h-source.html#l00075">_FC_SubSlot::mesh</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, <a class="el" href="storage_8h-source.html#l00126">FC_SortedBlobArray::numBlob</a>, <a class="el" href="datasetP_8h-source.html#l00092">_FC_DsSlot::numMesh</a>, <a class="el" href="datasetP_8h-source.html#l00088">_FC_DsSlot::numSeq</a>, and <a class="el" href="datasetP_8h-source.html#l00084">_FC_DsSlot::writable</a>.</p>

<p>Referenced by <a class="el" href="fileio_8c-source.html#l01706">fc_writeDataset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01937"></a>01937   {
<a name="l01938"></a>01938   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l01939"></a>01939   <span class="keywordtype">int</span> i, j, k, m, n, p;
<a name="l01940"></a>01940   <span class="keywordtype">int</span> maxID, *blk_ids;
<a name="l01941"></a>01941   <a class="code" href="struct__FC__DsSlot.html" title="Dataset Slot Structure for the Dataset Table.">_FC_DsSlot</a>* dsSlot;
<a name="l01942"></a>01942   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>* meshes;
<a name="l01943"></a>01943   <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a>* sequences, sequence;
<a name="l01944"></a>01944   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* nodeSets;
<a name="l01945"></a>01945   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* sideSets; 
<a name="l01946"></a>01946   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* elemSets;
<a name="l01947"></a>01947   <span class="keywordtype">int</span> numMesh, numTotalVert, numTotalElem, maxNumDim, numNodeSet,
<a name="l01948"></a>01948     numSideSet, numElemSet;
<a name="l01949"></a>01949   <span class="keywordtype">int</span> numSequence, numStep;
<a name="l01950"></a>01950   <span class="keywordtype">int</span> *numVerts, *numElems, *vertOffsets, *elemOffsets, *numDims, *numElemAttrs;
<a name="l01951"></a>01951   <span class="keywordtype">int</span> error, exoid, cpu_word_size, io_word_size;
<a name="l01952"></a>01952   <span class="keywordtype">char</span>* temp_name;
<a name="l01953"></a>01953   <span class="keywordtype">char</span>* coord_names[3] = { <span class="stringliteral">"coord_x"</span>, <span class="stringliteral">"coord_y"</span>, <span class="stringliteral">"coord_z"</span> };
<a name="l01954"></a>01954   <span class="keywordtype">double</span>* coords[3] = { NULL, NULL, NULL };
<a name="l01955"></a>01955   <a class="code" href="structFC__SortedBlobArray.html" title="Sorted, exclusive, self-exanding array of data blobs.">FC_SortedBlobArray</a> sba;
<a name="l01956"></a>01956   <a class="code" href="structFC__SortedBlobArray.html" title="Sorted, exclusive, self-exanding array of data blobs.">FC_SortedBlobArray</a> nattr_sba;
<a name="l01957"></a>01957   <span class="keywordtype">int</span> numNodalAttrs;
<a name="l01958"></a>01958   ex_init_params exoParams;
<a name="l01959"></a>01959 
<a name="l01960"></a>01960   <span class="comment">// check input</span>
<a name="l01961"></a>01961   dsSlot = <a class="code" href="group__PrivateDataset.html#gd3ed406753b9577575d71e0b7ce8a359" title="Get a dataset slot from a dataset handle.">_fc_getDsSlot</a>(dataset);
<a name="l01962"></a>01962   <span class="keywordflow">if</span> (dsSlot == NULL || dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#45bf720ce29415d5e8ef0c826647c811">writable</a> == 0 || 
<a name="l01963"></a>01963       (dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#bc767920afa6b50bbdbe53bc8775da44">numSeq</a> == 0 &amp;&amp; dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#132e931f020068da8e8e906bb9c2e82e">numMesh</a> == 0) ||
<a name="l01964"></a>01964       !filename) {
<a name="l01965"></a>01965     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l01966"></a>01966     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l01967"></a>01967   }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969   <span class="comment">// log message</span>
<a name="l01970"></a>01970   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Writing dataset '%s' to Exodus file '%s'"</span>, 
<a name="l01971"></a>01971                       dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#4339e69fe30b05ede4dc06248a0e883b">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, filename);
<a name="l01972"></a>01972 
<a name="l01973"></a>01973   <span class="comment">// --- Create the database file  ---</span>
<a name="l01974"></a>01974 
<a name="l01975"></a>01975   <span class="comment">// FIX??  should this check for an existing file?</span>
<a name="l01976"></a>01976   cpu_word_size = 8;
<a name="l01977"></a>01977   io_word_size = 8;
<a name="l01978"></a>01978   exoid = ex_create(filename, EX_CLOBBER, &amp;cpu_word_size, &amp;io_word_size);
<a name="l01979"></a>01979   <span class="keywordflow">if</span> (exoid &lt; 0) {
<a name="l01980"></a>01980     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to create Exodus dataset '%s'"</span>,
<a name="l01981"></a>01981                           dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#4339e69fe30b05ede4dc06248a0e883b">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>);
<a name="l01982"></a>01982     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l01983"></a>01983   }
<a name="l01984"></a>01984 
<a name="l01985"></a>01985   <span class="comment">// save file info</span>
<a name="l01986"></a>01986   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#8f0f6f1fa422a12522151135709df56a">baseFile</a> = (<span class="keywordtype">char</span>*) malloc((strlen(filename)+1)*<span class="keyword">sizeof</span>(char));
<a name="l01987"></a>01987   strcpy(dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#8f0f6f1fa422a12522151135709df56a">baseFile</a>, filename);
<a name="l01988"></a>01988   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.cpu_word_size = cpu_word_size;
<a name="l01989"></a>01989   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.io_word_size = io_word_size;
<a name="l01990"></a>01990   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.exoid = exoid;
<a name="l01991"></a>01991 
<a name="l01992"></a>01992   <span class="comment">// Preprocessing before can initialize file parameters (need num of things)</span>
<a name="l01993"></a>01993   rc = <a class="code" href="group__Mesh.html#gcb092c2c909dd536c0120830890a9f36" title="Get the meshes in a dataset.">fc_getMeshes</a>(dataset, &amp;numMesh, &amp;meshes);
<a name="l01994"></a>01994   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01995"></a>01995     <span class="keywordflow">return</span> rc;
<a name="l01996"></a>01996   numTotalVert = 0;
<a name="l01997"></a>01997   numTotalElem = 0;
<a name="l01998"></a>01998   maxNumDim = 0;
<a name="l01999"></a>01999   numNodeSet = 0;
<a name="l02000"></a>02000   numSideSet = 0;
<a name="l02001"></a>02001   numElemSet = 0;
<a name="l02002"></a>02002   vertOffsets = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02003"></a>02003   elemOffsets = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02004"></a>02004   numVerts = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02005"></a>02005   numElems = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02006"></a>02006   numDims = malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02007"></a>02007   numElemAttrs = calloc(numMesh, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); <span class="comment">// init to zero</span>
<a name="l02008"></a>02008   nodeSets = NULL;
<a name="l02009"></a>02009   sideSets = NULL;
<a name="l02010"></a>02010   elemSets = NULL;
<a name="l02011"></a>02011   <span class="keywordflow">if</span> (!vertOffsets || !elemOffsets || !numVerts || !numElems || !numDims ||
<a name="l02012"></a>02012       !numElemAttrs){
<a name="l02013"></a>02013     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02014"></a>02014     free(vertOffsets); free(elemOffsets); free(numVerts); free(numElems);
<a name="l02015"></a>02015     free(numDims); free(numElemAttrs);
<a name="l02016"></a>02016     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02017"></a>02017   }
<a name="l02018"></a>02018   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02019"></a>02019     <span class="keywordtype">int</span> numVert, numElem, numDim;
<a name="l02020"></a>02020     <span class="keywordtype">int</span> numSubset, numVar;
<a name="l02021"></a>02021     <span class="keywordtype">int</span> numSeqSubset, *numStepPerSeqSub;
<a name="l02022"></a>02022     <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *subsets, **seqSubsets;
<a name="l02023"></a>02023     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* vars;
<a name="l02024"></a>02024     <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l02025"></a>02025 
<a name="l02026"></a>02026     <span class="comment">// get mesh info</span>
<a name="l02027"></a>02027     rc = <a class="code" href="group__Mesh.html#ged61b1f684fc2a6ac489c10841cdb591" title="Get information about a mesh.">fc_getMeshInfo</a>(meshes[i], NULL, &amp;numDim, &amp;numVert, &amp;numElem,
<a name="l02028"></a>02028                         &amp;elemType);
<a name="l02029"></a>02029     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02030"></a>02030       <span class="keywordflow">return</span> rc;
<a name="l02031"></a>02031 
<a name="l02032"></a>02032     <span class="comment">// count numVert &amp; calc offsets and maxNumDim</span>
<a name="l02033"></a>02033     numVerts[i] = numVert;
<a name="l02034"></a>02034     numElems[i] = numElem;
<a name="l02035"></a>02035     vertOffsets[i] = numTotalVert;
<a name="l02036"></a>02036     elemOffsets[i] = numTotalElem;
<a name="l02037"></a>02037     numDims[i] = numDim;
<a name="l02038"></a>02038     numTotalVert += numVert;
<a name="l02039"></a>02039     numTotalElem += numElem;
<a name="l02040"></a>02040     <span class="keywordflow">if</span> (numDim &gt; maxNumDim)
<a name="l02041"></a>02041       maxNumDim = numDim;
<a name="l02042"></a>02042 
<a name="l02043"></a>02043     <span class="comment">// convert any seqSubsets to subsets</span>
<a name="l02044"></a>02044     rc = <a class="code" href="group__Subset.html#g17815a36b74d5568de04398ca4bd4bf4" title="Get the seq subsets in a mesh.">fc_getSeqSubsets</a>(meshes[i], &amp;numSeqSubset, &amp;numStepPerSeqSub, &amp;seqSubsets);
<a name="l02045"></a>02045     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02046"></a>02046       <span class="keywordflow">return</span> rc;
<a name="l02047"></a>02047     <span class="keywordflow">for</span> (j = 0; j &lt; numSeqSubset; j++){
<a name="l02048"></a>02048       <span class="keywordtype">char</span>* name;
<a name="l02049"></a>02049       rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(seqSubsets[j][0],&amp;name);
<a name="l02050"></a>02050       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02051"></a>02051      <span class="keywordflow">return</span> rc;
<a name="l02052"></a>02052       rc = <a class="code" href="group__Subset.html#gdfeb3c1ffc54043f2139f3e653471860" title="Convert a sequence subset into an array of normal subsets.">fc_convertSeqSubsetToSubsets</a>(numStepPerSeqSub[j],seqSubsets[j], name, &amp;subsets);
<a name="l02053"></a>02053       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02054"></a>02054      <span class="keywordflow">return</span> rc;
<a name="l02055"></a>02055       free(name);
<a name="l02056"></a>02056       free(subsets); <span class="comment">//just the array</span>
<a name="l02057"></a>02057       free(seqSubsets[j]);
<a name="l02058"></a>02058     }
<a name="l02059"></a>02059     free(numStepPerSeqSub);
<a name="l02060"></a>02060     free(seqSubsets);
<a name="l02061"></a>02061 
<a name="l02062"></a>02062 
<a name="l02063"></a>02063     <span class="comment">// count (&amp; save) subsets for nodesets and sidesets</span>
<a name="l02064"></a>02064     rc = <a class="code" href="group__Subset.html#gb12aea784bf43ec6a29a8e51a3c0da51" title="Get the subsets in a mesh.">fc_getSubsets</a>(meshes[i], &amp;numSubset, &amp;subsets);
<a name="l02065"></a>02065     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02066"></a>02066       <span class="keywordflow">return</span> rc;
<a name="l02067"></a>02067     <span class="keywordflow">for</span> (j = 0; j &lt; numSubset; j++) {
<a name="l02068"></a>02068       <span class="keywordtype">int</span> numMember;
<a name="l02069"></a>02069       <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l02070"></a>02070       <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *temp_subsets;
<a name="l02071"></a>02071       <span class="keywordtype">int</span> assoc_flag;  <span class="comment">// -1 = neither, 0 = nodeset, 1 = sideset, 2 = elemset</span>
<a name="l02072"></a>02072 
<a name="l02073"></a>02073       <span class="comment">// process</span>
<a name="l02074"></a>02074       rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subsets[j], &amp;numMember, NULL, &amp;assoc);
<a name="l02075"></a>02075       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02076"></a>02076         <span class="keywordflow">return</span> rc;
<a name="l02077"></a>02077       <span class="keywordflow">if</span> (!<a class="code" href="group__DataTypes.html#gc3097dff5d1b0602671b7d2805162169" title="Verify that the given value is valid for this enum.">fc_isAssociationTypeValid</a>(assoc)) {
<a name="l02078"></a>02078         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"subset did not have valid assoc"</span>);
<a name="l02079"></a>02079         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02080"></a>02080       }
<a name="l02081"></a>02081       assoc_flag = -1;
<a name="l02082"></a>02082       <span class="keywordflow">switch</span>(assoc) {
<a name="l02083"></a>02083       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>: assoc_flag = 0; <span class="keywordflow">break</span>;
<a name="l02084"></a>02084       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>: <span class="comment">// if elements are 2D, add to sidesets</span>
<a name="l02085"></a>02085         <span class="keywordflow">if</span> (<a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType) == 2) assoc_flag = 1; <span class="keywordflow">break</span>;
<a name="l02086"></a>02086       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>: <span class="comment">// if elements are 3D, add to sidesets</span>
<a name="l02087"></a>02087         <span class="keywordflow">if</span> (<a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType) == 3) assoc_flag = 1; <span class="keywordflow">break</span>;
<a name="l02088"></a>02088       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>: 
<a name="l02089"></a>02089      assoc_flag = 2; <span class="keywordflow">break</span>;
<a name="l02090"></a>02090       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>: 
<a name="l02091"></a>02091       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6ac55a57488add4ea9f01eac5c9eab232">FC_AT_WHOLE_DATASET</a>: <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6d5a38e6486b577a8d9bbba0e1c1a443d">FC_AT_UNKNOWN</a>:
<a name="l02092"></a>02092         ; <span class="comment">// -1</span>
<a name="l02093"></a>02093       }
<a name="l02094"></a>02094       <span class="keywordflow">switch</span> (assoc_flag){
<a name="l02095"></a>02095       <span class="keywordflow">case</span> 0:
<a name="l02096"></a>02096      <span class="comment">// add to nodesets</span>
<a name="l02097"></a>02097         temp_subsets = realloc(nodeSets, (numNodeSet+1)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02098"></a>02098         <span class="keywordflow">if</span> (!temp_subsets) {
<a name="l02099"></a>02099           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02100"></a>02100           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02101"></a>02101         }
<a name="l02102"></a>02102         nodeSets = temp_subsets;
<a name="l02103"></a>02103         nodeSets[numNodeSet] = subsets[j];
<a name="l02104"></a>02104         numNodeSet++;
<a name="l02105"></a>02105      <span class="keywordflow">break</span>;
<a name="l02106"></a>02106       <span class="keywordflow">case</span> 1:
<a name="l02107"></a>02107         temp_subsets = realloc(sideSets, (numSideSet+1)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02108"></a>02108         <span class="keywordflow">if</span> (!temp_subsets) {
<a name="l02109"></a>02109           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02110"></a>02110           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02111"></a>02111         }
<a name="l02112"></a>02112         sideSets = temp_subsets;
<a name="l02113"></a>02113         sideSets[numSideSet] = subsets[j];
<a name="l02114"></a>02114         numSideSet++;
<a name="l02115"></a>02115      <span class="keywordflow">break</span>;
<a name="l02116"></a>02116       <span class="keywordflow">case</span> 2:
<a name="l02117"></a>02117      <span class="comment">//elem set</span>
<a name="l02118"></a>02118      temp_subsets = realloc(elemSets, (numElemSet+1)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02119"></a>02119         <span class="keywordflow">if</span> (!temp_subsets) {
<a name="l02120"></a>02120           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02121"></a>02121           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02122"></a>02122         }
<a name="l02123"></a>02123      elemSets = temp_subsets;
<a name="l02124"></a>02124      elemSets[numElemSet] = subsets[j];
<a name="l02125"></a>02125      numElemSet++;
<a name="l02126"></a>02126      <span class="keywordflow">break</span>;
<a name="l02127"></a>02127       <span class="keywordflow">default</span>:
<a name="l02128"></a>02128         rc = <a class="code" href="group__Subset.html#g429e404a267e2f574e2578aa5d0aaa35" title="Get subset name.">fc_getSubsetName</a>(subsets[j], &amp;temp_name);
<a name="l02129"></a>02129         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02130"></a>02130           <span class="keywordflow">return</span> rc;
<a name="l02131"></a>02131         <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Skipping subset '%s' because exodus cannot "</span>
<a name="l02132"></a>02132                                 <span class="stringliteral">"handle subsets of type %s on a %dD mesh"</span>, 
<a name="l02133"></a>02133                                 temp_name, <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(assoc),
<a name="l02134"></a>02134                                 <a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType));
<a name="l02135"></a>02135         free(temp_name);
<a name="l02136"></a>02136       }
<a name="l02137"></a>02137     } <span class="comment">// end of loop over subsets</span>
<a name="l02138"></a>02138     free(subsets);
<a name="l02139"></a>02139     rc = <a class="code" href="group__Subset.html#ga695f5af84135aef9b92b8fe5426e949" title="Get the number of seq subsets in a mesh.">fc_getNumSeqSubset</a>(meshes[i], &amp;numSeqSubset);
<a name="l02140"></a>02140     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02141"></a>02141       <span class="keywordflow">return</span> rc;
<a name="l02142"></a>02142     <span class="keywordflow">if</span> (numSeqSubset &gt; 0 )
<a name="l02143"></a>02143       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Warning: not writing out %d sequence subsets"</span>, numSeqSubset);
<a name="l02144"></a>02144 
<a name="l02145"></a>02145 
<a name="l02146"></a>02146     <span class="comment">// count vars that can be elem attributes (not nodal)</span>
<a name="l02147"></a>02147     rc = <a class="code" href="group__Variable.html#ga96777675a667d79871c93c54729bde4" title="Get the variables in a mesh.">fc_getVariables</a>(meshes[i], &amp;numVar, &amp;vars);
<a name="l02148"></a>02148     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02149"></a>02149       <span class="keywordflow">return</span> rc;
<a name="l02150"></a>02150     <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l02151"></a>02151       <span class="keywordtype">int</span> numComp;
<a name="l02152"></a>02152       <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l02153"></a>02153       <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l02154"></a>02154       rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(vars[j], NULL, &amp;numComp, &amp;assoc, NULL,
<a name="l02155"></a>02155                               &amp;dataType);
<a name="l02156"></a>02156       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02157"></a>02157         <span class="keywordflow">return</span> rc;
<a name="l02158"></a>02158       <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a> &amp;&amp;
<a name="l02159"></a>02159        (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> || dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> ||
<a name="l02160"></a>02160         dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> || dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>)){
<a name="l02161"></a>02161         numElemAttrs[i]+=numComp;
<a name="l02162"></a>02162       }
<a name="l02163"></a>02163      } <span class="comment">// end of loop over vars</span>
<a name="l02164"></a>02164     free(vars);
<a name="l02165"></a>02165   } <span class="comment">// end of loop over meshes</span>
<a name="l02166"></a>02166   <span class="keywordflow">if</span> (maxNumDim &lt; 1) {
<a name="l02167"></a>02167         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus cannot write files with "</span>
<a name="l02168"></a>02168                               <span class="stringliteral">"dimensionality &lt; 1"</span>);
<a name="l02169"></a>02169     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02170"></a>02170   }
<a name="l02171"></a>02171   
<a name="l02172"></a>02172   <span class="comment">// Initialize file parameters</span>
<a name="l02173"></a>02173   rc = <a class="code" href="group__Dataset.html#gf6ce6ef4b5b3aebbd1d694c4e8d55969" title="Return name of a dataset.">fc_getDatasetName</a>(dataset, &amp;temp_name);
<a name="l02174"></a>02174   strncpy(exoParams.title, temp_name, MAX_STR_LENGTH);
<a name="l02175"></a>02175   exoParams.num_dim = maxNumDim;
<a name="l02176"></a>02176   exoParams.num_nodes = numTotalVert;
<a name="l02177"></a>02177   exoParams.num_edge = 0;
<a name="l02178"></a>02178   exoParams.num_edge_blk = 0;
<a name="l02179"></a>02179   exoParams.num_face = 0;
<a name="l02180"></a>02180   exoParams.num_face_blk = 0;
<a name="l02181"></a>02181   exoParams.num_elem = numTotalElem;
<a name="l02182"></a>02182   exoParams.num_elem_blk = numMesh;
<a name="l02183"></a>02183   exoParams.num_node_sets = numNodeSet;
<a name="l02184"></a>02184   exoParams.num_edge_sets = 0;
<a name="l02185"></a>02185   exoParams.num_face_sets = 0;
<a name="l02186"></a>02186   exoParams.num_side_sets = numSideSet;
<a name="l02187"></a>02187   exoParams.num_elem_sets = numElemSet;
<a name="l02188"></a>02188   <span class="comment">//we drop all maps</span>
<a name="l02189"></a>02189   exoParams.num_node_maps = 0;
<a name="l02190"></a>02190   exoParams.num_edge_maps = 0;
<a name="l02191"></a>02191   exoParams.num_face_maps = 0;
<a name="l02192"></a>02192   exoParams.num_elem_maps = 0;
<a name="l02193"></a>02193 
<a name="l02194"></a>02194   error = ex_put_init_ext(exoid, &amp;exoParams);
<a name="l02195"></a>02195   free(temp_name);
<a name="l02196"></a>02196   <span class="keywordflow">if</span> (error != 0) {
<a name="l02197"></a>02197     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put file parameters"</span>);
<a name="l02198"></a>02198     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02199"></a>02199   }
<a name="l02200"></a>02200 
<a name="l02201"></a>02201   <span class="comment">// Save Vert LUs</span>
<a name="l02202"></a>02202   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numTotalVert = numTotalVert;
<a name="l02203"></a>02203   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.numMesh = numMesh;
<a name="l02204"></a>02204   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs = (<span class="keywordtype">int</span>**)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l02205"></a>02205   <span class="keywordflow">if</span> (!dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs) {
<a name="l02206"></a>02206     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02207"></a>02207     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;  
<a name="l02208"></a>02208   }
<a name="l02209"></a>02209   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02210"></a>02210     <span class="keywordtype">int</span>* vertIDs = (<span class="keywordtype">int</span>*)malloc(numVerts[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02211"></a>02211     <span class="keywordflow">if</span> (!vertIDs) {
<a name="l02212"></a>02212       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02213"></a>02213       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;  
<a name="l02214"></a>02214     }
<a name="l02215"></a>02215     <span class="keywordflow">for</span> (j = 0; j &lt; numVerts[i]; j++)
<a name="l02216"></a>02216       vertIDs[j] = vertOffsets[i] + j;
<a name="l02217"></a>02217     dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#fe85451a16b0a0c3ff4ac02632632355">fileInfo</a>.exoInfo.vertIDs[i] = vertIDs;
<a name="l02218"></a>02218   }
<a name="l02219"></a>02219 
<a name="l02220"></a>02220   <span class="comment">// --- Write nodal coordinates ---</span>
<a name="l02221"></a>02221 
<a name="l02222"></a>02222   <span class="comment">// Make space</span>
<a name="l02223"></a>02223   <span class="keywordflow">for</span> (i = 0; i &lt; maxNumDim; i++) {
<a name="l02224"></a>02224     coords[i] = (<span class="keywordtype">double</span>*)malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l02225"></a>02225     <span class="keywordflow">if</span> (!coords[i]) {
<a name="l02226"></a>02226       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02227"></a>02227       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02228"></a>02228     }
<a name="l02229"></a>02229   }
<a name="l02230"></a>02230   <span class="comment">// create global, components of coords</span>
<a name="l02231"></a>02231    <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02232"></a>02232     <span class="keywordtype">double</span>* temp_coords;
<a name="l02233"></a>02233     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(meshes[i], &amp;temp_coords);
<a name="l02234"></a>02234     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02235"></a>02235       <span class="keywordflow">return</span> rc;
<a name="l02236"></a>02236     <span class="keywordflow">for</span> (j = 0; j &lt; numVerts[i]; j++) {
<a name="l02237"></a>02237       <span class="keywordflow">for</span> (k = 0; k &lt; numDims[i]; k++){
<a name="l02238"></a>02238         coords[k][vertOffsets[i] + j] = temp_coords[j*numDims[i]+k];
<a name="l02239"></a>02239       }
<a name="l02240"></a>02240       <span class="keywordflow">for</span> (k = numDims[i]; k &lt; maxNumDim; k++)
<a name="l02241"></a>02241         coords[k][vertOffsets[i] + j] = 0.;
<a name="l02242"></a>02242     } 
<a name="l02243"></a>02243   }
<a name="l02244"></a>02244 
<a name="l02245"></a>02245   <span class="comment">// do it</span>
<a name="l02246"></a>02246   error = ex_put_coord(exoid, coords[0], coords[1], coords[2]);
<a name="l02247"></a>02247   <span class="keywordflow">for</span> (i = 0; i &lt; maxNumDim; i++)
<a name="l02248"></a>02248     free(coords[i]);
<a name="l02249"></a>02249   <span class="keywordflow">if</span> (error != 0) {
<a name="l02250"></a>02250     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put coords"</span>);
<a name="l02251"></a>02251     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02252"></a>02252   }
<a name="l02253"></a>02253 
<a name="l02254"></a>02254   error = ex_put_coord_names(exoid, coord_names);
<a name="l02255"></a>02255   <span class="keywordflow">if</span> (error != 0) {
<a name="l02256"></a>02256     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put coord names"</span>);
<a name="l02257"></a>02257     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02258"></a>02258   }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260   <span class="comment">// --- Write element blocks (i.e. the conns) ---</span>
<a name="l02261"></a>02261 
<a name="l02262"></a>02262   <span class="comment">// Create block ids if they do not already exist</span>
<a name="l02263"></a>02263   <span class="comment">// To get unique ids, start w/ the max existing id + 1</span>
<a name="l02264"></a>02264   maxID = 0;
<a name="l02265"></a>02265   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02266"></a>02266     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[i]);
<a name="l02267"></a>02267     <span class="keywordflow">if</span> (meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a> &gt; maxID)
<a name="l02268"></a>02268       maxID = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>;
<a name="l02269"></a>02269   }
<a name="l02270"></a>02270   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02271"></a>02271     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[i]);
<a name="l02272"></a>02272     <span class="keywordflow">if</span> (meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a> == -1) {
<a name="l02273"></a>02273       maxID++;
<a name="l02274"></a>02274       meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a> = maxID;
<a name="l02275"></a>02275     }
<a name="l02276"></a>02276   }
<a name="l02277"></a>02277   blk_ids = (<span class="keywordtype">int</span>*)malloc(numMesh*<span class="keyword">sizeof</span>(numMesh));
<a name="l02278"></a>02278   <span class="keywordflow">if</span> (!blk_ids) {
<a name="l02279"></a>02279     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02280"></a>02280     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02281"></a>02281   }
<a name="l02282"></a>02282   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02283"></a>02283     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[i]);
<a name="l02284"></a>02284     blk_ids[i] = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>;
<a name="l02285"></a>02285   }
<a name="l02286"></a>02286 
<a name="l02287"></a>02287   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02288"></a>02288     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(meshes[i]);
<a name="l02289"></a>02289     <span class="keywordtype">char</span> exoElemType[MAX_STR_LENGTH+1];
<a name="l02290"></a>02290     <span class="keywordtype">int</span> numVertPerElem, *temp_conns, *conns;
<a name="l02291"></a>02291     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID = i;
<a name="l02292"></a>02292     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset = elemOffsets[i];
<a name="l02293"></a>02293     <span class="keywordflow">switch</span> (meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a>) {
<a name="l02294"></a>02294     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a76571df5a6db31cae09dfe11dd291fd8">FC_ET_POINT</a>:
<a name="l02295"></a>02295       <span class="keywordflow">if</span> (maxNumDim == 1)
<a name="l02296"></a>02296         sprintf(exoElemType, <span class="stringliteral">"POINT"</span>); <span class="comment">// FIX!?</span>
<a name="l02297"></a>02297       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxNumDim == 2)
<a name="l02298"></a>02298         sprintf(exoElemType, <span class="stringliteral">"CIRCLE"</span>);
<a name="l02299"></a>02299       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxNumDim == 3)
<a name="l02300"></a>02300         sprintf(exoElemType, <span class="stringliteral">"SPHERE"</span>);
<a name="l02301"></a>02301       <span class="keywordflow">break</span>;
<a name="l02302"></a>02302     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a80b8143aeefa54756df4ea881fb21fea">FC_ET_LINE</a>:  sprintf(exoElemType, <span class="stringliteral">"BEAM"</span>);   <span class="keywordflow">break</span>;
<a name="l02303"></a>02303     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884af79268373ad06101e34987c127cb50b5">FC_ET_TRI</a>:   sprintf(exoElemType, <span class="stringliteral">"TRI"</span>);    <span class="keywordflow">break</span>;
<a name="l02304"></a>02304     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884aecaa2098167cbf0e3ee39fec88e073ca">FC_ET_QUAD</a>:  sprintf(exoElemType, <span class="stringliteral">"QUAD"</span>);   <span class="keywordflow">break</span>;
<a name="l02305"></a>02305     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884ab804e31376ed4e06e0bad0f4af1d4ed3">FC_ET_TET</a>:   sprintf(exoElemType, <span class="stringliteral">"TETRA"</span>);  <span class="keywordflow">break</span>;
<a name="l02306"></a>02306     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884ac13209dbf3db3732a42ca48a668dc8e7">FC_ET_PYRAMID</a>: sprintf(exoElemType, <span class="stringliteral">"PYRAMID"</span>); <span class="keywordflow">break</span>;
<a name="l02307"></a>02307     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a183a114a124ce2ed96589373642a63d6">FC_ET_PRISM</a>: sprintf(exoElemType, <span class="stringliteral">"WEDGE"</span>);  <span class="keywordflow">break</span>;
<a name="l02308"></a>02308     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884a3d933c1932ea3f8dcc2968395e68767b">FC_ET_HEX</a>:   sprintf(exoElemType, <span class="stringliteral">"HEX"</span>);    <span class="keywordflow">break</span>;
<a name="l02309"></a>02309     <span class="keywordflow">default</span>:
<a name="l02310"></a>02310       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Elementype %s not supported"</span>,
<a name="l02311"></a>02311                             <a class="code" href="group__DataTypes.html#g4152b6e700d60abe601b48ce595db9a7" title="Return the name of the FC_ElementType&amp;#39;s value.">fc_getElementTypeText</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a>));
<a name="l02312"></a>02312       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02313"></a>02313     }
<a name="l02314"></a>02314     numVertPerElem = <a class="code" href="group__DataTypes.html#g2a400f7126e79f149032162c87c4eee8" title="Returns number of vertices in a type of element.">fc_getElementTypeNumVertex</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a>);
<a name="l02315"></a>02315     error = ex_put_elem_block(exoid, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>,
<a name="l02316"></a>02316                               exoElemType, numElems[i],
<a name="l02317"></a>02317                               numVertPerElem, numElemAttrs[i]);
<a name="l02318"></a>02318     <span class="keywordflow">if</span> (error != 0) {
<a name="l02319"></a>02319       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem blk meta data"</span>);
<a name="l02320"></a>02320       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02321"></a>02321     }
<a name="l02322"></a>02322 
<a name="l02323"></a>02323 
<a name="l02324"></a>02324     rc = <a class="code" href="group__Mesh.html#g19906bcae562d226991740da142000c0" title="Return element to vertex connectivities for the mesh.">fc_getMeshElementConnsPtr</a>(meshes[i], &amp;temp_conns);
<a name="l02325"></a>02325     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02326"></a>02326       <span class="keywordflow">return</span> rc;
<a name="l02327"></a>02327     conns = malloc(numElems[i]*numVertPerElem*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02328"></a>02328     <span class="keywordflow">if</span> (!conns) {
<a name="l02329"></a>02329       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02330"></a>02330       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02331"></a>02331     }
<a name="l02332"></a>02332     <span class="keywordflow">for</span> (j = 0; j &lt; numElems[i]*numVertPerElem; j++) 
<a name="l02333"></a>02333       conns[j] = temp_conns[j] + vertOffsets[i] + 1;
<a name="l02334"></a>02334     error = ex_put_elem_conn(exoid, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>, conns);
<a name="l02335"></a>02335     free(conns);
<a name="l02336"></a>02336     <span class="keywordflow">if</span> (error != 0) {
<a name="l02337"></a>02337       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem conns"</span>);
<a name="l02338"></a>02338       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02339"></a>02339     }
<a name="l02340"></a>02340     <span class="comment">// restrict name to MAX_STR_LENGTH</span>
<a name="l02341"></a>02341     temp_name = malloc(MAX_STR_LENGTH*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l02342"></a>02342     strncpy(temp_name, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, MAX_STR_LENGTH);
<a name="l02343"></a>02343     temp_name[MAX_STR_LENGTH-1] = <span class="charliteral">'\0'</span>;
<a name="l02344"></a>02344     <span class="keywordflow">if</span> (strlen(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) &gt;= MAX_STR_LENGTH)
<a name="l02345"></a>02345       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Mesh '%s's name is being clipped by Exodus "</span>
<a name="l02346"></a>02346                               <span class="stringliteral">"to '%s'"</span>, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, temp_name);
<a name="l02347"></a>02347     error = ex_put_name(exoid, EX_ELEM_BLOCK, meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.<a class="code" href="struct__FC__MeshFileIOInfo.html#8553729eaa5bf7c6fc281abcb4236862">id</a>,
<a name="l02348"></a>02348                         temp_name);
<a name="l02349"></a>02349     free(temp_name);
<a name="l02350"></a>02350     <span class="keywordflow">if</span> (error != 0) {
<a name="l02351"></a>02351       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem block name"</span>);
<a name="l02352"></a>02352       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02353"></a>02353     }
<a name="l02354"></a>02354     meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#68621513bb50e53f850e0b3fe84f43f7">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l02355"></a>02355   }
<a name="l02356"></a>02356 
<a name="l02357"></a>02357   <span class="comment">// --- Write side sets ---</span>
<a name="l02358"></a>02358   <span class="comment">// FIX? change to use concat method which is faster</span>
<a name="l02359"></a>02359 
<a name="l02360"></a>02360   <span class="keywordflow">for</span> (i = 0; i &lt; numSideSet; i++) {
<a name="l02361"></a>02361     <span class="keywordtype">int</span> meshID, sideset_id;
<a name="l02362"></a>02362     <span class="keywordtype">int</span> numMember, *members, *sides;
<a name="l02363"></a>02363     <span class="keywordtype">int</span> numEntityPerElem, *elemToEntityConns;
<a name="l02364"></a>02364     <span class="keywordtype">int</span> *numElemPerEntity, **elemParentsPerEntity;
<a name="l02365"></a>02365     <a class="code" href="struct__FC__SubSlot.html" title="Struct describing subset elements.">_FC_SubSlot</a>* subSlot;
<a name="l02366"></a>02366     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l02367"></a>02367 
<a name="l02368"></a>02368     <span class="comment">// setup</span>
<a name="l02369"></a>02369     subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(sideSets[i]);
<a name="l02370"></a>02370     meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>);
<a name="l02371"></a>02371     meshID = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID;
<a name="l02372"></a>02372     <span class="keywordflow">if</span> (subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#5886619735c0e79df2c3c1a776f8e91b">assoc</a> == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>) {
<a name="l02373"></a>02373       numEntityPerElem = <a class="code" href="group__DataTypes.html#gf2ce1082614c4a5cd5481c00c89a7e67" title="Returns number of edges in a type of element.">fc_getElementTypeNumEdge</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a>);
<a name="l02374"></a>02374       rc = <a class="code" href="group__Mesh.html#gcc3f8cb48b0c2673d9e0ce0d4eba2878" title="Return element to edge connectivities.">fc_getMeshElementToEdgeConnsPtr</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;elemToEntityConns);
<a name="l02375"></a>02375       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02376"></a>02376         <span class="keywordflow">return</span> rc;
<a name="l02377"></a>02377       rc = <a class="code" href="group__PrivateMesh.html#g889846c3db62a020c33f8ceb6d7e27e7" title="Return parent elements of the edges.">_fc_getMeshElementParentsOfEdgesPtr</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;numElemPerEntity,
<a name="l02378"></a>02378                                             &amp;elemParentsPerEntity);
<a name="l02379"></a>02379       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02380"></a>02380         <span class="keywordflow">return</span> rc;
<a name="l02381"></a>02381     }
<a name="l02382"></a>02382     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#5886619735c0e79df2c3c1a776f8e91b">assoc</a> == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>) {
<a name="l02383"></a>02383       numEntityPerElem = <a class="code" href="group__DataTypes.html#g1cffd2eb82ec74e749ca93a6cb623e4a" title="Returns number of faces in a type of element.">fc_getElementTypeNumFace</a>(meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#fadd3563d825716a3f58ffc5dfe8e3e6">elemType</a>);
<a name="l02384"></a>02384       rc = <a class="code" href="group__Mesh.html#g7f17910148b4237e84ca374845688cfc" title="Return element to face connectivities.">fc_getMeshElementToFaceConnsPtr</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;elemToEntityConns);
<a name="l02385"></a>02385       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02386"></a>02386         <span class="keywordflow">return</span> rc;
<a name="l02387"></a>02387       rc = <a class="code" href="group__PrivateMesh.html#g540b5f94172bea7ef0e2fcf41bf42425" title="Return parent elements of the faces.">_fc_getMeshElementParentsOfFacesPtr</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>, &amp;numElemPerEntity,
<a name="l02388"></a>02388                                             &amp;elemParentsPerEntity);
<a name="l02389"></a>02389       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02390"></a>02390         <span class="keywordflow">return</span> rc;
<a name="l02391"></a>02391     }
<a name="l02392"></a>02392     <span class="keywordflow">else</span> {
<a name="l02393"></a>02393       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error? should be edge or face subset"</span>);
<a name="l02394"></a>02394       <span class="keywordflow">return</span> rc;
<a name="l02395"></a>02395     }
<a name="l02396"></a>02396    
<a name="l02397"></a>02397     <span class="comment">// Get subset data - this is by copy</span>
<a name="l02398"></a>02398     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(sideSets[i], &amp;numMember, &amp;members);
<a name="l02399"></a>02399     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02400"></a>02400       <span class="keywordflow">return</span> rc;
<a name="l02401"></a>02401     sideset_id = i+1;
<a name="l02402"></a>02402     <span class="comment">// Put side set params</span>
<a name="l02403"></a>02403     error = ex_put_side_set_param(exoid, sideset_id, numMember, 0);
<a name="l02404"></a>02404     <span class="keywordflow">if</span> (error != 0) {
<a name="l02405"></a>02405       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put side set param"</span>);
<a name="l02406"></a>02406       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02407"></a>02407     }
<a name="l02408"></a>02408     <span class="comment">// put side set</span>
<a name="l02409"></a>02409     <span class="comment">// 5-12-08 currently ex_put_side_set only does anything if the set has numMember &gt; 0</span>
<a name="l02410"></a>02410     <span class="comment">//therefore only doing this if numMember &gt; 0. If that changes this check will</span>
<a name="l02411"></a>02411     <span class="comment">//have to change. I cannot check the return on this because the return for an</span>
<a name="l02412"></a>02412     <span class="comment">//empty subset is EX_WARN which is defined in exodus's internal headers</span>
<a name="l02413"></a>02413     <span class="keywordflow">if</span> (numMember){
<a name="l02414"></a>02414       sides = (<span class="keywordtype">int</span>*)malloc(numMember*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02415"></a>02415       <span class="keywordflow">if</span> (!sides) {
<a name="l02416"></a>02416      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02417"></a>02417      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02418"></a>02418       }
<a name="l02419"></a>02419       <span class="comment">// have to convert mesh side ids to global elem ids &amp; local to elem side id</span>
<a name="l02420"></a>02420       <span class="comment">// (members gets turned into element IDs)</span>
<a name="l02421"></a>02421       <span class="keywordflow">for</span> (j = 0; j &lt; numMember; j++) {
<a name="l02422"></a>02422      <span class="keywordtype">int</span> elemID, entityID;
<a name="l02423"></a>02423      <span class="comment">// get first element that has this entity, then figure out local ID</span>
<a name="l02424"></a>02424      elemID = elemParentsPerEntity[members[j]][0];
<a name="l02425"></a>02425      <span class="keywordflow">for</span> (k = 0; k &lt; numEntityPerElem; k++) {
<a name="l02426"></a>02426        <span class="keywordflow">if</span> (elemToEntityConns[elemID*numEntityPerElem+k] == members[j]) {
<a name="l02427"></a>02427          entityID = k;
<a name="l02428"></a>02428          <span class="keywordflow">break</span>;
<a name="l02429"></a>02429        }
<a name="l02430"></a>02430      }
<a name="l02431"></a>02431      members[j] = elemID + meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset + 1;
<a name="l02432"></a>02432      sides[j] = entityID + 1;
<a name="l02433"></a>02433       }
<a name="l02434"></a>02434       error = ex_put_side_set(exoid, sideset_id, members, sides);
<a name="l02435"></a>02435       free(members);
<a name="l02436"></a>02436       free(sides);
<a name="l02437"></a>02437       <span class="keywordflow">if</span> (error != 0) {
<a name="l02438"></a>02438      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put side set"</span>);
<a name="l02439"></a>02439      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02440"></a>02440       }
<a name="l02441"></a>02441     } 
<a name="l02442"></a>02442     <span class="comment">// restrict name to MAX_STR_LENGTH</span>
<a name="l02443"></a>02443     temp_name = malloc(MAX_STR_LENGTH*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l02444"></a>02444     strncpy(temp_name, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, MAX_STR_LENGTH);
<a name="l02445"></a>02445     temp_name[MAX_STR_LENGTH-1] = <span class="charliteral">'\0'</span>;
<a name="l02446"></a>02446     <span class="keywordflow">if</span> (strlen(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) &gt;= MAX_STR_LENGTH)
<a name="l02447"></a>02447       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Subset '%s's name is being clipped by Exodus"</span>
<a name="l02448"></a>02448                               <span class="stringliteral">"to '%s'"</span>, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, temp_name);
<a name="l02449"></a>02449     error = ex_put_name(exoid, EX_SIDE_SET, sideset_id, temp_name);
<a name="l02450"></a>02450     free(temp_name);
<a name="l02451"></a>02451     <span class="keywordflow">if</span> (error != 0) {
<a name="l02452"></a>02452       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put side set name"</span>);
<a name="l02453"></a>02453       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02454"></a>02454     }
<a name="l02455"></a>02455     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.assoc_flag = 0;
<a name="l02456"></a>02456     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid = sideset_id;
<a name="l02457"></a>02457     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l02458"></a>02458   }
<a name="l02459"></a>02459   free(sideSets);
<a name="l02460"></a>02460 
<a name="l02461"></a>02461   <span class="comment">// --- Write node sets ---</span>
<a name="l02462"></a>02462 
<a name="l02463"></a>02463   <span class="comment">// FIX? change to use concat method which is supposedly faster</span>
<a name="l02464"></a>02464 
<a name="l02465"></a>02465   <span class="keywordflow">for</span> (i = 0; i &lt; numNodeSet; i++) {
<a name="l02466"></a>02466     <span class="keywordtype">int</span> meshID, nodeset_id;
<a name="l02467"></a>02467     <span class="keywordtype">int</span> numMember, *members;
<a name="l02468"></a>02468     <a class="code" href="struct__FC__SubSlot.html" title="Struct describing subset elements.">_FC_SubSlot</a>* subSlot;
<a name="l02469"></a>02469     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l02470"></a>02470 
<a name="l02471"></a>02471     <span class="comment">// setup</span>
<a name="l02472"></a>02472     subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(nodeSets[i]);
<a name="l02473"></a>02473     meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>);
<a name="l02474"></a>02474     meshID = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID;
<a name="l02475"></a>02475     <span class="comment">// Get subset data - this is by copy</span>
<a name="l02476"></a>02476     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(nodeSets[i], &amp;numMember, &amp;members);
<a name="l02477"></a>02477     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02478"></a>02478       <span class="keywordflow">return</span> rc;
<a name="l02479"></a>02479     nodeset_id = i+1;
<a name="l02480"></a>02480     <span class="comment">// Put node set params</span>
<a name="l02481"></a>02481     error = ex_put_node_set_param(exoid, nodeset_id, numMember, 0);
<a name="l02482"></a>02482     <span class="keywordflow">if</span> (error != 0) {
<a name="l02483"></a>02483       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put node set param"</span>);
<a name="l02484"></a>02484       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02485"></a>02485     }
<a name="l02486"></a>02486 
<a name="l02487"></a>02487     <span class="comment">// have to convert mesh node ids to global node ids</span>
<a name="l02488"></a>02488     <span class="keywordflow">for</span> (j = 0; j &lt; numMember; j++)
<a name="l02489"></a>02489       members[j] += vertOffsets[meshID] + 1;
<a name="l02490"></a>02490     <span class="comment">// put node set</span>
<a name="l02491"></a>02491     <span class="comment">// 4-12-08 currently ex_put_node_set only does anything if the set has numMember &gt; 0</span>
<a name="l02492"></a>02492     <span class="comment">//therefore only doing this if numMember &gt; 0. If that changes this check will</span>
<a name="l02493"></a>02493     <span class="comment">//have to change. I cannot check the return on this because the return for an</span>
<a name="l02494"></a>02494     <span class="comment">//empty subset is EX_WARN which is defined in exodus's internal headers</span>
<a name="l02495"></a>02495     <span class="keywordflow">if</span> (numMember){
<a name="l02496"></a>02496       error = ex_put_node_set(exoid, nodeset_id, members);
<a name="l02497"></a>02497       free(members);
<a name="l02498"></a>02498       <span class="keywordflow">if</span> (error != 0){
<a name="l02499"></a>02499      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put node set"</span>);
<a name="l02500"></a>02500      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02501"></a>02501       }
<a name="l02502"></a>02502     }
<a name="l02503"></a>02503     <span class="comment">// restrict name to MAX_STR_LENGTH</span>
<a name="l02504"></a>02504     temp_name = malloc(MAX_STR_LENGTH*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l02505"></a>02505     strncpy(temp_name, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, MAX_STR_LENGTH);
<a name="l02506"></a>02506     temp_name[MAX_STR_LENGTH-1] = <span class="charliteral">'\0'</span>;
<a name="l02507"></a>02507     <span class="keywordflow">if</span> (strlen(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) &gt;= MAX_STR_LENGTH)
<a name="l02508"></a>02508       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Subset '%s's name is being clipped by Exodus"</span>
<a name="l02509"></a>02509                               <span class="stringliteral">"to '%s'"</span>, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, temp_name);
<a name="l02510"></a>02510     error = ex_put_name(exoid, EX_NODE_SET, nodeset_id, temp_name);
<a name="l02511"></a>02511     free(temp_name);
<a name="l02512"></a>02512     <span class="keywordflow">if</span> (error != 0) {
<a name="l02513"></a>02513       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put node set name"</span>);
<a name="l02514"></a>02514       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02515"></a>02515     }
<a name="l02516"></a>02516     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.assoc_flag = 0;
<a name="l02517"></a>02517     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid = nodeset_id;
<a name="l02518"></a>02518     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l02519"></a>02519   }
<a name="l02520"></a>02520   free(nodeSets);
<a name="l02521"></a>02521 
<a name="l02522"></a>02522   <span class="comment">// write elem sets</span>
<a name="l02523"></a>02523   <span class="comment">//  printf("num elem set + %d\n", numElemSet);</span>
<a name="l02524"></a>02524   <span class="keywordflow">for</span> (i = 0; i &lt; numElemSet; i++) {
<a name="l02525"></a>02525     <span class="keywordtype">int</span> meshID, elemset_id;
<a name="l02526"></a>02526     <span class="keywordtype">int</span> numMember, *members;
<a name="l02527"></a>02527     <a class="code" href="struct__FC__SubSlot.html" title="Struct describing subset elements.">_FC_SubSlot</a>* subSlot;
<a name="l02528"></a>02528     <a class="code" href="struct__FC__MeshSlot.html" title="Mesh Slot Structure for the Mesh Table.">_FC_MeshSlot</a>* meshSlot;
<a name="l02529"></a>02529 
<a name="l02530"></a>02530     <span class="comment">// setup</span>
<a name="l02531"></a>02531     subSlot = <a class="code" href="group__PrivateSubset.html#gfcfa40671d6a71442d882bf0926d7895" title="Get a subset slot from a subset handle.">_fc_getSubSlot</a>(elemSets[i]);
<a name="l02532"></a>02532     meshSlot = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#62d7d3fdde10983984b076625afa02c5">mesh</a>);
<a name="l02533"></a>02533     meshID = meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID;
<a name="l02534"></a>02534     <span class="comment">// Get subset data - this is by copy</span>
<a name="l02535"></a>02535     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(elemSets[i], &amp;numMember, &amp;members);
<a name="l02536"></a>02536     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02537"></a>02537       <span class="keywordflow">return</span> rc;
<a name="l02538"></a>02538     elemset_id = i+1;
<a name="l02539"></a>02539     <span class="comment">// Put elem set params</span>
<a name="l02540"></a>02540     error = ex_put_set_param(exoid, EX_ELEM_SET, elemset_id, numMember, 0);
<a name="l02541"></a>02541     <span class="keywordflow">if</span> (error != 0) {
<a name="l02542"></a>02542       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem set param"</span>);
<a name="l02543"></a>02543       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02544"></a>02544     }
<a name="l02545"></a>02545       
<a name="l02546"></a>02546     <span class="comment">// have to convert mesh elem ids to global elem ids</span>
<a name="l02547"></a>02547     <span class="keywordflow">for</span> (j = 0; j &lt; numMember; j++){
<a name="l02548"></a>02548       members[j] += meshSlot-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.elemOffset + 1;
<a name="l02549"></a>02549     }
<a name="l02550"></a>02550     <span class="comment">// put elem set</span>
<a name="l02551"></a>02551     <span class="comment">// 4-12-08 currently ex_put_set only does anything if the set has numMember &gt; 0</span>
<a name="l02552"></a>02552     <span class="comment">//therefore only doing this if numMember &gt; 0. If that changes this check will</span>
<a name="l02553"></a>02553     <span class="comment">//have to change. I cannot check the return on this because the return for an</span>
<a name="l02554"></a>02554     <span class="comment">//empty subset is EX_WARN which is defined in exodus's internal headers</span>
<a name="l02555"></a>02555    <span class="keywordflow">if</span> (numMember){
<a name="l02556"></a>02556       error = ex_put_set(exoid, EX_ELEM_SET, elemset_id, members, NULL);
<a name="l02557"></a>02557       free(members);
<a name="l02558"></a>02558       <span class="keywordflow">if</span> (error != 0) {
<a name="l02559"></a>02559      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem set"</span>);
<a name="l02560"></a>02560      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02561"></a>02561       }
<a name="l02562"></a>02562     }
<a name="l02563"></a>02563     <span class="comment">// restrict name to MAX_STR_LENGTH</span>
<a name="l02564"></a>02564     temp_name = malloc(MAX_STR_LENGTH*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l02565"></a>02565     strncpy(temp_name, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, MAX_STR_LENGTH);
<a name="l02566"></a>02566     temp_name[MAX_STR_LENGTH-1] = <span class="charliteral">'\0'</span>;
<a name="l02567"></a>02567     <span class="keywordflow">if</span> (strlen(subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>) &gt;= MAX_STR_LENGTH)
<a name="l02568"></a>02568       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Subset '%s's name is being clipped by Exodus"</span>
<a name="l02569"></a>02569                               <span class="stringliteral">"to '%s'"</span>, subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#b14afe27fdf25b95ceacb0ca867696a5">name</a>, temp_name);
<a name="l02570"></a>02570     <span class="comment">//    printf("putting elem set &lt;%s&gt;\n", temp_name);</span>
<a name="l02571"></a>02571     error = ex_put_name(exoid, EX_ELEM_SET, elemset_id, temp_name);
<a name="l02572"></a>02572     free(temp_name);
<a name="l02573"></a>02573     <span class="keywordflow">if</span> (error != 0) {
<a name="l02574"></a>02574       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem set name"</span>);
<a name="l02575"></a>02575       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02576"></a>02576     }
<a name="l02577"></a>02577     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.assoc_flag = 2;
<a name="l02578"></a>02578     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#cb2e5aa770a990061f2e194cae20ea4e">fileInfo</a>.exoInfo.nsssid = elemset_id;
<a name="l02579"></a>02579     subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#07d50e7e118f4d4c1c7c70caa2d9d2f6">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l02580"></a>02580   }
<a name="l02581"></a>02581   free(elemSets);
<a name="l02582"></a>02582 
<a name="l02583"></a>02583 
<a name="l02584"></a>02584 
<a name="l02585"></a>02585   <span class="comment">// --- Write vars</span>
<a name="l02586"></a>02586 
<a name="l02587"></a>02587   <span class="comment">// FC_AT_WHOLE_MESH, FC_DT_INT vars are properties</span>
<a name="l02588"></a>02588   <span class="comment">//   (other FC_AT_WHOLE_MESH are discarded)</span>
<a name="l02589"></a>02589   <span class="comment">// FC_AT_ELEMENT are attributes</span>
<a name="l02590"></a>02590   <span class="comment">// FC_AT_VERTEX are attributes and will be handled later</span>
<a name="l02591"></a>02591   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02592"></a>02592     <span class="keywordtype">int</span> numVar;
<a name="l02593"></a>02593     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *vars;
<a name="l02594"></a>02594     <span class="keywordtype">char</span>** elemAttrNames = NULL;
<a name="l02595"></a>02595     <span class="keywordtype">int</span> currElemAttr = 0;
<a name="l02596"></a>02596     <span class="keywordtype">char</span>* temp_name2;
<a name="l02597"></a>02597 
<a name="l02598"></a>02598     rc = <a class="code" href="group__Variable.html#ga96777675a667d79871c93c54729bde4" title="Get the variables in a mesh.">fc_getVariables</a>(meshes[i], &amp;numVar, &amp;vars);
<a name="l02599"></a>02599     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02600"></a>02600       <span class="keywordflow">return</span> rc;
<a name="l02601"></a>02601     <span class="keywordflow">if</span> (numElemAttrs[i] &gt; 0){
<a name="l02602"></a>02602       elemAttrNames = (<span class="keywordtype">char</span>**)malloc(numElemAttrs[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l02603"></a>02603       <span class="keywordflow">if</span> (!elemAttrNames){
<a name="l02604"></a>02604      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02605"></a>02605       }
<a name="l02606"></a>02606     }
<a name="l02607"></a>02607 
<a name="l02608"></a>02608     <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l02609"></a>02609       <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l02610"></a>02610       <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l02611"></a>02611       <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathType;
<a name="l02612"></a>02612       <span class="keywordtype">int</span> numComp, *prop_vals;
<a name="l02613"></a>02613       rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(vars[j], NULL, &amp;numComp, &amp;assoc, &amp;mathType,
<a name="l02614"></a>02614                               &amp;dataType);
<a name="l02615"></a>02615       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02616"></a>02616         <span class="keywordflow">return</span> rc;
<a name="l02617"></a>02617       rc = <a class="code" href="group__Variable.html#g233584b319c5dd90a13582fc9ac3484e" title="Return name of a variable.">fc_getVariableName</a>(vars[j], &amp;temp_name);
<a name="l02618"></a>02618       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02619"></a>02619      <span class="keywordflow">return</span> rc;
<a name="l02620"></a>02620       <span class="keywordflow">switch</span> (assoc){
<a name="l02621"></a>02621       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>:
<a name="l02622"></a>02622      <span class="keywordflow">if</span> (dataType != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>) {
<a name="l02623"></a>02623           <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Variable '%s' on mesh %d discard because "</span>
<a name="l02624"></a>02624                                   <span class="stringliteral">"cannot write datatype of %s"</span>, temp_name,
<a name="l02625"></a>02625                                   i, <a class="code" href="group__DataTypes.html#g688d0934eac6d388ad21c461e22fd19f" title="Return the name of the FC_DataType&amp;#39;s value.">fc_getDataTypeText</a>(dataType));
<a name="l02626"></a>02626           free(temp_name);
<a name="l02627"></a>02627        <span class="keywordflow">break</span>;
<a name="l02628"></a>02628      }
<a name="l02629"></a>02629         <span class="comment">// 'ID' is reserved for Exodus</span>
<a name="l02630"></a>02630         <span class="keywordflow">if</span> (!strcmp(temp_name, <span class="stringliteral">"ID"</span>)) {
<a name="l02631"></a>02631           <span class="comment">// Purposefully not adding warning message because we'd get one every</span>
<a name="l02632"></a>02632           <span class="comment">// time we rewrote an Exodus dataset -WSD 11/24/2006</span>
<a name="l02633"></a>02633           free(temp_name);
<a name="l02634"></a>02634        <span class="keywordflow">break</span>;
<a name="l02635"></a>02635         }
<a name="l02636"></a>02636         rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(vars[j], (<span class="keywordtype">void</span>**)&amp;prop_vals);
<a name="l02637"></a>02637         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02638"></a>02638           <span class="keywordflow">return</span> rc;
<a name="l02639"></a>02639         <span class="keywordflow">for</span> (k = 0; k &lt; numComp; k++) {
<a name="l02640"></a>02640           rc = <a class="code" href="group__ExodusFileIO.html#g2c3f4682201e3afdf8e2d18fe02e6675" title="Create the name for a component of a variable to use in Exodus file.">_fc_createExoVarCompName</a>(temp_name, numComp, mathType, k,
<a name="l02641"></a>02641                                         &amp;temp_name2);
<a name="l02642"></a>02642           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02643"></a>02643             <span class="keywordflow">return</span> rc;
<a name="l02644"></a>02644           error = ex_put_prop(exoid, EX_ELEM_BLOCK, blk_ids[i], temp_name2,
<a name="l02645"></a>02645                               prop_vals[k]);
<a name="l02646"></a>02646           <span class="keywordflow">if</span> (error != 0) {
<a name="l02647"></a>02647             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put prop '%s' on mesh #%d"</span>,
<a name="l02648"></a>02648                                   temp_name2, i);
<a name="l02649"></a>02649             <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02650"></a>02650           }
<a name="l02651"></a>02651           free(temp_name2);
<a name="l02652"></a>02652      }
<a name="l02653"></a>02653         free(temp_name);
<a name="l02654"></a>02654      <span class="comment">// end of if FC_AT_WHOLE_MESH</span>
<a name="l02655"></a>02655      <span class="keywordflow">break</span>;
<a name="l02656"></a>02656       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>:
<a name="l02657"></a>02657      {
<a name="l02658"></a>02658        <span class="keywordtype">void</span>* elemAttrVals = NULL;
<a name="l02659"></a>02659        <span class="keywordtype">double</span>* elemAttrData = NULL;
<a name="l02660"></a>02660 
<a name="l02661"></a>02661        <span class="comment">//note that numElemAttrs has taken into account dataType</span>
<a name="l02662"></a>02662        <span class="comment">//and numComponent above, since we needed the numattr</span>
<a name="l02663"></a>02663        <span class="comment">//to establish the elem block. cross ref with that if</span>
<a name="l02664"></a>02664        <span class="comment">//this code ever changes</span>
<a name="l02665"></a>02665 
<a name="l02666"></a>02666        <span class="keywordflow">if</span> (dataType != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>  &amp;&amp;
<a name="l02667"></a>02667            dataType != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>  &amp;&amp;
<a name="l02668"></a>02668            dataType != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> &amp;&amp;
<a name="l02669"></a>02669            dataType != <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>){
<a name="l02670"></a>02670          <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Variable '%s' on mesh %d elems discard "</span>
<a name="l02671"></a>02671                         <span class="stringliteral">"because cannot write datatype of %s"</span>,
<a name="l02672"></a>02672                         temp_name,
<a name="l02673"></a>02673                         i, <a class="code" href="group__DataTypes.html#g688d0934eac6d388ad21c461e22fd19f" title="Return the name of the FC_DataType&amp;#39;s value.">fc_getDataTypeText</a>(dataType));
<a name="l02674"></a>02674          free(temp_name);
<a name="l02675"></a>02675          <span class="keywordflow">break</span>;
<a name="l02676"></a>02676        }
<a name="l02677"></a>02677        <span class="comment">// 'ID' reserved for Exodus </span>
<a name="l02678"></a>02678        <span class="keywordflow">if</span> (!strcmp(temp_name, <span class="stringliteral">"ID"</span>)) {
<a name="l02679"></a>02679          <span class="comment">//this actually shouldnt matter because ID will be a prop for this var</span>
<a name="l02680"></a>02680          free(temp_name);
<a name="l02681"></a>02681          <span class="keywordflow">break</span>;
<a name="l02682"></a>02682        }
<a name="l02683"></a>02683        elemAttrData = (<span class="keywordtype">double</span>*)malloc(numElems[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l02684"></a>02684        <span class="keywordflow">if</span> (!elemAttrData){
<a name="l02685"></a>02685          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02686"></a>02686        }
<a name="l02687"></a>02687        rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(vars[j], &amp;elemAttrVals);
<a name="l02688"></a>02688        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02689"></a>02689          free(temp_name);
<a name="l02690"></a>02690          <span class="keywordflow">return</span> rc;
<a name="l02691"></a>02691        }
<a name="l02692"></a>02692 
<a name="l02693"></a>02693        <span class="keywordflow">for</span> (k = 0; k &lt; numComp; k++) {
<a name="l02694"></a>02694          <span class="keywordtype">int</span> kk;
<a name="l02695"></a>02695          <span class="keywordflow">for</span> (kk = 0; kk &lt; numElems[i]; kk++){
<a name="l02696"></a>02696           <span class="keywordflow">switch</span>(dataType){
<a name="l02697"></a>02697           <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:     
<a name="l02698"></a>02698             elemAttrData[kk] = ((<span class="keywordtype">int</span>*)elemAttrVals)[kk*numComp+k];
<a name="l02699"></a>02699             <span class="keywordflow">break</span>;
<a name="l02700"></a>02700           <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:   
<a name="l02701"></a>02701             elemAttrData[kk] = ((<span class="keywordtype">float</span>*)elemAttrVals)[kk*numComp+k];
<a name="l02702"></a>02702             <span class="keywordflow">break</span>;
<a name="l02703"></a>02703           <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:  
<a name="l02704"></a>02704             elemAttrData[kk] = ((<span class="keywordtype">double</span>*)elemAttrVals)[kk*numComp+k];
<a name="l02705"></a>02705             <span class="keywordflow">break</span>;
<a name="l02706"></a>02706           <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>:  
<a name="l02707"></a>02707             elemAttrData[kk] = ((<span class="keywordtype">char</span>*)elemAttrVals)[kk*numComp+k];
<a name="l02708"></a>02708             <span class="keywordflow">break</span>;
<a name="l02709"></a>02709           <span class="keywordflow">default</span>:
<a name="l02710"></a>02710             <span class="comment">//shouldnt happen</span>
<a name="l02711"></a>02711             <span class="keywordflow">break</span>;
<a name="l02712"></a>02712           }
<a name="l02713"></a>02713          }
<a name="l02714"></a>02714          <span class="comment">//attribute numbering starts at 1</span>
<a name="l02715"></a>02715          error = ex_put_one_elem_attr(exoid, blk_ids[i],currElemAttr+1,
<a name="l02716"></a>02716                           elemAttrData);
<a name="l02717"></a>02717          <span class="keywordflow">if</span> (error != 0){
<a name="l02718"></a>02718            free(temp_name);
<a name="l02719"></a>02719            <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put one elem attr mesh #%d"</span>,
<a name="l02720"></a>02720                         i);
<a name="l02721"></a>02721            <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02722"></a>02722          }
<a name="l02723"></a>02723          rc = <a class="code" href="group__ExodusFileIO.html#g2c3f4682201e3afdf8e2d18fe02e6675" title="Create the name for a component of a variable to use in Exodus file.">_fc_createExoVarCompName</a>(temp_name, numComp, mathType, k,
<a name="l02724"></a>02724                            &amp;temp_name2);
<a name="l02725"></a>02725          <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l02726"></a>02726            free(temp_name);
<a name="l02727"></a>02727            <span class="keywordflow">return</span> rc;
<a name="l02728"></a>02728          }
<a name="l02729"></a>02729          elemAttrNames[currElemAttr] = temp_name2;
<a name="l02730"></a>02730          currElemAttr++;
<a name="l02731"></a>02731        } <span class="comment">//numComp</span>
<a name="l02732"></a>02732        free(temp_name);
<a name="l02733"></a>02733        free(elemAttrData);
<a name="l02734"></a>02734      }
<a name="l02735"></a>02735      <span class="keywordflow">break</span>;
<a name="l02736"></a>02736       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>:
<a name="l02737"></a>02737      <span class="comment">//these will be handled below</span>
<a name="l02738"></a>02738         free(temp_name);
<a name="l02739"></a>02739      <span class="keywordflow">break</span>;
<a name="l02740"></a>02740       <span class="keywordflow">default</span>:
<a name="l02741"></a>02741         <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Variable '%s' on mesh %d discarded because "</span>
<a name="l02742"></a>02742                                 <span class="stringliteral">"cannot write assoc type of %s"</span>, temp_name,
<a name="l02743"></a>02743                                 i, <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(assoc));
<a name="l02744"></a>02744         free(temp_name);
<a name="l02745"></a>02745      <span class="keywordflow">break</span>;
<a name="l02746"></a>02746       } <span class="comment">// end of switch</span>
<a name="l02747"></a>02747     } <span class="comment">// end of loop over vars</span>
<a name="l02748"></a>02748     free(vars);
<a name="l02749"></a>02749 
<a name="l02750"></a>02750     <span class="keywordflow">if</span> (numElemAttrs[i] &gt; 0){
<a name="l02751"></a>02751       error = ex_put_elem_attr_names (exoid, blk_ids[i], elemAttrNames);
<a name="l02752"></a>02752       <span class="keywordflow">for</span> (j = 0; j &lt; numElemAttrs[i]; j++){
<a name="l02753"></a>02753      free(elemAttrNames[j]);
<a name="l02754"></a>02754       }
<a name="l02755"></a>02755       free(elemAttrNames);
<a name="l02756"></a>02756       <span class="keywordflow">if</span> (error != 0){
<a name="l02757"></a>02757      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put elem attr names on mesh #%d"</span>,
<a name="l02758"></a>02758                      i);
<a name="l02759"></a>02759      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02760"></a>02760       }
<a name="l02761"></a>02761     }
<a name="l02762"></a>02762 
<a name="l02763"></a>02763   } <span class="comment">//end of loop over meshes</span>
<a name="l02764"></a>02764 
<a name="l02765"></a>02765   <span class="comment">//we dont need the attributes anymore</span>
<a name="l02766"></a>02766   <span class="keywordflow">if</span> (numElemAttrs) free(numElemAttrs);
<a name="l02767"></a>02767 
<a name="l02768"></a>02768   <span class="comment">// --- Write sequence (there can only be 0 or 1) ---</span>
<a name="l02769"></a>02769   
<a name="l02770"></a>02770   rc = <a class="code" href="group__Sequence.html#g0ad1217500f245d78aaad5c79f960ba1" title="Get the sequences in a dataset.">fc_getSequences</a>(dataset, &amp;numSequence, &amp;sequences);
<a name="l02771"></a>02771   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02772"></a>02772     <span class="keywordflow">return</span> rc;
<a name="l02773"></a>02773   <span class="keywordflow">if</span> (numSequence &gt; 0) {
<a name="l02774"></a>02774     <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l02775"></a>02775     <span class="keywordtype">void</span>* data;
<a name="l02776"></a>02776 
<a name="l02777"></a>02777     <span class="comment">// Warn if too many sequences</span>
<a name="l02778"></a>02778     <span class="keywordflow">if</span> (numSequence &gt; 1) {
<a name="l02779"></a>02779       rc = <a class="code" href="group__Sequence.html#g94959dc695412dd18bd1e968b1ce3d59" title="Return name of a sequence.">fc_getSequenceName</a>(sequences[i], &amp;temp_name);
<a name="l02780"></a>02780       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02781"></a>02781         <span class="keywordflow">return</span> rc;
<a name="l02782"></a>02782       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Exodus can only have 1 sequence, using the "</span>
<a name="l02783"></a>02783                               <span class="stringliteral">"first one: '%s'"</span>, temp_name);
<a name="l02784"></a>02784       free(temp_name);
<a name="l02785"></a>02785       <span class="keywordflow">for</span> (i = 1; i &lt; numSequence; i++) {
<a name="l02786"></a>02786         rc = <a class="code" href="group__Sequence.html#g94959dc695412dd18bd1e968b1ce3d59" title="Return name of a sequence.">fc_getSequenceName</a>(sequences[i], &amp;temp_name);
<a name="l02787"></a>02787         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02788"></a>02788           <span class="keywordflow">return</span> rc;
<a name="l02789"></a>02789         <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Sequence '%s' discarded (also all seq vars "</span>
<a name="l02790"></a>02790                                 <span class="stringliteral">" on this seq discarded)"</span>, temp_name);
<a name="l02791"></a>02791         free(temp_name);
<a name="l02792"></a>02792       } 
<a name="l02793"></a>02793     }
<a name="l02794"></a>02794     
<a name="l02795"></a>02795     <span class="comment">// do it</span>
<a name="l02796"></a>02796     sequence = sequences[0]; <span class="comment">// keep for later</span>
<a name="l02797"></a>02797     rc = <a class="code" href="group__Sequence.html#g39b5198d7c58288101f909fac5569f71" title="Get information about a sequence.">fc_getSequenceInfo</a>(sequence, &amp;numStep, &amp;dataType);
<a name="l02798"></a>02798     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02799"></a>02799       <span class="keywordflow">return</span> rc;
<a name="l02800"></a>02800     rc = <a class="code" href="group__Sequence.html#ga88160e25be202c8de18ac89edf876c6" title="Get sequence coordinates.">fc_getSequenceCoordsPtr</a>(sequence, &amp;data);
<a name="l02801"></a>02801     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02802"></a>02802       <span class="keywordflow">return</span> rc;
<a name="l02803"></a>02803     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02804"></a>02804       <span class="keywordtype">double</span> time_coord;
<a name="l02805"></a>02805       <span class="keywordflow">switch</span> (dataType) {
<a name="l02806"></a>02806       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>:     time_coord = ((<span class="keywordtype">char</span>*)data)[i];    <span class="keywordflow">break</span>;
<a name="l02807"></a>02807       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:      time_coord = ((<span class="keywordtype">int</span>*)data)[i];     <span class="keywordflow">break</span>;
<a name="l02808"></a>02808       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:    time_coord = ((<span class="keywordtype">float</span>*)data)[i];   <span class="keywordflow">break</span>;
<a name="l02809"></a>02809       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:   time_coord = ((<span class="keywordtype">double</span>*)data)[i];  <span class="keywordflow">break</span>;
<a name="l02810"></a>02810       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9c76e1a6b572327d5433db69f08eddde1">FC_DT_UNKNOWN</a>:
<a name="l02811"></a>02811         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"sequence has unknown datatype"</span>);
<a name="l02812"></a>02812         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02813"></a>02813       }
<a name="l02814"></a>02814       error = ex_put_time(exoid, i+1, &amp;time_coord);
<a name="l02815"></a>02815       <span class="keywordflow">if</span> (error != 0) {
<a name="l02816"></a>02816         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put time value %d (of %d)"</span>, i, numStep);
<a name="l02817"></a>02817         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02818"></a>02818       }
<a name="l02819"></a>02819     } <span class="comment">// end of loop over steps</span>
<a name="l02820"></a>02820     <span class="comment">// Sequence is not read lazily, so don't set committed flag</span>
<a name="l02821"></a>02821   }
<a name="l02822"></a>02822   free(sequences);
<a name="l02823"></a>02823 
<a name="l02824"></a>02824   <span class="comment">// --- Write global seq variables ---</span>
<a name="l02825"></a>02825 
<a name="l02826"></a>02826   {
<a name="l02827"></a>02827     <span class="keywordtype">int</span> numGlbSeqVar, *numStepPerSeqVar;
<a name="l02828"></a>02828     <span class="keywordtype">int</span> numGlbVar;
<a name="l02829"></a>02829     <span class="keywordtype">int</span>* numComps = NULL; <span class="comment">// a zero entry means was on another seq</span>
<a name="l02830"></a>02830     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> **glbSeqVars;
<a name="l02831"></a>02831     
<a name="l02832"></a>02832     <span class="comment">// get the vars</span>
<a name="l02833"></a>02833     rc = <a class="code" href="group__Variable.html#g3085ad2d7a4be9f81eb0eccaa19ade10" title="Get the global sequence variables in a dataset.">fc_getGlobalSeqVariables</a>(dataset, &amp;numGlbSeqVar,
<a name="l02834"></a>02834                                   &amp;numStepPerSeqVar, &amp;glbSeqVars);
<a name="l02835"></a>02835     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02836"></a>02836       <span class="keywordflow">return</span> rc;
<a name="l02837"></a>02837     
<a name="l02838"></a>02838     <span class="comment">// Get number of globar vars (split up multi-component vars,</span>
<a name="l02839"></a>02839     <span class="comment">// ignore vars on other sequences)</span>
<a name="l02840"></a>02840     numGlbVar = 0;
<a name="l02841"></a>02841     <span class="keywordflow">if</span> (numGlbSeqVar &gt; 0) {
<a name="l02842"></a>02842       numComps = malloc(numGlbSeqVar*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02843"></a>02843       <span class="keywordflow">if</span> (!numComps) {
<a name="l02844"></a>02844      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02845"></a>02845      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02846"></a>02846       }
<a name="l02847"></a>02847       <span class="keywordflow">for</span> (i = 0; i &lt; numGlbSeqVar; i++) {
<a name="l02848"></a>02848      <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a> temp_sequence;
<a name="l02849"></a>02849      rc = <a class="code" href="group__Variable.html#g314a992ec5ba07d7075f1172b13ef166" title="Get the parent sequence of a sequence variable.">fc_getSequenceFromSeqVariable</a>(numStepPerSeqVar[i], glbSeqVars[i],
<a name="l02850"></a>02850                             &amp;temp_sequence);
<a name="l02851"></a>02851      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02852"></a>02852        <span class="keywordflow">return</span> rc;
<a name="l02853"></a>02853      <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(sequence, temp_sequence)) {
<a name="l02854"></a>02854        numComps[i] = 0;
<a name="l02855"></a>02855        <a class="code" href="group__Variable.html#g233584b319c5dd90a13582fc9ac3484e" title="Return name of a variable.">fc_getVariableName</a>(glbSeqVars[i][0], &amp;temp_name);
<a name="l02856"></a>02856        <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Global var '%s is not on the first "</span>
<a name="l02857"></a>02857                       <span class="stringliteral">"sequence, skipping"</span>, temp_name);
<a name="l02858"></a>02858        free(temp_name);
<a name="l02859"></a>02859        <span class="keywordflow">continue</span>;
<a name="l02860"></a>02860      }
<a name="l02861"></a>02861      rc = <a class="code" href="group__Variable.html#gb3e6e14f099d7870ee2c38ccccf87544" title="Return number of components of a variable.">fc_getVariableNumComponent</a>(glbSeqVars[i][0], &amp;numComps[i]);
<a name="l02862"></a>02862      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02863"></a>02863        <span class="keywordflow">return</span> rc;
<a name="l02864"></a>02864      numGlbVar += numComps[i];
<a name="l02865"></a>02865       }
<a name="l02866"></a>02866     }
<a name="l02867"></a>02867 
<a name="l02868"></a>02868     <span class="comment">// Further processing only necessary if there are any</span>
<a name="l02869"></a>02869     <span class="keywordflow">if</span> (numGlbVar &gt; 0) {
<a name="l02870"></a>02870       <span class="keywordtype">char</span>** names;
<a name="l02871"></a>02871           
<a name="l02872"></a>02872       <span class="comment">// write number</span>
<a name="l02873"></a>02873       error = ex_put_var_param(exoid, <span class="stringliteral">"g"</span>, numGlbVar);
<a name="l02874"></a>02874       <span class="keywordflow">if</span> (error != 0) {
<a name="l02875"></a>02875      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put 'g' var param"</span>);
<a name="l02876"></a>02876      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02877"></a>02877       }
<a name="l02878"></a>02878 
<a name="l02879"></a>02879       <span class="comment">// compile names</span>
<a name="l02880"></a>02880       names = (<span class="keywordtype">char</span>**)malloc(numGlbVar*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l02881"></a>02881       <span class="keywordflow">if</span> (!names) {
<a name="l02882"></a>02882      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02883"></a>02883      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02884"></a>02884       }
<a name="l02885"></a>02885       numGlbVar = 0;
<a name="l02886"></a>02886       <span class="keywordflow">for</span> (i = 0; i &lt; numGlbSeqVar; i++) {
<a name="l02887"></a>02887      <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype;
<a name="l02888"></a>02888      <span class="keywordflow">if</span> (numComps[i] == 0)
<a name="l02889"></a>02889        <span class="keywordflow">continue</span>; <span class="comment">// skip if on another sequence</span>
<a name="l02890"></a>02890      rc = <a class="code" href="group__Variable.html#g233584b319c5dd90a13582fc9ac3484e" title="Return name of a variable.">fc_getVariableName</a>(glbSeqVars[i][0], &amp;temp_name);
<a name="l02891"></a>02891      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02892"></a>02892        <span class="keywordflow">return</span> rc;
<a name="l02893"></a>02893      rc = <a class="code" href="group__Variable.html#g5dfa6a1adb587b1f865bceb83b0824ab" title="Return the math type of a variable.">fc_getVariableMathType</a>(glbSeqVars[i][0], &amp;mathtype);
<a name="l02894"></a>02894      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02895"></a>02895        <span class="keywordflow">return</span> rc;
<a name="l02896"></a>02896         <span class="keywordflow">for</span> (j = 0; j &lt; numComps[i]; j++) {
<a name="l02897"></a>02897           rc = <a class="code" href="group__ExodusFileIO.html#g2c3f4682201e3afdf8e2d18fe02e6675" title="Create the name for a component of a variable to use in Exodus file.">_fc_createExoVarCompName</a>(temp_name, numComps[i], mathtype, j,
<a name="l02898"></a>02898                                         &amp;names[numGlbVar]);
<a name="l02899"></a>02899           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02900"></a>02900             <span class="keywordflow">return</span> rc;
<a name="l02901"></a>02901           numGlbVar++;
<a name="l02902"></a>02902         }
<a name="l02903"></a>02903         free(temp_name);
<a name="l02904"></a>02904       }
<a name="l02905"></a>02905       
<a name="l02906"></a>02906       <span class="comment">// write number and names</span>
<a name="l02907"></a>02907       error = ex_put_var_names(exoid, <span class="stringliteral">"g"</span>, numGlbVar, names);
<a name="l02908"></a>02908       <span class="keywordflow">if</span> (error != 0) {
<a name="l02909"></a>02909      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put 'g' var names"</span>);
<a name="l02910"></a>02910      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02911"></a>02911       }  
<a name="l02912"></a>02912             
<a name="l02913"></a>02913       <span class="comment">// cleanup names</span>
<a name="l02914"></a>02914       <span class="keywordflow">for</span> (i = 0; i &lt; numGlbVar; i++)
<a name="l02915"></a>02915      free(names[i]);
<a name="l02916"></a>02916       free(names);
<a name="l02917"></a>02917       
<a name="l02918"></a>02918       <span class="comment">// write data for each step</span>
<a name="l02919"></a>02919       <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l02920"></a>02920       <span class="keywordtype">void</span>* data;
<a name="l02921"></a>02921       <span class="keywordtype">double</span> values[numGlbVar];
<a name="l02922"></a>02922       <span class="keywordflow">for</span> (j = 0; j &lt; numStep; j++) {
<a name="l02923"></a>02923      <span class="keywordtype">int</span> current = 0;
<a name="l02924"></a>02924      <span class="keywordflow">for</span> (i = 0; i &lt; numGlbSeqVar; i++) {
<a name="l02925"></a>02925        <span class="keywordflow">if</span> (numComps[i] == 0) <span class="comment">// skip if on another sequence</span>
<a name="l02926"></a>02926          <span class="keywordflow">continue</span>;
<a name="l02927"></a>02927        rc = <a class="code" href="group__Variable.html#gd3b7cecfd0c6d488e82b426b4c114aba" title="Return the data type of a variable.">fc_getVariableDataType</a>(glbSeqVars[i][0], &amp;dataType);
<a name="l02928"></a>02928        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02929"></a>02929          <span class="keywordflow">return</span> rc;
<a name="l02930"></a>02930        rc = <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(glbSeqVars[i][j], &amp;data);
<a name="l02931"></a>02931        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02932"></a>02932          <span class="keywordflow">return</span> rc;
<a name="l02933"></a>02933        <span class="keywordflow">for</span> (k = 0; k &lt; numComps[i]; k++) {
<a name="l02934"></a>02934          <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>)
<a name="l02935"></a>02935            values[current] = ((<span class="keywordtype">char</span>*)data)[k];
<a name="l02936"></a>02936          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>)
<a name="l02937"></a>02937            values[current] = ((<span class="keywordtype">int</span>*)data)[k];
<a name="l02938"></a>02938          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>)
<a name="l02939"></a>02939               values[current] = ((<span class="keywordtype">float</span>*)data)[k];
<a name="l02940"></a>02940          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>)
<a name="l02941"></a>02941            values[current] = ((<span class="keywordtype">double</span>*)data)[k];
<a name="l02942"></a>02942          current++;
<a name="l02943"></a>02943        }
<a name="l02944"></a>02944      }
<a name="l02945"></a>02945      error = ex_put_glob_vars(exoid, j+1, numGlbVar, values);
<a name="l02946"></a>02946      <span class="keywordflow">if</span> (error != 0) {
<a name="l02947"></a>02947        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put global vars for "</span>
<a name="l02948"></a>02948                     <span class="stringliteral">"step %d"</span>, j);
<a name="l02949"></a>02949        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l02950"></a>02950      }
<a name="l02951"></a>02951      <span class="comment">// global vars not read lazily, so no committed flag</span>
<a name="l02952"></a>02952       }
<a name="l02953"></a>02953     }
<a name="l02954"></a>02954 
<a name="l02955"></a>02955     <span class="comment">// cleanup (outside because numGlbVar could be zero even if numGlbSeqVar not)</span>
<a name="l02956"></a>02956     free(numComps);
<a name="l02957"></a>02957     <span class="keywordflow">for</span> (i = 0; i &lt; numGlbSeqVar; i++)
<a name="l02958"></a>02958       free(glbSeqVars[i]);
<a name="l02959"></a>02959     free(glbSeqVars);
<a name="l02960"></a>02960     free(numStepPerSeqVar);
<a name="l02961"></a>02961   }
<a name="l02962"></a>02962 
<a name="l02963"></a>02963 
<a name="l02964"></a>02964   <span class="comment">// Write nodal vars</span>
<a name="l02965"></a>02965   <span class="comment">// count vars that can be nodal attributes </span>
<a name="l02966"></a>02966   <span class="comment">// FIXME: may want to check for ID, though that shouldnt matter</span>
<a name="l02967"></a>02967   <span class="comment">// because it will be a prop </span>
<a name="l02968"></a>02968   <a class="code" href="group__SimpleDataObjects.html#g109b38ffe38532b7a29b7899fb649953" title="Initialize a sorted blob array.">fc_initSortedBlobArray</a>(&amp;nattr_sba);
<a name="l02969"></a>02969   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l02970"></a>02970     <span class="keywordtype">int</span> numVar;
<a name="l02971"></a>02971     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *vars;
<a name="l02972"></a>02972     rc = <a class="code" href="group__Variable.html#ga96777675a667d79871c93c54729bde4" title="Get the variables in a mesh.">fc_getVariables</a>(meshes[i], &amp;numVar, &amp;vars);
<a name="l02973"></a>02973     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02974"></a>02974       <span class="keywordflow">return</span> rc;
<a name="l02975"></a>02975     <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l02976"></a>02976       <span class="keywordtype">int</span> numComp;
<a name="l02977"></a>02977       <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l02978"></a>02978       <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l02979"></a>02979       rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(vars[j], NULL, &amp;numComp, &amp;assoc, NULL,
<a name="l02980"></a>02980                               &amp;dataType);
<a name="l02981"></a>02981       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02982"></a>02982         <span class="keywordflow">return</span> rc;
<a name="l02983"></a>02983       <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a> &amp;&amp;
<a name="l02984"></a>02984        (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a> || dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a> ||
<a name="l02985"></a>02985         dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a> || dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>) ){      
<a name="l02986"></a>02986      <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *tempVar = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>));
<a name="l02987"></a>02987      <span class="keywordflow">if</span> (!tempVar){
<a name="l02988"></a>02988        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l02989"></a>02989        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02990"></a>02990      }
<a name="l02991"></a>02991 
<a name="l02992"></a>02992      *tempVar = vars[j];
<a name="l02993"></a>02993      rc = <a class="code" href="group__SimpleDataObjects.html#g8e48e19abdc6075d704ce95b378087ab" title="Add a blob to a sorted blob array.">fc_addBlobToSortedBlobArray</a>(&amp;nattr_sba, tempVar,
<a name="l02994"></a>02994                           <a class="code" href="group__ExodusFileIO.html#gbccd96e8e4b129c566597245fc7b36f3" title="Compare algorithm for sorting seq vars including the meshID.">_fc_exo_seqVar_meshID_cmp</a>); 
<a name="l02995"></a>02995      <span class="keywordflow">if</span> (rc &lt; <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l02996"></a>02996        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"failed to add nodal var to nattr_sba"</span>);
<a name="l02997"></a>02997        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l02998"></a>02998      }
<a name="l02999"></a>02999      <span class="comment">// Warn about "duplicates" which are dropped ...</span>
<a name="l03000"></a>03000      <span class="keywordflow">if</span> (rc == 0) {
<a name="l03001"></a>03001        <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Encountered duplicate var, ignoring"</span>);
<a name="l03002"></a>03002        free(tempVar);
<a name="l03003"></a>03003      }
<a name="l03004"></a>03004       }
<a name="l03005"></a>03005     } <span class="comment">// end of loop over vars</span>
<a name="l03006"></a>03006     free(vars);
<a name="l03007"></a>03007   } <span class="comment">// end of loop over meshes</span>
<a name="l03008"></a>03008 
<a name="l03009"></a>03009   numNodalAttrs = 0;
<a name="l03010"></a>03010   <span class="keywordflow">if</span> (nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a> &gt; 0) {
<a name="l03011"></a>03011     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> ***sortedVars; <span class="comment">//[varIndex][meshID] </span>
<a name="l03012"></a>03012     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a> *last_Var, *curr_Var; 
<a name="l03013"></a>03013     <span class="keywordtype">int</span>* numNodalComps;
<a name="l03014"></a>03014 
<a name="l03015"></a>03015     numNodalAttrs = 1;
<a name="l03016"></a>03016     <span class="keywordflow">if</span> (nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a> &gt; 1){
<a name="l03017"></a>03017       last_Var = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[0];
<a name="l03018"></a>03018       for ( i = 1; i &lt; nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a>; i++){
<a name="l03019"></a>03019      <span class="comment">//we already know the assoc types are all the same</span>
<a name="l03020"></a>03020      curr_Var = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[i];
<a name="l03021"></a>03021      if (<a class="code" href="group__ExodusFileIO.html#g8665aefc96fcacfeff464a210f1e1fb3" title="Compare algorithm for sorting seq vars.">_fc_exo_seqVar_cmp</a>(curr_Var, last_Var) != 0){
<a name="l03022"></a>03022        numNodalAttrs++; <span class="comment">//note that this hasnt split things up into components</span>
<a name="l03023"></a>03023      }
<a name="l03024"></a>03024      last_Var = curr_Var;
<a name="l03025"></a>03025       }
<a name="l03026"></a>03026     }
<a name="l03027"></a>03027 
<a name="l03028"></a>03028     <span class="comment">// convert to array of var handles (w/ possible empty slots)</span>
<a name="l03029"></a>03029     <span class="comment">// handing off responsibility for vars</span>
<a name="l03030"></a>03030     k = 0;
<a name="l03031"></a>03031     curr_Var = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[k];
<a name="l03032"></a>03032     sortedVars = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>***)malloc(numNodalAttrs*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>**));
<a name="l03033"></a>03033     <span class="keywordflow">if</span> (!sortedVars){
<a name="l03034"></a>03034       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03035"></a>03035       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03036"></a>03036     }
<a name="l03037"></a>03037     <span class="keywordflow">for</span> (j = 0; j &lt; numNodalAttrs; j++){
<a name="l03038"></a>03038       sortedVars[j] = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>**)calloc(numMesh,<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*));
<a name="l03039"></a>03039       <span class="keywordflow">if</span> (!sortedVars[j]) {
<a name="l03040"></a>03040      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03041"></a>03041      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03042"></a>03042       }
<a name="l03043"></a>03043 
<a name="l03044"></a>03044       last_Var = curr_Var; <span class="comment">// quaranteed to get 1st one</span>
<a name="l03045"></a>03045       <span class="keywordflow">while</span> (k &lt; nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a>) {
<a name="l03046"></a>03046      curr_Var = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)nattr_sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[k];
<a name="l03047"></a>03047      <span class="keywordtype">int</span> meshID = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(<a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(*curr_Var)-&gt;<a class="code" href="struct__FC__VarSlot.html#7afb59f267464c49b3546acca51e985c">mesh</a>)-&gt;<a class="code" href="struct__FC__MeshSlot.html#7a7ee46d42eae43d9466223c954472fb">fileInfo</a>.exoInfo.meshID;
<a name="l03048"></a>03048      <span class="keywordflow">if</span> (<a class="code" href="group__ExodusFileIO.html#g8665aefc96fcacfeff464a210f1e1fb3" title="Compare algorithm for sorting seq vars.">_fc_exo_seqVar_cmp</a>(curr_Var, last_Var) != 0)
<a name="l03049"></a>03049        <span class="keywordflow">break</span>; <span class="comment">// move onto next var</span>
<a name="l03050"></a>03050      sortedVars[j][meshID] = curr_Var;
<a name="l03051"></a>03051      k++;
<a name="l03052"></a>03052       }
<a name="l03053"></a>03053     }
<a name="l03054"></a>03054 
<a name="l03055"></a>03055     <span class="comment">// Write number and names of nodal variables</span>
<a name="l03056"></a>03056     {
<a name="l03057"></a>03057       <span class="keywordtype">int</span> current;
<a name="l03058"></a>03058       <span class="keywordtype">int</span> numVar = numNodalAttrs;
<a name="l03059"></a>03059       <span class="keywordtype">int</span> numExoVar = numVar; <span class="comment">// currently includes multicomponents as solos                    </span>
<a name="l03060"></a>03060       <span class="keywordtype">char</span>** names, **temp_names;
<a name="l03061"></a>03061 
<a name="l03062"></a>03062       <span class="comment">// assemble names array                                                                </span>
<a name="l03063"></a>03063       <span class="comment">// CHECK for multicomponent =&gt; have to write as separate components                    </span>
<a name="l03064"></a>03064       names = (<span class="keywordtype">char</span>**)malloc(numVar*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*)); <span class="comment">// this might grow                       </span>
<a name="l03065"></a>03065       numNodalComps = (<span class="keywordtype">int</span>*)malloc(numVar*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); <span class="comment">// won't grow                          </span>
<a name="l03066"></a>03066       <span class="keywordflow">if</span> (!names || !numNodalComps) {
<a name="l03067"></a>03067         free(names); free(numNodalComps);
<a name="l03068"></a>03068         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03069"></a>03069         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03070"></a>03070       }
<a name="l03071"></a>03071       current = 0;
<a name="l03072"></a>03072 
<a name="l03073"></a>03073       <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l03074"></a>03074         <span class="keywordtype">int</span> validID;
<a name="l03075"></a>03075         <span class="keywordtype">int</span> numComp;
<a name="l03076"></a>03076         <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype;
<a name="l03077"></a>03077 
<a name="l03078"></a>03078         <span class="comment">// Find a valid seqVar (not all meshes may have a seqvar)                            </span>
<a name="l03079"></a>03079         validID = -1;
<a name="l03080"></a>03080         <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++) {
<a name="l03081"></a>03081           <span class="keywordflow">if</span> (sortedVars[j][k]) {
<a name="l03082"></a>03082             validID = k;
<a name="l03083"></a>03083             <span class="keywordflow">break</span>;
<a name="l03084"></a>03084           }
<a name="l03085"></a>03085         }
<a name="l03086"></a>03086         <span class="keywordflow">if</span> (validID &lt; 0) {
<a name="l03087"></a>03087           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error?"</span>);
<a name="l03088"></a>03088           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03089"></a>03089         }
<a name="l03090"></a>03090      <span class="comment">// Add the var's name (or names if multicomponent)                                   </span>
<a name="l03091"></a>03091         rc = <a class="code" href="group__Variable.html#g233584b319c5dd90a13582fc9ac3484e" title="Return name of a variable.">fc_getVariableName</a>(*(sortedVars[j][validID]),
<a name="l03092"></a>03092                                 &amp;temp_name);
<a name="l03093"></a>03093         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03094"></a>03094           <span class="keywordflow">return</span> rc;
<a name="l03095"></a>03095         rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(*(sortedVars[j][validID]), NULL,
<a name="l03096"></a>03096                                 &amp;numComp, NULL, &amp;mathtype, NULL);
<a name="l03097"></a>03097         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03098"></a>03098           <span class="keywordflow">return</span> rc;
<a name="l03099"></a>03099         numNodalComps[j] = numComp; <span class="comment">// save for later usage                                   </span>
<a name="l03100"></a>03100         <span class="keywordflow">if</span> (numComp &gt; 1) {
<a name="l03101"></a>03101           numExoVar += numComp - 1;  <span class="comment">// -1 'cause 1 component already counted                </span>
<a name="l03102"></a>03102           temp_names = realloc(names, numExoVar*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l03103"></a>03103           <span class="keywordflow">if</span> (!temp_names) {
<a name="l03104"></a>03104             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03105"></a>03105             <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03106"></a>03106           }
<a name="l03107"></a>03107           names = temp_names;
<a name="l03108"></a>03108         }
<a name="l03109"></a>03109         <span class="keywordflow">for</span> (k = 0; k &lt; numComp; k++) {
<a name="l03110"></a>03110           rc = <a class="code" href="group__ExodusFileIO.html#g2c3f4682201e3afdf8e2d18fe02e6675" title="Create the name for a component of a variable to use in Exodus file.">_fc_createExoVarCompName</a>(temp_name, numComp, mathtype, k,
<a name="l03111"></a>03111                                         &amp;names[current]);
<a name="l03112"></a>03112           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03113"></a>03113             <span class="keywordflow">return</span> rc;
<a name="l03114"></a>03114           current++;
<a name="l03115"></a>03115         }
<a name="l03116"></a>03116         free(temp_name);
<a name="l03117"></a>03117       }
<a name="l03118"></a>03118 
<a name="l03119"></a>03119       error = ex_put_attr_param(exoid, EX_NODAL, 0, numExoVar);
<a name="l03120"></a>03120       <span class="keywordflow">if</span> (error != 0) {
<a name="l03121"></a>03121      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put nodal var param"</span>);
<a name="l03122"></a>03122      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03123"></a>03123       }
<a name="l03124"></a>03124       error = ex_put_attr_names(exoid, EX_NODAL, 0, names);
<a name="l03125"></a>03125       <span class="keywordflow">if</span> (error != 0) {
<a name="l03126"></a>03126      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put nodal var names"</span>);
<a name="l03127"></a>03127      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03128"></a>03128       }
<a name="l03129"></a>03129 
<a name="l03130"></a>03130       <span class="comment">// cleanup names array </span>
<a name="l03131"></a>03131       <span class="keywordflow">for</span> (j = 0; j &lt; numExoVar; j++)
<a name="l03132"></a>03132         free(names[j]);
<a name="l03133"></a>03133       free(names);
<a name="l03134"></a>03134     }
<a name="l03135"></a>03135 
<a name="l03136"></a>03136     <span class="comment">// write nodal data</span>
<a name="l03137"></a>03137     {
<a name="l03138"></a>03138       <span class="comment">// write var for all nodes, per step                                                   </span>
<a name="l03139"></a>03139       <span class="keywordtype">double</span>* values = malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l03140"></a>03140       <span class="keywordflow">if</span> (!values) {
<a name="l03141"></a>03141      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03142"></a>03142      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03143"></a>03143       }
<a name="l03144"></a>03144       <span class="keywordtype">void</span>* data;
<a name="l03145"></a>03145       <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l03146"></a>03146       <span class="keywordtype">int</span> current = 0;
<a name="l03147"></a>03147       <span class="keywordflow">for</span> (k = 0; k &lt; numNodalAttrs; k++){
<a name="l03148"></a>03148      <span class="keywordflow">for</span> (m = 0; m &lt; numNodalComps[k]; m++) {
<a name="l03149"></a>03149        <span class="keywordflow">for</span> (n = 0; n &lt; numTotalVert; n++)
<a name="l03150"></a>03150          values[n] = 0; <span class="comment">// initialize in case values don't exist                      </span>
<a name="l03151"></a>03151        <span class="keywordflow">for</span> (n = 0; n &lt; numMesh; n++) {
<a name="l03152"></a>03152          <span class="comment">// FIX add a warning for this - do it in names section above ??</span>
<a name="l03153"></a>03153          <span class="keywordflow">if</span> (!sortedVars[k][n])
<a name="l03154"></a>03154            <span class="keywordflow">continue</span>; <span class="comment">// skip if var doesn't exist == pad with zeros                   </span>
<a name="l03155"></a>03155          <a class="code" href="group__Variable.html#gd3b7cecfd0c6d488e82b426b4c114aba" title="Return the data type of a variable.">fc_getVariableDataType</a>(*sortedVars[k][n], &amp;dataType);
<a name="l03156"></a>03156          <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(*sortedVars[k][n], &amp;data);
<a name="l03157"></a>03157          <span class="keywordflow">for</span> (p = 0; p &lt; numVerts[n]; p++) {
<a name="l03158"></a>03158            <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>)
<a name="l03159"></a>03159           values[vertOffsets[n] + p] = ((<span class="keywordtype">int</span>*)data)[p*numNodalComps[k]+m];
<a name="l03160"></a>03160            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>)
<a name="l03161"></a>03161           values[vertOffsets[n] + p] = ((<span class="keywordtype">float</span>*)data)[p*numNodalComps[k]+m];
<a name="l03162"></a>03162            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>)
<a name="l03163"></a>03163           values[vertOffsets[n] + p] = ((<span class="keywordtype">double</span>*)data)[p*numNodalComps[k]+m];
<a name="l03164"></a>03164            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>){
<a name="l03165"></a>03165           values[vertOffsets[n] + p] = ((<span class="keywordtype">char</span>*)data)[p*numNodalComps[k]+m];
<a name="l03166"></a>03166            }
<a name="l03167"></a>03167          }
<a name="l03168"></a>03168        }
<a name="l03169"></a>03169        error = ex_put_one_attr(exoid, EX_NODAL, 0, current+1, values);
<a name="l03170"></a>03170        <span class="keywordflow">if</span> (error != 0) {
<a name="l03171"></a>03171          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put nodal attr"</span>);
<a name="l03172"></a>03172          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03173"></a>03173        }
<a name="l03174"></a>03174        current++;
<a name="l03175"></a>03175      }
<a name="l03176"></a>03176       }
<a name="l03177"></a>03177       free(values);
<a name="l03178"></a>03178     }
<a name="l03179"></a>03179 
<a name="l03180"></a>03180     <span class="comment">// Cleanup                                                                               </span>
<a name="l03181"></a>03181     free(numNodalComps);
<a name="l03182"></a>03182    <span class="keywordflow">for</span> (j = 0; j &lt; numNodalAttrs; j++) {
<a name="l03183"></a>03183       <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++)
<a name="l03184"></a>03184      free(sortedVars[j][k]);
<a name="l03185"></a>03185       free(sortedVars[j]);
<a name="l03186"></a>03186     }
<a name="l03187"></a>03187     free(sortedVars);
<a name="l03188"></a>03188   } <span class="comment">//numBlob &gt; 0</span>
<a name="l03189"></a>03189 
<a name="l03190"></a>03190   <span class="comment">// delete nattr_sba (internal data was handed off above)</span>
<a name="l03191"></a>03191   <a class="code" href="group__SimpleDataObjects.html#g7d6fe5f9fead77e709e968fc810672c7" title="Free the sorted blob array&amp;#39;s values.">fc_freeSortedBlobArray</a>(&amp;nattr_sba);
<a name="l03192"></a>03192 
<a name="l03193"></a>03193 
<a name="l03194"></a>03194   <span class="comment">// --- Write seq variables ---</span>
<a name="l03195"></a>03195   <span class="comment">// FIX? committed flag and exoinfo stuff not set so cannot release ...</span>
<a name="l03196"></a>03196   <span class="comment">//      this is hard to fix due to mulitcomponent variables</span>
<a name="l03197"></a>03197 
<a name="l03198"></a>03198   <span class="comment">// Sort the seq vars by assoc type, then other stuff, &amp; lastely by meshID.</span>
<a name="l03199"></a>03199   <a class="code" href="group__SimpleDataObjects.html#g109b38ffe38532b7a29b7899fb649953" title="Initialize a sorted blob array.">fc_initSortedBlobArray</a>(&amp;sba);
<a name="l03200"></a>03200   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l03201"></a>03201     <span class="keywordtype">int</span> numSeqVar, *numStepPerSeq;
<a name="l03202"></a>03202     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>** seqVars;
<a name="l03203"></a>03203     rc = <a class="code" href="group__Variable.html#g01bf1b0d9b1de983115a461216039449" title="Get the sequence variables in a mesh.">fc_getSeqVariables</a>(meshes[i], &amp;numSeqVar, &amp;numStepPerSeq, &amp;seqVars);
<a name="l03204"></a>03204     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03205"></a>03205       <span class="keywordflow">return</span> rc;
<a name="l03206"></a>03206     <span class="keywordflow">for</span> (j = 0; j &lt; numSeqVar; j++) {
<a name="l03207"></a>03207       <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a> temp_sequence;
<a name="l03208"></a>03208       rc = <a class="code" href="group__Variable.html#g314a992ec5ba07d7075f1172b13ef166" title="Get the parent sequence of a sequence variable.">fc_getSequenceFromSeqVariable</a>(numStepPerSeq[j], seqVars[j],
<a name="l03209"></a>03209                                          &amp;temp_sequence);
<a name="l03210"></a>03210       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03211"></a>03211         <span class="keywordflow">return</span> rc;
<a name="l03212"></a>03212       <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(sequence, temp_sequence)) {
<a name="l03213"></a>03213         <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Encountered var not on the first sequence, "</span>
<a name="l03214"></a>03214                                 <span class="stringliteral">"ignoring"</span>)
<a name="l03215"></a>03215         continue;
<a name="l03216"></a>03216       }
<a name="l03217"></a>03217       rc = <a class="code" href="group__SimpleDataObjects.html#g8e48e19abdc6075d704ce95b378087ab" title="Add a blob to a sorted blob array.">fc_addBlobToSortedBlobArray</a>(&amp;sba, seqVars[j],
<a name="l03218"></a>03218                            <a class="code" href="group__ExodusFileIO.html#gbccd96e8e4b129c566597245fc7b36f3" title="Compare algorithm for sorting seq vars including the meshID.">_fc_exo_seqVar_meshID_cmp</a>); 
<a name="l03219"></a>03219       if (rc &lt; <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l03220"></a>03220         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"failed to add seqvar to sba"</span>);
<a name="l03221"></a>03221         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03222"></a>03222       }
<a name="l03223"></a>03223       <span class="comment">// Warn about "duplicates" which are dropped ...</span>
<a name="l03224"></a>03224       <span class="keywordflow">if</span> (rc == 0) {
<a name="l03225"></a>03225      free(seqVars[j]);
<a name="l03226"></a>03226      <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Encountered duplicate seqvar, ignoring"</span>);
<a name="l03227"></a>03227       }
<a name="l03228"></a>03228     }
<a name="l03229"></a>03229     free(numStepPerSeq);
<a name="l03230"></a>03230     free(seqVars);
<a name="l03231"></a>03231   }
<a name="l03232"></a>03232 
<a name="l03233"></a>03233   <span class="keywordflow">if</span> (sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a> &gt; 0) {
<a name="l03234"></a>03234     <span class="comment">// FIX: Could make this code clearer - actually have each assoc type</span>
<a name="l03235"></a>03235     <span class="comment">// as separate array?</span>
<a name="l03236"></a>03236     <span class="comment">//int total possible is = 7;</span>
<a name="l03237"></a>03237     <span class="keywordtype">int</span> numAssocType = 0;
<a name="l03238"></a>03238     <span class="keywordtype">int</span> numVarPerAssocType[7] = { 0, 0, 0, 0, 0, 0 }; <span class="comment">// num uniquely name seqvars</span>
<a name="l03239"></a>03239                                                    <span class="comment">// of that type</span>
<a name="l03240"></a>03240     <span class="keywordtype">int</span> numExoVarPerAssocType[7];
<a name="l03241"></a>03241     <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> lastAssoc = -1, assocTypes[7];
<a name="l03242"></a>03242     <span class="keywordtype">char</span> exoVarTypes[7][2];
<a name="l03243"></a>03243     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*** sortedSeqVars[7]; <span class="comment">// [assocType][varIndexPerType][meshID]</span>
<a name="l03244"></a>03244     <span class="keywordtype">int</span>* numComps[7]; <span class="comment">// [assocType][varIndexPerType]</span>
<a name="l03245"></a>03245     <a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>* last_seqVar = NULL, *curr_seqVar;
<a name="l03246"></a>03246 
<a name="l03247"></a>03247     <span class="comment">// count number of vars of each assoc type</span>
<a name="l03248"></a>03248     <span class="keywordflow">for</span> (i = 0; i &lt; sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a>; i++) {
<a name="l03249"></a>03249       <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l03250"></a>03250       curr_seqVar = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[i];
<a name="l03251"></a>03251       rc = <a class="code" href="group__Variable.html#ge4935bc28dae482ddabcfd421400ab13" title="Return data association of a variable.">fc_getVariableAssociationType</a>(curr_seqVar[0], &amp;assoc);
<a name="l03252"></a>03252       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03253"></a>03253         <span class="keywordflow">return</span> rc;
<a name="l03254"></a>03254       <span class="comment">// if of same assoc, only increment if really a new var</span>
<a name="l03255"></a>03255       <span class="keywordflow">if</span> (assoc == lastAssoc) {
<a name="l03256"></a>03256         <span class="keywordflow">if</span> (<a class="code" href="group__ExodusFileIO.html#g8665aefc96fcacfeff464a210f1e1fb3" title="Compare algorithm for sorting seq vars.">_fc_exo_seqVar_cmp</a>(curr_seqVar, last_seqVar) != 0)
<a name="l03257"></a>03257           numVarPerAssocType[numAssocType-1]++;
<a name="l03258"></a>03258       }
<a name="l03259"></a>03259       <span class="comment">// else, change the current association type and count as first</span>
<a name="l03260"></a>03260       <span class="keywordflow">else</span> {
<a name="l03261"></a>03261         numAssocType++;
<a name="l03262"></a>03262         numVarPerAssocType[numAssocType-1]++;
<a name="l03263"></a>03263         assocTypes[numAssocType-1] = assoc;
<a name="l03264"></a>03264         lastAssoc = assoc;
<a name="l03265"></a>03265       }
<a name="l03266"></a>03266       last_seqVar = curr_seqVar;
<a name="l03267"></a>03267     }
<a name="l03268"></a>03268     <span class="comment">// convert to array of var handles (w/ possible empty slots)</span>
<a name="l03269"></a>03269     <span class="comment">// handing off responsibility for seqVar arrays</span>
<a name="l03270"></a>03270     k = 0;
<a name="l03271"></a>03271     curr_seqVar = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[k];
<a name="l03272"></a>03272     for (i = 0; i &lt; numAssocType; i++) {
<a name="l03273"></a>03273       sortedSeqVars[i] = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>***)malloc(numVarPerAssocType[i]*
<a name="l03274"></a>03274                                                 <span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>**));
<a name="l03275"></a>03275       <span class="keywordflow">if</span> (!sortedSeqVars[i]) {
<a name="l03276"></a>03276         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03277"></a>03277         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03278"></a>03278       }
<a name="l03279"></a>03279       <span class="keywordflow">for</span> (j = 0; j &lt; numVarPerAssocType[i]; j++) {
<a name="l03280"></a>03280         sortedSeqVars[i][j] = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>**)calloc(numMesh,
<a name="l03281"></a>03281                                                     <span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*));
<a name="l03282"></a>03282         <span class="keywordflow">if</span> (!sortedSeqVars[i][j]) {
<a name="l03283"></a>03283           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03284"></a>03284           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03285"></a>03285         }
<a name="l03286"></a>03286         last_seqVar = curr_seqVar; <span class="comment">// quaranteed to get 1st one</span>
<a name="l03287"></a>03287      <span class="keywordflow">while</span> (k &lt; sba.<a class="code" href="structFC__SortedBlobArray.html#34c6ab8d6c82a778a557ceddfda083cf">numBlob</a>) {
<a name="l03288"></a>03288           curr_seqVar = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)sba.<a class="code" href="structFC__SortedBlobArray.html#f9dbb9592866625fb9da739cea70c6b1">blobs</a>[k];
<a name="l03289"></a>03289           <span class="keywordtype">int</span> meshID = <a class="code" href="group__PrivateMesh.html#g6bb5928d0f0ecc4f5271315a3c7520d8" title="Get a mesh slot from a mesh handle.">_fc_getMeshSlot</a>(<a class="code" href="group__PrivateVariable.html#gf497c9a7299e6455d322dd98805ea8f0" title="Get a variable slot from a variable handle.">_fc_getVarSlot</a>(curr_seqVar[0])-&gt;<a class="code" href="struct__FC__VarSlot.html#7afb59f267464c49b3546acca51e985c">mesh</a>)
<a name="l03290"></a>03290                                                 -&gt;fileInfo.exoInfo.meshID;
<a name="l03291"></a>03291           if (<a class="code" href="group__ExodusFileIO.html#g8665aefc96fcacfeff464a210f1e1fb3" title="Compare algorithm for sorting seq vars.">_fc_exo_seqVar_cmp</a>(curr_seqVar, last_seqVar) != 0)
<a name="l03292"></a>03292             <span class="keywordflow">break</span>; <span class="comment">// move onto next var</span>
<a name="l03293"></a>03293           sortedSeqVars[i][j][meshID] = curr_seqVar;
<a name="l03294"></a>03294           k++;
<a name="l03295"></a>03295         }
<a name="l03296"></a>03296       }
<a name="l03297"></a>03297     }
<a name="l03298"></a>03298     <span class="comment">// delete sba (internal data was handed off above)</span>
<a name="l03299"></a>03299     <a class="code" href="group__SimpleDataObjects.html#g7d6fe5f9fead77e709e968fc810672c7" title="Free the sorted blob array&amp;#39;s values.">fc_freeSortedBlobArray</a>(&amp;sba);
<a name="l03300"></a>03300 
<a name="l03301"></a>03301 
<a name="l03302"></a>03302     <span class="comment">// Write number and names of variables</span>
<a name="l03303"></a>03303     <span class="keywordflow">for</span> (i = 0; i &lt; numAssocType; i++) {
<a name="l03304"></a>03304       <span class="keywordtype">int</span> current;
<a name="l03305"></a>03305       <span class="keywordtype">int</span> numVar = numVarPerAssocType[i]; <span class="comment">// # of fclib variables</span>
<a name="l03306"></a>03306       <span class="keywordtype">int</span> numExoVar = numVar; <span class="comment">// includes multicomponents as solos</span>
<a name="l03307"></a>03307       <span class="keywordtype">char</span>** names, **temp_names;
<a name="l03308"></a>03308 
<a name="l03309"></a>03309       <span class="comment">// determine type</span>
<a name="l03310"></a>03310       <span class="keywordflow">switch</span> (assocTypes[i]) {
<a name="l03311"></a>03311       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6d5a38e6486b577a8d9bbba0e1c1a443d">FC_AT_UNKNOWN</a>:  strcpy(exoVarTypes[i], <span class="stringliteral">""</span>);   <span class="keywordflow">break</span>;
<a name="l03312"></a>03312       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>:   strcpy(exoVarTypes[i], <span class="stringliteral">"n"</span>);  <span class="keywordflow">break</span>;
<a name="l03313"></a>03313       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>:     strcpy(exoVarTypes[i], <span class="stringliteral">""</span>);   <span class="keywordflow">break</span>;
<a name="l03314"></a>03314       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>:     strcpy(exoVarTypes[i], <span class="stringliteral">""</span>);   <span class="keywordflow">break</span>;
<a name="l03315"></a>03315       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>:  strcpy(exoVarTypes[i], <span class="stringliteral">"e"</span>);  <span class="keywordflow">break</span>;
<a name="l03316"></a>03316       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>:    strcpy(exoVarTypes[i], <span class="stringliteral">""</span>);  <span class="keywordflow">break</span>;
<a name="l03317"></a>03317       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af6ac55a57488add4ea9f01eac5c9eab232">FC_AT_WHOLE_DATASET</a>:    strcpy(exoVarTypes[i], <span class="stringliteral">""</span>);  <span class="keywordflow">break</span>;
<a name="l03318"></a>03318       <span class="keywordflow">default</span>:
<a name="l03319"></a>03319         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"invalid assocation type encountered"</span>);
<a name="l03320"></a>03320         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03321"></a>03321       }
<a name="l03322"></a>03322 
<a name="l03323"></a>03323       <span class="comment">// assemble names array</span>
<a name="l03324"></a>03324       <span class="comment">// CHECK for multicomponent =&gt; have to write as separate components</span>
<a name="l03325"></a>03325       names = (<span class="keywordtype">char</span>**)malloc(numVar*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*)); <span class="comment">// this might grow</span>
<a name="l03326"></a>03326       numComps[i] = (<span class="keywordtype">int</span>*)malloc(numVar*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); <span class="comment">// won't grow</span>
<a name="l03327"></a>03327       <span class="keywordflow">if</span> (!names || !numComps[i]) {
<a name="l03328"></a>03328         free(names); free(numComps[i]);
<a name="l03329"></a>03329         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03330"></a>03330         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03331"></a>03331       }
<a name="l03332"></a>03332       current = 0;
<a name="l03333"></a>03333       <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l03334"></a>03334         <span class="keywordtype">int</span> validID;
<a name="l03335"></a>03335         <span class="keywordtype">int</span> numComp;
<a name="l03336"></a>03336         <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype;
<a name="l03337"></a>03337 
<a name="l03338"></a>03338         <span class="comment">// Find a valid seqVar (not all meshes may have a seqvar)</span>
<a name="l03339"></a>03339         validID = -1;
<a name="l03340"></a>03340         <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++) {
<a name="l03341"></a>03341           <span class="keywordflow">if</span> (sortedSeqVars[i][j][k]) {
<a name="l03342"></a>03342             validID = k;
<a name="l03343"></a>03343             <span class="keywordflow">break</span>;
<a name="l03344"></a>03344           }
<a name="l03345"></a>03345         }
<a name="l03346"></a>03346         <span class="keywordflow">if</span> (validID &lt; 0) {
<a name="l03347"></a>03347           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error?"</span>);
<a name="l03348"></a>03348           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03349"></a>03349         }
<a name="l03350"></a>03350 
<a name="l03351"></a>03351         <span class="comment">// Add the var's name (or names if multicomponent)</span>
<a name="l03352"></a>03352         rc = <a class="code" href="group__Variable.html#g233584b319c5dd90a13582fc9ac3484e" title="Return name of a variable.">fc_getVariableName</a>(sortedSeqVars[i][j][validID][0], 
<a name="l03353"></a>03353                                 &amp;temp_name);
<a name="l03354"></a>03354         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03355"></a>03355           <span class="keywordflow">return</span> rc;
<a name="l03356"></a>03356         rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(sortedSeqVars[i][j][validID][0], NULL, 
<a name="l03357"></a>03357                                 &amp;numComp, NULL, &amp;mathtype, NULL);
<a name="l03358"></a>03358         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03359"></a>03359           <span class="keywordflow">return</span> rc;
<a name="l03360"></a>03360         numComps[i][j] = numComp; <span class="comment">// save for later useage</span>
<a name="l03361"></a>03361         <span class="keywordflow">if</span> (numComp &gt; 1) {
<a name="l03362"></a>03362           numExoVar += numComp - 1;  <span class="comment">// -1 'cause 1 component already counted</span>
<a name="l03363"></a>03363           temp_names = realloc(names, numExoVar*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l03364"></a>03364           <span class="keywordflow">if</span> (!temp_names) {
<a name="l03365"></a>03365             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03366"></a>03366             <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03367"></a>03367           }
<a name="l03368"></a>03368           names = temp_names;
<a name="l03369"></a>03369         }
<a name="l03370"></a>03370         <span class="keywordflow">for</span> (k = 0; k &lt; numComp; k++) {
<a name="l03371"></a>03371           rc = <a class="code" href="group__ExodusFileIO.html#g2c3f4682201e3afdf8e2d18fe02e6675" title="Create the name for a component of a variable to use in Exodus file.">_fc_createExoVarCompName</a>(temp_name, numComp, mathtype, k,
<a name="l03372"></a>03372                                         &amp;names[current]);
<a name="l03373"></a>03373           <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l03374"></a>03374             <span class="keywordflow">return</span> rc;
<a name="l03375"></a>03375           current++;
<a name="l03376"></a>03376         }
<a name="l03377"></a>03377         free(temp_name);
<a name="l03378"></a>03378       }
<a name="l03379"></a>03379       numExoVarPerAssocType[i] = numExoVar; <span class="comment">// save for later</span>
<a name="l03380"></a>03380  
<a name="l03381"></a>03381       <span class="comment">// Process names - write to exo or explain why can't</span>
<a name="l03382"></a>03382       <span class="keywordflow">if</span> (!strcmp(exoVarTypes[i], <span class="stringliteral">""</span>)) {
<a name="l03383"></a>03383         <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Exodus can't handle variables with "</span>
<a name="l03384"></a>03384                                 <span class="stringliteral">"association type '%s'"</span>, 
<a name="l03385"></a>03385                                 <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(assocTypes[i]));
<a name="l03386"></a>03386         <span class="keywordflow">for</span> (j = 0; j &lt; numExoVar; j++)
<a name="l03387"></a>03387           <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"  Discarding %s variable '%s'"</span>,
<a name="l03388"></a>03388                                   <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(assocTypes[i]),
<a name="l03389"></a>03389                                   names[j]);
<a name="l03390"></a>03390       }
<a name="l03391"></a>03391       <span class="keywordflow">else</span> {
<a name="l03392"></a>03392         error = ex_put_var_param(exoid, exoVarTypes[i], numExoVar);
<a name="l03393"></a>03393         <span class="keywordflow">if</span> (error != 0) {
<a name="l03394"></a>03394           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put '%s' var param"</span>, exoVarTypes[i]);
<a name="l03395"></a>03395           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03396"></a>03396         }
<a name="l03397"></a>03397         error = ex_put_var_names(exoid, exoVarTypes[i], numExoVar, names);
<a name="l03398"></a>03398         <span class="keywordflow">if</span> (error != 0) {
<a name="l03399"></a>03399           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put '%s' var names"</span>, exoVarTypes[i]);
<a name="l03400"></a>03400           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03401"></a>03401         }
<a name="l03402"></a>03402       }
<a name="l03403"></a>03403 
<a name="l03404"></a>03404       <span class="comment">// cleanup names array</span>
<a name="l03405"></a>03405       <span class="keywordflow">for</span> (j = 0; j &lt; numExoVar; j++)
<a name="l03406"></a>03406         free(names[j]);
<a name="l03407"></a>03407       free(names);
<a name="l03408"></a>03408 
<a name="l03409"></a>03409       <span class="comment">// Write Element var truth table if elements</span>
<a name="l03410"></a>03410       <span class="keywordflow">if</span> (assocTypes[i] == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>) {
<a name="l03411"></a>03411         <span class="keywordtype">int</span>* truth_table;
<a name="l03412"></a>03412         truth_table = calloc(numMesh*numExoVar, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03413"></a>03413         <span class="keywordflow">if</span> (!truth_table) {
<a name="l03414"></a>03414           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03415"></a>03415           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03416"></a>03416         }
<a name="l03417"></a>03417         current = 0;
<a name="l03418"></a>03418         <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l03419"></a>03419           <span class="keywordflow">for</span> (k = 0; k &lt; numVar; k++) {
<a name="l03420"></a>03420             <span class="keywordflow">for</span> (m = 0; m &lt; numComps[i][k]; m++) {
<a name="l03421"></a>03421               <span class="keywordflow">if</span> (sortedSeqVars[i][k][j])
<a name="l03422"></a>03422                 truth_table[current] = 1;
<a name="l03423"></a>03423               current++;
<a name="l03424"></a>03424             }
<a name="l03425"></a>03425           }
<a name="l03426"></a>03426         }
<a name="l03427"></a>03427         error = ex_put_elem_var_tab(exoid, numMesh, numExoVar, truth_table);
<a name="l03428"></a>03428         <span class="keywordflow">if</span> (error != 0) {
<a name="l03429"></a>03429           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Failed to put element var truth table"</span>);
<a name="l03430"></a>03430           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03431"></a>03431         }
<a name="l03432"></a>03432         free(truth_table);
<a name="l03433"></a>03433       }
<a name="l03434"></a>03434     }
<a name="l03435"></a>03435 
<a name="l03436"></a>03436     <span class="comment">// write data</span>
<a name="l03437"></a>03437     <span class="keywordflow">for</span> (i = 0; i &lt; numAssocType; i++) {
<a name="l03438"></a>03438       <span class="keywordtype">int</span> numVar = numVarPerAssocType[i];
<a name="l03439"></a>03439         
<a name="l03440"></a>03440       <span class="comment">// skip types we aren't writing</span>
<a name="l03441"></a>03441       <span class="keywordflow">if</span> (!strcmp(exoVarTypes[i], <span class="stringliteral">""</span>)) 
<a name="l03442"></a>03442         <span class="keywordflow">continue</span>;
<a name="l03443"></a>03443       
<a name="l03444"></a>03444       <span class="comment">// do global vars</span>
<a name="l03445"></a>03445       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(exoVarTypes[i], <span class="stringliteral">"g"</span>)) {
<a name="l03446"></a>03446         <span class="keywordtype">double</span>* values;
<a name="l03447"></a>03447         <span class="keywordtype">void</span>* data;
<a name="l03448"></a>03448         <span class="keywordtype">int</span> validIDs[numVarPerAssocType[i]];
<a name="l03449"></a>03449         <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l03450"></a>03450         
<a name="l03451"></a>03451         <span class="comment">// Find 1st valid seqVar for each global var</span>
<a name="l03452"></a>03452         <span class="comment">// FIX? warn that we are only taking the first one? - will become</span>
<a name="l03453"></a>03453         <span class="comment">// moot if implement proper global vars</span>
<a name="l03454"></a>03454         <span class="keywordflow">for</span> (j = 0; j &lt; numVar; j++) {
<a name="l03455"></a>03455           validIDs[j] = -1;
<a name="l03456"></a>03456           <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++) {
<a name="l03457"></a>03457             <span class="keywordflow">if</span> (sortedSeqVars[i][j][k]) {
<a name="l03458"></a>03458               validIDs[j] = k;
<a name="l03459"></a>03459               <span class="keywordflow">break</span>;
<a name="l03460"></a>03460             }
<a name="l03461"></a>03461           }      
<a name="l03462"></a>03462           <span class="keywordflow">if</span> (validIDs[j] &lt; 0) {
<a name="l03463"></a>03463             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Programmer error?"</span>);
<a name="l03464"></a>03464             <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l03465"></a>03465           }
<a name="l03466"></a>03466         }
<a name="l03467"></a>03467 
<a name="l03468"></a>03468         <span class="comment">// make exo values array</span>
<a name="l03469"></a>03469         values = malloc(numExoVarPerAssocType[i]*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l03470"></a>03470         <span class="keywordflow">if</span> (!values) {
<a name="l03471"></a>03471           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03472"></a>03472           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03473"></a>03473         }
<a name="l03474"></a>03474         <span class="comment">// For each step, write all global vars</span>
<a name="l03475"></a>03475         <span class="keywordflow">for</span> (j = 0; j &lt; numStep; j++) {
<a name="l03476"></a>03476           <span class="keywordtype">int</span> current = 0;
<a name="l03477"></a>03477           <span class="keywordflow">for</span> (k = 0; k &lt; numVar; k++) {
<a name="l03478"></a>03478             <a class="code" href="group__Variable.html#gd3b7cecfd0c6d488e82b426b4c114aba" title="Return the data type of a variable.">fc_getVariableDataType</a>(sortedSeqVars[i][k][validIDs[k]][j], &amp;dataType);
<a name="l03479"></a>03479             <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(sortedSeqVars[i][k][validIDs[k]][j], &amp;data);
<a name="l03480"></a>03480             <span class="keywordflow">for</span> (m = 0; m &lt; numComps[i][k]; m++) {
<a name="l03481"></a>03481               <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>)
<a name="l03482"></a>03482                 values[current] = ((<span class="keywordtype">char</span>*)data)[m];
<a name="l03483"></a>03483               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>)
<a name="l03484"></a>03484                 values[current] = ((<span class="keywordtype">int</span>*)data)[m];
<a name="l03485"></a>03485               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>)
<a name="l03486"></a>03486                 values[current] = ((<span class="keywordtype">float</span>*)data)[m];
<a name="l03487"></a>03487               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>)
<a name="l03488"></a>03488                 values[current] = ((<span class="keywordtype">double</span>*)data)[m];
<a name="l03489"></a>03489               current++;
<a name="l03490"></a>03490             }
<a name="l03491"></a>03491           }
<a name="l03492"></a>03492           error = ex_put_glob_vars(exoid, j+1, numExoVarPerAssocType[i], 
<a name="l03493"></a>03493                                    values);
<a name="l03494"></a>03494           <span class="keywordflow">if</span> (error != 0) {
<a name="l03495"></a>03495             <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put global vars for "</span>
<a name="l03496"></a>03496                                   <span class="stringliteral">"step %d"</span>, j);
<a name="l03497"></a>03497             <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03498"></a>03498           }
<a name="l03499"></a>03499           <span class="comment">// global vars not read lazily, so no committed flag</span>
<a name="l03500"></a>03500         }
<a name="l03501"></a>03501         free(values);
<a name="l03502"></a>03502       }
<a name="l03503"></a>03503 
<a name="l03504"></a>03504       <span class="comment">// do nodal vars</span>
<a name="l03505"></a>03505       <span class="comment">// write var for all nodes, per step</span>
<a name="l03506"></a>03506       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(exoVarTypes[i], <span class="stringliteral">"n"</span>)) {
<a name="l03507"></a>03507         <span class="keywordtype">double</span>* values = malloc(numTotalVert*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l03508"></a>03508         <span class="keywordflow">if</span> (!values) {
<a name="l03509"></a>03509           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03510"></a>03510           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03511"></a>03511         }
<a name="l03512"></a>03512         <span class="keywordtype">void</span>* data;
<a name="l03513"></a>03513         <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l03514"></a>03514         <span class="keywordflow">for</span> (j = 0; j &lt; numStep; j++) {
<a name="l03515"></a>03515           <span class="keywordtype">int</span> current = 0;
<a name="l03516"></a>03516           <span class="keywordflow">for</span> (k = 0; k &lt; numVarPerAssocType[i]; k++) {
<a name="l03517"></a>03517             <span class="keywordflow">for</span> (m = 0; m &lt; numComps[i][k]; m++) {
<a name="l03518"></a>03518               <span class="keywordflow">for</span> (n = 0; n &lt; numTotalVert; n++) 
<a name="l03519"></a>03519                 values[n] = 0; <span class="comment">// initialize in case values don't exist</span>
<a name="l03520"></a>03520               <span class="keywordflow">for</span> (n = 0; n &lt; numMesh; n++) {
<a name="l03521"></a>03521                 <span class="comment">// FIX add a warning for this - do it in names section above</span>
<a name="l03522"></a>03522                 <span class="keywordflow">if</span> (!sortedSeqVars[i][k][n]) 
<a name="l03523"></a>03523                   <span class="keywordflow">continue</span>; <span class="comment">// skip if var doesn't exist == pad with zeros</span>
<a name="l03524"></a>03524                 <a class="code" href="group__Variable.html#gd3b7cecfd0c6d488e82b426b4c114aba" title="Return the data type of a variable.">fc_getVariableDataType</a>(sortedSeqVars[i][k][n][j], &amp;dataType);
<a name="l03525"></a>03525                 <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(sortedSeqVars[i][k][n][j], &amp;data);
<a name="l03526"></a>03526                 <span class="keywordflow">for</span> (p = 0; p &lt; numVerts[n]; p++) {
<a name="l03527"></a>03527                   <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>)
<a name="l03528"></a>03528                     values[vertOffsets[n] + p] = ((<span class="keywordtype">char</span>*)data)[p*numComps[i][k]+m];
<a name="l03529"></a>03529                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>)
<a name="l03530"></a>03530                     values[vertOffsets[n] + p] = ((<span class="keywordtype">int</span>*)data)[p*numComps[i][k]+m];
<a name="l03531"></a>03531                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>)
<a name="l03532"></a>03532                     values[vertOffsets[n] + p] = ((<span class="keywordtype">float</span>*)data)[p*numComps[i][k]+m];
<a name="l03533"></a>03533                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>)
<a name="l03534"></a>03534                     values[vertOffsets[n] + p] = ((<span class="keywordtype">double</span>*)data)[p*numComps[i][k]+m];
<a name="l03535"></a>03535                 }
<a name="l03536"></a>03536               }
<a name="l03537"></a>03537               error = ex_put_nodal_var(exoid, j+1, current+1, numTotalVert, values);
<a name="l03538"></a>03538               <span class="keywordflow">if</span> (error != 0) {
<a name="l03539"></a>03539                 <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put nodal vars for "</span>
<a name="l03540"></a>03540                                       <span class="stringliteral">"step %d"</span>, j);
<a name="l03541"></a>03541                 <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03542"></a>03542               }
<a name="l03543"></a>03543               current++;
<a name="l03544"></a>03544             }
<a name="l03545"></a>03545           }
<a name="l03546"></a>03546         }
<a name="l03547"></a>03547         free(values);
<a name="l03548"></a>03548       }
<a name="l03549"></a>03549 
<a name="l03550"></a>03550       <span class="comment">// do element vars</span>
<a name="l03551"></a>03551       <span class="comment">// write var per step per block</span>
<a name="l03552"></a>03552       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(exoVarTypes[i], <span class="stringliteral">"e"</span>)) {
<a name="l03553"></a>03553         <span class="keywordtype">int</span> numDP;
<a name="l03554"></a>03554         <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> dataType;
<a name="l03555"></a>03555         <span class="keywordtype">double</span>* values;
<a name="l03556"></a>03556         <span class="keywordtype">void</span>* data;
<a name="l03557"></a>03557         <span class="keywordflow">for</span> (j = 0; j &lt; numStep; j++) {
<a name="l03558"></a>03558           <span class="keywordflow">for</span> (m = 0; m &lt; numMesh; m++) {
<a name="l03559"></a>03559             <span class="keywordtype">int</span> current = 0;
<a name="l03560"></a>03560             <span class="keywordflow">for</span> (k = 0; k &lt; numVarPerAssocType[i]; k++) {
<a name="l03561"></a>03561               <span class="keywordflow">if</span> (!sortedSeqVars[i][k][m])
<a name="l03562"></a>03562                 current += numComps[i][k];
<a name="l03563"></a>03563               <span class="keywordflow">else</span> {
<a name="l03564"></a>03564                 <a class="code" href="group__Variable.html#g2af8bf7fdb2852fe2ddd06fd94ee4caa" title="Return number of data points in a variable.">fc_getVariableNumDataPoint</a>(sortedSeqVars[i][k][m][j], &amp;numDP);
<a name="l03565"></a>03565                 <a class="code" href="group__Variable.html#gd3b7cecfd0c6d488e82b426b4c114aba" title="Return the data type of a variable.">fc_getVariableDataType</a>(sortedSeqVars[i][k][m][j], &amp;dataType);
<a name="l03566"></a>03566                 <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(sortedSeqVars[i][k][m][j], &amp;data);
<a name="l03567"></a>03567                 values = malloc(numDP*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l03568"></a>03568                 <span class="keywordflow">if</span> (!values) {
<a name="l03569"></a>03569                   <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l03570"></a>03570                   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l03571"></a>03571                 }
<a name="l03572"></a>03572                 <span class="keywordflow">for</span> (n = 0; n &lt; numComps[i][k]; n++) {
<a name="l03573"></a>03573                   <span class="keywordflow">for</span> (p = 0; p &lt; numDP; p++) {
<a name="l03574"></a>03574                     values[p] = 12;
<a name="l03575"></a>03575                     <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>)
<a name="l03576"></a>03576                       values[p] = ((<span class="keywordtype">char</span>*)data)[p*numComps[i][k]+n];
<a name="l03577"></a>03577                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>)
<a name="l03578"></a>03578                       values[p] = ((<span class="keywordtype">int</span>*)data)[p*numComps[i][k]+n];
<a name="l03579"></a>03579                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>)
<a name="l03580"></a>03580                       values[p] = ((<span class="keywordtype">float</span>*)data)[p*numComps[i][k]+n];
<a name="l03581"></a>03581                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dataType == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>)
<a name="l03582"></a>03582                       values[p] = ((<span class="keywordtype">double</span>*)data)[p*numComps[i][k]+n];
<a name="l03583"></a>03583                   }
<a name="l03584"></a>03584                   <span class="comment">// time id, var id, block id</span>
<a name="l03585"></a>03585                   error = ex_put_elem_var(exoid, j+1, current+1, blk_ids[m], 
<a name="l03586"></a>03586                            numDP, values);
<a name="l03587"></a>03587                   <span class="keywordflow">if</span> (error != 0) {
<a name="l03588"></a>03588                     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to put elem vars for "</span>
<a name="l03589"></a>03589                                           <span class="stringliteral">"step %d on block %d"</span>, j, blk_ids[m]);
<a name="l03590"></a>03590                     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03591"></a>03591                   }
<a name="l03592"></a>03592                   current++;
<a name="l03593"></a>03593                 }
<a name="l03594"></a>03594                 free(values);
<a name="l03595"></a>03595               }
<a name="l03596"></a>03596             }
<a name="l03597"></a>03597           }
<a name="l03598"></a>03598         }
<a name="l03599"></a>03599       }
<a name="l03600"></a>03600     } <span class="comment">// end of write data</span>
<a name="l03601"></a>03601     
<a name="l03602"></a>03602     <span class="comment">// Cleanup </span>
<a name="l03603"></a>03603     <span class="keywordflow">for</span> (i = 0; i &lt; numAssocType; i++) {
<a name="l03604"></a>03604       free(numComps[i]);
<a name="l03605"></a>03605       <span class="keywordflow">for</span> (j = 0; j &lt; numVarPerAssocType[i]; j++) {
<a name="l03606"></a>03606         <span class="keywordflow">for</span> (k = 0; k &lt; numMesh; k++) 
<a name="l03607"></a>03607           free(sortedSeqVars[i][j][k]);
<a name="l03608"></a>03608         free(sortedSeqVars[i][j]);
<a name="l03609"></a>03609       }
<a name="l03610"></a>03610       free(sortedSeqVars[i]);
<a name="l03611"></a>03611     }
<a name="l03612"></a>03612     <span class="comment">// Do NOT free sortedSeqVars - it's an automatic variable</span>
<a name="l03613"></a>03613     
<a name="l03614"></a>03614   } <span class="comment">// done with seq vars</span>
<a name="l03615"></a>03615 
<a name="l03616"></a>03616   <span class="comment">// cleanup</span>
<a name="l03617"></a>03617   free(blk_ids);
<a name="l03618"></a>03618  
<a name="l03619"></a>03619   <span class="comment">// Flush the buffers</span>
<a name="l03620"></a>03620   error = ex_update(exoid);
<a name="l03621"></a>03621   <span class="keywordflow">if</span> (error != 0) {
<a name="l03622"></a>03622     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Exodus failed to update at end of writing"</span>);
<a name="l03623"></a>03623     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce406cfb6be2c486a7655cecdd3f5c02e44">FC_FILE_IO_ERROR</a>;
<a name="l03624"></a>03624   }
<a name="l03625"></a>03625 
<a name="l03626"></a>03626   <span class="comment">// Move these up in the file? .... delete when no longer used</span>
<a name="l03627"></a>03627   free(numDims);
<a name="l03628"></a>03628   free(meshes);
<a name="l03629"></a>03629   free(vertOffsets);
<a name="l03630"></a>03630   free(elemOffsets);
<a name="l03631"></a>03631   free(numVerts);
<a name="l03632"></a>03632   free(numElems);
<a name="l03633"></a>03633 
<a name="l03634"></a>03634   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#5da6a240b511f5d9e266c2c16b4d998c">fileType</a> = <a class="code" href="group__FileIO.html#gge2c4eb60578842e0dfb050ffe07be10f99ecebdb6b57140d8fd211b1f9f62c4b">FC_FT_EXODUS</a>;
<a name="l03635"></a>03635   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#4339e69fe30b05ede4dc06248a0e883b">header</a>.<a class="code" href="struct__FC__SlotHeader.html#df0a17b8284aa195791caff85ff62743">committed</a> = 1;
<a name="l03636"></a>03636   dsSlot-&gt;<a class="code" href="struct__FC__DsSlot.html#45bf720ce29415d5e8ef0c826647c811">writable</a> = 0;
<a name="l03637"></a>03637 
<a name="l03638"></a>03638   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l03639"></a>03639 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:21 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
