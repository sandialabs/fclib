<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: (Private)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>(Private)<br>
<small>
[<a class="el" href="group__Shape.html">Shape</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for (Private):</div>
<div class="dynsection">
<center><table><tr><td><img src="group__PrivateShape.gif" border="0" alt="" usemap="#group____PrivateShape_map">
<map name="group____PrivateShape_map">
<area shape="rect" href="group__Shape.html" title="Information about Shapes." alt="" coords="7,5,73,32"></map></td></tr></table></center>
</div>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g2254938019f03a64de53c57a3d23272a">_fc_initSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">inits the sfi array  <a href="#g2254938019f03a64de53c57a3d23272a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#gcbd321d07dba845428323f604e9c864f">_fc_addToSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi, <a class="el" href="struct__faceinfo.html">_FC_FACEINFO</a> *fi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">add an sfi to the sfi array  <a href="#gcbd321d07dba845428323f604e9c864f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g8d220ceaab54d5d3c89d106d9f4c3f48">_fc_lookupInSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi, int i, <a class="el" href="struct__faceinfo.html">_FC_FACEINFO</a> **fi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">looks for a fi index in sfi array  <a href="#g8d220ceaab54d5d3c89d106d9f4c3f48"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g745fc26da9637e72dc91adcf9a0834a0">_fc_removeFromSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi, int i, <a class="el" href="struct__faceinfo.html">_FC_FACEINFO</a> **fi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">removes an item from the sfi array  <a href="#g745fc26da9637e72dc91adcf9a0834a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g45bbf71518d8d732bfc2e4e7c46cd6a7">_fc_reallocSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">reallocs the sfi array  <a href="#g45bbf71518d8d732bfc2e4e7c46cd6a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#gf4a082b457cd472acbde47cffc7b90f7">_fc_printSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">prints the sfi array  <a href="#gf4a082b457cd472acbde47cffc7b90f7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6">_fc_freeSFI_Array</a> (<a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *sfi)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">frees the sfi array  <a href="#g50ecebb2721798d813904008e0dff0c6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#gd3eccd62e677afb1e348319a15648dbb">_fc_buildFaceInfoListFromSubset</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *skinlist)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return sorted array of ptrs to faceinfos for the subset skin  <a href="#gd3eccd62e677afb1e348319a15648dbb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#gcc118132a213d6b6daa6425fb571d4ed">_fc_buildFaceInfoListFromShape</a> (<a class="el" href="structFC__Shape.html">FC_Shape</a> *shape, <a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *skinlist)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">given a current shape, return sorted array of ptrs to faceinfos for the shape sides  <a href="#gcc118132a213d6b6daa6425fb571d4ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g8d520bfe173ac78fd6e253afc1393e8e">_fc_getOutwardFaceNormal</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int faceID, int elemID, <a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *normal)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns outward normal vector for a given face on a given element.  <a href="#g8d520bfe173ac78fd6e253afc1393e8e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateShape.html#g3e9cf7ace4ab706649116911f6ee379e">_fc_createShapePartsFromFaceInfoList</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *in_faceinfolist, char **basename, double comp_angle, int shared_dim, int *numSides, <a class="el" href="structFC__Subset.html">FC_Subset</a> **newFaceSubsets, <a class="el" href="structFC__Subset.html">FC_Subset</a> **newElemSubsets, int ***adjmatrix)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">makes the shape parts from the faceinfolist  <a href="#g3e9cf7ace4ab706649116911f6ee379e"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gcbd321d07dba845428323f604e9c864f"></a><!-- doxytag: member="shape.c::_fc_addToSFI_Array" ref="gcbd321d07dba845428323f604e9c864f" args="(_FC_SFI_ARRAY *sfi, _FC_FACEINFO *fi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _fc_addToSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__faceinfo.html">_FC_FACEINFO</a> *&nbsp;</td>
          <td class="paramname"> <em>fi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
add an sfi to the sfi array 
<p>
<b>Description:</b> <p>
adds an sfi to the sfi array. returns 1 if it added it, 0 if there is one already there.<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>

<p>Definition at line <a class="el" href="shape_8c-source.html#l00132">132</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shapeP_8h-source.html#l00059">_faceinfo::faceID</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="shapeP_8h-source.html#l00068">_sfi_array::maxVals</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l00593">_fc_buildFaceInfoListFromShape()</a>, and <a class="el" href="shape_8c-source.html#l00402">_fc_buildFaceInfoListFromSubset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00135"></a>00135  {
<a name="l00136"></a>00136   <span class="keywordtype">int</span> low, high, mid;
<a name="l00137"></a>00137   <span class="keywordtype">int</span> indexx;
<a name="l00138"></a>00138   <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> **temp;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 
<a name="l00141"></a>00141   <span class="keywordflow">if</span> (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> == NULL){ <span class="comment">//empty</span>
<a name="l00142"></a>00142     sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>**)malloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l00143"></a>00143     <span class="keywordflow">if</span> (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> == NULL){
<a name="l00144"></a>00144       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00145"></a>00145       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147     sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a> = 1;
<a name="l00148"></a>00148     sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a> = 1;
<a name="l00149"></a>00149     sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[0] = fi; <span class="comment">//gets the ptr, now responsible for the memory</span>
<a name="l00150"></a>00150     <span class="keywordflow">return</span> 1;
<a name="l00151"></a>00151   }
<a name="l00152"></a>00152   
<a name="l00153"></a>00153   <span class="comment">//binary search</span>
<a name="l00154"></a>00154   low = 0;
<a name="l00155"></a>00155   high = sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>-1;
<a name="l00156"></a>00156   <span class="keywordflow">while</span>(low &lt;= high){
<a name="l00157"></a>00157     mid = (low+high)/2;
<a name="l00158"></a>00158     <span class="comment">//      printf("low %d high %d mid %d\n",low,high,mid);</span>
<a name="l00159"></a>00159     <span class="keywordflow">if</span> ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID == fi-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>){
<a name="l00160"></a>00160       <span class="keywordflow">return</span> 0;
<a name="l00161"></a>00161     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID &lt; fi-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>){
<a name="l00162"></a>00162       low = mid+1;
<a name="l00163"></a>00163     } <span class="keywordflow">else</span>{
<a name="l00164"></a>00164       high = mid -1;
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   <span class="comment">//either goes below or above mid. realloc if necessary</span>
<a name="l00169"></a>00169   indexx = ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID &gt; fi-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a> ? mid:mid+1);
<a name="l00170"></a>00170   <span class="keywordflow">if</span> (sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a> &gt;= sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a>){ <span class="comment">//grow</span>
<a name="l00171"></a>00171     temp = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>**)realloc(sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>,(2*sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a>)*<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l00172"></a>00172     <span class="keywordflow">if</span> (temp == NULL){
<a name="l00173"></a>00173       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00174"></a>00174       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176     sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a>*=2;
<a name="l00177"></a>00177     sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> = temp;
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179   <span class="comment">//memcpy didnt work right when i moved more than 1 element up</span>
<a name="l00180"></a>00180   memmove((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>)+indexx+1,(sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>)+indexx,
<a name="l00181"></a>00181        (sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>-indexx)*<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l00182"></a>00182   sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[indexx] = fi; <span class="comment">//gets the ptr, now responsible for the memory</span>
<a name="l00183"></a>00183   sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>++;
<a name="l00184"></a>00184   <span class="keywordflow">return</span> 1;
<a name="l00185"></a>00185   
<a name="l00186"></a>00186 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gcc118132a213d6b6daa6425fb571d4ed"></a><!-- doxytag: member="shape.c::_fc_buildFaceInfoListFromShape" ref="gcc118132a213d6b6daa6425fb571d4ed" args="(FC_Shape *shape, _FC_SFI_ARRAY *skinlist)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_buildFaceInfoListFromShape           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Shape.html">FC_Shape</a> *&nbsp;</td>
          <td class="paramname"> <em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>skinlist</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
given a current shape, return sorted array of ptrs to faceinfos for the shape sides 
<p>
<b>Description:</b> <p>
Similiar to <a class="el" href="group__PrivateShape.html#gcc118132a213d6b6daa6425fb571d4ed">_fc_buildFaceInfoListFromShape</a>, but in that case you have the subset of the entire shape elements, including its innards. This method is instead called when you are going to reshape, and therefore have only the information about the sides.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000074">Todo:</a></b></dt><dd><ul>
<li>will this work ?</li><li>untested</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>08/19/06 ACG created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>shape</em>&nbsp;</td><td>
input -shape </td></tr>
<tr><td valign="top"><em>skinlist</em>&nbsp;</td><td>
output - sorted array of faceinfos </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l00593">593</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00132">_fc_addToSFI_Array()</a>, <a class="el" href="shape_8c-source.html#l00347">_fc_freeSFI_Array()</a>, <a class="el" href="shape_8c-source.html#l00750">_fc_getOutwardFaceNormal()</a>, <a class="el" href="shape_8c-source.html#l00109">_fc_initSFI_Array()</a>, <a class="el" href="shapeP_8h-source.html#l00061">_faceinfo::elemID</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shapeP_8h-source.html#l00059">_faceinfo::faceID</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="storage_8c-source.html#l01301">fc_convertIntArrayToSortedIntArray()</a>, <a class="el" href="storage_8c-source.html#l00591">fc_deleteIntFromSortedIntArray()</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="storage_8c-source.html#l00846">fc_freeSortedIntArray()</a>, <a class="el" href="topo_8c-source.html#l00116">fc_getMeshEntityChildren()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="storage_8c-source.html#l00676">fc_getSortedIntArrayBack()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="storage_8c-source.html#l00763">fc_popSortedIntArrayBack()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shapeP_8h-source.html#l00063">_faceinfo::normal</a>, <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>, and <a class="el" href="storage_8h-source.html#l00099">FC_SortedIntArray::numVal</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l01609">fc_reshapeByAngle()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00596"></a>00596    {
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00599"></a>00599   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l00600"></a>00600   <span class="keywordtype">int</span> i,k;
<a name="l00601"></a>00601   
<a name="l00602"></a>00602   <span class="keywordflow">if</span> (!shape || shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a> &lt; 1){
<a name="l00603"></a>00603     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00604"></a>00604   }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a>00607   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[0],&amp;mesh);
<a name="l00608"></a>00608   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00609"></a>00609     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get mesh from subset"</span>);
<a name="l00610"></a>00610     <span class="keywordflow">return</span> rc;
<a name="l00611"></a>00611   }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   rc = <a class="code" href="group__PrivateShape.html#g2254938019f03a64de53c57a3d23272a" title="inits the sfi array">_fc_initSFI_Array</a>(skinlist);
<a name="l00614"></a>00614   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00615"></a>00615     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't init SFI array"</span>);
<a name="l00616"></a>00616     <span class="keywordflow">return</span> rc;
<a name="l00617"></a>00617   }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619   <span class="comment">//each face can only be a child of one element making up the sides</span>
<a name="l00620"></a>00620   <span class="keywordflow">for</span> (i = 0; i &lt; shape-&gt;<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l00621"></a>00621     <span class="keywordtype">int</span> *farr, *earr, numf, nume;
<a name="l00622"></a>00622     <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> facearr;
<a name="l00623"></a>00623     <a class="code" href="structFC__SortedIntArray.html" title="Sorted, exclusive, self-exanding int array.">FC_SortedIntArray</a> elemarr;
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],&amp;numf,&amp;farr);
<a name="l00626"></a>00626     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00627"></a>00627       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get face members"</span>);
<a name="l00628"></a>00628       <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00629"></a>00629       <span class="keywordflow">return</span> rc;
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631 
<a name="l00632"></a>00632     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(shape-&gt;<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],&amp;nume,&amp;earr);
<a name="l00633"></a>00633     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00634"></a>00634       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get elem members"</span>);
<a name="l00635"></a>00635       free(farr);
<a name="l00636"></a>00636       <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00637"></a>00637       <span class="keywordflow">return</span> rc;
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640     rc = <a class="code" href="group__SimpleDataObjects.html#gfae48dc7d1998fe49a86de7f58e42906" title="Convert int array (no duplicates) to sorted int array.">fc_convertIntArrayToSortedIntArray</a>(numf,farr,1,&amp;facearr);
<a name="l00641"></a>00641     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00642"></a>00642       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't convert face array"</span>);
<a name="l00643"></a>00643       free(farr);
<a name="l00644"></a>00644       free(earr);
<a name="l00645"></a>00645       <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00646"></a>00646       <span class="keywordflow">return</span> rc;
<a name="l00647"></a>00647     }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649     rc = <a class="code" href="group__SimpleDataObjects.html#gfae48dc7d1998fe49a86de7f58e42906" title="Convert int array (no duplicates) to sorted int array.">fc_convertIntArrayToSortedIntArray</a>(nume,earr,1,&amp;elemarr);
<a name="l00650"></a>00650     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00651"></a>00651       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't convert elem array"</span>);
<a name="l00652"></a>00652       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00653"></a>00653       free(earr);
<a name="l00654"></a>00654       <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00655"></a>00655       <span class="keywordflow">return</span> rc;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657 
<a name="l00658"></a>00658     <span class="keywordflow">while</span>(elemarr.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>){
<a name="l00659"></a>00659       <span class="keywordtype">int</span> curre;
<a name="l00660"></a>00660       <span class="keywordtype">int</span> numChild, *childIDs;
<a name="l00661"></a>00661       rc = <a class="code" href="group__SimpleDataObjects.html#gcac20e36ca69f12296b7be400454dacb" title="Get last value in the sorted int array (WARNING: does not check for empty array)...">fc_getSortedIntArrayBack</a>(&amp;elemarr,&amp;curre);
<a name="l00662"></a>00662       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00663"></a>00663      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get last elem"</span>);
<a name="l00664"></a>00664      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00665"></a>00665      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;elemarr);
<a name="l00666"></a>00666      <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00667"></a>00667      <span class="keywordflow">return</span> rc;
<a name="l00668"></a>00668       }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670       rc = <a class="code" href="group__TopologyRelations.html#g08edc0183a4bb0e44eb226ea75177fd8" title="Get the entities which make up the specified entity.">fc_getMeshEntityChildren</a>(mesh,<a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>,curre,
<a name="l00671"></a>00671                         <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>,&amp;numChild,&amp;childIDs);
<a name="l00672"></a>00672       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00673"></a>00673      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get elem children"</span>);
<a name="l00674"></a>00674      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00675"></a>00675      <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;elemarr);
<a name="l00676"></a>00676      <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00677"></a>00677      <span class="keywordflow">return</span> rc;
<a name="l00678"></a>00678       }
<a name="l00679"></a>00679 
<a name="l00680"></a>00680       <span class="keywordflow">for</span> (k = 0; k &lt; numChild;k++){
<a name="l00681"></a>00681      <span class="keywordtype">int</span> ret;
<a name="l00682"></a>00682      <span class="keywordflow">if</span> (<a class="code" href="group__SimpleDataObjects.html#gc800f634fb42d44a6c31d79743a6864c" title="Remove an int from a sorted int array.">fc_deleteIntFromSortedIntArray</a>(&amp;facearr,childIDs[k])){
<a name="l00683"></a>00683        <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> *face_data = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>));
<a name="l00684"></a>00684        face_data-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a> = childIDs[k];
<a name="l00685"></a>00685        face_data-&gt;<a class="code" href="struct__faceinfo.html#f8a60bc7ff3519ac17b3d052eea92e67">elemID</a> = curre;
<a name="l00686"></a>00686        rc = <a class="code" href="group__PrivateShape.html#g8d520bfe173ac78fd6e253afc1393e8e" title="Returns outward normal vector for a given face on a given element.">_fc_getOutwardFaceNormal</a>(mesh, face_data-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>,
<a name="l00687"></a>00687                          face_data-&gt;<a class="code" href="struct__faceinfo.html#f8a60bc7ff3519ac17b3d052eea92e67">elemID</a>,
<a name="l00688"></a>00688                          &amp;(face_data-&gt;<a class="code" href="struct__faceinfo.html#5dd2e8728504a5c05c7e5e0ac60e3b0c">normal</a>));
<a name="l00689"></a>00689        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00690"></a>00690          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get normal for this face"</span>);
<a name="l00691"></a>00691          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00692"></a>00692          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;elemarr);
<a name="l00693"></a>00693          <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00694"></a>00694          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00695"></a>00695        }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697        ret = <a class="code" href="group__PrivateShape.html#gcbd321d07dba845428323f604e9c864f" title="add an sfi to the sfi array">_fc_addToSFI_Array</a>(skinlist,face_data);
<a name="l00698"></a>00698        <span class="keywordflow">if</span> (!ret){
<a name="l00699"></a>00699          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't add to SFI array"</span>);
<a name="l00700"></a>00700          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00701"></a>00701          <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;elemarr);
<a name="l00702"></a>00702          <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00703"></a>00703          <span class="keywordflow">if</span> (face_data) free(face_data);
<a name="l00704"></a>00704          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00705"></a>00705        }
<a name="l00706"></a>00706      }
<a name="l00707"></a>00707       }<span class="comment">//loop over children of this element</span>
<a name="l00708"></a>00708       free(childIDs);
<a name="l00709"></a>00709       <a class="code" href="group__SimpleDataObjects.html#gab4acf6f140c6c0f68b68e6935d047bd" title="Delete the last value in a sorted int array.">fc_popSortedIntArrayBack</a>(&amp;elemarr);
<a name="l00710"></a>00710     } <span class="comment">//loop over elements of this side</span>
<a name="l00711"></a>00711 
<a name="l00712"></a>00712     <span class="comment">//now all the faces and elems should have been moved to the skinlist</span>
<a name="l00713"></a>00713     <span class="keywordflow">if</span> (facearr.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a> &amp;&amp; elemarr.<a class="code" href="structFC__SortedIntArray.html#41c02abac0e388a077675863f16c325f">numVal</a>){
<a name="l00714"></a>00714       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"there are still remaining faces or elems for this side"</span>);
<a name="l00715"></a>00715       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00716"></a>00716       <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;elemarr);
<a name="l00717"></a>00717       <a class="code" href="group__PrivateShape.html#g50ecebb2721798d813904008e0dff0c6" title="frees the sfi array">_fc_freeSFI_Array</a>(skinlist);
<a name="l00718"></a>00718       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00719"></a>00719     }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;facearr);
<a name="l00722"></a>00722     <a class="code" href="group__SimpleDataObjects.html#g20daa2fb7f38e75da823116f5c41a579" title="Free the sorted int array&amp;#39;s values.">fc_freeSortedIntArray</a>(&amp;elemarr);
<a name="l00723"></a>00723 
<a name="l00724"></a>00724   }<span class="comment">//loop over sides</span>
<a name="l00725"></a>00725 
<a name="l00726"></a>00726   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00727"></a>00727 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd3eccd62e677afb1e348319a15648dbb"></a><!-- doxytag: member="shape.c::_fc_buildFaceInfoListFromSubset" ref="gd3eccd62e677afb1e348319a15648dbb" args="(FC_Subset subset, _FC_SFI_ARRAY *skinlist)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_buildFaceInfoListFromSubset           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>skinlist</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return sorted array of ptrs to faceinfos for the subset skin 
<p>
<b>Description:</b> <p>
This is a variation of fc_getSubsetSkin that also returns the element and the normal giving rise to those faces. Its easier to get these all at the same time.<p>
There seems to be an issue in skin on how to handle an empty subset. Here I will return empty subset as an error.<p>
Note: Since this is based on skin, in theory it handles not just element-faces but other topodim as well. In those cases I don't think there is a guarentee that the face-equivalent item is unique in the set.<p>
This is a helper for the revised _fc_getSubsetShapes. It is a combination of the old _fc_makeSubsetSkinFaceListWithElementData and the the old _fc_makeFaceListWithNormalsData. This was then renamed from getDetailedSkinData<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000073">Todo:</a></b></dt><dd><ul>
<li>replaced the linked list with a numFace allocated array to simulate a hash table to speed things up. will want a real hash table</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>06/02/06 ACG created from the elem data and the normal data to increase efficiency of sides.</li><li>06/05/06 ACG trying replacing the linked list with a numFace allocated array to simulate a hash table to speed things up.</li><li>06/07/06 ACG replacing the skinlist with a sorted array of _FC_FACEINFO since it will need to search it later</li><li>08/19/06 ACG renamed from getDetailedSkinData. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>skinlist</em>&nbsp;</td><td>
output - sorted array of faceinfos </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l00402">402</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00132">_fc_addToSFI_Array()</a>, <a class="el" href="shape_8c-source.html#l00750">_fc_getOutwardFaceNormal()</a>, <a class="el" href="shape_8c-source.html#l00109">_fc_initSFI_Array()</a>, <a class="el" href="shapeP_8h-source.html#l00061">_faceinfo::elemID</a>, <a class="el" href="shapeP_8h-source.html#l00059">_faceinfo::faceID</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00477">fc_getAssociationTypeText()</a>, <a class="el" href="base_8c-source.html#l00514">fc_getElementTypeTopoDim()</a>, <a class="el" href="topo_8c-source.html#l00116">fc_getMeshEntityChildren()</a>, <a class="el" href="mesh_8c-source.html#l03371">fc_getMeshEntityElementType()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="mesh_8c-source.html#l03025">fc_getMeshNumElement()</a>, <a class="el" href="mesh_8c-source.html#l03299">fc_getMeshNumEntity()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="subset_8c-source.html#l02828">fc_getSubsetNumMember()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="shapeP_8h-source.html#l00063">_faceinfo::normal</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l01339">fc_getSubsetShapes()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00405"></a>00405    {
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00408"></a>00408   <span class="keywordtype">int</span> i, j;
<a name="l00409"></a>00409   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc_orig, assoc_skin;
<a name="l00410"></a>00410   <span class="keywordtype">int</span> numMember, *memberIDs, maxNumSkin, *counts, numChild, *childIDs;
<a name="l00411"></a>00411   <span class="keywordtype">int</span> topodim_orig;
<a name="l00412"></a>00412   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l00413"></a>00413   <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="keywordtype">int</span> *temp_hasharray; <span class="comment">//this wil be replaced by a real hashtable later</span>
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 
<a name="l00418"></a>00418   <span class="comment">//---default return values</span>
<a name="l00419"></a>00419   <span class="comment">//  if (skinlist)</span>
<a name="l00420"></a>00420   <span class="comment">//    *skinlist = NULL;</span>
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   <span class="comment">// check input</span>
<a name="l00423"></a>00423   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(subset) ||
<a name="l00424"></a>00424       !skinlist) {
<a name="l00425"></a>00425     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00426"></a>00426     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00427"></a>00427   }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <span class="comment">// log message</span>
<a name="l00430"></a>00430   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Creating faceinfo list"</span>);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432   <span class="comment">// Get info from subset and a little more checking</span>
<a name="l00433"></a>00433   rc = <a class="code" href="group__Subset.html#gdf7851470403bb379426110abf7923ba" title="Get number of members in a subset.">fc_getSubsetNumMember</a>(subset, &amp;numMember);
<a name="l00434"></a>00434   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00435"></a>00435     <span class="keywordflow">return</span> rc;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="keywordflow">if</span> (numMember &lt; 1) {
<a name="l00438"></a>00438     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't create skin of empty subset"</span>);
<a name="l00439"></a>00439     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00440"></a>00440   }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442   rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subset, NULL, NULL, &amp;assoc_orig); 
<a name="l00443"></a>00443   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00444"></a>00444     <span class="keywordflow">return</span> rc;
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 
<a name="l00447"></a>00447   <span class="keywordflow">if</span> (!(assoc_orig == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a> || assoc_orig == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>)){
<a name="l00448"></a>00448     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't handle subset with association type %s"</span>,
<a name="l00449"></a>00449                           <a class="code" href="group__DataTypes.html#g615e96c3b13331857b5ba45d597c49de" title="Return the name of the FC_AssociationType&amp;#39;s value.">fc_getAssociationTypeText</a>(assoc_orig));
<a name="l00450"></a>00450     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00451"></a>00451   }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l00454"></a>00454   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00455"></a>00455     <span class="keywordflow">return</span> rc;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457   <span class="comment">// determine topodim of the members</span>
<a name="l00458"></a>00458   rc = <a class="code" href="group__Mesh.html#gfc269313fe6595610ac3eb54cef327c7" title="Get the element type of the mesh entity.">fc_getMeshEntityElementType</a>(mesh, assoc_orig, 0, &amp;elemType);
<a name="l00459"></a>00459   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00460"></a>00460     free(memberIDs);
<a name="l00461"></a>00461     <span class="keywordflow">return</span> rc;
<a name="l00462"></a>00462   }
<a name="l00463"></a>00463   topodim_orig = <a class="code" href="group__DataTypes.html#g88ee850817d024de6ff86aea039b4997" title="Returns number of topological dimensions for a type of element.">fc_getElementTypeTopoDim</a>(elemType);
<a name="l00464"></a>00464 
<a name="l00465"></a>00465   <span class="keywordflow">if</span> (topodim_orig != 3){
<a name="l00466"></a>00466     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid topodim %d (must be 3)\n"</span>,topodim_orig);
<a name="l00467"></a>00467     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469   assoc_skin = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471   <span class="comment">// Get members -- If subset is whole, get all elements</span>
<a name="l00472"></a>00472   <span class="keywordflow">if</span> (assoc_orig == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>) {
<a name="l00473"></a>00473     assoc_orig = <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>;
<a name="l00474"></a>00474     rc = <a class="code" href="group__Mesh.html#g8bcadefbf0728724adf77ef52c1f3732" title="Returns number of elements in a mesh.">fc_getMeshNumElement</a>(mesh, &amp;numMember);
<a name="l00475"></a>00475     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00476"></a>00476       <span class="keywordflow">return</span> rc;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478     memberIDs = malloc(numMember*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00479"></a>00479     <span class="keywordflow">if</span> (!memberIDs) {
<a name="l00480"></a>00480       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00481"></a>00481       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00482"></a>00482     }
<a name="l00483"></a>00483     <span class="keywordflow">for</span> (i = 0; i &lt; numMember; i++)
<a name="l00484"></a>00484       memberIDs[i] = i;
<a name="l00485"></a>00485   }
<a name="l00486"></a>00486   <span class="keywordflow">else</span> {
<a name="l00487"></a>00487     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l00488"></a>00488     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00489"></a>00489       <span class="keywordflow">return</span> rc;
<a name="l00490"></a>00490   }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   rc = <a class="code" href="group__Mesh.html#g12d76ae817fee1f4ea941aad228923bc" title="Returns number of a type of mesh entity.">fc_getMeshNumEntity</a>(mesh, assoc_skin, &amp;maxNumSkin);
<a name="l00493"></a>00493   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00494"></a>00494     free(memberIDs);
<a name="l00495"></a>00495     <span class="keywordflow">return</span> rc;
<a name="l00496"></a>00496   }
<a name="l00497"></a>00497   counts = calloc(maxNumSkin, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00498"></a>00498   <span class="keywordflow">if</span> (!counts) {
<a name="l00499"></a>00499     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00500"></a>00500     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00501"></a>00501   }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503   <span class="comment">//adding all the faces for each element with the element id as the data.</span>
<a name="l00504"></a>00504   <span class="comment">//if a face arises again from a different element, then remove it</span>
<a name="l00505"></a>00505   temp_hasharray = (<span class="keywordtype">int</span>*)malloc(maxNumSkin*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00506"></a>00506   <span class="keywordflow">if</span> (temp_hasharray == NULL){
<a name="l00507"></a>00507     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00508"></a>00508     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00509"></a>00509   }
<a name="l00510"></a>00510   <span class="keywordflow">for</span> (i = 0; i &lt; maxNumSkin; i++){
<a name="l00511"></a>00511     temp_hasharray[i] = -1;
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513   
<a name="l00514"></a>00514   <span class="comment">//  printf("determining the skin faces and elems\n");</span>
<a name="l00515"></a>00515   <span class="keywordflow">for</span> (i = 0; i &lt; numMember; i++) {
<a name="l00516"></a>00516     <a class="code" href="group__TopologyRelations.html#g08edc0183a4bb0e44eb226ea75177fd8" title="Get the entities which make up the specified entity.">fc_getMeshEntityChildren</a>(mesh, assoc_orig, memberIDs[i], assoc_skin,
<a name="l00517"></a>00517                     &amp;numChild, &amp;childIDs);
<a name="l00518"></a>00518     <span class="keywordflow">for</span> (j = 0; j &lt; numChild; j++){
<a name="l00519"></a>00519       <span class="keywordflow">switch</span>(++counts[childIDs[j]]){
<a name="l00520"></a>00520       <span class="keywordflow">case</span> 1:{ <span class="comment">//add it</span>
<a name="l00521"></a>00521      temp_hasharray[childIDs[j]] = memberIDs[i];
<a name="l00522"></a>00522      <span class="keywordflow">break</span>;
<a name="l00523"></a>00523       }
<a name="l00524"></a>00524       <span class="keywordflow">case</span> 2:{ <span class="comment">//remove it</span>
<a name="l00525"></a>00525      temp_hasharray[childIDs[j]] = -1;
<a name="l00526"></a>00526      <span class="keywordflow">break</span>;
<a name="l00527"></a>00527       }
<a name="l00528"></a>00528       <span class="keywordflow">default</span>:  <span class="comment">//its gone already</span>
<a name="l00529"></a>00529      <span class="comment">//      printf("skipping face %d element %d\n",childIDs[j],memberIDs[i]);</span>
<a name="l00530"></a>00530      <span class="keywordflow">break</span>;
<a name="l00531"></a>00531       }
<a name="l00532"></a>00532     }
<a name="l00533"></a>00533     free(childIDs);
<a name="l00534"></a>00534   }
<a name="l00535"></a>00535   free(memberIDs);
<a name="l00536"></a>00536   free(counts);
<a name="l00537"></a>00537   <span class="comment">//  printf("done determining the skin faces and elems\n");</span>
<a name="l00538"></a>00538 
<a name="l00539"></a>00539   <span class="comment">//  printf("buiding the SFI array and determining the normals\n");</span>
<a name="l00540"></a>00540   <span class="comment">//since its already sorted there is a faster way to add things, but we will</span>
<a name="l00541"></a>00541   <span class="comment">//use the interface for now</span>
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   rc = <a class="code" href="group__PrivateShape.html#g2254938019f03a64de53c57a3d23272a" title="inits the sfi array">_fc_initSFI_Array</a>(skinlist);
<a name="l00544"></a>00544   <span class="keywordflow">for</span> (i = maxNumSkin-1; i &gt;= 0; i--){
<a name="l00545"></a>00545     <span class="keywordflow">if</span> (temp_hasharray[i] != -1){
<a name="l00546"></a>00546       <span class="keywordtype">int</span> test = 0;
<a name="l00547"></a>00547       <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> *face_data = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>));
<a name="l00548"></a>00548       face_data-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a> = i;
<a name="l00549"></a>00549       face_data-&gt;<a class="code" href="struct__faceinfo.html#f8a60bc7ff3519ac17b3d052eea92e67">elemID</a> = temp_hasharray[i];
<a name="l00550"></a>00550       <span class="comment">//      printf("adding face %d element %d\n",face_data-&gt;faceID,</span>
<a name="l00551"></a>00551       <span class="comment">//       face_data-&gt;elemID);</span>
<a name="l00552"></a>00552       rc = <a class="code" href="group__PrivateShape.html#g8d520bfe173ac78fd6e253afc1393e8e" title="Returns outward normal vector for a given face on a given element.">_fc_getOutwardFaceNormal</a>(mesh, i, temp_hasharray[i],&amp;(face_data-&gt;<a class="code" href="struct__faceinfo.html#5dd2e8728504a5c05c7e5e0ac60e3b0c">normal</a>));
<a name="l00553"></a>00553       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00554"></a>00554      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00555"></a>00555       }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557       test = <a class="code" href="group__PrivateShape.html#gcbd321d07dba845428323f604e9c864f" title="add an sfi to the sfi array">_fc_addToSFI_Array</a>(skinlist,face_data);
<a name="l00558"></a>00558       <span class="keywordflow">if</span> (!test){
<a name="l00559"></a>00559      free(temp_hasharray);
<a name="l00560"></a>00560      <span class="keywordflow">if</span> (face_data) free(face_data);
<a name="l00561"></a>00561      <span class="comment">//skinlist will be freed outside</span>
<a name="l00562"></a>00562      <span class="keywordflow">return</span> rc;
<a name="l00563"></a>00563       }
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565   }
<a name="l00566"></a>00566   <span class="comment">//  printf("done building the skinlist and determining the normals\n");</span>
<a name="l00567"></a>00567   free(temp_hasharray);
<a name="l00568"></a>00568 
<a name="l00569"></a>00569   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00570"></a>00570 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g3e9cf7ace4ab706649116911f6ee379e"></a><!-- doxytag: member="shape.c::_fc_createShapePartsFromFaceInfoList" ref="g3e9cf7ace4ab706649116911f6ee379e" args="(FC_Mesh mesh, _FC_SFI_ARRAY *in_faceinfolist, char **basename, double comp_angle, int shared_dim, int *numSides, FC_Subset **newFaceSubsets, FC_Subset **newElemSubsets, int ***adjmatrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_createShapePartsFromFaceInfoList           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>in_faceinfolist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>basename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>comp_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numSides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>newFaceSubsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>newElemSubsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int ***&nbsp;</td>
          <td class="paramname"> <em>adjmatrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
makes the shape parts from the faceinfolist 
<p>
<b>Description:</b> makes the shape parts from the faceinfolist. This was the major guts of the old _fc_getSubsetSides (now defunct as a result), but I'm pulling it out in order to be able to do a reangle of an existing shape.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000076">Todo:</a></b></dt><dd><ul>
<li>will need to standardize on devouring the faceinfo list, in case of input error etc</li><li>just writing this now, it isnt tested</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>10/04/05 ACG created as surfacesegment. trying to keep this as close as possible in algorithm to fc_segment</li><li>11/30/05 ACG changed name from surfaceSegment to getSubsetSides to reflect new terminology.</li><li>01/13/06 ACG rewrote using new WSK algorithm in <a class="el" href="group__TopologyRelations.html#g45c86dc9ebd4835c3f96efdf2a6003d9">fc_segment</a></li><li>06/06/06 ACG replacing the currlist (built from the working list) with two growing int arrays which are then handed to the subsets. this drops out one of the (sorting) linked lists.</li><li>06/07/06 ACG replacing the working list (built from the face list) with a growing unsorted array of _FC_FACEINFO ptrs. this drops out another sorted linked list.</li><li>06/07/06 ACG replacing the faceinfo list (built from buildFaceInfoList) with a growing sorted array of _FC_FACEINFO ptrs. this drops out another sorted linked list. We wont be adding anything to it, but the search will be faster</li><li>06/16/06 ACG warning about creases</li><li>06/28/06 ACG moved to private</li><li>08/16/06 ACG created from splitting out of _fc_getSubsetSides. renamed to createShapePartsFromFaceInfoList </li></ul>

<p>
2 subsets(faces and elems) - add the whole array at once <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input -- the mesh </td></tr>
<tr><td valign="top"><em>in_faceinfolist</em>&nbsp;</td><td>
input - the starting array with all the facedata, if this method is successful, will end empty </td></tr>
<tr><td valign="top"><em>basename</em>&nbsp;</td><td>
input - base name for the sides </td></tr>
<tr><td valign="top"><em>comp_angle</em>&nbsp;</td><td>
input - if two neighboring faces differ by more than this angle then they are considered to be on different surfaces. </td></tr>
<tr><td valign="top"><em>shared_dim</em>&nbsp;</td><td>
input - the minimum dimensionality of shared part of neighbors of faces </td></tr>
<tr><td valign="top"><em>numSides</em>&nbsp;</td><td>
output - number of new subsets </td></tr>
<tr><td valign="top"><em>newFaceSubsets</em>&nbsp;</td><td>
output - array of segmented regions (by face) </td></tr>
<tr><td valign="top"><em>newElemSubsets</em>&nbsp;</td><td>
output - array of segmented regions (by element) </td></tr>
<tr><td valign="top"><em>adjmatrix</em>&nbsp;</td><td>
output - adjmatrix </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l00893">893</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shape_8c-source.html#l00200">_fc_lookupInSFI_Array()</a>, <a class="el" href="shape_8c-source.html#l00246">_fc_removeFromSFI_Array()</a>, <a class="el" href="shapeP_8h-source.html#l00061">_faceinfo::elemID</a>, <a class="el" href="shapeP_8h-source.html#l00059">_faceinfo::faceID</a>, <a class="el" href="subset_8c-source.html#l02064">fc_addArrayMembersToSubset()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="geom_8c-source.html#l00215">fc_calcAngleBetweenVectors()</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="topo_8c-source.html#l00510">fc_getMeshEntityNeighbors()</a>, <a class="el" href="mesh_8c-source.html#l03208">fc_getMeshNumFace()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="library_8h-source.html#l00154">fc_printfWarningMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shapeP_8h-source.html#l00054">_intpair::ID1</a>, <a class="el" href="shapeP_8h-source.html#l00055">_intpair::ID2</a>, <a class="el" href="shapeP_8h-source.html#l00063">_faceinfo::normal</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l01339">fc_getSubsetShapes()</a>, and <a class="el" href="shape_8c-source.html#l01609">fc_reshapeByAngle()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00912"></a>00912    {
<a name="l00913"></a>00913 
<a name="l00914"></a>00914   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00915"></a>00915 
<a name="l00916"></a>00916   <span class="keywordtype">char</span>* temp_name;
<a name="l00917"></a>00917 
<a name="l00918"></a>00918   <a class="code" href="struct__intpair.html">_FC_INTPAIR</a> *edgePairs = NULL;
<a name="l00919"></a>00919   <span class="keywordtype">int</span> numEdgePairs = 0;
<a name="l00920"></a>00920   <span class="keywordtype">int</span> maxEdgePairs = 0;
<a name="l00921"></a>00921   <span class="keywordtype">int</span> *sideArray = NULL; <span class="comment">//temporary till I get a hash table - edge face ID to side table</span>
<a name="l00922"></a>00922   <span class="keywordtype">int</span> numMeshFace = 0;
<a name="l00923"></a>00923 
<a name="l00924"></a>00924   <span class="keywordtype">int</span> numSegments; <span class="comment">//these are temporary till we set up the new Shape Object</span>
<a name="l00925"></a>00925   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* faceSegments = NULL;
<a name="l00926"></a>00926   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* elemSegments = NULL;
<a name="l00927"></a>00927 
<a name="l00928"></a>00928   <span class="keywordtype">int</span> **intmatrix = NULL;
<a name="l00929"></a>00929   <span class="keywordtype">int</span> i,j;
<a name="l00930"></a>00930   
<a name="l00931"></a>00931   <span class="comment">//---default return values</span>
<a name="l00932"></a>00932   <span class="keywordflow">if</span> (numSides)
<a name="l00933"></a>00933     *numSides = -1;
<a name="l00934"></a>00934   <span class="keywordflow">if</span> (newFaceSubsets)
<a name="l00935"></a>00935     *newFaceSubsets = NULL;
<a name="l00936"></a>00936   <span class="keywordflow">if</span> (newElemSubsets)
<a name="l00937"></a>00937     *newElemSubsets = NULL;
<a name="l00938"></a>00938   <span class="keywordflow">if</span> (adjmatrix)
<a name="l00939"></a>00939     *adjmatrix = NULL;
<a name="l00940"></a>00940 
<a name="l00941"></a>00941   
<a name="l00942"></a>00942   <span class="comment">// check input</span>
<a name="l00943"></a>00943   <span class="keywordflow">if</span> (!in_faceinfolist || !numSides ||
<a name="l00944"></a>00944       shared_dim &lt; 0 || shared_dim &gt; 1  || !adjmatrix ||
<a name="l00945"></a>00945       !newFaceSubsets || ! newElemSubsets || comp_angle &lt; 0 ||
<a name="l00946"></a>00946       comp_angle &gt; 180) { 
<a name="l00947"></a>00947     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00948"></a>00948     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00949"></a>00949   }
<a name="l00950"></a>00950 
<a name="l00951"></a>00951   <span class="comment">// log message</span>
<a name="l00952"></a>00952   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"getting shapeinfo from faceinfolist"</span>);
<a name="l00953"></a>00953 
<a name="l00954"></a>00954   <span class="keywordflow">if</span> (in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a> == 0){ <span class="comment">//return if empty subset</span>
<a name="l00955"></a>00955     *numSides = 0;
<a name="l00956"></a>00956     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00957"></a>00957   }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959   <span class="comment">// setup space for names of segments</span>
<a name="l00960"></a>00960   temp_name = malloc((strlen(*basename)+30)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00961"></a>00961   <span class="keywordflow">if</span> (temp_name == NULL) {
<a name="l00962"></a>00962     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00963"></a>00963     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00964"></a>00964   }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966   <span class="comment">//set up space for edgepairs</span>
<a name="l00967"></a>00967   edgePairs = (<a class="code" href="struct__intpair.html">_FC_INTPAIR</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__intpair.html">_FC_INTPAIR</a>));
<a name="l00968"></a>00968   <span class="keywordflow">if</span> (edgePairs == NULL){
<a name="l00969"></a>00969     free(temp_name);
<a name="l00970"></a>00970     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00971"></a>00971     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00972"></a>00972   }
<a name="l00973"></a>00973 
<a name="l00974"></a>00974   numEdgePairs = 0;
<a name="l00975"></a>00975   maxEdgePairs = 1;
<a name="l00976"></a>00976   <span class="comment">//set up space for sideArray, to be replaced by a hashtable</span>
<a name="l00977"></a>00977   rc = <a class="code" href="group__Mesh.html#g8c619c146c0850895098f5dbfb487418" title="Get number of faces in a mesh.">fc_getMeshNumFace</a>(mesh,&amp;numMeshFace);
<a name="l00978"></a>00978   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00979"></a>00979     free(temp_name);
<a name="l00980"></a>00980     <span class="keywordflow">return</span> rc;
<a name="l00981"></a>00981   }
<a name="l00982"></a>00982 
<a name="l00983"></a>00983   sideArray = (<span class="keywordtype">int</span>*)malloc(numMeshFace*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00984"></a>00984   <span class="keywordflow">if</span> (sideArray == NULL){
<a name="l00985"></a>00985     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00986"></a>00986     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00987"></a>00987   }
<a name="l00988"></a>00988   <span class="keywordflow">for</span> (i=0 ; i &lt; numMeshFace; i++){
<a name="l00989"></a>00989     sideArray[i] = -1;
<a name="l00990"></a>00990   }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992   <span class="comment">//  printf("segmenting faceinfo list\n");</span>
<a name="l00993"></a>00993   <span class="comment">//---segment the faceinfo list</span>
<a name="l00994"></a>00994   numSegments = 0;
<a name="l00995"></a>00995   <span class="keywordflow">while</span>(in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>){ <span class="comment">// each pass will create a new side</span>
<a name="l00996"></a>00996     <span class="comment">//first set up data structures....</span>
<a name="l00997"></a>00997 
<a name="l00998"></a>00998     <span class="comment">//info list which will contain members of the current side</span>
<a name="l00999"></a>00999     <span class="comment">//being built. this list needs to be added to, popped off</span>
<a name="l01000"></a>01000     <span class="comment">//either end and order doesnt matter (neither here or later).</span>
<a name="l01001"></a>01001     <span class="comment">//contains info on the face, assoc elem, and normal.</span>
<a name="l01002"></a>01002     <span class="comment">//therefore choosing faceinfo array. allocating space for</span>
<a name="l01003"></a>01003     <span class="comment">//1 since we know there will be at least one in this face</span>
<a name="l01004"></a>01004     <span class="comment">//(that is - the one we pop off the facelist</span>
<a name="l01005"></a>01005     <span class="comment">//directly below)</span>
<a name="l01006"></a>01006     <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>** working_list  = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>**)malloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l01007"></a>01007     <span class="keywordtype">int</span> numworkinglist = 0;
<a name="l01008"></a>01008     <span class="keywordtype">int</span> maxworkinglist = 1;
<a name="l01009"></a>01009 
<a name="l01010"></a>01010     <span class="comment">//id arrays for the current side. chose (unsorted) int arrays </span>
<a name="l01011"></a>01011     <span class="comment">//becuase its the most efficient way to later add the IDs to the</span><span class="comment"></span>
<a name="l01012"></a>01012 <span class="comment">    ///2 subsets(faces and elems) - add the whole array at once</span>
<a name="l01013"></a>01013 <span class="comment"></span>    <span class="comment">//(subset will do a sorting and uniqueness of the array).</span>
<a name="l01014"></a>01014     <span class="comment">//they dont need to be sorted or searched. start by</span>
<a name="l01015"></a>01015     <span class="comment">//allocating space for 1, since we know there wil be at least</span>
<a name="l01016"></a>01016     <span class="comment">//1 side in this face (that is - the one we pop off the facelist</span>
<a name="l01017"></a>01017     <span class="comment">//directly below</span>
<a name="l01018"></a>01018     <span class="keywordtype">int</span> *currside_faces = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); 
<a name="l01019"></a>01019     <span class="keywordtype">int</span> *currside_elems = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01020"></a>01020                                    
<a name="l01021"></a>01021     <span class="keywordtype">int</span> numcurrsideIDs = 0;
<a name="l01022"></a>01022     <span class="keywordtype">int</span> maxcurrsideIDs = 1;
<a name="l01023"></a>01023 
<a name="l01024"></a>01024     <span class="keywordflow">if</span> (!working_list || ! currside_faces || ! currside_elems){
<a name="l01025"></a>01025       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01026"></a>01026       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029     <span class="comment">//     printf("working on side %d\n",numSegments);</span>
<a name="l01030"></a>01030 
<a name="l01031"></a>01031     <span class="comment">//initialize - pop off the last one and addit to the working list</span>
<a name="l01032"></a>01032     <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> *temp_node = in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>-1];
<a name="l01033"></a>01033     in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>--;
<a name="l01034"></a>01034     working_list[0]= temp_node; <span class="comment">//we know we have space for it</span>
<a name="l01035"></a>01035     numworkinglist = 1;
<a name="l01036"></a>01036 
<a name="l01037"></a>01037     <span class="comment">// "grow" connected region from seed by checking neighbors</span>
<a name="l01038"></a>01038     <span class="keywordflow">while</span>(numworkinglist){
<a name="l01039"></a>01039       <span class="keywordtype">int</span> currID;
<a name="l01040"></a>01040       <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> currNormal; 
<a name="l01041"></a>01041 
<a name="l01042"></a>01042       <span class="comment">// remove last entity from working list and put it on</span>
<a name="l01043"></a>01043       <span class="comment">// the 3 lists with side info</span>
<a name="l01044"></a>01044       <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> *currnode = working_list[numworkinglist-1]; 
<a name="l01045"></a>01045       numworkinglist--;
<a name="l01046"></a>01046 
<a name="l01047"></a>01047       sideArray[currnode-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>] = numSegments; <span class="comment">//fill in its side in the array (hashtable)</span>
<a name="l01048"></a>01048       <span class="keywordflow">if</span> (numcurrsideIDs == maxcurrsideIDs){<span class="comment">//grow the lists</span>
<a name="l01049"></a>01049      <span class="keywordtype">int</span>* temp = (<span class="keywordtype">int</span>*)realloc(currside_faces,(2*maxcurrsideIDs)*<span class="keyword">sizeof</span>(int));
<a name="l01050"></a>01050      <span class="keywordflow">if</span> (temp == NULL){
<a name="l01051"></a>01051        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01052"></a>01052        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01053"></a>01053      }
<a name="l01054"></a>01054      currside_faces = temp;
<a name="l01055"></a>01055      temp = (<span class="keywordtype">int</span>*)realloc(currside_elems,(2*maxcurrsideIDs)*<span class="keyword">sizeof</span>(int));
<a name="l01056"></a>01056      <span class="keywordflow">if</span> (temp == NULL){
<a name="l01057"></a>01057        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01058"></a>01058        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01059"></a>01059      }
<a name="l01060"></a>01060      currside_elems = temp;
<a name="l01061"></a>01061      maxcurrsideIDs*=2;
<a name="l01062"></a>01062       }
<a name="l01063"></a>01063       currside_faces[numcurrsideIDs] = currnode-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>;
<a name="l01064"></a>01064       currside_elems[numcurrsideIDs] = currnode-&gt;<a class="code" href="struct__faceinfo.html#f8a60bc7ff3519ac17b3d052eea92e67">elemID</a>;
<a name="l01065"></a>01065       numcurrsideIDs++;
<a name="l01066"></a>01066       
<a name="l01067"></a>01067       <span class="comment">//we only need these if there is a neighbor, but it</span>
<a name="l01068"></a>01068       <span class="comment">//allows us to free the currnode</span>
<a name="l01069"></a>01069       currID = currnode-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>;
<a name="l01070"></a>01070       <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l01071"></a>01071      currNormal[i] = currnode-&gt;<a class="code" href="struct__faceinfo.html#5dd2e8728504a5c05c7e5e0ac60e3b0c">normal</a>[i];
<a name="l01072"></a>01072       }
<a name="l01073"></a>01073       free(currnode); <span class="comment">//free the actual info, not the ptr.</span>
<a name="l01074"></a>01074 
<a name="l01075"></a>01075       <span class="keywordflow">if</span> (in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>){ <span class="comment">//we have neighbors to check (otherwise</span>
<a name="l01076"></a>01076      <span class="comment">// just loop till empty out working list</span>
<a name="l01077"></a>01077      <span class="keywordtype">int</span> *neighborIDs;
<a name="l01078"></a>01078      <span class="keywordtype">int</span> numNeighbor;
<a name="l01079"></a>01079 
<a name="l01080"></a>01080      <span class="comment">//   printf("checking neighbors of currid = %d\n",currID);</span>
<a name="l01081"></a>01081      <span class="comment">// Move neighbors of that entity that satisfy the angle criteria</span>
<a name="l01082"></a>01082      <span class="comment">// that are in the orig list to the working list</span>
<a name="l01083"></a>01083      rc = <a class="code" href="group__TopologyRelations.html#g6ee1028bf4343f79d907b41cc0d108c4" title="Get the neighbors of a mesh subentity.">fc_getMeshEntityNeighbors</a>(mesh, currID, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>, shared_dim,
<a name="l01084"></a>01084                            &amp;numNeighbor, &amp;neighborIDs);
<a name="l01085"></a>01085      <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l01086"></a>01086        <span class="comment">//clean up</span>
<a name="l01087"></a>01087        <span class="keywordflow">return</span> rc;
<a name="l01088"></a>01088      
<a name="l01089"></a>01089      <span class="keywordflow">for</span> (i = 0; i &lt; numNeighbor; i++) {
<a name="l01090"></a>01090        <span class="keywordtype">double</span> angle;
<a name="l01091"></a>01091        <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> *node;
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 
<a name="l01094"></a>01094        rc = <a class="code" href="group__PrivateShape.html#g8d220ceaab54d5d3c89d106d9f4c3f48" title="looks for a fi index in sfi array">_fc_lookupInSFI_Array</a>(in_faceinfolist,neighborIDs[i],&amp;node);
<a name="l01095"></a>01095        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01096"></a>01096          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant check for key in list"</span>);
<a name="l01097"></a>01097          <span class="comment">//clean up</span>
<a name="l01098"></a>01098          <span class="keywordflow">return</span> rc;
<a name="l01099"></a>01099        }
<a name="l01100"></a>01100        
<a name="l01101"></a>01101        <span class="keywordflow">if</span> (node == NULL){ <span class="comment">//this face is not part of the skin</span>
<a name="l01102"></a>01102          <span class="comment">//        printf("face %d in not ont he skin\n",neighborIDs[i]);</span>
<a name="l01103"></a>01103          <span class="keywordflow">continue</span>;
<a name="l01104"></a>01104        }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106        <span class="comment">//does this neighbor satisfy the angle criteria ?</span>
<a name="l01107"></a>01107        rc = <a class="code" href="group__GeometricRelations.html#g30ce3387c782c3d8a74fb0075168bca0" title="Determine angle between two vectors.">fc_calcAngleBetweenVectors</a>(currNormal,
<a name="l01108"></a>01108                            node-&gt;<a class="code" href="struct__faceinfo.html#5dd2e8728504a5c05c7e5e0ac60e3b0c">normal</a>,
<a name="l01109"></a>01109                            &amp;angle);
<a name="l01110"></a>01110        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01111"></a>01111          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get angle between vectors"</span>);
<a name="l01112"></a>01112          <span class="comment">//clean up</span>
<a name="l01113"></a>01113          <span class="keywordflow">return</span> rc;
<a name="l01114"></a>01114        }
<a name="l01115"></a>01115 
<a name="l01116"></a>01116        <span class="keywordflow">if</span> (angle &gt; comp_angle){ 
<a name="l01117"></a>01117          <span class="comment">//this face is not part of this side, but it is an edgepair</span>
<a name="l01118"></a>01118          <span class="keywordtype">void</span> *temp;
<a name="l01119"></a>01119          <span class="comment">//        printf("face %d in not on the side, but is an edge\n",node-&gt;faceID);</span>
<a name="l01120"></a>01120          <span class="keywordflow">if</span> (numEdgePairs + 1 &gt; maxEdgePairs) {
<a name="l01121"></a>01121            maxEdgePairs *= 2;
<a name="l01122"></a>01122            temp = realloc(edgePairs, maxEdgePairs*<span class="keyword">sizeof</span>(<a class="code" href="struct__intpair.html">_FC_INTPAIR</a>));
<a name="l01123"></a>01123            <span class="keywordflow">if</span> (temp == NULL) {
<a name="l01124"></a>01124           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01125"></a>01125           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;  
<a name="l01126"></a>01126            }
<a name="l01127"></a>01127            edgePairs = temp;
<a name="l01128"></a>01128          }
<a name="l01129"></a>01129          
<a name="l01130"></a>01130          edgePairs[numEdgePairs].<a class="code" href="struct__intpair.html#dc70f34e5575cd940017d1b53123e1b0">ID1</a> = currID;
<a name="l01131"></a>01131          edgePairs[numEdgePairs].<a class="code" href="struct__intpair.html#55d90419867c058ed9d24e1c2df8dab8">ID2</a> = node-&gt;<a class="code" href="struct__faceinfo.html#55af13b785e7a8671d13db857a7d8a87">faceID</a>;
<a name="l01132"></a>01132          numEdgePairs++;
<a name="l01133"></a>01133          <span class="keywordflow">continue</span>;
<a name="l01134"></a>01134        }
<a name="l01135"></a>01135        
<a name="l01136"></a>01136        <span class="comment">//its part of the skin and its on this side</span>
<a name="l01137"></a>01137        <span class="comment">//   printf("face %d is on the side\n",node-&gt;faceID);</span>
<a name="l01138"></a>01138        rc = <a class="code" href="group__PrivateShape.html#g745fc26da9637e72dc91adcf9a0834a0" title="removes an item from the sfi array">_fc_removeFromSFI_Array</a>(in_faceinfolist,neighborIDs[i],&amp;node);
<a name="l01139"></a>01139        <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l01140"></a>01140          <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cant remove node"</span>);
<a name="l01141"></a>01141          <span class="comment">//clean up</span>
<a name="l01142"></a>01142          <span class="keywordflow">return</span> rc;
<a name="l01143"></a>01143        }
<a name="l01144"></a>01144 
<a name="l01145"></a>01145        <span class="comment">//now add that data to the workinglist</span>
<a name="l01146"></a>01146        <span class="keywordflow">if</span> (numworkinglist == maxworkinglist){ <span class="comment">//grow the array</span>
<a name="l01147"></a>01147          <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>** temp = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>**)realloc(working_list,
<a name="l01148"></a>01148                                      (2*maxworkinglist)*<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l01149"></a>01149          <span class="keywordflow">if</span> (temp == NULL){
<a name="l01150"></a>01150            <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01151"></a>01151            <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01152"></a>01152          }
<a name="l01153"></a>01153          working_list = temp;
<a name="l01154"></a>01154          maxworkinglist*=2;
<a name="l01155"></a>01155        }
<a name="l01156"></a>01156        working_list[numworkinglist] = node; <span class="comment">//gets the ptr</span>
<a name="l01157"></a>01157        numworkinglist++;
<a name="l01158"></a>01158        
<a name="l01159"></a>01159      } <span class="comment">//end for</span>
<a name="l01160"></a>01160      free(neighborIDs);
<a name="l01161"></a>01161       } <span class="comment">//end if facelist != NULL</span>
<a name="l01162"></a>01162     } <span class="comment">// end while working list</span>
<a name="l01163"></a>01163     free(working_list); <span class="comment">//this is the array itself, there are no members now</span>
<a name="l01164"></a>01164 
<a name="l01165"></a>01165     <span class="comment">//now weve got faces and elem arrays for this side </span>
<a name="l01166"></a>01166     { <span class="comment">// create subsets from arrays of IDs</span>
<a name="l01167"></a>01167       <span class="keywordtype">void</span> *temp;
<a name="l01168"></a>01168 
<a name="l01169"></a>01169       <span class="comment">//      printf("making subsets from arrays\n");</span>
<a name="l01170"></a>01170       temp = realloc(faceSegments, (numSegments+1)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01171"></a>01171       <span class="keywordflow">if</span> (temp == NULL) {
<a name="l01172"></a>01172      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01173"></a>01173      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01174"></a>01174       }
<a name="l01175"></a>01175       faceSegments = temp;
<a name="l01176"></a>01176       sprintf(temp_name, <span class="stringliteral">"%s_FaceSurface%d"</span>, *basename, numSegments);
<a name="l01177"></a>01177       rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh, temp_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>, &amp;faceSegments[numSegments]);
<a name="l01178"></a>01178       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01179"></a>01179      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cannot create newFaceSubset[%d]"</span>, numSegments);
<a name="l01180"></a>01180      <span class="comment">//clean up</span>
<a name="l01181"></a>01181      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; 
<a name="l01182"></a>01182       }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184       rc = <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(faceSegments[numSegments], numcurrsideIDs,
<a name="l01185"></a>01185                           currside_faces);
<a name="l01186"></a>01186       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01187"></a>01187      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cannot add ids to facesegment"</span>);
<a name="l01188"></a>01188      <span class="comment">//clean up</span>
<a name="l01189"></a>01189      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; 
<a name="l01190"></a>01190       }
<a name="l01191"></a>01191       
<a name="l01192"></a>01192       temp = realloc(elemSegments, (numSegments+1)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l01193"></a>01193       <span class="keywordflow">if</span> (temp == NULL) {
<a name="l01194"></a>01194      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l01195"></a>01195      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l01196"></a>01196       }
<a name="l01197"></a>01197       elemSegments = temp;
<a name="l01198"></a>01198       sprintf(temp_name, <span class="stringliteral">"%s_ElemSurface%d"</span>, *basename, numSegments);
<a name="l01199"></a>01199       rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh, temp_name, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, &amp;elemSegments[numSegments]);
<a name="l01200"></a>01200       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01201"></a>01201      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cannot create newElemSubset[%d]"</span>, numSegments);
<a name="l01202"></a>01202      <span class="comment">//clean up</span>
<a name="l01203"></a>01203      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; 
<a name="l01204"></a>01204       }
<a name="l01205"></a>01205 
<a name="l01206"></a>01206       rc = <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(elemSegments[numSegments], numcurrsideIDs,
<a name="l01207"></a>01207                           currside_elems);
<a name="l01208"></a>01208       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) {
<a name="l01209"></a>01209      <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"cannot add ids to facesegment"</span>);
<a name="l01210"></a>01210      <span class="comment">//clean up</span>
<a name="l01211"></a>01211      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; 
<a name="l01212"></a>01212       }
<a name="l01213"></a>01213 
<a name="l01214"></a>01214       <span class="comment">//clean up currside info</span>
<a name="l01215"></a>01215       free(currside_faces);
<a name="l01216"></a>01216       free(currside_elems);
<a name="l01217"></a>01217 
<a name="l01218"></a>01218       numSegments++;
<a name="l01219"></a>01219     } <span class="comment">//created subsets</span>
<a name="l01220"></a>01220   } <span class="comment">// while orig_list</span>
<a name="l01221"></a>01221 
<a name="l01222"></a>01222   free(in_faceinfolist-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>); <span class="comment">//free the array of ptrs, already freed what they are pting to</span>
<a name="l01223"></a>01223 
<a name="l01224"></a>01224 
<a name="l01225"></a>01225   <span class="comment">//adjmatrix calculation</span>
<a name="l01226"></a>01226   intmatrix = (<span class="keywordtype">int</span>**)malloc(numSegments*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l01227"></a>01227   <span class="keywordflow">for</span> (i = 0; i &lt; numSegments; i++){
<a name="l01228"></a>01228     intmatrix[i] = (<span class="keywordtype">int</span>*)calloc(numSegments,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01229"></a>01229   }
<a name="l01230"></a>01230   <span class="comment">//  printf("internal calc of adjmatrix\n");</span>
<a name="l01231"></a>01231 
<a name="l01232"></a>01232   <span class="keywordflow">for</span> (i = 0; i &lt; numEdgePairs; i++){
<a name="l01233"></a>01233     <span class="comment">//      printf("ID %d side %d ID %d side %d\n",edgePairs[i].ID1,sideArray[edgePairs[i].ID1],</span>
<a name="l01234"></a>01234     <span class="comment">//        edgePairs[i].ID2,sideArray[edgePairs[i].ID2]);</span>
<a name="l01235"></a>01235     <span class="keywordflow">if</span> (sideArray[edgePairs[i].ID1] == sideArray[edgePairs[i].ID2]){
<a name="l01236"></a>01236       <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Faces %d %d are edges but both on same side %d - Might be a crease\n"</span>,
<a name="l01237"></a>01237                      edgePairs[i].ID1,edgePairs[i].ID2,sideArray[edgePairs[i].ID1]);
<a name="l01238"></a>01238     }<span class="keywordflow">else</span>{
<a name="l01239"></a>01239       intmatrix[sideArray[edgePairs[i].<a class="code" href="struct__intpair.html#dc70f34e5575cd940017d1b53123e1b0">ID1</a>]][sideArray[edgePairs[i].<a class="code" href="struct__intpair.html#55d90419867c058ed9d24e1c2df8dab8">ID2</a>]] = 1;
<a name="l01240"></a>01240       intmatrix[sideArray[edgePairs[i].ID2]][sideArray[edgePairs[i].ID1]] = 1;
<a name="l01241"></a>01241     }
<a name="l01242"></a>01242   }
<a name="l01243"></a>01243 
<a name="l01244"></a>01244   <span class="keywordflow">if</span> (0){
<a name="l01245"></a>01245     <span class="comment">//print adj matrix</span>
<a name="l01246"></a>01246     printf(<span class="stringliteral">"before leaving shape parts\n"</span>);
<a name="l01247"></a>01247     <span class="keywordflow">for</span> (i = 0; i &lt; numSegments; i++){  
<a name="l01248"></a>01248       <span class="keywordflow">for</span> (j = 0; j &lt; numSegments; j++){     
<a name="l01249"></a>01249      printf(<span class="stringliteral">"%d "</span>, intmatrix[i][j]);
<a name="l01250"></a>01250       }
<a name="l01251"></a>01251       printf(<span class="stringliteral">"\n"</span>);
<a name="l01252"></a>01252     }
<a name="l01253"></a>01253   }
<a name="l01254"></a>01254 
<a name="l01255"></a>01255   <span class="comment">// cleanup (orig_list is empty)</span>
<a name="l01256"></a>01256   free(temp_name);
<a name="l01257"></a>01257   free(sideArray);
<a name="l01258"></a>01258   free(edgePairs);
<a name="l01259"></a>01259 
<a name="l01260"></a>01260   <span class="comment">//return values </span>
<a name="l01261"></a>01261   *numSides = numSegments;
<a name="l01262"></a>01262   *newFaceSubsets = faceSegments;
<a name="l01263"></a>01263   *newElemSubsets = elemSegments;
<a name="l01264"></a>01264   *adjmatrix = intmatrix;
<a name="l01265"></a>01265 
<a name="l01266"></a>01266   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l01267"></a>01267 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g50ecebb2721798d813904008e0dff0c6"></a><!-- doxytag: member="shape.c::_fc_freeSFI_Array" ref="g50ecebb2721798d813904008e0dff0c6" args="(_FC_SFI_ARRAY *sfi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_freeSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
frees the sfi array 
<p>
<b>Description:</b> <p>
frees the sfi array<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>

<p>Definition at line <a class="el" href="shape_8c-source.html#l00347">347</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shapeP_8h-source.html#l00068">_sfi_array::maxVals</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l00593">_fc_buildFaceInfoListFromShape()</a>, <a class="el" href="shape_8c-source.html#l01339">fc_getSubsetShapes()</a>, and <a class="el" href="shape_8c-source.html#l01609">fc_reshapeByAngle()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00349"></a>00349   {
<a name="l00350"></a>00350   <span class="keywordtype">int</span> i;
<a name="l00351"></a>00351   <span class="keywordflow">for</span>(i = 0; i &lt; sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>; i++){
<a name="l00352"></a>00352     <span class="comment">//free each face info</span>
<a name="l00353"></a>00353     <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> *fi = sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[i];
<a name="l00354"></a>00354     free(fi);
<a name="l00355"></a>00355   }
<a name="l00356"></a>00356   <span class="comment">//free the array if it isnt already</span>
<a name="l00357"></a>00357   <span class="keywordflow">if</span> (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>) free(sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>);
<a name="l00358"></a>00358   sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> = NULL;
<a name="l00359"></a>00359   sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a> = 0;
<a name="l00360"></a>00360   sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a> = 0;
<a name="l00361"></a>00361 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8d520bfe173ac78fd6e253afc1393e8e"></a><!-- doxytag: member="shape.c::_fc_getOutwardFaceNormal" ref="g8d520bfe173ac78fd6e253afc1393e8e" args="(FC_Mesh mesh, int faceID, int elemID, FC_Vector *normal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getOutwardFaceNormal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>faceID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>elemID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>normal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns outward normal vector for a given face on a given element. 
<p>
<b>Description:</b> <p>
Returns outward normal vector for a given face on a given element Uses assumption of fc_calcSurfaceNormals that this is only correct for planar elements (like triangles and planar quads), but checking FaceType rather than ElemType.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000075">Todo:</a></b></dt><dd><ul>
<li>faster search</li><li>check mem allocation, esp in inner _fc_calcSurfaceNormal</li><li>does this need to be explicitly unittested? it is tested inso far as getSubsetSides and getPlanarSideNormal have been tested</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>10/07/05 ACG created</li><li>12/19/2005 ACG moved from <a class="el" href="group__TopologyRelations.html">Topological Relations</a> to <a class="el" href="group__Shape.html">Shape</a> </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>faceID</em>&nbsp;</td><td>
input - faceID </td></tr>
<tr><td valign="top"><em>elemID</em>&nbsp;</td><td>
input - elemID </td></tr>
<tr><td valign="top"><em>normal</em>&nbsp;</td><td>
output - normal vector </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l00750">750</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l06901">_fc_calcSurfaceNormal()</a>, <a class="el" href="base_8h-source.html#l00123">FC_ET_QUAD</a>, <a class="el" href="base_8h-source.html#l00122">FC_ET_TRI</a>, <a class="el" href="base_8c-source.html#l00622">fc_getElementTypeNumFace()</a>, <a class="el" href="base_8c-source.html#l00385">fc_getElementTypeText()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03952">fc_getMeshElementFaceOrientsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03880">fc_getMeshElementToFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03691">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03622">fc_getMeshFaceTypesPtr()</a>, <a class="el" href="mesh_8c-source.html#l02848">fc_getMeshInfo()</a>, <a class="el" href="mesh_8c-source.html#l03208">fc_getMeshNumFace()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l00593">_fc_buildFaceInfoListFromShape()</a>, <a class="el" href="shape_8c-source.html#l00402">_fc_buildFaceInfoListFromSubset()</a>, <a class="el" href="shape_8c-source.html#l03873">fc_getPlanarSideNormal()</a>, and <a class="el" href="shape_8c-source.html#l04008">fc_getSideNormalMeanSdev()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00755"></a>00755   {
<a name="l00756"></a>00756   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00757"></a>00757   <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType, *faceTypes;
<a name="l00758"></a>00758   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> coords[4]; <span class="comment">//restricted to tri and quad</span>
<a name="l00759"></a>00759   <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> temp_normal;
<a name="l00760"></a>00760   <span class="keywordtype">int</span> numelem, numface, orient, numDim, numFacePerElem;
<a name="l00761"></a>00761   <span class="keywordtype">int</span> i,j,k;
<a name="l00762"></a>00762   <span class="keywordtype">double</span>* mesh_coords;
<a name="l00763"></a>00763   <span class="keywordtype">int</span> maxNumVertPerFace, *numVertPerFace, *faceConns, *elemToFaceConns;
<a name="l00764"></a>00764   <span class="keywordtype">int</span> *elemFaceOrients;
<a name="l00765"></a>00765 
<a name="l00766"></a>00766   <span class="comment">//default</span>
<a name="l00767"></a>00767   <span class="keywordflow">if</span> (normal){
<a name="l00768"></a>00768     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l00769"></a>00769       (*normal)[i] = 0;
<a name="l00770"></a>00770     }
<a name="l00771"></a>00771   }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"calc normal for face %d on elem %d\n"</span>, faceID, elemID);
<a name="l00774"></a>00774 
<a name="l00775"></a>00775   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || !normal){
<a name="l00776"></a>00776     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00777"></a>00777     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00778"></a>00778   }
<a name="l00779"></a>00779 
<a name="l00780"></a>00780   rc = <a class="code" href="group__Mesh.html#ged61b1f684fc2a6ac489c10841cdb591" title="Get information about a mesh.">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, NULL, &amp;numelem, &amp;elemType);
<a name="l00781"></a>00781   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00782"></a>00782     <span class="keywordflow">return</span> rc;
<a name="l00783"></a>00783 
<a name="l00784"></a>00784   rc = <a class="code" href="group__Mesh.html#g8c619c146c0850895098f5dbfb487418" title="Get number of faces in a mesh.">fc_getMeshNumFace</a>(mesh,&amp;numface);
<a name="l00785"></a>00785   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00786"></a>00786     <span class="keywordflow">return</span> rc;
<a name="l00787"></a>00787 
<a name="l00788"></a>00788   numFacePerElem = <a class="code" href="group__DataTypes.html#g1cffd2eb82ec74e749ca93a6cb623e4a" title="Returns number of faces in a type of element.">fc_getElementTypeNumFace</a>(elemType);
<a name="l00789"></a>00789 
<a name="l00790"></a>00790   <span class="keywordflow">if</span> (elemID &lt; 0 || elemID &gt; numelem || faceID &lt; 0 || faceID &gt; numface){
<a name="l00791"></a>00791     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l00792"></a>00792     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00793"></a>00793   }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795   rc = <a class="code" href="group__Mesh.html#g8e318f4b17572413004acf14b18deb2b" title="Return face connectivities.">fc_getMeshFaceConnsPtr</a>(mesh, &amp;numVertPerFace, &amp;maxNumVertPerFace, 
<a name="l00796"></a>00796                               &amp;faceConns);
<a name="l00797"></a>00797   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l00798"></a>00798     <span class="keywordflow">return</span> rc;
<a name="l00799"></a>00799   rc = <a class="code" href="group__Mesh.html#gcb5601b14ced6179dd454ed35585d21d" title="Return face types.">fc_getMeshFaceTypesPtr</a>(mesh, &amp;faceTypes);
<a name="l00800"></a>00800   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00801"></a>00801     <span class="keywordflow">return</span> rc;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803   <span class="keywordflow">if</span> (faceTypes[faceID] != <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884af79268373ad06101e34987c127cb50b5">FC_ET_TRI</a> &amp;&amp; faceTypes[faceID] != <a class="code" href="group__DataTypes.html#gg57a0abe7a63cc2c6c9fb0a3db339884aecaa2098167cbf0e3ee39fec88e073ca">FC_ET_QUAD</a>){
<a name="l00804"></a>00804     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s, can't handle face type %s"</span>,
<a name="l00805"></a>00805                           <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>),
<a name="l00806"></a>00806                           <a class="code" href="group__DataTypes.html#g4152b6e700d60abe601b48ce595db9a7" title="Return the name of the FC_ElementType&amp;#39;s value.">fc_getElementTypeText</a>(faceTypes[faceID]));
<a name="l00807"></a>00807    <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00808"></a>00808   }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810   rc = <a class="code" href="group__Mesh.html#g7f17910148b4237e84ca374845688cfc" title="Return element to face connectivities.">fc_getMeshElementToFaceConnsPtr</a>(mesh, &amp;elemToFaceConns);
<a name="l00811"></a>00811   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00812"></a>00812     <span class="keywordflow">return</span> rc;
<a name="l00813"></a>00813   rc = <a class="code" href="group__Mesh.html#gfcea3747b7482cb7317b2aa54e7b1f8c" title="Return element&amp;#39;s face&amp;#39;s orientations relative to global faces.">fc_getMeshElementFaceOrientsPtr</a>(mesh, &amp;elemFaceOrients);
<a name="l00814"></a>00814   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00815"></a>00815     <span class="keywordflow">return</span> rc;
<a name="l00816"></a>00816   rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(mesh, &amp;mesh_coords);
<a name="l00817"></a>00817   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) 
<a name="l00818"></a>00818     <span class="keywordflow">return</span> rc;
<a name="l00819"></a>00819 
<a name="l00820"></a>00820   orient = 0;
<a name="l00821"></a>00821   <span class="keywordflow">for</span> (i = 0; i &lt; numFacePerElem; i++){
<a name="l00822"></a>00822     <span class="keywordflow">if</span> (elemToFaceConns[elemID*numFacePerElem+i] == faceID){
<a name="l00823"></a>00823       orient = elemFaceOrients[elemID*numFacePerElem+i];
<a name="l00824"></a>00824       <span class="keywordflow">break</span>;
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826   }
<a name="l00827"></a>00827   <span class="keywordflow">if</span> (orient == 0){
<a name="l00828"></a>00828     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"face %d not in face list for element %d"</span>,
<a name="l00829"></a>00829                           faceID,elemID);
<a name="l00830"></a>00830     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l00831"></a>00831   }
<a name="l00832"></a>00832   
<a name="l00833"></a>00833   <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerFace[faceID]; j++) {
<a name="l00834"></a>00834     <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++)
<a name="l00835"></a>00835      coords[j][k] = mesh_coords[faceConns[faceID*maxNumVertPerFace+j]*numDim+k];
<a name="l00836"></a>00836     <span class="keywordflow">for</span> (k = numDim; k &lt; 3; k++)
<a name="l00837"></a>00837       coords[j][k] = 0;
<a name="l00838"></a>00838   }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840   <a class="code" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17" title="Compute unit normal of surface.">_fc_calcSurfaceNormal</a>(numVertPerFace[faceID], coords, &amp;temp_normal);
<a name="l00841"></a>00841   <span class="comment">//  printf("surface normal (%g %g %g) ",</span>
<a name="l00842"></a>00842   <span class="comment">//     temp_normal[0],temp_normal[1], temp_normal[2]);</span>
<a name="l00843"></a>00843 
<a name="l00844"></a>00844   <span class="comment">//  normal = (FC_Vector*)malloc(sizeof(FC_Vector));</span>
<a name="l00845"></a>00845   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00846"></a>00846     (*normal)[i] = orient*temp_normal[i];
<a name="l00847"></a>00847 
<a name="l00848"></a>00848   <span class="comment">//  printf(" after orient (%g %g %g)\n",(*normal)[0],(*normal)[1],</span>
<a name="l00849"></a>00849   <span class="comment">//     (*normal)[2]);</span>
<a name="l00850"></a>00850   
<a name="l00851"></a>00851   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00852"></a>00852 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2254938019f03a64de53c57a3d23272a"></a><!-- doxytag: member="shape.c::_fc_initSFI_Array" ref="g2254938019f03a64de53c57a3d23272a" args="(_FC_SFI_ARRAY *sfi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_initSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
inits the sfi array 
<p>
<b>Description:</b> <p>
inits the sfi array<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>sfi</em>&nbsp;</td><td>
input - sorted face info array </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="shape_8c-source.html#l00109">109</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shapeP_8h-source.html#l00068">_sfi_array::maxVals</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l00593">_fc_buildFaceInfoListFromShape()</a>, and <a class="el" href="shape_8c-source.html#l00402">_fc_buildFaceInfoListFromSubset()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00111"></a>00111    {
<a name="l00112"></a>00112   sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a> = 0;
<a name="l00113"></a>00113   sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a> = 0;
<a name="l00114"></a>00114   sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> = NULL;
<a name="l00115"></a>00115   
<a name="l00116"></a>00116   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00117"></a>00117 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8d220ceaab54d5d3c89d106d9f4c3f48"></a><!-- doxytag: member="shape.c::_fc_lookupInSFI_Array" ref="g8d220ceaab54d5d3c89d106d9f4c3f48" args="(_FC_SFI_ARRAY *sfi, int i, _FC_FACEINFO **fi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_lookupInSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__faceinfo.html">_FC_FACEINFO</a> **&nbsp;</td>
          <td class="paramname"> <em>fi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
looks for a fi index in sfi array 
<p>
<b>Description:</b> <p>
looks for a fi index in sfi array. returns a pointer to the item if its there, NULL if not<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>

<p>Definition at line <a class="el" href="shape_8c-source.html#l00200">200</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l00893">_fc_createShapePartsFromFaceInfoList()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00204"></a>00204  {
<a name="l00205"></a>00205 
<a name="l00206"></a>00206   <span class="keywordtype">int</span> low, high, mid;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   *fi = NULL;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   <span class="keywordflow">if</span> (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> == NULL){ <span class="comment">//empty</span>
<a name="l00211"></a>00211     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00212"></a>00212   }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <span class="comment">//binary search</span>
<a name="l00215"></a>00215   
<a name="l00216"></a>00216   low = 0;
<a name="l00217"></a>00217   high = sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>-1;
<a name="l00218"></a>00218   <span class="keywordflow">while</span>(low &lt;= high){
<a name="l00219"></a>00219     mid = (low+high)/2;
<a name="l00220"></a>00220     <span class="comment">//      printf("low %d high %d mid %d\n",low,high,mid);</span>
<a name="l00221"></a>00221     <span class="keywordflow">if</span> ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID == i){
<a name="l00222"></a>00222       *fi = sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid];
<a name="l00223"></a>00223       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00224"></a>00224     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID &lt; i){
<a name="l00225"></a>00225       low = mid+1;
<a name="l00226"></a>00226     } <span class="keywordflow">else</span>{
<a name="l00227"></a>00227       high = mid -1;
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229   }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00232"></a>00232 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf4a082b457cd472acbde47cffc7b90f7"></a><!-- doxytag: member="shape.c::_fc_printSFI_Array" ref="gf4a082b457cd472acbde47cffc7b90f7" args="(_FC_SFI_ARRAY *sfi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_printSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
prints the sfi array 
<p>
<b>Description:</b> <p>
prints the sfi array<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>

<p>Definition at line <a class="el" href="shape_8c-source.html#l00320">320</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00322"></a>00322  {
<a name="l00323"></a>00323   <span class="keywordtype">int</span> i;
<a name="l00324"></a>00324   printf(<span class="stringliteral">"SFI_Array has %d vals\n"</span>,sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>);
<a name="l00325"></a>00325   <span class="keywordflow">for</span> (i = 0; i &lt; sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>; i++){
<a name="l00326"></a>00326     printf(<span class="stringliteral">"faceid %d elemid %d normal %10g %10g %10g\n"</span>,
<a name="l00327"></a>00327         (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[i])-&gt;faceID,
<a name="l00328"></a>00328         (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[i])-&gt;elemID,
<a name="l00329"></a>00329         (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[i])-&gt;normal[0],
<a name="l00330"></a>00330         (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[i])-&gt;normal[1],
<a name="l00331"></a>00331         (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[i])-&gt;normal[2]);
<a name="l00332"></a>00332   }
<a name="l00333"></a>00333 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g45bbf71518d8d732bfc2e4e7c46cd6a7"></a><!-- doxytag: member="shape.c::_fc_reallocSFI_Array" ref="g45bbf71518d8d732bfc2e4e7c46cd6a7" args="(_FC_SFI_ARRAY *sfi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _fc_reallocSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
reallocs the sfi array 
<p>
<b>Description:</b> <p>
reallocs the sfi array<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>

<p>Definition at line <a class="el" href="shape_8c-source.html#l00294">294</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="shapeP_8h-source.html#l00068">_sfi_array::maxVals</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00296"></a>00296   {
<a name="l00297"></a>00297   <a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a> **temp = (<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>**)realloc(sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>,
<a name="l00298"></a>00298                                (sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>)*<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l00299"></a>00299   <span class="keywordflow">if</span> (temp == NULL){
<a name="l00300"></a>00300     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00301"></a>00301     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00302"></a>00302   }
<a name="l00303"></a>00303   sfi-&gt;<a class="code" href="struct__sfi__array.html#853b245a0f391b7246cf7f4fb35ffbf4">maxVals</a> = sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>;
<a name="l00304"></a>00304   sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> = temp;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   <span class="keywordflow">return</span> 1;
<a name="l00307"></a>00307 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g745fc26da9637e72dc91adcf9a0834a0"></a><!-- doxytag: member="shape.c::_fc_removeFromSFI_Array" ref="g745fc26da9637e72dc91adcf9a0834a0" args="(_FC_SFI_ARRAY *sfi, int i, _FC_FACEINFO **fi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_removeFromSFI_Array           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__sfi__array.html">_FC_SFI_ARRAY</a> *&nbsp;</td>
          <td class="paramname"> <em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__faceinfo.html">_FC_FACEINFO</a> **&nbsp;</td>
          <td class="paramname"> <em>fi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
removes an item from the sfi array 
<p>
<b>Description:</b> <p>
removes an item from the sfi array. returns a pointer to it. the user is responsible for freeing it when he is done with it<p>
<b>Modifications:</b> <ul>
<li>06/07/06 ACG created </li></ul>

<p>Definition at line <a class="el" href="shape_8c-source.html#l00246">246</a> of file <a class="el" href="shape_8c-source.html">shape.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shapeP_8h-source.html#l00067">_sfi_array::numVals</a>, and <a class="el" href="shapeP_8h-source.html#l00069">_sfi_array::vals</a>.</p>

<p>Referenced by <a class="el" href="shape_8c-source.html#l00893">_fc_createShapePartsFromFaceInfoList()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00250"></a>00250  {
<a name="l00251"></a>00251   <span class="keywordtype">int</span> low, high, mid;
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   *fi = NULL;
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="keywordflow">if</span> (sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a> == NULL){ <span class="comment">//empty</span>
<a name="l00256"></a>00256     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00257"></a>00257   }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259   <span class="comment">//binary search</span>
<a name="l00260"></a>00260   
<a name="l00261"></a>00261   low = 0;
<a name="l00262"></a>00262   high = sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>-1;
<a name="l00263"></a>00263   <span class="keywordflow">while</span>(low &lt;= high){
<a name="l00264"></a>00264     mid = (low+high)/2;
<a name="l00265"></a>00265     <span class="comment">//      printf("low %d high %d mid %d\n",low,high,mid);</span>
<a name="l00266"></a>00266     <span class="keywordflow">if</span> ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID == i){
<a name="l00267"></a>00267       *fi = sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid];
<a name="l00268"></a>00268       <span class="comment">//shuffle everything down</span>
<a name="l00269"></a>00269       memmove((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>)+mid,(sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>)+mid+1,
<a name="l00270"></a>00270            (sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>-mid)*<span class="keyword">sizeof</span>(<a class="code" href="struct__faceinfo.html">_FC_FACEINFO</a>*));
<a name="l00271"></a>00271       sfi-&gt;<a class="code" href="struct__sfi__array.html#75300029541e2df427124dfa5f0138ee">numVals</a>--;
<a name="l00272"></a>00272       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00273"></a>00273     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((sfi-&gt;<a class="code" href="struct__sfi__array.html#964fa6dbf3102db9b38a39f962fdad23">vals</a>[mid])-&gt;faceID &lt; i){
<a name="l00274"></a>00274       low = mid+1;
<a name="l00275"></a>00275     } <span class="keywordflow">else</span>{
<a name="l00276"></a>00276       high = mid -1;
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278   }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00281"></a>00281 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:22 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
