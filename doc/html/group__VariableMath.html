<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>FCLib: Variable Math</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>Variable Math<br>
<small>
[<a class="el" href="group__API.html">FCLib API</a>]</small>
</h1>
<p>
Collaboration diagram for Variable Math:<hr><a name="_details"></a><h2>Detailed Description</h2>
Mathematic operations on and between variables. 
<p>
<b>Description:</b> <p>
This module provides three sets of functions for doing mathematic operations on and between variables. In general, these functions always create new variables which contain the desired result. There are versions for normal variables and analogous versions for sequence variables.<p>
<b>1) Built-in operators</b><p>
The first group of functions, e.g. <a class="el" href="group__VariableMath.html#g4b95801eace5c69732676a8e5d636b13">fc_operatorVar()</a> and <a class="el" href="group__VariableMath.html#g4bc1d027d0c58095361d5b4389a4739c">fc_varOperatorVar()</a>, can be used to do built-in operations like '+' and '*'. Like built-in operations, they preserve or promote type as necessary with the major expectation that the resultants are only ever int or double.<p>
The FCLib function name indicates the type of variables to which the operator is applied (e.g., Var, SeqVar) and their order relative to the operator: i.e., <a class="el" href="group__VariableMath.html#gd4a4af630d980cea143a0edbc4496f99">fc_seqVarOperatorVar()</a> can be used to take a seqvar and add a regular var to each of its values at each of its sequence steps. Thie mimics an operator's usage: arg1 op arg2. Currently all functions in this group that take a seqvar as at least of the arguments return a seqvar; all others return a var.<p>
<b>2) User supplied functions</b><p>
The second group of functions, e.g. <a class="el" href="group__VariableMath.html#g84b3f6963472cbe8c79fe1d6c1c39640">fc_varUnaryFunction()</a> and <a class="el" href="group__VariableMath.html#g7a7fd46e48d01ee29209c49268982f89">fc_varBinaryFunctionVarVar()</a>, allow the user to pass in a function that does the desired operation. The following example produces a new variables whose values are the square root of the values of the original variable ('sqrt' is a standard C math function):<p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__VariableMath.html#g84b3f6963472cbe8c79fe1d6c1c39640">fc_varUnaryFunction</a>(var, sqrt, <span class="stringliteral">"sqrt"</span>, &amp;newVar);
</pre></div><p>
The FCLib function name indicates the type of variables (e.g., Var, SeqVar) to which the user's function is applied, their order as arguments to the function, and the return var type. i.e., <a class="el" href="group__VariableMath.html#gfe3766448bf4f55c6057a9e312be113a">fc_seqVarBinaryFunctionSeqVarVar()</a> can be used to take a seqvar and, with a user supplied function to do an add, add a regular var to it each of its values at each of its sequence steps and the return value is a seqvar. This mimics a function's declaration: returntype functionname(arg1,arg2).<p>
<b>(1 &amp; 2 Aside: Binary operations with a "constant")</b><p>
There are additional versions of the binary versions of these first type sets of functions that allow operations between a variable and a 'constant'. That is, a single (but can be multi-component) data point can be applied to all data points of the variable. For example, the following scales a 3D vector by a factor of two:<p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">int</span> scale[3] = { 2, 2, 2 };
 <a class="code" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst</a>(vectorVar, <span class="charliteral">'*'</span>, 3, scale, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <span class="stringliteral">"scaled vector"</span>, &amp;newVar);
</pre></div><p>
<b>3) Other</b><p>
The final set of functions provide operations that don't fit into the previous twos. Mostly these are functions that treat the different components of multicomponent variables differently.<p>
<b>Modifications:</b> <ul>
<li>2003-JUN-23 W. Koegler Created.</li><li>02/02/04 RM, Redone, new implementation, added unary operators and general functions for unary and binary operations.</li><li>02/23/04 RM, Added <a class="el" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst()</a></li><li>02/26/04 RM, Added user operator functions and examples for them, and functions for more advanced users</li><li>03/04/04 RM, Added examples of unary and binary user functions.</li><li>11/10/04 WSK, reorg &amp; rename. Also removed 'more sophisticated' unary &amp; binary functions as they were too general purpose. (Might as well just write an entire new function.)</li><li>6/03/05 ACG, adding analgous functions but for seqvar </li></ul>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateVariableMath.html">(Private)</a></td></tr>

<tr><td colspan="2"><br><h2>Built in operators on variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g4b95801eace5c69732676a8e5d636b13">fc_operatorVar</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, char *operation, char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in unary operations on a variable.  <a href="#g4b95801eace5c69732676a8e5d636b13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g4bc1d027d0c58095361d5b4389a4739c">fc_varOperatorVar</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var1, char *operation, <a class="el" href="structFC__Variable.html">FC_Variable</a> var2, char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on two variables.  <a href="#g4bc1d027d0c58095361d5b4389a4739c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, char *operation, int constNumComp, void *constVector, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a variable and a constant.  <a href="#gd8da3c1657c0158566a30a848f76ae59"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g42db54669d16d0ce55edd29aa73e4719">fc_constOperatorVar</a> (int constNumComp, void *constVector, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, char *operation, <a class="el" href="structFC__Variable.html">FC_Variable</a> var, char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a constant and a variable.  <a href="#g42db54669d16d0ce55edd29aa73e4719"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Built-in operators on sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gfc8c9867f92687d20e29694f15d459ac">fc_operatorSeqVar</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var, char *operation, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in unary operations on a sequence variable.  <a href="#gfc8c9867f92687d20e29694f15d459ac"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g2d2ca15323837c8b87f4eba089e5153a">fc_seqVarOperatorSeqVar</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var1, char *operation, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var2, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on two seq variables.  <a href="#g2d2ca15323837c8b87f4eba089e5153a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gd81ceef16fe52226fc581552a133ea31">fc_seqVarOperatorSeqConst</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var1, char *operation, int constNumComp, void *constVectors, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a seq variable a seq of constants.  <a href="#gd81ceef16fe52226fc581552a133ea31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gef3e37a79067c13d21fc25264ff145e4">fc_seqConstOperatorSeqVar</a> (int numStep, int constNumComp, void *constVectors, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, char *operation, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var2, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a seq variable a seq of constants.  <a href="#gef3e37a79067c13d21fc25264ff145e4"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Built-in operators between variables and sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gd4a4af630d980cea143a0edbc4496f99">fc_seqVarOperatorVar</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var1, char *operation, <a class="el" href="structFC__Variable.html">FC_Variable</a> var2, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a seq variable and a normal var.  <a href="#gd4a4af630d980cea143a0edbc4496f99"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g8c5c39c5bc7018e3d99b7c8c3590e645">fc_varOperatorSeqVar</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var1, char *operation, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var2, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a seq variable and a normal var.  <a href="#g8c5c39c5bc7018e3d99b7c8c3590e645"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gace4d175be16d1182c4b9131fb4abc74">fc_seqVarOperatorConst</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var1, char *operation, int constNumComp, void *constVector, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a seq variable and constant.  <a href="#gace4d175be16d1182c4b9131fb4abc74"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g4d3a1daac4eee6b72617a0c3a2013883">fc_constOperatorSeqVar</a> (int constNumComp, void *constVector, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, char *operation, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var2, char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs built-in binary operation on a seq variable and constant.  <a href="#g4d3a1daac4eee6b72617a0c3a2013883"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User supplied functions on variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g84b3f6963472cbe8c79fe1d6c1c39640">fc_varUnaryFunction</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, double(*unaryFunction)(double), char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs unary function on a variable.  <a href="#g84b3f6963472cbe8c79fe1d6c1c39640"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g7a7fd46e48d01ee29209c49268982f89">fc_varBinaryFunctionVarVar</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var1, <a class="el" href="structFC__Variable.html">FC_Variable</a> var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on two variables.  <a href="#g7a7fd46e48d01ee29209c49268982f89"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gc734bc45c302fc3bee946dc5c938088f">fc_varBinaryFunctionVarConst</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, int constNumComp, double *constValues, double(*binaryFunction)(double, double), char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a variable and a constant.  <a href="#gc734bc45c302fc3bee946dc5c938088f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gff2ccc7579022d86a34fcbc204f59cb1">fc_varBinaryFunctionConstVar</a> (int constNumComp, double *constValues, <a class="el" href="structFC__Variable.html">FC_Variable</a> var, double(*binaryFunction)(double, double), char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a constant and a variable.  <a href="#gff2ccc7579022d86a34fcbc204f59cb1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User functions on sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gfa62b9975a3e0437aa8c8f98a146f2de">fc_seqVarUnaryFunction</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var, double(*unaryFunction)(double), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs unary function on a seq variable.  <a href="#gfa62b9975a3e0437aa8c8f98a146f2de"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g0ebb6d6f7f185c1e6fd219f52b6c184e">fc_seqVarBinaryFunctionSeqVarSeqVar</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var1, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on two seq variables.  <a href="#g0ebb6d6f7f185c1e6fd219f52b6c184e"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User functions on sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g2b769d43b8ef47db4e03d9791de09586">fc_seqVarBinaryFunctionSeqVarSeqConst</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var, int constNumComp, void *constVectors, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a seqVar and seqConstant.  <a href="#g2b769d43b8ef47db4e03d9791de09586"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User functions on sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g88f211e45e38fb4b51c2a8e774ccbe4c">fc_seqVarBinaryFunctionSeqConstSeqVar</a> (int numStep, int constNumComp, void *constVectors, <a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> constType, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a seqConst and a seqVar.  <a href="#g88f211e45e38fb4b51c2a8e774ccbe4c"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User functions on sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g52ec8e4997f8ac579953ac2f4ef152e1">fc_seqVarBinaryFunctionSeqVarConst</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var, int constNumComp, double *constValues, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a seqVar and a constant.  <a href="#g52ec8e4997f8ac579953ac2f4ef152e1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User functions on sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g07749e6607db4793502605412805b450">fc_seqVarBinaryFunctionConstSeqVar</a> (int constNumComp, double *constValues, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a constant and a seqVar.  <a href="#g07749e6607db4793502605412805b450"></a><br></td></tr>
<tr><td colspan="2"><br><h2>User functions between variables and sequence variables.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gfe3766448bf4f55c6057a9e312be113a">fc_seqVarBinaryFunctionSeqVarVar</a> (int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var1, <a class="el" href="structFC__Variable.html">FC_Variable</a> var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a seq variable and a var.  <a href="#gfe3766448bf4f55c6057a9e312be113a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g58ae973cb45e1ee09db60b2697a64197">fc_seqVarBinaryFunctionVarSeqVar</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var1, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *seq_var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> **new_seq_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs binary function on a seq variable and a var.  <a href="#g58ae973cb45e1ee09db60b2697a64197"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Component aware manipulations.</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g0023166ac4a038928131d6e0f2f54ef3">fc_createMagnitudeVariable</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> var, char *new_var_name, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a new variable which is the magnitude of the current variable.  <a href="#g0023166ac4a038928131d6e0f2f54ef3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#gc04baa7b64532f959c1d8c224959dd65">fc_createNormalTangentVariables</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> inputVector, int dim_ref, double *referenceVector, <a class="el" href="structFC__Variable.html">FC_Variable</a> *normalComponent, <a class="el" href="structFC__Variable.html">FC_Variable</a> *tangentComponent)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decompose a vector into normal and tangent components respective to a reference vector.  <a href="#gc04baa7b64532f959c1d8c224959dd65"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g6b7fd07f05be873eee13d4c16a74e76b">fc_createNormalTangentVariables2</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> inputVector, <a class="el" href="structFC__Variable.html">FC_Variable</a> referenceVector, <a class="el" href="structFC__Variable.html">FC_Variable</a> *normalComponent, <a class="el" href="structFC__Variable.html">FC_Variable</a> *tangentComponent)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decompose a vector into normal and tangent components respective to a reference vector.  <a href="#g6b7fd07f05be873eee13d4c16a74e76b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__VariableMath.html#g1587178edc4e731f8010076424a04312">fc_createStressPressureVariables</a> (<a class="el" href="structFC__Variable.html">FC_Variable</a> *sigmaVars, <a class="el" href="structFC__Variable.html">FC_Variable</a> *stressVar, <a class="el" href="structFC__Variable.html">FC_Variable</a> *pressureVar)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute Von Mises stress and pressure from the stress matrix.  <a href="#g1587178edc4e731f8010076424a04312"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g4d3a1daac4eee6b72617a0c3a2013883"></a><!-- doxytag: member="varmath.c::fc_constOperatorSeqVar" ref="g4d3a1daac4eee6b72617a0c3a2013883" args="(int constNumComp, void *constVector, FC_DataType constType, char *operation, int numStep, FC_Variable *seq_var2, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_constOperatorSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a seq variable and constant. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation between a given seq variable and a constant applied at each sequence step.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; const + var </code></li><li><code> "-" =&gt; const - var </code></li><li><code> "*" =&gt; const * var </code></li><li><code> "/" =&gt; const / var </code></li></ul>
<p>
The seq variable and the constant must have the same number of components.<p>
The seq new variable will be on the same mesh and sequence and will have the same association and mathtype as the seq variable. The operation is performed per component at each sequence step.<p>
If both original variables have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>11/20/2006 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constVector </td></tr>
<tr><td valign="top"><em>constVector</em>&nbsp;</td><td>
input - constant vector </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var2</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01394">1394</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="varmath_8c-source.html#l00566">fc_constOperatorVar()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l01403"></a>01403   {   
<a name="l01404"></a>01404   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01405"></a>01405   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l01406"></a>01406   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l01407"></a>01407   <span class="keywordtype">int</span> i, j;
<a name="l01408"></a>01408 
<a name="l01409"></a>01409   <span class="comment">// default return</span>
<a name="l01410"></a>01410   <span class="keywordflow">if</span> (new_seq_var)
<a name="l01411"></a>01411     *new_seq_var = NULL;
<a name="l01412"></a>01412 
<a name="l01413"></a>01413   <span class="comment">// check input</span>
<a name="l01414"></a>01414   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var2)) || !operation ||
<a name="l01415"></a>01415       constNumComp &lt; 1 || !constVector || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType) ||
<a name="l01416"></a>01416       constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> ||
<a name="l01417"></a>01417       (new_seq_var == NULL) || new_seq_var_name == NULL) {
<a name="l01418"></a>01418     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01419"></a>01419     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01420"></a>01420   }
<a name="l01421"></a>01421   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l01422"></a>01422 
<a name="l01423"></a>01423   <span class="comment">// log message</span>
<a name="l01424"></a>01424   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation '%s' on seq variable '%s'"</span>,
<a name="l01425"></a>01425                       operation, 
<a name="l01426"></a>01426                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var2[0])-&gt;header.name);
<a name="l01427"></a>01427 
<a name="l01428"></a>01428   <span class="comment">// Get info</span>
<a name="l01429"></a>01429   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var2, &amp;seq);
<a name="l01430"></a>01430   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01431"></a>01431     <span class="keywordflow">return</span> rc;
<a name="l01432"></a>01432 
<a name="l01433"></a>01433   <span class="comment">// Make space to save temp_vars</span>
<a name="l01434"></a>01434   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l01435"></a>01435   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l01436"></a>01436     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01437"></a>01437     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01438"></a>01438   }
<a name="l01439"></a>01439 
<a name="l01440"></a>01440   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l01441"></a>01441   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01442"></a>01442     rc = <a class="code" href="group__VariableMath.html#g42db54669d16d0ce55edd29aa73e4719">fc_constOperatorVar</a>(constNumComp, constVector, constType, operation, 
<a name="l01443"></a>01443                              seq_var2[i], <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l01444"></a>01444     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l01445"></a>01445       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l01446"></a>01446      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l01447"></a>01447       free(temp_vars);
<a name="l01448"></a>01448       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l01449"></a>01449       <span class="keywordflow">return</span> rc;
<a name="l01450"></a>01450     }
<a name="l01451"></a>01451   }
<a name="l01452"></a>01452 
<a name="l01453"></a>01453   <span class="comment">// stitch steps into the new seq var</span>
<a name="l01454"></a>01454   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l01455"></a>01455                                         new_seq_var_name, new_seq_var);
<a name="l01456"></a>01456   free(temp_vars);
<a name="l01457"></a>01457   <span class="keywordflow">return</span> rc;
<a name="l01458"></a>01458 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g42db54669d16d0ce55edd29aa73e4719"></a><!-- doxytag: member="varmath.c::fc_constOperatorVar" ref="g42db54669d16d0ce55edd29aa73e4719" args="(int constNumComp, void *constVector, FC_DataType constType, char *operation, FC_Variable var, char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_constOperatorVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a constant and a variable. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new variable with the result of that operation performed with the constant on each data point of the variable. Use <a class="el" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst()</a> to apply operation in reverse order.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; const + var </code></li><li><code> "-" =&gt; const - var </code></li><li><code> "*" =&gt; const * var </code></li><li><code> "/" =&gt; const / var </code></li></ul>
<p>
The variables and the constant must have the same number of components.<p>
The new variable will be on the same mesh and have the same association and mathtype as the variable. The operation is performed per component and data point.<p>
If both the variable and the constant have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>11/09/03 WSK, created to complement fc_varOperatorConst. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constVector </td></tr>
<tr><td valign="top"><em>constVector</em>&nbsp;</td><td>
input - constant vector </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - FCLib variable </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00566">566</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="varmath_8c-source.html#l03344">_fc_binaryOperatorCore()</a>, <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l01394">fc_constOperatorSeqVar()</a>, and <a class="el" href="varmath_8c-source.html#l00979">fc_seqConstOperatorSeqVar()</a>.<div class="fragment"><pre class="fragment"><a name="l00574"></a>00574   {
<a name="l00575"></a>00575   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00576"></a>00576   <span class="keywordtype">int</span> numComp, numData;
<a name="l00577"></a>00577   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l00578"></a>00578   <span class="keywordtype">void</span> *data; 
<a name="l00579"></a>00579    
<a name="l00580"></a>00580   <span class="comment">// set default return value</span>
<a name="l00581"></a>00581   <span class="keywordflow">if</span> (new_var)
<a name="l00582"></a>00582     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l00583"></a>00583     
<a name="l00584"></a>00584   <span class="comment">// check input</span>
<a name="l00585"></a>00585   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var)) || !operation || constNumComp &lt; 1 ||
<a name="l00586"></a>00586       !constVector || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType) || 
<a name="l00587"></a>00587       constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || !new_var_name  || !new_var) {
<a name="l00588"></a>00588     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l00589"></a>00589     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592   <span class="comment">// log message</span>
<a name="l00593"></a>00593   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation (var %s const), with var '%s'"</span>,
<a name="l00594"></a>00594                 operation, <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var)-&gt;header.name);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596   <span class="comment">// get variable info</span>
<a name="l00597"></a>00597   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;numComp, NULL, NULL, &amp;datatype);
<a name="l00598"></a>00598   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00599"></a>00599     <span class="keywordflow">return</span> rc;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601   <span class="comment">// check that const is similar enough</span>
<a name="l00602"></a>00602   <span class="keywordflow">if</span> (numComp != constNumComp) {
<a name="l00603"></a>00603     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"constant need sot have same number of components "</span>
<a name="l00604"></a>00604                  <span class="stringliteral">"as var"</span>);
<a name="l00605"></a>00605     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00606"></a>00606   }
<a name="l00607"></a>00607 
<a name="l00608"></a>00608   <span class="comment">// get data</span>
<a name="l00609"></a>00609   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l00610"></a>00610   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00611"></a>00611     <span class="keywordflow">return</span> rc;
<a name="l00612"></a>00612  
<a name="l00613"></a>00613   <span class="keywordflow">return</span> <a class="code" href="group__PrivateVariableMath.html#gd1a184efa1c82323a2013eae8e410d8f">_fc_binaryOperatorCore</a>(numComp, 1, constVector, constType, operation,
<a name="l00614"></a>00614                     numData, data, datatype,
<a name="l00615"></a>00615                     var, new_var_name, new_var);
<a name="l00616"></a>00616 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g0023166ac4a038928131d6e0f2f54ef3"></a><!-- doxytag: member="varmath.c::fc_createMagnitudeVariable" ref="g0023166ac4a038928131d6e0f2f54ef3" args="(FC_Variable var, char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createMagnitudeVariable           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a new variable which is the magnitude of the current variable. 
<p>
<b>Description:</b> <p>
Given a vector variable, this routine will create a new variable whose values are the magnitudes of the vector variable. Magnitudes are calculated as the distance from the origin to the point. This routine only works for vector variables with more than 1 components.<p>
<b>Modifications:</b> <ul>
<li>05/03/04 WSK, Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - a variable with vector data </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new magnitude of the variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l03533">3533</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="loadHistory_8c-source.html#l00064">main()</a>.<div class="fragment"><pre class="fragment"><a name="l03537"></a>03537   {
<a name="l03538"></a>03538         
<a name="l03539"></a>03539   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03540"></a>03540   <span class="keywordtype">int</span> i, j;
<a name="l03541"></a>03541   <span class="keywordtype">int</span> numData, dim;
<a name="l03542"></a>03542   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03543"></a>03543   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l03544"></a>03544   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype;
<a name="l03545"></a>03545   <span class="keywordtype">void</span> *data;
<a name="l03546"></a>03546   <span class="keywordtype">double</span> *new_data;
<a name="l03547"></a>03547 
<a name="l03548"></a>03548   <span class="comment">// set default return value</span>
<a name="l03549"></a>03549   <span class="keywordflow">if</span> (new_var)
<a name="l03550"></a>03550     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03551"></a>03551 
<a name="l03552"></a>03552   <span class="comment">// check input</span>
<a name="l03553"></a>03553   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var) || !new_var_name || !new_var) {
<a name="l03554"></a>03554     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l03555"></a>03555     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03556"></a>03556   }
<a name="l03557"></a>03557 
<a name="l03558"></a>03558   <span class="comment">// get variable info</span>
<a name="l03559"></a>03559   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;dim, &amp;assoc, &amp;mathtype, &amp;datatype);
<a name="l03560"></a>03560   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03561"></a>03561     <span class="keywordflow">return</span> rc;
<a name="l03562"></a>03562   <span class="comment">// check the datatype that can be handled here</span>
<a name="l03563"></a>03563   <span class="comment">// the datatype can be only FC_DT_INT or FC_DT_FLOAT or FC_DT_DOUBLE</span>
<a name="l03564"></a>03564   <span class="keywordflow">if</span> (dim &lt; 2 || mathtype != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a> || 
<a name="l03565"></a>03565       !(datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> || datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> || datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>)) {
<a name="l03566"></a>03566     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Input Error: not a vector or bad datatype"</span>);
<a name="l03567"></a>03567     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03568"></a>03568   }  
<a name="l03569"></a>03569 
<a name="l03570"></a>03570   <span class="comment">// log message</span>
<a name="l03571"></a>03571   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Creating new magnitude variable."</span>);
<a name="l03572"></a>03572 
<a name="l03573"></a>03573   <span class="comment">// get data</span>
<a name="l03574"></a>03574   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l03575"></a>03575   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03576"></a>03576     <span class="keywordflow">return</span> rc; 
<a name="l03577"></a>03577 
<a name="l03578"></a>03578   <span class="comment">// create the new data</span>
<a name="l03579"></a>03579   new_data = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData);
<a name="l03580"></a>03580   <span class="keywordflow">if</span> (new_data == NULL) {
<a name="l03581"></a>03581     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03582"></a>03582     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03583"></a>03583   }
<a name="l03584"></a>03584   <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++) {
<a name="l03585"></a>03585     new_data[i] = 0;
<a name="l03586"></a>03586     <span class="keywordflow">for</span> (j = 0; j &lt; dim; j++) {
<a name="l03587"></a>03587       <span class="keywordflow">switch</span>(datatype) {
<a name="l03588"></a>03588       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l03589"></a>03589      new_data[i] += ((<span class="keywordtype">int</span>*)data)[i*dim+j] * ((<span class="keywordtype">int</span>*)data)[i*dim+j];
<a name="l03590"></a>03590      <span class="keywordflow">break</span>;
<a name="l03591"></a>03591       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l03592"></a>03592      new_data[i] += ((<span class="keywordtype">float</span>*)data)[i*dim+j] * ((<span class="keywordtype">float</span>*)data)[i*dim+j];
<a name="l03593"></a>03593      <span class="keywordflow">break</span>;
<a name="l03594"></a>03594       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l03595"></a>03595      new_data[i] += ((<span class="keywordtype">double</span>*)data)[i*dim+j] * ((<span class="keywordtype">double</span>*)data)[i*dim+j];
<a name="l03596"></a>03596      <span class="keywordflow">break</span>;
<a name="l03597"></a>03597       <span class="keywordflow">default</span>:
<a name="l03598"></a>03598      ; <span class="comment">// nothing</span>
<a name="l03599"></a>03599       }
<a name="l03600"></a>03600     }
<a name="l03601"></a>03601     new_data[i] = sqrt(new_data[i]);
<a name="l03602"></a>03602   }
<a name="l03603"></a>03603 
<a name="l03604"></a>03604   <span class="comment">// create the new variable</span>
<a name="l03605"></a>03605   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var)) {
<a name="l03606"></a>03606     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l03607"></a>03607     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(var, &amp;dataset);
<a name="l03608"></a>03608     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03609"></a>03609       <span class="keywordflow">return</span> rc;
<a name="l03610"></a>03610     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, new_var_name, new_var);
<a name="l03611"></a>03611     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03612"></a>03612       <span class="keywordflow">return</span> rc; 
<a name="l03613"></a>03613   }
<a name="l03614"></a>03614   <span class="keywordflow">else</span> {
<a name="l03615"></a>03615     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l03616"></a>03616     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(var, &amp;mesh);
<a name="l03617"></a>03617     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03618"></a>03618       <span class="keywordflow">return</span> rc;
<a name="l03619"></a>03619     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, new_var_name, new_var);
<a name="l03620"></a>03620     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03621"></a>03621       <span class="keywordflow">return</span> rc; 
<a name="l03622"></a>03622   }
<a name="l03623"></a>03623  
<a name="l03624"></a>03624   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numData, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03625"></a>03625                     <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, (<span class="keywordtype">void</span>*)new_data);
<a name="l03626"></a>03626   <span class="comment">// do not free new_data </span>
<a name="l03627"></a>03627        
<a name="l03628"></a>03628   <span class="keywordflow">return</span> rc;    
<a name="l03629"></a>03629 }       
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gc04baa7b64532f959c1d8c224959dd65"></a><!-- doxytag: member="varmath.c::fc_createNormalTangentVariables" ref="gc04baa7b64532f959c1d8c224959dd65" args="(FC_Variable inputVector, int dim_ref, double *referenceVector, FC_Variable *normalComponent, FC_Variable *tangentComponent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createNormalTangentVariables           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>inputVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dim_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>referenceVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>normalComponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>tangentComponent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Decompose a vector into normal and tangent components respective to a reference vector. 
<p>
<b>Description:</b> <p>
Most common usage will be to decompose a force on a surface into a component in the direction of the surface normal, and a component tangential to the surface.<p>
Note, an infinite number of vectors are tangent to the reference vector. The calculated tangential component will be in the plane defined by the input vector and the reference vector. (Perhaps we should also calculate and return this?)<p>
Note that the dimensions of the input and reference vector do not have to be equal. The extra dimensions are assumed to have component values of zero. (In fact, one of the vectors could be a scalar. This would correspond to a vector aligned with the X axis).<p>
<b>Modifications:</b> <ul>
<li>2003-MAY-15 W Koegler Created.</li><li>2003-SEP-05 W Koegler Moved core of decompose algorithm to its own function _fc_decomposeVector to better share w/ others functions.</li><li>11/01/04 WSK Moved from geom to varmath </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>inputVector</em>&nbsp;</td><td>
input - vector variable to decompose </td></tr>
<tr><td valign="top"><em>dim_ref</em>&nbsp;</td><td>
input - the number of components in reference vector </td></tr>
<tr><td valign="top"><em>referenceVector</em>&nbsp;</td><td>
input - the components of the reference vector </td></tr>
<tr><td valign="top"><em>normalComponent</em>&nbsp;</td><td>
output - new variable with normal components </td></tr>
<tr><td valign="top"><em>tangentComponent</em>&nbsp;</td><td>
output - new variable with tangent components </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l03658">3658</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="varmath_8c-source.html#l04235">_fc_decomposeVector()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="variable_8c-source.html#l04152">fc_getVariableName()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03664"></a>03664   {
<a name="l03665"></a>03665   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03666"></a>03666   <span class="keywordtype">int</span> i, j;
<a name="l03667"></a>03667   <span class="keywordtype">int</span> numData; <span class="comment">// number of data points</span>
<a name="l03668"></a>03668   <span class="keywordtype">int</span> dim_in; <span class="comment">// number of components per point</span>
<a name="l03669"></a>03669   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03670"></a>03670   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l03671"></a>03671   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype;
<a name="l03672"></a>03672   <span class="keywordtype">double</span> magnitude;
<a name="l03673"></a>03673   <span class="keywordtype">double</span> *normRefVect = NULL;
<a name="l03674"></a>03674   <span class="keywordtype">double</span> *normals = NULL, *tangents = NULL;
<a name="l03675"></a>03675   <span class="keywordtype">void</span> *datap = NULL;
<a name="l03676"></a>03676   <span class="keywordtype">char</span> *vname = NULL;
<a name="l03677"></a>03677   <span class="keywordtype">char</span> *tempstring1 = NULL, *tempstring2 = NULL;
<a name="l03678"></a>03678   
<a name="l03679"></a>03679   <span class="comment">// set default return values</span>
<a name="l03680"></a>03680   <span class="keywordflow">if</span> (normalComponent)
<a name="l03681"></a>03681     *normalComponent = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03682"></a>03682   <span class="keywordflow">if</span> (tangentComponent)
<a name="l03683"></a>03683     *tangentComponent = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03684"></a>03684   
<a name="l03685"></a>03685   <span class="comment">// check input</span>
<a name="l03686"></a>03686   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(inputVector) || dim_ref &lt; 1 || !referenceVector ||
<a name="l03687"></a>03687       !normalComponent || !tangentComponent)  {
<a name="l03688"></a>03688     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03689"></a>03689     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03690"></a>03690   }
<a name="l03691"></a>03691   
<a name="l03692"></a>03692   <span class="comment">// log message</span>
<a name="l03693"></a>03693   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Decomposing a vector into normal and tangent "</span>
<a name="l03694"></a>03694                       <span class="stringliteral">"components."</span>);   
<a name="l03695"></a>03695   
<a name="l03696"></a>03696   <span class="comment">// get info about inputVector</span>
<a name="l03697"></a>03697   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(inputVector, &amp;numData, &amp;dim_in, &amp;assoc,  
<a name="l03698"></a>03698                           &amp;mathtype, &amp;datatype);
<a name="l03699"></a>03699   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03700"></a>03700     <span class="keywordflow">return</span> rc;
<a name="l03701"></a>03701   <span class="keywordflow">if</span> (mathtype != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a> &amp;&amp; mathtype != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>)
<a name="l03702"></a>03702     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>; <span class="comment">// can't handle tensor</span>
<a name="l03703"></a>03703   
<a name="l03704"></a>03704   <span class="comment">// get input vector data</span>
<a name="l03705"></a>03705   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(inputVector, &amp;datap);
<a name="l03706"></a>03706   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03707"></a>03707     <span class="keywordflow">return</span> rc;
<a name="l03708"></a>03708   
<a name="l03709"></a>03709   <span class="comment">// calculate magnitude of reference vector</span>
<a name="l03710"></a>03710   magnitude = 0;
<a name="l03711"></a>03711   <span class="keywordflow">for</span> (i = 0; i &lt; dim_ref; i++)
<a name="l03712"></a>03712     magnitude += referenceVector[i]*referenceVector[i];
<a name="l03713"></a>03713   magnitude = sqrt(magnitude);
<a name="l03714"></a>03714   <span class="comment">// FIX!</span>
<a name="l03715"></a>03715   <span class="keywordflow">if</span> (magnitude &lt;= 0)
<a name="l03716"></a>03716     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>; 
<a name="l03717"></a>03717   
<a name="l03718"></a>03718   <span class="comment">// make normalized reference vector</span>
<a name="l03719"></a>03719   normRefVect = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*dim_ref);
<a name="l03720"></a>03720   <span class="keywordflow">if</span> (normRefVect == NULL ) {
<a name="l03721"></a>03721     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03722"></a>03722     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03723"></a>03723   } 
<a name="l03724"></a>03724   <span class="keywordflow">if</span> (magnitude &gt; 0) {
<a name="l03725"></a>03725     <span class="keywordflow">for</span> (i = 0; i &lt; dim_ref; i++)
<a name="l03726"></a>03726       normRefVect[i] = referenceVector[i]/magnitude;
<a name="l03727"></a>03727   }
<a name="l03728"></a>03728   
<a name="l03729"></a>03729   <span class="comment">// make space for temporary normal and tangent component arrays</span>
<a name="l03730"></a>03730   normals = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData);
<a name="l03731"></a>03731   tangents = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData);
<a name="l03732"></a>03732   <span class="keywordflow">if</span> (normals == NULL || tangents == NULL) {
<a name="l03733"></a>03733     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03734"></a>03734     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03735"></a>03735   } 
<a name="l03736"></a>03736   
<a name="l03737"></a>03737   <span class="keywordflow">switch</span> (datatype) {
<a name="l03738"></a>03738   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l03739"></a>03739     {
<a name="l03740"></a>03740       <span class="keywordtype">int</span> *castp = (<span class="keywordtype">int</span>*)datap;
<a name="l03741"></a>03741       <span class="keywordtype">double</span> temp[dim_in];
<a name="l03742"></a>03742       <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++) {
<a name="l03743"></a>03743         <span class="keywordflow">for</span> (j = 0; j &lt; dim_in; j++)
<a name="l03744"></a>03744           temp[j] = castp[i*dim_in + j];
<a name="l03745"></a>03745         <a class="code" href="group__PrivateVariableMath.html#g7db7a2e7fc87f59815ae7a87ad24975d">_fc_decomposeVector</a>(dim_in, temp, dim_ref, normRefVect, &amp;normals[i],
<a name="l03746"></a>03746                             &amp;tangents[i]);
<a name="l03747"></a>03747       }
<a name="l03748"></a>03748     } 
<a name="l03749"></a>03749     <span class="keywordflow">break</span>;
<a name="l03750"></a>03750   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>: 
<a name="l03751"></a>03751     {
<a name="l03752"></a>03752       <span class="keywordtype">float</span> *castp = (<span class="keywordtype">float</span>*)datap;
<a name="l03753"></a>03753       <span class="keywordtype">double</span> temp[dim_in];
<a name="l03754"></a>03754       <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++) {
<a name="l03755"></a>03755         <span class="keywordflow">for</span> (j = 0; j &lt; dim_in; j++)
<a name="l03756"></a>03756           temp[j] = castp[i*dim_in + j];
<a name="l03757"></a>03757         <a class="code" href="group__PrivateVariableMath.html#g7db7a2e7fc87f59815ae7a87ad24975d">_fc_decomposeVector</a>(dim_in, temp, dim_ref, normRefVect, &amp;normals[i],
<a name="l03758"></a>03758                             &amp;tangents[i]);
<a name="l03759"></a>03759       }
<a name="l03760"></a>03760     } 
<a name="l03761"></a>03761     <span class="keywordflow">break</span>;
<a name="l03762"></a>03762   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l03763"></a>03763     {
<a name="l03764"></a>03764       <span class="keywordtype">double</span> *castp = (<span class="keywordtype">double</span>*)datap;
<a name="l03765"></a>03765       <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++) 
<a name="l03766"></a>03766         <a class="code" href="group__PrivateVariableMath.html#g7db7a2e7fc87f59815ae7a87ad24975d">_fc_decomposeVector</a>(dim_in, &amp;castp[i*dim_in], dim_ref,
<a name="l03767"></a>03767                             normRefVect, &amp;normals[i], &amp;tangents[i]);
<a name="l03768"></a>03768     } 
<a name="l03769"></a>03769     <span class="keywordflow">break</span>;
<a name="l03770"></a>03770   <span class="keywordflow">default</span>:
<a name="l03771"></a>03771     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03772"></a>03772   }
<a name="l03773"></a>03773   free(normRefVect);
<a name="l03774"></a>03774   
<a name="l03775"></a>03775   <span class="comment">// add new variables to current mesh/dataset</span>
<a name="l03776"></a>03776   rc = <a class="code" href="group__Variable.html#g3ec29251d717c5d0ca4ecfd9824f67b1">fc_getVariableName</a>(inputVector, &amp;vname);
<a name="l03777"></a>03777   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03778"></a>03778     <span class="keywordflow">return</span> rc;
<a name="l03779"></a>03779   tempstring1 = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*(strlen(vname) + 55));
<a name="l03780"></a>03780   tempstring2 = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*(strlen(vname) + 55));
<a name="l03781"></a>03781   <span class="keywordflow">if</span> (tempstring1 == NULL || tempstring2 == NULL) {
<a name="l03782"></a>03782     free(tempstring1);
<a name="l03783"></a>03783     free(tempstring2);
<a name="l03784"></a>03784     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03785"></a>03785     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03786"></a>03786   } 
<a name="l03787"></a>03787   sprintf(tempstring1, <span class="stringliteral">"%s Normal Component decomposed on a reference vector"</span>,
<a name="l03788"></a>03788           vname);
<a name="l03789"></a>03789   sprintf(tempstring2, <span class="stringliteral">"%s Tangent Component decomposed on a reference vector"</span>,
<a name="l03790"></a>03790           vname);
<a name="l03791"></a>03791   free(vname);
<a name="l03792"></a>03792   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(inputVector)) {
<a name="l03793"></a>03793     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l03794"></a>03794     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(inputVector, &amp;dataset);
<a name="l03795"></a>03795     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03796"></a>03796       <span class="keywordflow">return</span> rc;
<a name="l03797"></a>03797     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, tempstring1, normalComponent);
<a name="l03798"></a>03798     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03799"></a>03799       <span class="keywordflow">return</span> rc;
<a name="l03800"></a>03800     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, tempstring2, tangentComponent);
<a name="l03801"></a>03801     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03802"></a>03802       <span class="keywordflow">return</span> rc;
<a name="l03803"></a>03803   }
<a name="l03804"></a>03804   <span class="keywordflow">else</span> {
<a name="l03805"></a>03805     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l03806"></a>03806     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(inputVector, &amp;mesh);
<a name="l03807"></a>03807     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03808"></a>03808       <span class="keywordflow">return</span> rc;
<a name="l03809"></a>03809     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, tempstring1, normalComponent);
<a name="l03810"></a>03810     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03811"></a>03811       <span class="keywordflow">return</span> rc;
<a name="l03812"></a>03812     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, tempstring2, tangentComponent);
<a name="l03813"></a>03813     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03814"></a>03814       <span class="keywordflow">return</span> rc;
<a name="l03815"></a>03815   }
<a name="l03816"></a>03816   free(tempstring1);
<a name="l03817"></a>03817   free(tempstring2);
<a name="l03818"></a>03818   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*normalComponent, numData, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03819"></a>03819                              <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, normals);
<a name="l03820"></a>03820   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03821"></a>03821     <span class="keywordflow">return</span> rc;
<a name="l03822"></a>03822   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*tangentComponent, numData, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03823"></a>03823                              <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, tangents);
<a name="l03824"></a>03824   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03825"></a>03825     <span class="keywordflow">return</span> rc;
<a name="l03826"></a>03826   
<a name="l03827"></a>03827   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l03828"></a>03828 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g6b7fd07f05be873eee13d4c16a74e76b"></a><!-- doxytag: member="varmath.c::fc_createNormalTangentVariables2" ref="g6b7fd07f05be873eee13d4c16a74e76b" args="(FC_Variable inputVector, FC_Variable referenceVector, FC_Variable *normalComponent, FC_Variable *tangentComponent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createNormalTangentVariables2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>inputVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>referenceVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>normalComponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>tangentComponent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Decompose a vector into normal and tangent components respective to a reference vector. 
<p>
<b>Description:</b> <p>
See fc_createNormalTangentVariables. This function is similar except that it takes a field of reference vectors instead of a single reference vector.<p>
<b>Modifications:</b> <ul>
<li>2003-MAY-15 W Koegler Created.</li><li>2003-SEP-05 W Koegler Moved core of decompose algorithm to its own function _fc_decomposeVector to better share w/ others functions.</li><li>11/01/04 WSK Moved from geom to varmath </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>inputVector</em>&nbsp;</td><td>
input - vector variable to decompose </td></tr>
<tr><td valign="top"><em>referenceVector</em>&nbsp;</td><td>
input - variable of reference vectors </td></tr>
<tr><td valign="top"><em>normalComponent</em>&nbsp;</td><td>
output - new variable with normal components </td></tr>
<tr><td valign="top"><em>tangentComponent</em>&nbsp;</td><td>
output - new variable with tangent components </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l03847">3847</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="varmath_8c-source.html#l04235">_fc_decomposeVector()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="variable_8c-source.html#l04152">fc_getVariableName()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l03852"></a>03852   {
<a name="l03853"></a>03853   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03854"></a>03854   <span class="keywordtype">int</span> i, j;
<a name="l03855"></a>03855   <span class="keywordtype">int</span> dim_in;  <span class="comment">// number of components in input vector</span>
<a name="l03856"></a>03856   <span class="keywordtype">int</span> dim_ref; <span class="comment">// number of components in reference vector</span>
<a name="l03857"></a>03857   <span class="keywordtype">int</span> numData_in, numData_ref;
<a name="l03858"></a>03858   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc_in, assoc_ref;
<a name="l03859"></a>03859   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype_in, datatype_ref;
<a name="l03860"></a>03860   <span class="comment">//FC_DataType datatype_min;</span>
<a name="l03861"></a>03861   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype_in, mathtype_ref;
<a name="l03862"></a>03862   <span class="keywordtype">double</span> *normRefVect = NULL;
<a name="l03863"></a>03863   <span class="keywordtype">double</span> *normals = NULL, *tangents = NULL;
<a name="l03864"></a>03864   <span class="keywordtype">void</span> *data_in = NULL, *data_ref;
<a name="l03865"></a>03865   <span class="keywordtype">char</span> *name_in = NULL, *name_ref = NULL;
<a name="l03866"></a>03866   <span class="keywordtype">char</span> *tempstring1 = NULL, *tempstring2 = NULL;
<a name="l03867"></a>03867   
<a name="l03868"></a>03868   <span class="comment">// set default return values</span>
<a name="l03869"></a>03869   <span class="keywordflow">if</span> (normalComponent)
<a name="l03870"></a>03870     *normalComponent = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03871"></a>03871   <span class="keywordflow">if</span> (tangentComponent)
<a name="l03872"></a>03872     *tangentComponent = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03873"></a>03873   
<a name="l03874"></a>03874   <span class="comment">// check input</span>
<a name="l03875"></a>03875   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(inputVector) || 
<a name="l03876"></a>03876       !<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(referenceVector) || !normalComponent || 
<a name="l03877"></a>03877       !tangentComponent) {
<a name="l03878"></a>03878     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03879"></a>03879     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03880"></a>03880   }
<a name="l03881"></a>03881   
<a name="l03882"></a>03882   <span class="comment">// log message</span>
<a name="l03883"></a>03883   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Decomposing vector into a normal and tangent "</span>
<a name="l03884"></a>03884                       <span class="stringliteral">"components with respect to a reference vector."</span>);
<a name="l03885"></a>03885 
<a name="l03886"></a>03886   <span class="comment">// get info about inputVector</span>
<a name="l03887"></a>03887   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(inputVector, &amp;numData_in, &amp;dim_in, &amp;assoc_in, 
<a name="l03888"></a>03888                      &amp;mathtype_in, &amp;datatype_in);
<a name="l03889"></a>03889   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03890"></a>03890     <span class="keywordflow">return</span> rc;
<a name="l03891"></a>03891   <span class="keywordflow">if</span> (mathtype_in != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a> &amp;&amp; mathtype_in != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>) 
<a name="l03892"></a>03892     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>; <span class="comment">// can't handle tensors</span>
<a name="l03893"></a>03893   
<a name="l03894"></a>03894   <span class="comment">// get info about reference Vector</span>
<a name="l03895"></a>03895   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(referenceVector, &amp;numData_ref, &amp;dim_ref, &amp;assoc_ref, 
<a name="l03896"></a>03896                      &amp;mathtype_ref, &amp;datatype_ref);
<a name="l03897"></a>03897   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03898"></a>03898     <span class="keywordflow">return</span> rc;
<a name="l03899"></a>03899   <span class="keywordflow">if</span> (numData_in != numData_ref)
<a name="l03900"></a>03900     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>; <span class="comment">// Must have same number of data points</span>
<a name="l03901"></a>03901   <span class="keywordflow">if</span> (mathtype_ref != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a> &amp;&amp; mathtype_ref != <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>) 
<a name="l03902"></a>03902     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>; <span class="comment">// can't handle tensors</span>
<a name="l03903"></a>03903   
<a name="l03904"></a>03904   <span class="comment">// get vector data</span>
<a name="l03905"></a>03905   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(inputVector, &amp;data_in);
<a name="l03906"></a>03906   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03907"></a>03907     <span class="keywordflow">return</span> rc;
<a name="l03908"></a>03908   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(referenceVector, &amp;data_ref);
<a name="l03909"></a>03909   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03910"></a>03910     <span class="keywordflow">return</span> rc;
<a name="l03911"></a>03911   
<a name="l03912"></a>03912   <span class="comment">// normalize the reference vector</span>
<a name="l03913"></a>03913   <span class="comment">// also converts to double</span>
<a name="l03914"></a>03914   normRefVect = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData_ref*dim_ref);
<a name="l03915"></a>03915   <span class="keywordflow">if</span> (normRefVect == NULL ) {
<a name="l03916"></a>03916     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03917"></a>03917     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03918"></a>03918   } 
<a name="l03919"></a>03919   <span class="keywordflow">switch</span> (datatype_ref) {
<a name="l03920"></a>03920   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>:
<a name="l03921"></a>03921     {
<a name="l03922"></a>03922       <span class="keywordtype">int</span>* castp = (<span class="keywordtype">int</span>*)data_ref;
<a name="l03923"></a>03923       <span class="keywordflow">for</span> (i = 0; i &lt; numData_in; i++) {
<a name="l03924"></a>03924         <span class="keywordflow">for</span> (j = 0; j &lt; dim_ref; j++)
<a name="l03925"></a>03925           normRefVect[i*dim_ref + j] = castp[i*dim_ref + j];
<a name="l03926"></a>03926       }
<a name="l03927"></a>03927     }
<a name="l03928"></a>03928     <span class="keywordflow">break</span>;
<a name="l03929"></a>03929   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l03930"></a>03930     {
<a name="l03931"></a>03931       <span class="keywordtype">float</span>* castp = (<span class="keywordtype">float</span>*)data_ref;
<a name="l03932"></a>03932       <span class="keywordflow">for</span> (i = 0; i &lt; numData_in; i++) {
<a name="l03933"></a>03933         <span class="keywordflow">for</span> (j = 0; j &lt; dim_ref; j++)
<a name="l03934"></a>03934           normRefVect[i*dim_ref + j] = castp[i*dim_ref + j];
<a name="l03935"></a>03935       }
<a name="l03936"></a>03936     }
<a name="l03937"></a>03937     <span class="keywordflow">break</span>;
<a name="l03938"></a>03938   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l03939"></a>03939     {
<a name="l03940"></a>03940       <span class="keywordtype">double</span>* castp = (<span class="keywordtype">double</span>*)data_ref;
<a name="l03941"></a>03941       <span class="keywordflow">for</span> (i = 0; i &lt; numData_in; i++) {
<a name="l03942"></a>03942         <span class="keywordflow">for</span> (j = 0; j &lt; dim_ref; j++)
<a name="l03943"></a>03943           normRefVect[i*dim_ref + j] = castp[i*dim_ref + j];
<a name="l03944"></a>03944       }
<a name="l03945"></a>03945     }
<a name="l03946"></a>03946     <span class="keywordflow">break</span>;
<a name="l03947"></a>03947   <span class="keywordflow">default</span>:
<a name="l03948"></a>03948     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03949"></a>03949   }
<a name="l03950"></a>03950   
<a name="l03951"></a>03951   <span class="comment">// make space for temporary normal and tangent component arrays</span>
<a name="l03952"></a>03952   normals = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData_in);
<a name="l03953"></a>03953   tangents = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData_in);
<a name="l03954"></a>03954   <span class="keywordflow">if</span> (normals == NULL || tangents == NULL) {
<a name="l03955"></a>03955     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03956"></a>03956     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03957"></a>03957   } 
<a name="l03958"></a>03958   
<a name="l03959"></a>03959   <span class="keywordflow">switch</span> (datatype_in) {
<a name="l03960"></a>03960   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l03961"></a>03961     {
<a name="l03962"></a>03962       <span class="keywordtype">int</span> *castp = (<span class="keywordtype">int</span>*)data_in;
<a name="l03963"></a>03963       <span class="keywordtype">double</span> temp[dim_in];
<a name="l03964"></a>03964       <span class="keywordflow">for</span> (i = 0; i &lt; numData_in; i++) {
<a name="l03965"></a>03965         <span class="keywordflow">for</span> (j = 0; j &lt; dim_in; j++)
<a name="l03966"></a>03966           temp[j] = castp[i*dim_in + j];
<a name="l03967"></a>03967         <a class="code" href="group__PrivateVariableMath.html#g7db7a2e7fc87f59815ae7a87ad24975d">_fc_decomposeVector</a>(dim_in, temp, dim_ref, &amp;normRefVect[i*dim_ref], 
<a name="l03968"></a>03968                             &amp;normals[i], &amp;tangents[i]);
<a name="l03969"></a>03969       }
<a name="l03970"></a>03970     } 
<a name="l03971"></a>03971     <span class="keywordflow">break</span>;
<a name="l03972"></a>03972   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>: 
<a name="l03973"></a>03973     {
<a name="l03974"></a>03974       <span class="keywordtype">float</span> *castp = (<span class="keywordtype">float</span>*)data_in;
<a name="l03975"></a>03975       <span class="keywordtype">double</span> temp[dim_in];
<a name="l03976"></a>03976       <span class="keywordflow">for</span> (i = 0; i &lt; numData_in; i++) {
<a name="l03977"></a>03977         <span class="keywordflow">for</span> (j = 0; j &lt; dim_in; j++)
<a name="l03978"></a>03978           temp[j] = castp[i*dim_in + j];
<a name="l03979"></a>03979         <a class="code" href="group__PrivateVariableMath.html#g7db7a2e7fc87f59815ae7a87ad24975d">_fc_decomposeVector</a>(dim_in, temp, dim_ref, &amp;normRefVect[i*dim_ref], 
<a name="l03980"></a>03980                             &amp;normals[i], &amp;tangents[i]);
<a name="l03981"></a>03981       }
<a name="l03982"></a>03982     } 
<a name="l03983"></a>03983     <span class="keywordflow">break</span>;
<a name="l03984"></a>03984   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l03985"></a>03985     {
<a name="l03986"></a>03986       <span class="keywordtype">double</span> *castp = (<span class="keywordtype">double</span>*)data_in;
<a name="l03987"></a>03987       <span class="keywordflow">for</span> (i = 0; i &lt; numData_in; i++) 
<a name="l03988"></a>03988         <a class="code" href="group__PrivateVariableMath.html#g7db7a2e7fc87f59815ae7a87ad24975d">_fc_decomposeVector</a>(dim_in, &amp;castp[i*dim_in], dim_ref,
<a name="l03989"></a>03989                             &amp;normRefVect[i*dim_ref], &amp;normals[i], &amp;tangents[i]);
<a name="l03990"></a>03990     } 
<a name="l03991"></a>03991     <span class="keywordflow">break</span>;
<a name="l03992"></a>03992   <span class="keywordflow">default</span>:
<a name="l03993"></a>03993     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03994"></a>03994   }
<a name="l03995"></a>03995   free(normRefVect);
<a name="l03996"></a>03996   
<a name="l03997"></a>03997   <span class="comment">// add new variables to current mesh</span>
<a name="l03998"></a>03998   <span class="comment">// FIX check for name collisions, better if done in create_variable</span>
<a name="l03999"></a>03999   rc = <a class="code" href="group__Variable.html#g3ec29251d717c5d0ca4ecfd9824f67b1">fc_getVariableName</a>(inputVector, &amp;name_in);
<a name="l04000"></a>04000   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04001"></a>04001     <span class="keywordflow">return</span> rc;
<a name="l04002"></a>04002   rc = <a class="code" href="group__Variable.html#g3ec29251d717c5d0ca4ecfd9824f67b1">fc_getVariableName</a>(referenceVector, &amp;name_ref);
<a name="l04003"></a>04003   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04004"></a>04004     <span class="keywordflow">return</span> rc;
<a name="l04005"></a>04005   tempstring1 = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*(strlen(name_in) + strlen(name_ref) +40));
<a name="l04006"></a>04006   tempstring2 = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*(strlen(name_in) + strlen(name_ref) +40));
<a name="l04007"></a>04007   <span class="keywordflow">if</span> (tempstring1 == NULL || tempstring2 == NULL) {
<a name="l04008"></a>04008     free(tempstring1);
<a name="l04009"></a>04009     free(tempstring2);
<a name="l04010"></a>04010     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l04011"></a>04011     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l04012"></a>04012   }
<a name="l04013"></a>04013   sprintf(tempstring1, <span class="stringliteral">"%s Normal Component with respect to %s"</span>, name_in, name_ref);
<a name="l04014"></a>04014   sprintf(tempstring2, <span class="stringliteral">"%s Tangent Component with respect to %s"</span>, name_in, name_ref);
<a name="l04015"></a>04015   free(name_in);
<a name="l04016"></a>04016   free(name_ref);
<a name="l04017"></a>04017   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(inputVector)) {
<a name="l04018"></a>04018     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l04019"></a>04019     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(inputVector, &amp;dataset);
<a name="l04020"></a>04020     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04021"></a>04021       <span class="keywordflow">return</span> rc;
<a name="l04022"></a>04022     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, tempstring1, normalComponent);
<a name="l04023"></a>04023     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04024"></a>04024       <span class="keywordflow">return</span> rc;
<a name="l04025"></a>04025     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, tempstring2, tangentComponent);
<a name="l04026"></a>04026     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04027"></a>04027       <span class="keywordflow">return</span> rc;
<a name="l04028"></a>04028   }
<a name="l04029"></a>04029   <span class="keywordflow">else</span> {
<a name="l04030"></a>04030     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l04031"></a>04031     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(inputVector, &amp;mesh);
<a name="l04032"></a>04032     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04033"></a>04033       <span class="keywordflow">return</span> rc;
<a name="l04034"></a>04034     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, tempstring1, normalComponent);
<a name="l04035"></a>04035     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04036"></a>04036       <span class="keywordflow">return</span> rc;
<a name="l04037"></a>04037     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, tempstring2, tangentComponent);
<a name="l04038"></a>04038     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04039"></a>04039       <span class="keywordflow">return</span> rc;
<a name="l04040"></a>04040   }
<a name="l04041"></a>04041   free(tempstring1);
<a name="l04042"></a>04042   free(tempstring2);
<a name="l04043"></a>04043   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*normalComponent, numData_in, 1, assoc_in, 
<a name="l04044"></a>04044                         <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, normals);
<a name="l04045"></a>04045   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04046"></a>04046     <span class="keywordflow">return</span> rc;
<a name="l04047"></a>04047   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*tangentComponent, numData_in, 1, assoc_in, 
<a name="l04048"></a>04048                         <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, tangents);
<a name="l04049"></a>04049   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04050"></a>04050     <span class="keywordflow">return</span> rc;
<a name="l04051"></a>04051   
<a name="l04052"></a>04052   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04053"></a>04053 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g1587178edc4e731f8010076424a04312"></a><!-- doxytag: member="varmath.c::fc_createStressPressureVariables" ref="g1587178edc4e731f8010076424a04312" args="(FC_Variable *sigmaVars, FC_Variable *stressVar, FC_Variable *pressureVar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createStressPressureVariables           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>sigmaVars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>stressVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>pressureVar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute Von Mises stress and pressure from the stress matrix. 
<p>
<b>Description:</b> <p>
Given the six variables that make up the symmetric stress tensor, this function computes the Von Mises stress and the pressure. The expected order of the stress tensor components (passed in as an array) are { xx, yy, zz, xy, yz, zx };<p>
The calculations are based on equations from "Intermediate Mechanics of Materials", J. R. Barber, McGraw-Hill, 2001, pgs 33-48. Pressure is defined such that it is negative for compression and positive for tension.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000110">Todo:</a></b></dt><dd>Is this the best home for this function?</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000110">Todo:</a></b></dt><dd>this doesn't handle global vars yet</dd></dl>
<b>Modifications:</b> <ul>
<li>8/08/2006 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>sigmaVars</em>&nbsp;</td><td>
input - array of 6 stress tensor components in order { xx, yy, zz, xy, yz, zx } </td></tr>
<tr><td valign="top"><em>stressVar</em>&nbsp;</td><td>
output - the von misses stress </td></tr>
<tr><td valign="top"><em>pressureVar</em>&nbsp;</td><td>
output - the pressure </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l04078">4078</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04415">fc_getVariableAssociationType()</a>, <a class="el" href="variable_8c-source.html#l04649">fc_getVariableDataAsDataType()</a>, <a class="el" href="variable_8c-source.html#l04458">fc_getVariableNumComponent()</a>, <a class="el" href="variable_8c-source.html#l04543">fc_getVariableNumDataPoint()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="util_8h-source.html#l00174">FC_PI</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varNormalize_8c-source.html#l00116">createStressOrPressureVar()</a>, and <a class="el" href="maxStress_8c-source.html#l00074">main()</a>.<div class="fragment"><pre class="fragment"><a name="l04080"></a>04080                            { xx, yy, zz, xy, yz, zx } */
<a name="l04081"></a>04081   <a class="code" href="structFC__Variable.html">FC_Variable</a>* stressVar,   <span class="comment">/**&lt; output - the von misses stress */</span>
<a name="l04082"></a>04082   <a class="code" href="structFC__Variable.html">FC_Variable</a>* pressureVar  <span class="comment">/**&lt; output - the pressure */</span>
<a name="l04083"></a>04083 ) 
<a name="l04084"></a>04084 {
<a name="l04085"></a>04085   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04086"></a>04086   <span class="keywordtype">int</span> i;
<a name="l04087"></a>04087   <span class="comment">// sigmas: 0 - xx, 1 - yy, 2 - zz, 3 - xy , 4 - yz, 5 - zx</span>
<a name="l04088"></a>04088   <span class="keywordtype">double</span>* sigmas[6];
<a name="l04089"></a>04089   <span class="keywordtype">double</span>* stress;
<a name="l04090"></a>04090   <span class="keywordtype">double</span>* pressure;
<a name="l04091"></a>04091   <span class="keywordtype">int</span> numDataPoint;
<a name="l04092"></a>04092   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l04093"></a>04093   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l04094"></a>04094 
<a name="l04095"></a>04095   <span class="comment">// default return</span>
<a name="l04096"></a>04096   <span class="keywordflow">if</span> (stressVar)
<a name="l04097"></a>04097     *stressVar = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l04098"></a>04098   <span class="keywordflow">if</span> (pressureVar)
<a name="l04099"></a>04099     *pressureVar = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l04100"></a>04100 
<a name="l04101"></a>04101   <span class="comment">// check input </span>
<a name="l04102"></a>04102   <span class="keywordflow">if</span> (!sigmaVars || !stressVar || !pressureVar) {
<a name="l04103"></a>04103     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04104"></a>04104     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04105"></a>04105   }
<a name="l04106"></a>04106   <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {
<a name="l04107"></a>04107     <span class="keywordtype">int</span> numComp;
<a name="l04108"></a>04108     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> temp_mesh;
<a name="l04109"></a>04109     <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(sigmaVars[i])) {
<a name="l04110"></a>04110       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04111"></a>04111       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04112"></a>04112     }
<a name="l04113"></a>04113     <a class="code" href="group__Variable.html#g954ae36f975a3fe850f18db5b3e15fc5">fc_getVariableNumComponent</a>(sigmaVars[i], &amp;numComp);
<a name="l04114"></a>04114     <span class="keywordflow">if</span> (numComp != 1) {
<a name="l04115"></a>04115       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"input stress components must be scalars"</span>);
<a name="l04116"></a>04116       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04117"></a>04117     }
<a name="l04118"></a>04118     <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(sigmaVars[i], &amp;temp_mesh);
<a name="l04119"></a>04119     <span class="keywordflow">if</span> (i == 0)
<a name="l04120"></a>04120       mesh = temp_mesh;
<a name="l04121"></a>04121     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(mesh, temp_mesh)) {
<a name="l04122"></a>04122       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"all stress components must be on same mesh"</span>);
<a name="l04123"></a>04123       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04124"></a>04124     }
<a name="l04125"></a>04125   }
<a name="l04126"></a>04126 
<a name="l04127"></a>04127   <span class="comment">// log messaeg</span>
<a name="l04128"></a>04128   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Creating Von Misses stress and pressure variables"</span>);
<a name="l04129"></a>04129 
<a name="l04130"></a>04130   <span class="comment">// get the starting data</span>
<a name="l04131"></a>04131   rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(sigmaVars[0], &amp;mesh);
<a name="l04132"></a>04132   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04133"></a>04133     <span class="keywordflow">return</span> rc;
<a name="l04134"></a>04134   rc = <a class="code" href="group__Variable.html#g36c4ac9f503bcf040c378c06e1ad9188">fc_getVariableAssociationType</a>(sigmaVars[0], &amp;assoc);
<a name="l04135"></a>04135   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04136"></a>04136     <span class="keywordflow">return</span> rc;
<a name="l04137"></a>04137   rc = <a class="code" href="group__Variable.html#gca6fc2e25075838bc8b2ef3a347efb20">fc_getVariableNumDataPoint</a>(sigmaVars[0], &amp;numDataPoint);
<a name="l04138"></a>04138   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04139"></a>04139     <span class="keywordflow">return</span> rc;
<a name="l04140"></a>04140   <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++) {
<a name="l04141"></a>04141     rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(sigmaVars[i], <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, 
<a name="l04142"></a>04142                           (<span class="keywordtype">void</span>*)&amp;sigmas[i]);
<a name="l04143"></a>04143     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04144"></a>04144       <span class="keywordflow">return</span> rc;
<a name="l04145"></a>04145   }
<a name="l04146"></a>04146 
<a name="l04147"></a>04147   <span class="comment">// make room for new data</span>
<a name="l04148"></a>04148   stress = (<span class="keywordtype">double</span>*)malloc(numDataPoint*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l04149"></a>04149   pressure = (<span class="keywordtype">double</span>*)malloc(numDataPoint*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l04150"></a>04150   <span class="keywordflow">if</span> (!stress || !pressure) {
<a name="l04151"></a>04151     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l04152"></a>04152     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l04153"></a>04153   }
<a name="l04154"></a>04154 
<a name="l04155"></a>04155   <span class="comment">// calculate data</span>
<a name="l04156"></a>04156   <span class="keywordflow">for</span> (i = 0; i &lt; numDataPoint; i++) {
<a name="l04157"></a>04157     <span class="keywordtype">double</span> I1, I2, I3;
<a name="l04158"></a>04158     <span class="keywordtype">double</span> phi;
<a name="l04159"></a>04159     
<a name="l04160"></a>04160     I1 = sigmas[0][i] + sigmas[1][i] + sigmas[2][i];
<a name="l04161"></a>04161     I2 =   sigmas[0][i]*sigmas[1][i]
<a name="l04162"></a>04162          + sigmas[1][i]*sigmas[2][i]
<a name="l04163"></a>04163          + sigmas[2][i]*sigmas[0][i] 
<a name="l04164"></a>04164          - sigmas[3][i]*sigmas[3][i] 
<a name="l04165"></a>04165          - sigmas[4][i]*sigmas[4][i]
<a name="l04166"></a>04166          - sigmas[5][i]*sigmas[5][i];
<a name="l04167"></a>04167     I3 =   sigmas[0][i]*sigmas[1][i]*sigmas[2][i]
<a name="l04168"></a>04168          - sigmas[0][i]*sigmas[4][i]*sigmas[4][i]
<a name="l04169"></a>04169          - sigmas[1][i]*sigmas[5][i]*sigmas[5][i]
<a name="l04170"></a>04170          - sigmas[2][i]*sigmas[3][i]*sigmas[3][i]
<a name="l04171"></a>04171          + 2*sigmas[3][i]*sigmas[4][i]*sigmas[5][i];
<a name="l04172"></a>04172 
<a name="l04173"></a>04173     stress[i] = sqrt(I1*I1 - 3*I2);
<a name="l04174"></a>04174 
<a name="l04175"></a>04175     <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>(stress[i], 0)) {
<a name="l04176"></a>04176       pressure[i] = 1/3. * I1;
<a name="l04177"></a>04177     }
<a name="l04178"></a>04178     <span class="keywordflow">else</span> {
<a name="l04179"></a>04179       phi = 1/3. * acos((2*I1*I1*I1 - 9*I1*I2 + 27*I3)/2./
<a name="l04180"></a>04180                (stress[i]*stress[i]*stress[i]));      
<a name="l04181"></a>04181       pressure[i] = 1/3. * (I1 + 2.*stress[i]*(cos(phi) +
<a name="l04182"></a>04182                                 cos(phi + 2./3.*<a class="code" href="group__MiscUtilities.html#g0143d40c3cb2fd8d5ed18838b108c1b0">FC_PI</a>) + 
<a name="l04183"></a>04183                                 cos(phi + 4./3.*<a class="code" href="group__MiscUtilities.html#g0143d40c3cb2fd8d5ed18838b108c1b0">FC_PI</a>)));
<a name="l04184"></a>04184     }
<a name="l04185"></a>04185   }
<a name="l04186"></a>04186   <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++)
<a name="l04187"></a>04187     free(sigmas[i]);
<a name="l04188"></a>04188 
<a name="l04189"></a>04189   <span class="comment">// create new vars</span>
<a name="l04190"></a>04190   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"von mises stress"</span>, stressVar);
<a name="l04191"></a>04191   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04192"></a>04192     <span class="keywordflow">return</span> rc;
<a name="l04193"></a>04193   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*stressVar, numDataPoint, 1, assoc,
<a name="l04194"></a>04194                     <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, stress);
<a name="l04195"></a>04195   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04196"></a>04196     <span class="keywordflow">return</span> rc;
<a name="l04197"></a>04197   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"pressure"</span>, pressureVar);
<a name="l04198"></a>04198   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04199"></a>04199     <span class="keywordflow">return</span> rc;
<a name="l04200"></a>04200   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*pressureVar, numDataPoint, 1, assoc,
<a name="l04201"></a>04201                     <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, pressure);
<a name="l04202"></a>04202   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04203"></a>04203     <span class="keywordflow">return</span> rc;
<a name="l04204"></a>04204 
<a name="l04205"></a>04205   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04206"></a>04206 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfc8c9867f92687d20e29694f15d459ac"></a><!-- doxytag: member="varmath.c::fc_operatorSeqVar" ref="gfc8c9867f92687d20e29694f15d459ac" args="(int numStep, FC_Variable *seq_var, char *operation, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_operatorSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in unary operations on a sequence variable. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired unary operation, return a new sequence variable with the result of that operation performed on each step of the given sequence variable. This is the sequence variable analogy to <a class="el" href="group__VariableMath.html#g4b95801eace5c69732676a8e5d636b13">fc_operatorVar()</a>;<p>
Supported operations are:<ul>
<li><code> "-" =&gt; -var </code></li></ul>
<p>
The new sequence variable will be on the same mesh and sequence as the original and will have the same association and math type as the original. The operation is performed on each component of each data point at each sequence step.<p>
If the original sequence variable had data type FC_DT_INT, then the result will have data type FC_DT_INT. If the original sequence variable had data type FC_DT_FLOAT or FC_DT_DOUBLE, the result will have data type FC_DT_DOUBLE. The function returns with an error if the data type is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>06/03/04 ACG Created.</li><li>06/07/05 ACG removing datatype check and leaving that to internal call</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - numstep in the input seq var </td></tr>
<tr><td valign="top"><em>seq_var</em>&nbsp;</td><td>
input - seq variable </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variable </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new seq variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00655">655</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="varmath_8c-source.html#l00220">fc_operatorVar()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00661"></a>00661   {
<a name="l00662"></a>00662   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00663"></a>00663   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l00664"></a>00664   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l00665"></a>00665   <span class="keywordtype">int</span> i, j;
<a name="l00666"></a>00666 
<a name="l00667"></a>00667   <span class="comment">// default return</span>
<a name="l00668"></a>00668   <span class="keywordflow">if</span> (new_seq_var)
<a name="l00669"></a>00669     *new_seq_var = NULL;
<a name="l00670"></a>00670 
<a name="l00671"></a>00671   <span class="comment">// check input</span>
<a name="l00672"></a>00672   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var)) || (new_seq_var == NULL)
<a name="l00673"></a>00673       || new_seq_var_name == NULL){
<a name="l00674"></a>00674     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00675"></a>00675     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00676"></a>00676   }
<a name="l00677"></a>00677   <span class="comment">//other checks are done internally in operatorvar</span>
<a name="l00678"></a>00678 
<a name="l00679"></a>00679   <span class="comment">// log message</span>
<a name="l00680"></a>00680   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operatorSeqVar '%s' on variable '%s'"</span>,
<a name="l00681"></a>00681             operation, <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var[0])-&gt;header.name);
<a name="l00682"></a>00682 
<a name="l00683"></a>00683   <span class="comment">// Get info</span>
<a name="l00684"></a>00684   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var,&amp;seq);
<a name="l00685"></a>00685   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00686"></a>00686     <span class="keywordflow">return</span> rc;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688   <span class="comment">// Make space to save temp_vars</span>
<a name="l00689"></a>00689   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l00690"></a>00690   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l00691"></a>00691     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l00692"></a>00692     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00693"></a>00693   }
<a name="l00694"></a>00694   
<a name="l00695"></a>00695   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l00696"></a>00696   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00697"></a>00697     rc = <a class="code" href="group__VariableMath.html#g4b95801eace5c69732676a8e5d636b13">fc_operatorVar</a>(seq_var[i], operation, <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]);
<a name="l00698"></a>00698     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l00699"></a>00699       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l00700"></a>00700      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l00701"></a>00701       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l00702"></a>00702       free(temp_vars);
<a name="l00703"></a>00703       <span class="keywordflow">return</span> rc;
<a name="l00704"></a>00704     }
<a name="l00705"></a>00705   }
<a name="l00706"></a>00706 
<a name="l00707"></a>00707   <span class="comment">// stitch steps into the new seq var</span>
<a name="l00708"></a>00708   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l00709"></a>00709                          new_seq_var_name, new_seq_var);
<a name="l00710"></a>00710   free(temp_vars);
<a name="l00711"></a>00711   <span class="keywordflow">return</span> rc;
<a name="l00712"></a>00712 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g4b95801eace5c69732676a8e5d636b13"></a><!-- doxytag: member="varmath.c::fc_operatorVar" ref="g4b95801eace5c69732676a8e5d636b13" args="(FC_Variable var, char *operation, char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_operatorVar           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in unary operations on a variable. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired unary operation, return a new variable with the result of that operation performed on the given variable.<p>
Supported operations are:<ul>
<li><code> "-" =&gt; -var </code></li></ul>
<p>
The new variable will be on the same mesh as the original and will have the same association and math type as the original. The operation is performed on each component of each data point.<p>
If the original variable had data type FC_DT_INT, then the result will have data type FC_DT_INT. If the original variable had data type FC_DT_FLOAT or FC_DT_DOUBLE, the result will have data type FC_DT_DOUBLE. The function returns with an error if the data type is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>02/02/04 R.McCoy Created.</li><li>11/09/03 WSK, restricted to built-in types. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variable </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00220">220</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="varmath_8c-source.html#l02940">_fc_negateDoubles()</a>, <a class="el" href="varmath_8c-source.html#l02913">_fc_negateInts()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="base_8c-source.html#l00418">fc_getDataTypeText()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l00655">fc_operatorSeqVar()</a>.<div class="fragment"><pre class="fragment"><a name="l00225"></a>00225   {
<a name="l00226"></a>00226   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00227"></a>00227   <span class="keywordtype">int</span> i;
<a name="l00228"></a>00228   <span class="keywordtype">int</span> opID;
<a name="l00229"></a>00229   <span class="keywordtype">int</span> numData, numComp;
<a name="l00230"></a>00230   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc, new_datatype;
<a name="l00231"></a>00231   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l00232"></a>00232   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype;
<a name="l00233"></a>00233   <span class="keywordtype">void</span> *data, *resultPtr;
<a name="l00234"></a>00234   <span class="keywordtype">double</span> *dblDataPtr;
<a name="l00235"></a>00235   <span class="comment">// create array of pointers to int &amp; double array functions</span>
<a name="l00236"></a>00236   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> (*IntUnaryOper[])(int, <span class="keywordtype">int</span>*, <span class="keywordtype">int</span>*) = { 
<a name="l00237"></a>00237                          <a class="code" href="group__PrivateVariableMath.html#gd4f906de7a8e36f8280983e49417c16a">_fc_negateInts</a>
<a name="l00238"></a>00238                         };
<a name="l00239"></a>00239   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> (*DblUnaryOper[])(int, <span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*) = {
<a name="l00240"></a>00240                           <a class="code" href="group__PrivateVariableMath.html#g74d67e9a5a87c5e8d0d07b7264da7b0f">_fc_negateDoubles</a> 
<a name="l00241"></a>00241                         }; 
<a name="l00242"></a>00242 
<a name="l00243"></a>00243   <span class="comment">// set default return value</span>
<a name="l00244"></a>00244   <span class="keywordflow">if</span> (new_var)
<a name="l00245"></a>00245     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l00246"></a>00246   
<a name="l00247"></a>00247   <span class="comment">// check input</span>
<a name="l00248"></a>00248   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var)) || !operation || !new_var || !new_var_name) {
<a name="l00249"></a>00249     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00250"></a>00250     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00251"></a>00251   }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   <span class="comment">// pick operation</span>
<a name="l00254"></a>00254   <span class="keywordflow">if</span> (!strcmp(operation, <span class="stringliteral">"-"</span>)) 
<a name="l00255"></a>00255     opID = 0;
<a name="l00256"></a>00256   <span class="keywordflow">else</span> {
<a name="l00257"></a>00257     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"operation '%s' not recognized."</span>, operation); 
<a name="l00258"></a>00258     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00259"></a>00259   }
<a name="l00260"></a>00260   
<a name="l00261"></a>00261   <span class="comment">// log message</span>
<a name="l00262"></a>00262   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing unary operation '%s' on variable '%s'"</span>,
<a name="l00263"></a>00263             operation, <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var)-&gt;header.name);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265   <span class="comment">// get variable info</span>
<a name="l00266"></a>00266   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;numComp, &amp;assoc, 
<a name="l00267"></a>00267                  &amp;mathtype, &amp;datatype);
<a name="l00268"></a>00268   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00269"></a>00269     <span class="keywordflow">return</span> rc;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271   <span class="comment">// check that the datatype can be handled here</span>
<a name="l00272"></a>00272   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; 
<a name="l00273"></a>00273       datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l00274"></a>00274     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"data type '%s' cannot be handled."</span>, 
<a name="l00275"></a>00275                  <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(datatype));
<a name="l00276"></a>00276     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l00277"></a>00277   } 
<a name="l00278"></a>00278 
<a name="l00279"></a>00279   <span class="comment">// get data</span>
<a name="l00280"></a>00280   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l00281"></a>00281   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00282"></a>00282     <span class="keywordflow">return</span> rc;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284   <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l00285"></a>00285     new_datatype = <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>;
<a name="l00286"></a>00286     resultPtr = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*numComp*numData);
<a name="l00287"></a>00287     <span class="keywordflow">if</span> (resultPtr == NULL) {
<a name="l00288"></a>00288       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));  
<a name="l00289"></a>00289       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291     rc = (*IntUnaryOper[opID])(numComp*numData, (<span class="keywordtype">int</span>*)data, (<span class="keywordtype">int</span>*)resultPtr);
<a name="l00292"></a>00292     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00293"></a>00293       <span class="keywordflow">return</span> rc;
<a name="l00294"></a>00294   }
<a name="l00295"></a>00295   <span class="keywordflow">else</span> {
<a name="l00296"></a>00296     new_datatype = <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298      <span class="comment">// get double representation of data</span>
<a name="l00299"></a>00299     <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>)
<a name="l00300"></a>00300       dblDataPtr = (<span class="keywordtype">double</span>*)data;
<a name="l00301"></a>00301     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l00302"></a>00302       <span class="keywordtype">float</span>* cast_data = (<span class="keywordtype">float</span>*)data;
<a name="l00303"></a>00303       dblDataPtr = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numComp*numData);
<a name="l00304"></a>00304       <span class="keywordflow">if</span> (dblDataPtr == NULL) {
<a name="l00305"></a>00305      <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));  
<a name="l00306"></a>00306      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00307"></a>00307       }
<a name="l00308"></a>00308       <span class="keywordflow">for</span> (i = 0; i &lt; numComp*numData; i++)
<a name="l00309"></a>00309      dblDataPtr[i] = cast_data[i];
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     <span class="comment">// do it</span>
<a name="l00313"></a>00313     resultPtr = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numComp*numData);
<a name="l00314"></a>00314     <span class="keywordflow">if</span> (resultPtr == NULL) {
<a name="l00315"></a>00315       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));  
<a name="l00316"></a>00316       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318     rc = (*DblUnaryOper[opID])(numComp*numData, (<span class="keywordtype">double</span>*)dblDataPtr, 
<a name="l00319"></a>00319                       (<span class="keywordtype">double</span>*)resultPtr);
<a name="l00320"></a>00320     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00321"></a>00321       <span class="keywordflow">return</span> rc;
<a name="l00322"></a>00322     
<a name="l00323"></a>00323     <span class="comment">// deallocate memory if it was allocated</span>
<a name="l00324"></a>00324     <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>)
<a name="l00325"></a>00325       free(dblDataPtr);
<a name="l00326"></a>00326   }
<a name="l00327"></a>00327  
<a name="l00328"></a>00328   <span class="comment">// create the new variable</span>
<a name="l00329"></a>00329   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var)) {
<a name="l00330"></a>00330     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l00331"></a>00331     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(var, &amp;dataset);
<a name="l00332"></a>00332     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00333"></a>00333       <span class="keywordflow">return</span> rc;
<a name="l00334"></a>00334     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, new_var_name, new_var);
<a name="l00335"></a>00335     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00336"></a>00336       <span class="keywordflow">return</span> rc; 
<a name="l00337"></a>00337   }
<a name="l00338"></a>00338   <span class="keywordflow">else</span> {
<a name="l00339"></a>00339     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l00340"></a>00340     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(var, &amp;mesh);
<a name="l00341"></a>00341     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00342"></a>00342       <span class="keywordflow">return</span> rc;
<a name="l00343"></a>00343     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, new_var_name, new_var);
<a name="l00344"></a>00344     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00345"></a>00345       <span class="keywordflow">return</span> rc; 
<a name="l00346"></a>00346   }
<a name="l00347"></a>00347   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numData, numComp, assoc, mathtype, 
<a name="l00348"></a>00348                     new_datatype, resultPtr);
<a name="l00349"></a>00349   <span class="keywordflow">return</span> rc;    
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 } 
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gef3e37a79067c13d21fc25264ff145e4"></a><!-- doxytag: member="varmath.c::fc_seqConstOperatorSeqVar" ref="gef3e37a79067c13d21fc25264ff145e4" args="(int numStep, int constNumComp, void *constVectors, FC_DataType constType, char *operation, FC_Variable *seq_var2, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqConstOperatorSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a seq variable a seq of constants. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation performed on the the given seq of constants. Use <a class="el" href="group__VariableMath.html#gd81ceef16fe52226fc581552a133ea31">fc_seqVarOperatorSeqConst()</a> to apply the operation in the reverse order.<p>
This is the seq var version of <a class="el" href="group__VariableMath.html#g42db54669d16d0ce55edd29aa73e4719">fc_constOperatorVar()</a> where a different constant vector is applied to each step of the sequence variable. The constant values should be an array with all components for the first step first, then all components for the next step, etc. If you would like to apply the same constant to all steps, use <a class="el" href="group__VariableMath.html#g4d3a1daac4eee6b72617a0c3a2013883">fc_constOperatorSeqVar()</a>.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; const + var </code></li><li><code> "-" =&gt; const - var </code></li><li><code> "*" =&gt; const * var </code></li><li><code> "/" =&gt; const / var </code></li></ul>
<p>
The seq variable and the constants must have the same number components.<p>
The seq new variable will be on the same mesh and have the same association and mathtype as the seq variable. The operation is performed per component and data point at each sequence step.<p>
If both the original variable and the constants have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>11/20/2006 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var and const </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constVector </td></tr>
<tr><td valign="top"><em>constVectors</em>&nbsp;</td><td>
input - constant vectors, stored as vector for first step, then vector for next step, etc. </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>seq_var2</em>&nbsp;</td><td>
input seq var2 </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00979">979</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="varmath_8c-source.html#l00566">fc_constOperatorVar()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00989"></a>00989   {   
<a name="l00990"></a>00990   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00991"></a>00991   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l00992"></a>00992   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l00993"></a>00993   <span class="keywordtype">int</span> i, j;
<a name="l00994"></a>00994 
<a name="l00995"></a>00995   <span class="comment">// default return</span>
<a name="l00996"></a>00996   <span class="keywordflow">if</span> (new_seq_var)
<a name="l00997"></a>00997     *new_seq_var = NULL;
<a name="l00998"></a>00998 
<a name="l00999"></a>00999   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l01000"></a>01000   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var2) || !operation || 
<a name="l01001"></a>01001       constNumComp &lt; 1 || !constVectors || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType) ||
<a name="l01002"></a>01002       constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || new_seq_var_name == NULL ||
<a name="l01003"></a>01003       new_seq_var == NULL) {
<a name="l01004"></a>01004     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01005"></a>01005     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01006"></a>01006   }
<a name="l01007"></a>01007   <span class="comment">//other checks are done internally in varoperatorconst</span>
<a name="l01008"></a>01008 
<a name="l01009"></a>01009   <span class="comment">// log message</span>
<a name="l01010"></a>01010   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarOperatorSeqConst '%s' with"</span>
<a name="l01011"></a>01011                 <span class="stringliteral">"seq variable '%s'"</span>, operation,
<a name="l01012"></a>01012                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var2[0])-&gt;header.name);
<a name="l01013"></a>01013 
<a name="l01014"></a>01014   <span class="comment">// get info</span>
<a name="l01015"></a>01015   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var2, &amp;seq);
<a name="l01016"></a>01016   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01017"></a>01017     <span class="keywordflow">return</span> rc;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019   <span class="comment">// Make space to save temp_vars</span>
<a name="l01020"></a>01020   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l01021"></a>01021   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l01022"></a>01022     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01023"></a>01023     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01024"></a>01024   }
<a name="l01025"></a>01025 
<a name="l01026"></a>01026   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l01027"></a>01027   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01028"></a>01028     <span class="keywordtype">void</span>* temp_constVector;
<a name="l01029"></a>01029     <span class="keywordflow">switch</span>(constType) {
<a name="l01030"></a>01030     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>:
<a name="l01031"></a>01031       temp_constVector = &amp;((<span class="keywordtype">char</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l01032"></a>01032     <span class="keywordflow">case</span>  <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l01033"></a>01033       temp_constVector = &amp;((<span class="keywordtype">int</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l01034"></a>01034     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l01035"></a>01035       temp_constVector = &amp;((<span class="keywordtype">float</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l01036"></a>01036     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l01037"></a>01037       temp_constVector = &amp;((<span class="keywordtype">double</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l01038"></a>01038     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>:
<a name="l01039"></a>01039       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"should never get here"</span>);
<a name="l01040"></a>01040       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01041"></a>01041     }
<a name="l01042"></a>01042     rc = <a class="code" href="group__VariableMath.html#g42db54669d16d0ce55edd29aa73e4719">fc_constOperatorVar</a>(constNumComp, temp_constVector, constType,
<a name="l01043"></a>01043                              operation, seq_var2[i], 
<a name="l01044"></a>01044                              <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l01045"></a>01045     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l01046"></a>01046       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l01047"></a>01047      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l01048"></a>01048       free(temp_vars);
<a name="l01049"></a>01049       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l01050"></a>01050       <span class="keywordflow">return</span> rc;
<a name="l01051"></a>01051     }
<a name="l01052"></a>01052   }
<a name="l01053"></a>01053 
<a name="l01054"></a>01054   <span class="comment">// stitch steps into the new seq var</span>
<a name="l01055"></a>01055   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l01056"></a>01056                          new_seq_var_name, new_seq_var);
<a name="l01057"></a>01057   free(temp_vars);
<a name="l01058"></a>01058   <span class="keywordflow">return</span> rc;
<a name="l01059"></a>01059 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g07749e6607db4793502605412805b450"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionConstSeqVar" ref="g07749e6607db4793502605412805b450" args="(int constNumComp, double *constValues, int numStep, FC_Variable *seq_var, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionConstSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>constValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a constant and a seqVar. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new sequence variable whose values are the results of the function applied to each value and component of the sequence variable and the constant. This is the sequence variable version of the varBinaryFunctionConstVar function.<p>
The sequence variable and constant must have the same number of components.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the sequence variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>03/01/2007 CDU Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constant </td></tr>
<tr><td valign="top"><em>constValues</em>&nbsp;</td><td>
input - values of constant </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var</em>&nbsp;</td><td>
input - sequence variable </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02640">2640</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01943">fc_varBinaryFunctionConstVar()</a>.<div class="fragment"><pre class="fragment"><a name="l02650"></a>02650  {
<a name="l02651"></a>02651   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02652"></a>02652   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02653"></a>02653   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02654"></a>02654   <span class="keywordtype">int</span> i, j;
<a name="l02655"></a>02655 
<a name="l02656"></a>02656   <span class="comment">// default return</span>
<a name="l02657"></a>02657   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02658"></a>02658     *new_seq_var = NULL;
<a name="l02659"></a>02659 
<a name="l02660"></a>02660   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l02661"></a>02661   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var))  ||
<a name="l02662"></a>02662       (constNumComp &lt; 1) || (constValues==NULL)  ||
<a name="l02663"></a>02663       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02664"></a>02664     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02665"></a>02665     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02666"></a>02666   }
<a name="l02667"></a>02667   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02668"></a>02668 
<a name="l02669"></a>02669   <span class="comment">// log message</span>
<a name="l02670"></a>02670   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionConstSeqVar on"</span>
<a name="l02671"></a>02671                 <span class="stringliteral">"seq variable '%s' and a constant"</span>,
<a name="l02672"></a>02672                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var[0])-&gt;header.name);
<a name="l02673"></a>02673 
<a name="l02674"></a>02674   <span class="comment">// get info</span>
<a name="l02675"></a>02675   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var,&amp;seq);
<a name="l02676"></a>02676   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02677"></a>02677     <span class="keywordflow">return</span> rc;
<a name="l02678"></a>02678  
<a name="l02679"></a>02679   <span class="comment">// Make space to save temp_vars</span>
<a name="l02680"></a>02680   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02681"></a>02681   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02682"></a>02682     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02683"></a>02683     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02684"></a>02684   }
<a name="l02685"></a>02685 
<a name="l02686"></a>02686   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02687"></a>02687   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02688"></a>02688     rc = <a class="code" href="group__VariableMath.html#gff2ccc7579022d86a34fcbc204f59cb1">fc_varBinaryFunctionConstVar</a>(constNumComp, constValues,
<a name="l02689"></a>02689                           seq_var[i], 
<a name="l02690"></a>02690                           binaryFunction,
<a name="l02691"></a>02691                           <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02692"></a>02692     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l02693"></a>02693       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02694"></a>02694      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02695"></a>02695       free(temp_vars);
<a name="l02696"></a>02696       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02697"></a>02697       <span class="keywordflow">return</span> rc;
<a name="l02698"></a>02698     }
<a name="l02699"></a>02699   }
<a name="l02700"></a>02700 
<a name="l02701"></a>02701   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02702"></a>02702   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02703"></a>02703                          new_seq_var_name, new_seq_var);
<a name="l02704"></a>02704   free(temp_vars);
<a name="l02705"></a>02705   <span class="keywordflow">return</span> rc;
<a name="l02706"></a>02706 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g88f211e45e38fb4b51c2a8e774ccbe4c"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionSeqConstSeqVar" ref="g88f211e45e38fb4b51c2a8e774ccbe4c" args="(int numStep, int constNumComp, void *constVectors, FC_DataType constType, FC_Variable *seq_var, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionSeqConstSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a seqConst and a seqVar. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new sequence variable whose values are the results of the function applied to each value and component of the input sequence constant and the input sequence variable. This is the sequence variable version of the varBinaryFunctionConstVar.<p>
The seqConstant and seqVariable must have the same number of components, as well as the same number of steps.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the sequence variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>03/01/2007 CDU Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constant </td></tr>
<tr><td valign="top"><em>constVectors</em>&nbsp;</td><td>
input - constant vectors, stored as vector for first step, then vector for next step, etc. </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>seq_var</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02414">2414</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01943">fc_varBinaryFunctionConstVar()</a>.<div class="fragment"><pre class="fragment"><a name="l02427"></a>02427  {
<a name="l02428"></a>02428   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02429"></a>02429   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02430"></a>02430   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02431"></a>02431   <span class="keywordtype">double</span> *temp_const;
<a name="l02432"></a>02432   <span class="keywordtype">int</span> i, j;
<a name="l02433"></a>02433 
<a name="l02434"></a>02434   <span class="comment">// default return</span>
<a name="l02435"></a>02435   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02436"></a>02436     *new_seq_var = NULL;
<a name="l02437"></a>02437 
<a name="l02438"></a>02438   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l02439"></a>02439   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var)) ||
<a name="l02440"></a>02440       (constNumComp &lt; 1) || (constVectors==NULL)  || 
<a name="l02441"></a>02441       (!<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType)) || (constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>) ||
<a name="l02442"></a>02442       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02443"></a>02443     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02444"></a>02444     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02445"></a>02445   }
<a name="l02446"></a>02446   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02447"></a>02447 
<a name="l02448"></a>02448   <span class="comment">// log message</span>
<a name="l02449"></a>02449   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionSeqVarSeqConst on"</span>
<a name="l02450"></a>02450                 <span class="stringliteral">"seq variable '%s' and a constant"</span>,
<a name="l02451"></a>02451                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var[0])-&gt;header.name);
<a name="l02452"></a>02452 
<a name="l02453"></a>02453   <span class="comment">// get info</span>
<a name="l02454"></a>02454   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var,&amp;seq);
<a name="l02455"></a>02455   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02456"></a>02456     <span class="keywordflow">return</span> rc;
<a name="l02457"></a>02457  
<a name="l02458"></a>02458   <span class="comment">// Make space to save temp_vars</span>
<a name="l02459"></a>02459   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02460"></a>02460   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02461"></a>02461     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02462"></a>02462     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02463"></a>02463   }
<a name="l02464"></a>02464 
<a name="l02465"></a>02465   <span class="comment">// Convert the constant to double</span>
<a name="l02466"></a>02466   temp_const = malloc(constNumComp * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));  
<a name="l02467"></a>02467   <span class="keywordflow">if</span>(!temp_const){
<a name="l02468"></a>02468     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02469"></a>02469     free(temp_vars);
<a name="l02470"></a>02470     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02471"></a>02471   }
<a name="l02472"></a>02472 
<a name="l02473"></a>02473 
<a name="l02474"></a>02474   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02475"></a>02475   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02476"></a>02476 
<a name="l02477"></a>02477     <span class="comment">//Convert this step of the constVector</span>
<a name="l02478"></a>02478     <span class="keywordflow">for</span>(j=0;j&lt;constNumComp;j++){
<a name="l02479"></a>02479       <span class="keywordflow">switch</span>(constType){
<a name="l02480"></a>02480       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>:
<a name="l02481"></a>02481      temp_const[j] = (<span class="keywordtype">double</span>) ((<span class="keywordtype">char</span>  *)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02482"></a>02482       <span class="keywordflow">case</span>  <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l02483"></a>02483      temp_const[j] = (double) ((<span class="keywordtype">int</span>   *)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02484"></a>02484       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l02485"></a>02485      temp_const[j] = (double) ((<span class="keywordtype">float</span> *)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02486"></a>02486       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l02487"></a>02487      temp_const[j] = (double) ((<span class="keywordtype">double</span>*)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02488"></a>02488       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>:
<a name="l02489"></a>02489      <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"should never get here"</span>);
<a name="l02490"></a>02490      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l02491"></a>02491       }
<a name="l02492"></a>02492     }
<a name="l02493"></a>02493 
<a name="l02494"></a>02494     <span class="comment">//Make the actual call</span>
<a name="l02495"></a>02495     rc = <a class="code" href="group__VariableMath.html#gff2ccc7579022d86a34fcbc204f59cb1">fc_varBinaryFunctionConstVar</a>(constNumComp, temp_const,
<a name="l02496"></a>02496                           seq_var[i], 
<a name="l02497"></a>02497                           binaryFunction,
<a name="l02498"></a>02498                           <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02499"></a>02499     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l02500"></a>02500       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02501"></a>02501      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02502"></a>02502       free(temp_const);
<a name="l02503"></a>02503       free(temp_vars);
<a name="l02504"></a>02504       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02505"></a>02505       <span class="keywordflow">return</span> rc;
<a name="l02506"></a>02506     }
<a name="l02507"></a>02507   }
<a name="l02508"></a>02508     
<a name="l02509"></a>02509   free(temp_const);
<a name="l02510"></a>02510 
<a name="l02511"></a>02511   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02512"></a>02512   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02513"></a>02513                          new_seq_var_name, new_seq_var);
<a name="l02514"></a>02514   free(temp_vars);
<a name="l02515"></a>02515   <span class="keywordflow">return</span> rc;
<a name="l02516"></a>02516 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g52ec8e4997f8ac579953ac2f4ef152e1"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionSeqVarConst" ref="g52ec8e4997f8ac579953ac2f4ef152e1" args="(int numStep, FC_Variable *seq_var, int constNumComp, double *constValues, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionSeqVarConst           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>constValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a seqVar and a constant. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new sequence variable whose values are the results of the function applied to each value and component of the sequence variable and the constant. This is the sequence variable version of the varBinaryFunctionVarConst.<p>
The sequence variable and constant must have the same number of components.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the sequence variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>03/01/2007 CDU Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var</em>&nbsp;</td><td>
input - sequence variable </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constant </td></tr>
<tr><td valign="top"><em>constValues</em>&nbsp;</td><td>
input - values of constant </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02546">2546</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01801">fc_varBinaryFunctionVarConst()</a>.<div class="fragment"><pre class="fragment"><a name="l02556"></a>02556  {
<a name="l02557"></a>02557   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02558"></a>02558   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02559"></a>02559   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02560"></a>02560   <span class="keywordtype">int</span> i, j;
<a name="l02561"></a>02561 
<a name="l02562"></a>02562   <span class="comment">// default return</span>
<a name="l02563"></a>02563   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02564"></a>02564     *new_seq_var = NULL;
<a name="l02565"></a>02565 
<a name="l02566"></a>02566   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l02567"></a>02567   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var)) ||
<a name="l02568"></a>02568       (constNumComp &lt; 1) || (constValues==NULL)  ||
<a name="l02569"></a>02569       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02570"></a>02570     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02571"></a>02571     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02572"></a>02572   }
<a name="l02573"></a>02573   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02574"></a>02574 
<a name="l02575"></a>02575   <span class="comment">// log message</span>
<a name="l02576"></a>02576   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionSeqVarConst on"</span>
<a name="l02577"></a>02577                 <span class="stringliteral">"seq variable '%s' and a constant"</span>,
<a name="l02578"></a>02578                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var[0])-&gt;header.name);
<a name="l02579"></a>02579 
<a name="l02580"></a>02580   <span class="comment">// get info</span>
<a name="l02581"></a>02581   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var,&amp;seq);
<a name="l02582"></a>02582   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02583"></a>02583     <span class="keywordflow">return</span> rc;
<a name="l02584"></a>02584  
<a name="l02585"></a>02585   <span class="comment">// Make space to save temp_vars</span>
<a name="l02586"></a>02586   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02587"></a>02587   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02588"></a>02588     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02589"></a>02589     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02590"></a>02590   }
<a name="l02591"></a>02591 
<a name="l02592"></a>02592   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02593"></a>02593   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02594"></a>02594     rc = <a class="code" href="group__VariableMath.html#gc734bc45c302fc3bee946dc5c938088f">fc_varBinaryFunctionVarConst</a>(seq_var[i], 
<a name="l02595"></a>02595                           constNumComp, constValues,
<a name="l02596"></a>02596                           binaryFunction,
<a name="l02597"></a>02597                           <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02598"></a>02598     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l02599"></a>02599       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02600"></a>02600      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02601"></a>02601       free(temp_vars);
<a name="l02602"></a>02602       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02603"></a>02603       <span class="keywordflow">return</span> rc;
<a name="l02604"></a>02604     }
<a name="l02605"></a>02605   }
<a name="l02606"></a>02606 
<a name="l02607"></a>02607   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02608"></a>02608   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02609"></a>02609                          new_seq_var_name, new_seq_var);
<a name="l02610"></a>02610   free(temp_vars);
<a name="l02611"></a>02611   <span class="keywordflow">return</span> rc;
<a name="l02612"></a>02612 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2b769d43b8ef47db4e03d9791de09586"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionSeqVarSeqConst" ref="g2b769d43b8ef47db4e03d9791de09586" args="(int numStep, FC_Variable *seq_var, int constNumComp, void *constVectors, FC_DataType constType, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionSeqVarSeqConst           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a seqVar and seqConstant. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new sequence variable whose values are the results of the function applied to each value and component of the input sequence variable and the input sequence constant. This is the sequence variable version of the varBinaryFunctionVarConst.<p>
The seqVariable and seqConstant must have the same number of components, as well as the same number of steps.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the sequence variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>03/01/2007 CDU Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var</em>&nbsp;</td><td>
input - seq var1 </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constant </td></tr>
<tr><td valign="top"><em>constVectors</em>&nbsp;</td><td>
input - constant vectors, stored as vector for first step, then vector for next step, etc. </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02284">2284</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01801">fc_varBinaryFunctionVarConst()</a>.<div class="fragment"><pre class="fragment"><a name="l02297"></a>02297  {
<a name="l02298"></a>02298   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02299"></a>02299   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02300"></a>02300   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02301"></a>02301   <span class="keywordtype">double</span> *temp_const;
<a name="l02302"></a>02302   <span class="keywordtype">int</span> i, j;
<a name="l02303"></a>02303 
<a name="l02304"></a>02304   <span class="comment">// default return</span>
<a name="l02305"></a>02305   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02306"></a>02306     *new_seq_var = NULL;
<a name="l02307"></a>02307 
<a name="l02308"></a>02308   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l02309"></a>02309   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var)) ||
<a name="l02310"></a>02310       (constNumComp &lt; 1) || (constVectors==NULL)  || 
<a name="l02311"></a>02311       (!<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType)) || (constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>) ||
<a name="l02312"></a>02312       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02313"></a>02313     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02314"></a>02314     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02315"></a>02315   }
<a name="l02316"></a>02316   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02317"></a>02317 
<a name="l02318"></a>02318   <span class="comment">// log message</span>
<a name="l02319"></a>02319   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionSeqVarSeqConst on"</span>
<a name="l02320"></a>02320                 <span class="stringliteral">"seq variable '%s' and a constant"</span>,
<a name="l02321"></a>02321                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var[0])-&gt;header.name);
<a name="l02322"></a>02322 
<a name="l02323"></a>02323   <span class="comment">// get info</span>
<a name="l02324"></a>02324   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var,&amp;seq);
<a name="l02325"></a>02325   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02326"></a>02326     <span class="keywordflow">return</span> rc;
<a name="l02327"></a>02327  
<a name="l02328"></a>02328   <span class="comment">// Make space to save temp_vars</span>
<a name="l02329"></a>02329   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02330"></a>02330   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02331"></a>02331     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02332"></a>02332     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02333"></a>02333   }
<a name="l02334"></a>02334 
<a name="l02335"></a>02335   <span class="comment">// Convert the constant to double</span>
<a name="l02336"></a>02336   temp_const = malloc(constNumComp * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));  
<a name="l02337"></a>02337   <span class="keywordflow">if</span>(!temp_const){
<a name="l02338"></a>02338     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02339"></a>02339     free(temp_vars);
<a name="l02340"></a>02340     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02341"></a>02341   }
<a name="l02342"></a>02342 
<a name="l02343"></a>02343   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02344"></a>02344   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02345"></a>02345 
<a name="l02346"></a>02346     <span class="comment">//Convert this step of the constVector</span>
<a name="l02347"></a>02347     <span class="keywordflow">for</span>(j=0;j&lt;constNumComp;j++){
<a name="l02348"></a>02348       <span class="keywordflow">switch</span>(constType){
<a name="l02349"></a>02349       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>:
<a name="l02350"></a>02350      temp_const[j] = (<span class="keywordtype">double</span>) ((<span class="keywordtype">char</span>  *)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02351"></a>02351       <span class="keywordflow">case</span>  <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l02352"></a>02352      temp_const[j] = (double) ((<span class="keywordtype">int</span>   *)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02353"></a>02353       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l02354"></a>02354      temp_const[j] = (double) ((<span class="keywordtype">float</span> *)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02355"></a>02355       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l02356"></a>02356      temp_const[j] = (double) ((<span class="keywordtype">double</span>*)constVectors)[i*constNumComp+j]; <span class="keywordflow">break</span>;
<a name="l02357"></a>02357       <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>:
<a name="l02358"></a>02358      <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"should never get here"</span>);
<a name="l02359"></a>02359      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l02360"></a>02360       }
<a name="l02361"></a>02361     }
<a name="l02362"></a>02362 
<a name="l02363"></a>02363     <span class="comment">//Make the actual call</span>
<a name="l02364"></a>02364     rc = <a class="code" href="group__VariableMath.html#gc734bc45c302fc3bee946dc5c938088f">fc_varBinaryFunctionVarConst</a>(seq_var[i], 
<a name="l02365"></a>02365                           constNumComp, temp_const,
<a name="l02366"></a>02366                           binaryFunction,
<a name="l02367"></a>02367                           <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02368"></a>02368     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l02369"></a>02369       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02370"></a>02370      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02371"></a>02371       free(temp_const);
<a name="l02372"></a>02372       free(temp_vars);
<a name="l02373"></a>02373       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02374"></a>02374       <span class="keywordflow">return</span> rc;
<a name="l02375"></a>02375     }
<a name="l02376"></a>02376   }
<a name="l02377"></a>02377     
<a name="l02378"></a>02378   free(temp_const);
<a name="l02379"></a>02379 
<a name="l02380"></a>02380   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02381"></a>02381   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02382"></a>02382                          new_seq_var_name, new_seq_var);
<a name="l02383"></a>02383   free(temp_vars);
<a name="l02384"></a>02384   <span class="keywordflow">return</span> rc;
<a name="l02385"></a>02385 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g0ebb6d6f7f185c1e6fd219f52b6c184e"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionSeqVarSeqVar" ref="g0ebb6d6f7f185c1e6fd219f52b6c184e" args="(int numStep, FC_Variable *seq_var1, FC_Variable *seq_var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionSeqVarSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on two seq variables. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a newseq variable whose values are the results of the function applied to the original seq variables' values. This is the seq var version of varBinaryFunctionVarVar.<p>
The two variables must have the same number of data points and the same number of components and be on the same sequence.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the first variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>06/07/05 ACG Created.</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var1</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>seq_var2</em>&nbsp;</td><td>
input seq var2 </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02179">2179</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01611">fc_varBinaryFunctionVarVar()</a>.<div class="fragment"><pre class="fragment"><a name="l02188"></a>02188  {
<a name="l02189"></a>02189   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02190"></a>02190   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq1, seq2;
<a name="l02191"></a>02191   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02192"></a>02192   <span class="keywordtype">int</span> i, j;
<a name="l02193"></a>02193 
<a name="l02194"></a>02194   <span class="comment">// default return</span>
<a name="l02195"></a>02195   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02196"></a>02196     *new_seq_var = NULL;
<a name="l02197"></a>02197 
<a name="l02198"></a>02198   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l02199"></a>02199   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var1)) ||
<a name="l02200"></a>02200       (!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var2)) ||
<a name="l02201"></a>02201       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02202"></a>02202     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02203"></a>02203     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02204"></a>02204   }
<a name="l02205"></a>02205   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02206"></a>02206 
<a name="l02207"></a>02207   <span class="comment">// log message</span>
<a name="l02208"></a>02208   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionSeqVarSeqVar on"</span>
<a name="l02209"></a>02209                 <span class="stringliteral">"seq variables '%s' and  '%s'"</span>,
<a name="l02210"></a>02210                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var1[0])-&gt;header.name,
<a name="l02211"></a>02211                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var2[0])-&gt;header.name);
<a name="l02212"></a>02212 
<a name="l02213"></a>02213 
<a name="l02214"></a>02214 
<a name="l02215"></a>02215   <span class="comment">// get info</span>
<a name="l02216"></a>02216   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var1,&amp;seq1);
<a name="l02217"></a>02217   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02218"></a>02218     <span class="keywordflow">return</span> rc;
<a name="l02219"></a>02219   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var2,&amp;seq2);
<a name="l02220"></a>02220   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02221"></a>02221     <span class="keywordflow">return</span> rc;
<a name="l02222"></a>02222   <span class="comment">// FIX? remove this?</span>
<a name="l02223"></a>02223   <span class="keywordflow">if</span> (!(<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(seq1,seq2))){
<a name="l02224"></a>02224     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Variables are not on the same sequence"</span>);
<a name="l02225"></a>02225     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02226"></a>02226   }
<a name="l02227"></a>02227  
<a name="l02228"></a>02228   <span class="comment">// Make space to save temp_vars</span>
<a name="l02229"></a>02229   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02230"></a>02230   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02231"></a>02231     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02232"></a>02232     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02233"></a>02233   }
<a name="l02234"></a>02234 
<a name="l02235"></a>02235   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02236"></a>02236   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02237"></a>02237     rc = <a class="code" href="group__VariableMath.html#g7a7fd46e48d01ee29209c49268982f89">fc_varBinaryFunctionVarVar</a>(seq_var1[i], seq_var2[i], binaryFunction,
<a name="l02238"></a>02238                         <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02239"></a>02239     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l02240"></a>02240       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02241"></a>02241      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02242"></a>02242       free(temp_vars);
<a name="l02243"></a>02243       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02244"></a>02244       <span class="keywordflow">return</span> rc;
<a name="l02245"></a>02245     }
<a name="l02246"></a>02246   }
<a name="l02247"></a>02247 
<a name="l02248"></a>02248   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02249"></a>02249   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq1,
<a name="l02250"></a>02250                          new_seq_var_name, new_seq_var);
<a name="l02251"></a>02251   free(temp_vars);
<a name="l02252"></a>02252   <span class="keywordflow">return</span> rc;
<a name="l02253"></a>02253 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfe3766448bf4f55c6057a9e312be113a"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionSeqVarVar" ref="gfe3766448bf4f55c6057a9e312be113a" args="(int numStep, FC_Variable *seq_var1, FC_Variable var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionSeqVarVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a seq variable and a var. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a newseq variable whose values are the results of the function applied to the original seq variable and a normal variable's values.<p>
The two variables must have the same number of data points and the same number of components.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the first variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>06/08/05 ACG Created.</li><li>06/09/05 ACG renamed for seqvarBFvarseqvar to seqvarBFseqvarvar in order to agre with naming convention that for functions the first identifier is the return type.</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var1</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>var2</em>&nbsp;</td><td>
input var2 </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02742">2742</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01611">fc_varBinaryFunctionVarVar()</a>.<div class="fragment"><pre class="fragment"><a name="l02751"></a>02751  {
<a name="l02752"></a>02752   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02753"></a>02753   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02754"></a>02754   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02755"></a>02755   <span class="keywordtype">int</span> i, j;
<a name="l02756"></a>02756 
<a name="l02757"></a>02757   <span class="comment">// default return</span>
<a name="l02758"></a>02758   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02759"></a>02759     *new_seq_var = NULL;
<a name="l02760"></a>02760 
<a name="l02761"></a>02761   <span class="comment">// check input</span>
<a name="l02762"></a>02762   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var1)) ||
<a name="l02763"></a>02763       (!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var2)) ||
<a name="l02764"></a>02764       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02765"></a>02765     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02766"></a>02766     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02767"></a>02767   }
<a name="l02768"></a>02768   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02769"></a>02769 
<a name="l02770"></a>02770   <span class="comment">// log message</span>
<a name="l02771"></a>02771   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionSeqVarVar on"</span>
<a name="l02772"></a>02772                 <span class="stringliteral">"seq variable '%s' and  variable '%s'"</span>,
<a name="l02773"></a>02773                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var1[0])-&gt;header.name,
<a name="l02774"></a>02774                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var2)-&gt;header.name);
<a name="l02775"></a>02775 
<a name="l02776"></a>02776   <span class="comment">//get info </span>
<a name="l02777"></a>02777   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var1, &amp;seq);
<a name="l02778"></a>02778   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02779"></a>02779     <span class="keywordflow">return</span> rc;
<a name="l02780"></a>02780 
<a name="l02781"></a>02781   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02782"></a>02782   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02783"></a>02783     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02784"></a>02784     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02785"></a>02785   }
<a name="l02786"></a>02786 
<a name="l02787"></a>02787   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02788"></a>02788   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02789"></a>02789     rc = <a class="code" href="group__VariableMath.html#g7a7fd46e48d01ee29209c49268982f89">fc_varBinaryFunctionVarVar</a>(seq_var1[i], var2, binaryFunction,
<a name="l02790"></a>02790                         <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02791"></a>02791     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l02792"></a>02792       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02793"></a>02793      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02794"></a>02794       free(temp_vars);
<a name="l02795"></a>02795       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02796"></a>02796       <span class="keywordflow">return</span> rc;
<a name="l02797"></a>02797     }
<a name="l02798"></a>02798   }
<a name="l02799"></a>02799 
<a name="l02800"></a>02800   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02801"></a>02801   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02802"></a>02802                          new_seq_var_name, new_seq_var);
<a name="l02803"></a>02803   free(temp_vars);
<a name="l02804"></a>02804   <span class="keywordflow">return</span> rc;
<a name="l02805"></a>02805 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g58ae973cb45e1ee09db60b2697a64197"></a><!-- doxytag: member="varmath.c::fc_seqVarBinaryFunctionVarSeqVar" ref="g58ae973cb45e1ee09db60b2697a64197" args="(FC_Variable var1, int numStep, FC_Variable *seq_var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarBinaryFunctionVarSeqVar           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a seq variable and a var. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a newseq variable whose values are the results of the function applied to the original seq variable and a normal variable's values.<p>
The two variables must have the same number of data points and the same number of components.<p>
The new variable will be on the same mesh and sequence and will have the same association and math type as the first variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>06/08/05 ACG Created.</li><li>06/09/05 ACG renamed for seqvarBFvarseqvar to seqvarBFseqvarvar in order to agre with naming convention that for functions the first identifier is the return type.</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var1</em>&nbsp;</td><td>
input var1 </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var2</em>&nbsp;</td><td>
input seq var2 </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02835">2835</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01611">fc_varBinaryFunctionVarVar()</a>.<div class="fragment"><pre class="fragment"><a name="l02844"></a>02844  {
<a name="l02845"></a>02845   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02846"></a>02846   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02847"></a>02847   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02848"></a>02848   <span class="keywordtype">int</span> i, j;
<a name="l02849"></a>02849 
<a name="l02850"></a>02850   <span class="comment">// default return</span>
<a name="l02851"></a>02851   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02852"></a>02852     *new_seq_var = NULL;
<a name="l02853"></a>02853 
<a name="l02854"></a>02854   <span class="comment">// check input</span>
<a name="l02855"></a>02855   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var1)) ||
<a name="l02856"></a>02856       (!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var2)) ||
<a name="l02857"></a>02857       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l02858"></a>02858     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02859"></a>02859     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02860"></a>02860   }
<a name="l02861"></a>02861   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l02862"></a>02862 
<a name="l02863"></a>02863   <span class="comment">// log message</span>
<a name="l02864"></a>02864   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarBinaryFunctionSeqVarVar on"</span>
<a name="l02865"></a>02865                 <span class="stringliteral">"seq variable '%s' and  variable '%s'"</span>,
<a name="l02866"></a>02866                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var1)-&gt;header.name,
<a name="l02867"></a>02867                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var2[0])-&gt;header.name);
<a name="l02868"></a>02868 
<a name="l02869"></a>02869   <span class="comment">//get info </span>
<a name="l02870"></a>02870   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var2, &amp;seq);
<a name="l02871"></a>02871   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02872"></a>02872     <span class="keywordflow">return</span> rc;
<a name="l02873"></a>02873 
<a name="l02874"></a>02874   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02875"></a>02875   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02876"></a>02876     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02877"></a>02877     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02878"></a>02878   }
<a name="l02879"></a>02879 
<a name="l02880"></a>02880   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02881"></a>02881   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02882"></a>02882     rc = <a class="code" href="group__VariableMath.html#g7a7fd46e48d01ee29209c49268982f89">fc_varBinaryFunctionVarVar</a>(var1, seq_var2[i], binaryFunction,
<a name="l02883"></a>02883                         <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l02884"></a>02884     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l02885"></a>02885       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02886"></a>02886      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02887"></a>02887       free(temp_vars);
<a name="l02888"></a>02888       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02889"></a>02889       <span class="keywordflow">return</span> rc;
<a name="l02890"></a>02890     }
<a name="l02891"></a>02891   }
<a name="l02892"></a>02892 
<a name="l02893"></a>02893   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02894"></a>02894   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02895"></a>02895                          new_seq_var_name, new_seq_var);
<a name="l02896"></a>02896   free(temp_vars);
<a name="l02897"></a>02897   <span class="keywordflow">return</span> rc;
<a name="l02898"></a>02898 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gace4d175be16d1182c4b9131fb4abc74"></a><!-- doxytag: member="varmath.c::fc_seqVarOperatorConst" ref="gace4d175be16d1182c4b9131fb4abc74" args="(int numStep, FC_Variable *seq_var1, char *operation, int constNumComp, void *constVector, FC_DataType constType, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarOperatorConst           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a seq variable and constant. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation between a given seq variable and a constant applied at each sequence step.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var + const </code></li><li><code> "-" =&gt; var - const </code></li><li><code> "*" =&gt; var * const </code></li><li><code> "/" =&gt; var / const </code></li></ul>
<p>
The seq variable and the constant must have the same number of components.<p>
The seq new variable will be on the same mesh and sequence and will have the same association and mathtype as the seq variable. The operation is performed per component at each sequence step.<p>
If both original variables have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>11/20/2006 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var1</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constVector </td></tr>
<tr><td valign="top"><em>constVector</em>&nbsp;</td><td>
input - constant vector </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01296">1296</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l00481">fc_varOperatorConst()</a>.
<p>
Referenced by <a class="el" href="varNormalize_8c-source.html#l00196">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01305"></a>01305   {   
<a name="l01306"></a>01306   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01307"></a>01307   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l01308"></a>01308   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l01309"></a>01309   <span class="keywordtype">int</span> i, j;
<a name="l01310"></a>01310 
<a name="l01311"></a>01311   <span class="comment">// default return</span>
<a name="l01312"></a>01312   <span class="keywordflow">if</span> (new_seq_var)
<a name="l01313"></a>01313     *new_seq_var = NULL;
<a name="l01314"></a>01314 
<a name="l01315"></a>01315   <span class="comment">// check input</span>
<a name="l01316"></a>01316   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var1)) || !operation ||
<a name="l01317"></a>01317       constNumComp &lt; 1 || !constVector || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType) ||
<a name="l01318"></a>01318       constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> ||
<a name="l01319"></a>01319       (new_seq_var == NULL) || new_seq_var_name == NULL) {
<a name="l01320"></a>01320     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01321"></a>01321     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01322"></a>01322   }
<a name="l01323"></a>01323   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l01324"></a>01324 
<a name="l01325"></a>01325   <span class="comment">// log message</span>
<a name="l01326"></a>01326   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation '%s' on seq variable '%s'"</span>,
<a name="l01327"></a>01327                       operation, 
<a name="l01328"></a>01328                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var1[0])-&gt;header.name);
<a name="l01329"></a>01329 
<a name="l01330"></a>01330   <span class="comment">// Get info</span>
<a name="l01331"></a>01331   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var1, &amp;seq);
<a name="l01332"></a>01332   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01333"></a>01333     <span class="keywordflow">return</span> rc;
<a name="l01334"></a>01334 
<a name="l01335"></a>01335   <span class="comment">// Make space to save temp_vars</span>
<a name="l01336"></a>01336   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l01337"></a>01337   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l01338"></a>01338     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01339"></a>01339     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01340"></a>01340   }
<a name="l01341"></a>01341 
<a name="l01342"></a>01342   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l01343"></a>01343   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01344"></a>01344     rc = <a class="code" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst</a>(seq_var1[i], operation, constNumComp, 
<a name="l01345"></a>01345                              constVector, constType,
<a name="l01346"></a>01346                              <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l01347"></a>01347     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l01348"></a>01348       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l01349"></a>01349      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l01350"></a>01350       free(temp_vars);
<a name="l01351"></a>01351       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l01352"></a>01352       <span class="keywordflow">return</span> rc;
<a name="l01353"></a>01353     }
<a name="l01354"></a>01354   }
<a name="l01355"></a>01355 
<a name="l01356"></a>01356   <span class="comment">// stitch steps into the new seq var</span>
<a name="l01357"></a>01357   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l01358"></a>01358                          new_seq_var_name, new_seq_var);
<a name="l01359"></a>01359   free(temp_vars);
<a name="l01360"></a>01360   <span class="keywordflow">return</span> rc;
<a name="l01361"></a>01361 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd81ceef16fe52226fc581552a133ea31"></a><!-- doxytag: member="varmath.c::fc_seqVarOperatorSeqConst" ref="gd81ceef16fe52226fc581552a133ea31" args="(int numStep, FC_Variable *seq_var1, char *operation, int constNumComp, void *constVectors, FC_DataType constType, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarOperatorSeqConst           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a seq variable a seq of constants. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation performed on the the given seq of constants. Use <a class="el" href="group__VariableMath.html#gef3e37a79067c13d21fc25264ff145e4">fc_seqConstOperatorSeqVar()</a> to apply the operation in the reverse order.<p>
This is the seq var version of <a class="el" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst()</a> where a different constant vector is applied to each step of the sequence variable. The constant values should be an array with all components for the first step first, then all components for the next step, etc. If you would like to apply the same constant to all steps, use <a class="el" href="group__VariableMath.html#gace4d175be16d1182c4b9131fb4abc74">fc_seqVarOperatorConst()</a>.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var + const </code></li><li><code> "-" =&gt; var - const </code></li><li><code> "*" =&gt; var * const </code></li><li><code> "/" =&gt; var / const </code></li></ul>
<p>
The seq variable and the constants must have the same number components.<p>
The seq new variable will be on the same mesh and have the same association and mathtype as the seq variable. The operation is performed per component and data point at each sequence step.<p>
If both the original variable and the constants have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>11/20/2006 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var and const </td></tr>
<tr><td valign="top"><em>seq_var1</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constVector </td></tr>
<tr><td valign="top"><em>constVectors</em>&nbsp;</td><td>
input - constant vectors, stored as vector for first step, then vector for next step, etc. </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00858">858</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l00481">fc_varOperatorConst()</a>.
<p>
Referenced by <a class="el" href="varNormalize_8c-source.html#l00196">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00868"></a>00868   {   
<a name="l00869"></a>00869   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00870"></a>00870   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l00871"></a>00871   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l00872"></a>00872   <span class="keywordtype">int</span> i, j;
<a name="l00873"></a>00873 
<a name="l00874"></a>00874   <span class="comment">// default return</span>
<a name="l00875"></a>00875   <span class="keywordflow">if</span> (new_seq_var)
<a name="l00876"></a>00876     *new_seq_var = NULL;
<a name="l00877"></a>00877 
<a name="l00878"></a>00878   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l00879"></a>00879   <span class="keywordflow">if</span> (!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var1) || !operation || 
<a name="l00880"></a>00880       constNumComp &lt; 1 || !constVectors || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType) ||
<a name="l00881"></a>00881       constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || new_seq_var_name == NULL ||
<a name="l00882"></a>00882       new_seq_var == NULL) {
<a name="l00883"></a>00883     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00884"></a>00884     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00885"></a>00885   }
<a name="l00886"></a>00886   <span class="comment">//other checks are done internally in varoperatorconst</span>
<a name="l00887"></a>00887 
<a name="l00888"></a>00888   <span class="comment">// log message</span>
<a name="l00889"></a>00889   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarOperatorSeqConst '%s' with"</span>
<a name="l00890"></a>00890                 <span class="stringliteral">"seq variable '%s'"</span>, operation,
<a name="l00891"></a>00891                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var1[0])-&gt;header.name);
<a name="l00892"></a>00892 
<a name="l00893"></a>00893   <span class="comment">// get info</span>
<a name="l00894"></a>00894   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var1, &amp;seq);
<a name="l00895"></a>00895   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00896"></a>00896     <span class="keywordflow">return</span> rc;
<a name="l00897"></a>00897 
<a name="l00898"></a>00898   <span class="comment">// Make space to save temp_vars</span>
<a name="l00899"></a>00899   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l00900"></a>00900   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l00901"></a>00901     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l00902"></a>00902     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00903"></a>00903   }
<a name="l00904"></a>00904 
<a name="l00905"></a>00905   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l00906"></a>00906   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00907"></a>00907     <span class="keywordtype">void</span>* temp_constVector;
<a name="l00908"></a>00908     <span class="keywordflow">switch</span>(constType) {
<a name="l00909"></a>00909     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>:
<a name="l00910"></a>00910       temp_constVector = &amp;((<span class="keywordtype">char</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l00911"></a>00911     <span class="keywordflow">case</span>  <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: 
<a name="l00912"></a>00912       temp_constVector = &amp;((<span class="keywordtype">int</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l00913"></a>00913     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:
<a name="l00914"></a>00914       temp_constVector = &amp;((<span class="keywordtype">float</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l00915"></a>00915     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:
<a name="l00916"></a>00916       temp_constVector = &amp;((<span class="keywordtype">double</span>*)constVectors)[i*constNumComp]; <span class="keywordflow">break</span>;
<a name="l00917"></a>00917     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>:
<a name="l00918"></a>00918       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"should never get here"</span>);
<a name="l00919"></a>00919       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l00920"></a>00920     }
<a name="l00921"></a>00921     rc = <a class="code" href="group__VariableMath.html#gd8da3c1657c0158566a30a848f76ae59">fc_varOperatorConst</a>(seq_var1[i], operation, constNumComp, 
<a name="l00922"></a>00922                             temp_constVector, constType,
<a name="l00923"></a>00923                              <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]); 
<a name="l00924"></a>00924     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l00925"></a>00925       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l00926"></a>00926      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l00927"></a>00927       free(temp_vars);
<a name="l00928"></a>00928       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l00929"></a>00929       <span class="keywordflow">return</span> rc;
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931   }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933   <span class="comment">// stitch steps into the new seq var</span>
<a name="l00934"></a>00934   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l00935"></a>00935                          new_seq_var_name, new_seq_var);
<a name="l00936"></a>00936   free(temp_vars);
<a name="l00937"></a>00937   <span class="keywordflow">return</span> rc;
<a name="l00938"></a>00938 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2d2ca15323837c8b87f4eba089e5153a"></a><!-- doxytag: member="varmath.c::fc_seqVarOperatorSeqVar" ref="g2d2ca15323837c8b87f4eba089e5153a" args="(int numStep, FC_Variable *seq_var1, char *operation, FC_Variable *seq_var2, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarOperatorSeqVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on two seq variables. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation performed on the the given seq variables. This is the seq var version of fc_varOperatorVar.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var1 + var2 </code></li><li><code> "-" =&gt; var1 - var2 </code></li><li><code> "*" =&gt; var1 * var2 </code></li><li><code> "/" =&gt; var1 / var2 </code></li></ul>
<p>
The two seq variables must have the same number of data points and the same number of components and be on the same sequence.<p>
The seq new variable will be on the same mesh and have the same association and mathtype as the first variable. The operation is performed per component and data point at each sequence step.<p>
If both original variables have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>06/07/05 ACG Created.</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var1</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>seq_var2</em>&nbsp;</td><td>
input seq var2 </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00747">747</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l00386">fc_varOperatorVar()</a>.
<p>
Referenced by <a class="el" href="series_8c-source.html#l03021">fc_dimensionlessAreaBetweenCurves()</a>, and <a class="el" href="series_8c-source.html#l02844">fc_euclideanDistanceBetweenCurves()</a>.<div class="fragment"><pre class="fragment"><a name="l00754"></a>00754   {   
<a name="l00755"></a>00755   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00756"></a>00756   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq1, seq2;
<a name="l00757"></a>00757   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l00758"></a>00758   <span class="keywordtype">int</span> i, j;
<a name="l00759"></a>00759 
<a name="l00760"></a>00760   <span class="comment">// default return</span>
<a name="l00761"></a>00761   <span class="keywordflow">if</span> (new_seq_var)
<a name="l00762"></a>00762     *new_seq_var = NULL;
<a name="l00763"></a>00763 
<a name="l00764"></a>00764   <span class="comment">// check input (this indirectly checks that numStep is the same on both seqs</span>
<a name="l00765"></a>00765   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var1)) ||
<a name="l00766"></a>00766       (!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var2)) ||
<a name="l00767"></a>00767       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l00768"></a>00768     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00769"></a>00769     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00770"></a>00770   }
<a name="l00771"></a>00771   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l00772"></a>00772 
<a name="l00773"></a>00773   <span class="comment">// log message</span>
<a name="l00774"></a>00774   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing SeqVarOperatorSeqVar '%s' on"</span>
<a name="l00775"></a>00775                 <span class="stringliteral">"seq variables '%s' and '%s'"</span>, operation,
<a name="l00776"></a>00776                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var1[0])-&gt;header.name,
<a name="l00777"></a>00777                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var2[0])-&gt;header.name);
<a name="l00778"></a>00778 
<a name="l00779"></a>00779   <span class="comment">// get info</span>
<a name="l00780"></a>00780   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var1,&amp;seq1);
<a name="l00781"></a>00781   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00782"></a>00782     <span class="keywordflow">return</span> rc;
<a name="l00783"></a>00783   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var2,&amp;seq2);
<a name="l00784"></a>00784   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00785"></a>00785     <span class="keywordflow">return</span> rc;
<a name="l00786"></a>00786   <span class="comment">// FIX? remove this?</span>
<a name="l00787"></a>00787   <span class="keywordflow">if</span> (!(<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(seq1,seq2))){
<a name="l00788"></a>00788     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <span class="stringliteral">"Variables are not on the same sequence"</span>);
<a name="l00789"></a>00789     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00790"></a>00790   }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792   <span class="comment">// Make space to save temp_vars</span>
<a name="l00793"></a>00793   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l00794"></a>00794   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l00795"></a>00795     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l00796"></a>00796     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00797"></a>00797   }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l00800"></a>00800   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00801"></a>00801     rc = <a class="code" href="group__VariableMath.html#g4bc1d027d0c58095361d5b4389a4739c">fc_varOperatorVar</a>(seq_var1[i], operation, seq_var2[i], <span class="stringliteral">"junk_var"</span>,
<a name="l00802"></a>00802                   &amp;temp_vars[i]); 
<a name="l00803"></a>00803     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l00804"></a>00804       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l00805"></a>00805      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l00806"></a>00806       free(temp_vars);
<a name="l00807"></a>00807       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l00808"></a>00808       <span class="keywordflow">return</span> rc;
<a name="l00809"></a>00809     }
<a name="l00810"></a>00810   }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812   <span class="comment">// stitch steps into the new seq var</span>
<a name="l00813"></a>00813   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq1,
<a name="l00814"></a>00814                          new_seq_var_name, new_seq_var);
<a name="l00815"></a>00815   free(temp_vars);
<a name="l00816"></a>00816   <span class="keywordflow">return</span> rc;
<a name="l00817"></a>00817 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd4a4af630d980cea143a0edbc4496f99"></a><!-- doxytag: member="varmath.c::fc_seqVarOperatorVar" ref="gd4a4af630d980cea143a0edbc4496f99" args="(int numStep, FC_Variable *seq_var1, char *operation, FC_Variable var2, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarOperatorVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a seq variable and a normal var. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation between a given seq variable and a normal var applied at each sequence step. For example, one can use this to scale a seqvar's values by their mean over the sequence (e.g., time).<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var1 + var2 </code></li><li><code> "-" =&gt; var1 - var2 </code></li><li><code> "*" =&gt; var1 * var2 </code></li><li><code> "/" =&gt; var1 / var2 </code></li></ul>
<p>
The two seq variable and the normal variable must have the same number of data points and the same number of components.<p>
The seq new variable will be on the same mesh and sequence and will have the same association and mathtype as the seq variable. The operation is performed per component and data point at each sequence step.<p>
If both original variables have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<ul>
<li>01/24/06 WSK Rewrote innards to mimimize data creation.</li></ul>
<p>
<b>Modifications:</b> <ul>
<li>06/07/05 ACG Created.</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var1</em>&nbsp;</td><td>
input seq var1 </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>var2</em>&nbsp;</td><td>
input var </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01101">1101</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l00386">fc_varOperatorVar()</a>.<div class="fragment"><pre class="fragment"><a name="l01108"></a>01108   {   
<a name="l01109"></a>01109   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01110"></a>01110   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l01111"></a>01111   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l01112"></a>01112   <span class="keywordtype">int</span> i, j;
<a name="l01113"></a>01113 
<a name="l01114"></a>01114   <span class="comment">// default return</span>
<a name="l01115"></a>01115   <span class="keywordflow">if</span> (new_seq_var)
<a name="l01116"></a>01116     *new_seq_var = NULL;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118   <span class="comment">// check input</span>
<a name="l01119"></a>01119   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var1)) ||
<a name="l01120"></a>01120       (!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var2)) ||
<a name="l01121"></a>01121       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l01122"></a>01122     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01123"></a>01123     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01124"></a>01124   }
<a name="l01125"></a>01125   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l01126"></a>01126 
<a name="l01127"></a>01127   <span class="comment">// log message</span>
<a name="l01128"></a>01128   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation '%s' on seq variable '%s'"</span>
<a name="l01129"></a>01129                 <span class="stringliteral">" and variable '%s'"</span>, operation,
<a name="l01130"></a>01130                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var1[0])-&gt;header.name,
<a name="l01131"></a>01131                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var2)-&gt;header.name);
<a name="l01132"></a>01132 
<a name="l01133"></a>01133   <span class="comment">// Get info</span>
<a name="l01134"></a>01134   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var1, &amp;seq);
<a name="l01135"></a>01135   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01136"></a>01136     <span class="keywordflow">return</span> rc;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138   <span class="comment">// Make space to save temp_vars</span>
<a name="l01139"></a>01139   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l01140"></a>01140   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l01141"></a>01141     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01142"></a>01142     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01143"></a>01143   }
<a name="l01144"></a>01144 
<a name="l01145"></a>01145   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l01146"></a>01146   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01147"></a>01147     rc = <a class="code" href="group__VariableMath.html#g4bc1d027d0c58095361d5b4389a4739c">fc_varOperatorVar</a>(seq_var1[i], operation, var2, <span class="stringliteral">"junk_var"</span>,
<a name="l01148"></a>01148                   &amp;temp_vars[i]); 
<a name="l01149"></a>01149     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l01150"></a>01150       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l01151"></a>01151      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l01152"></a>01152       free(temp_vars);
<a name="l01153"></a>01153       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l01154"></a>01154       <span class="keywordflow">return</span> rc;
<a name="l01155"></a>01155     }
<a name="l01156"></a>01156   }
<a name="l01157"></a>01157 
<a name="l01158"></a>01158   <span class="comment">// stitch steps into the new seq var</span>
<a name="l01159"></a>01159   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l01160"></a>01160                          new_seq_var_name, new_seq_var);
<a name="l01161"></a>01161   free(temp_vars);
<a name="l01162"></a>01162   <span class="keywordflow">return</span> rc;
<a name="l01163"></a>01163 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gfa62b9975a3e0437aa8c8f98a146f2de"></a><!-- doxytag: member="varmath.c::fc_seqVarUnaryFunction" ref="gfa62b9975a3e0437aa8c8f98a146f2de" args="(int numStep, FC_Variable *seq_var, double(*unaryFunction)(double), char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_seqVarUnaryFunction           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double)&nbsp;</td>
          <td class="paramname"> <em>unaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs unary function on a seq variable. 
<p>
<b>Description:</b> <p>
Given a unary function that takes a double and returns a double, this function creates a new seq variable whose values are the results of the function applied to the original seq variable's values. This is the seqvar analogy of fc_varUnaryFunction<p>
The new seq variable will be on the same mesh and sequence as the original and will have the same association and math type as the original. The function is performed on each component of each data point at each sequence step. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
NOTE: this uses createSeqVariable so user will have to deleteSeqVariable *and* free it unless deleteseqvar is changed.<p>
<b>Modifications:</b> <ul>
<li>06/07/05 ACG Created.</li><li>06/07/05 ACG removing datatype check and leaving that to internal call</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var</em>&nbsp;</td><td>
input seq var </td></tr>
<tr><td valign="top"><em>unaryFunction</em>&nbsp;</td><td>
input - function that operates on a double and returns a double </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l02094">2094</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l01485">fc_varUnaryFunction()</a>.<div class="fragment"><pre class="fragment"><a name="l02102"></a>02102   {
<a name="l02103"></a>02103   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02104"></a>02104   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l02105"></a>02105   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l02106"></a>02106   <span class="keywordtype">int</span> i, j;
<a name="l02107"></a>02107   
<a name="l02108"></a>02108   <span class="comment">// check input</span>
<a name="l02109"></a>02109   <span class="keywordflow">if</span> (new_seq_var)
<a name="l02110"></a>02110     *new_seq_var = NULL;
<a name="l02111"></a>02111 
<a name="l02112"></a>02112   <span class="comment">// check input</span>
<a name="l02113"></a>02113   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep,seq_var)) || (new_seq_var == NULL)
<a name="l02114"></a>02114       || new_seq_var_name == NULL){
<a name="l02115"></a>02115     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02116"></a>02116     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02117"></a>02117   }
<a name="l02118"></a>02118   <span class="comment">//other checks are done internally in varUnaryFunction (incl numerical type),</span>
<a name="l02119"></a>02119 
<a name="l02120"></a>02120   <span class="comment">// log message</span>
<a name="l02121"></a>02121   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing UnaryFunctionSeqVar on seq variable '%s'"</span>,
<a name="l02122"></a>02122                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var[0])-&gt;header.name);
<a name="l02123"></a>02123 
<a name="l02124"></a>02124   <span class="comment">// Get info</span>
<a name="l02125"></a>02125   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep,seq_var,&amp;seq);
<a name="l02126"></a>02126   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02127"></a>02127     <span class="keywordflow">return</span> rc;
<a name="l02128"></a>02128 
<a name="l02129"></a>02129   <span class="comment">// Make space to save temp_vars</span>
<a name="l02130"></a>02130   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l02131"></a>02131   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l02132"></a>02132     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02133"></a>02133     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l02134"></a>02134   }
<a name="l02135"></a>02135   
<a name="l02136"></a>02136   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l02137"></a>02137   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l02138"></a>02138     rc = <a class="code" href="group__VariableMath.html#g84b3f6963472cbe8c79fe1d6c1c39640">fc_varUnaryFunction</a>(seq_var[i],unaryFunction, <span class="stringliteral">"junk_var"</span>, &amp;temp_vars[i]);
<a name="l02139"></a>02139     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l02140"></a>02140       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l02141"></a>02141      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l02142"></a>02142       free(temp_vars);
<a name="l02143"></a>02143       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l02144"></a>02144       <span class="keywordflow">return</span> rc;
<a name="l02145"></a>02145     }
<a name="l02146"></a>02146   }
<a name="l02147"></a>02147 
<a name="l02148"></a>02148   <span class="comment">// stitch steps into the new seq var</span>
<a name="l02149"></a>02149   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l02150"></a>02150                          new_seq_var_name, new_seq_var);
<a name="l02151"></a>02151   free(temp_vars);
<a name="l02152"></a>02152   <span class="keywordflow">return</span> rc;
<a name="l02153"></a>02153 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gff2ccc7579022d86a34fcbc204f59cb1"></a><!-- doxytag: member="varmath.c::fc_varBinaryFunctionConstVar" ref="gff2ccc7579022d86a34fcbc204f59cb1" args="(int constNumComp, double *constValues, FC_Variable var, double(*binaryFunction)(double, double), char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varBinaryFunctionConstVar           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>constValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double, double)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a constant and a variable. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new variable whose values are the results of the function applied with the constant to each data point of the variable. Use <a class="el" href="group__VariableMath.html#gff2ccc7579022d86a34fcbc204f59cb1">fc_varBinaryFunctionConstVar()</a> to apply the function in reverse order.<p>
The variable and the constant must have the same number of components.<p>
The new variable will be on the same mesh and will have the same association and math type as the variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>11/09/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constant </td></tr>
<tr><td valign="top"><em>constValues</em>&nbsp;</td><td>
input - the values of the constant </td></tr>
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01943">1943</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="base_8c-source.html#l00418">fc_getDataTypeText()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l02640">fc_seqVarBinaryFunctionConstSeqVar()</a>, and <a class="el" href="varmath_8c-source.html#l02414">fc_seqVarBinaryFunctionSeqConstSeqVar()</a>.<div class="fragment"><pre class="fragment"><a name="l01952"></a>01952  {
<a name="l01953"></a>01953   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01954"></a>01954   <span class="keywordtype">int</span> i, j;
<a name="l01955"></a>01955   <span class="keywordtype">int</span> numData, numComp;
<a name="l01956"></a>01956   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l01957"></a>01957   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l01958"></a>01958   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype; 
<a name="l01959"></a>01959   <span class="keywordtype">void</span> *data; 
<a name="l01960"></a>01960   <span class="keywordtype">double</span> *dblResultPtr;
<a name="l01961"></a>01961 
<a name="l01962"></a>01962   <span class="comment">// set default return value</span>
<a name="l01963"></a>01963   <span class="keywordflow">if</span> (new_var)
<a name="l01964"></a>01964     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l01965"></a>01965 
<a name="l01966"></a>01966   <span class="comment">// check input</span>
<a name="l01967"></a>01967   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var)) || constNumComp &lt; 1 || !constValues ||
<a name="l01968"></a>01968       !new_var_name || !new_var) {
<a name="l01969"></a>01969     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l01970"></a>01970     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01971"></a>01971   }
<a name="l01972"></a>01972   <span class="keywordflow">if</span> (!binaryFunction) {
<a name="l01973"></a>01973     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Function was not provided"</span>);      
<a name="l01974"></a>01974     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01975"></a>01975   }
<a name="l01976"></a>01976 
<a name="l01977"></a>01977   <span class="comment">// log message</span>
<a name="l01978"></a>01978   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing binary user operation on var = '%s' and "</span>
<a name="l01979"></a>01979            <span class="stringliteral">"a constant"</span> , <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var)-&gt;header.name);  
<a name="l01980"></a>01980 
<a name="l01981"></a>01981   <span class="comment">// get variable info</span>
<a name="l01982"></a>01982   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;numComp, &amp;assoc, 
<a name="l01983"></a>01983                  &amp;mathtype, &amp;datatype);
<a name="l01984"></a>01984   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01985"></a>01985     <span class="keywordflow">return</span> rc;
<a name="l01986"></a>01986 
<a name="l01987"></a>01987   <span class="comment">// check that variables and const are similar enough</span>
<a name="l01988"></a>01988   <span class="keywordflow">if</span> (numComp != constNumComp) {
<a name="l01989"></a>01989     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Variables and const do not have the same numComp"</span>);
<a name="l01990"></a>01990     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01991"></a>01991   }
<a name="l01992"></a>01992 
<a name="l01993"></a>01993   <span class="comment">// check that the datatype can be handled here</span>
<a name="l01994"></a>01994   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; 
<a name="l01995"></a>01995       datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01996"></a>01996     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"datatype '%s' cannot be handled"</span>,
<a name="l01997"></a>01997                  <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(datatype));
<a name="l01998"></a>01998     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01999"></a>01999   }
<a name="l02000"></a>02000 
<a name="l02001"></a>02001   <span class="comment">// get data</span>
<a name="l02002"></a>02002   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l02003"></a>02003   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02004"></a>02004     <span class="keywordflow">return</span> rc;
<a name="l02005"></a>02005 
<a name="l02006"></a>02006   <span class="comment">// calc values</span>
<a name="l02007"></a>02007   dblResultPtr = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData*numComp);
<a name="l02008"></a>02008   <span class="keywordflow">if</span> (dblResultPtr == NULL) {
<a name="l02009"></a>02009     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l02010"></a>02010     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;   
<a name="l02011"></a>02011   }
<a name="l02012"></a>02012   <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l02013"></a>02013     <span class="keywordtype">int</span>* cast_data = (<span class="keywordtype">int</span>*)data;
<a name="l02014"></a>02014     <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++)
<a name="l02015"></a>02015       <span class="keywordflow">for</span> (j = 0; j &lt; numComp; j++)
<a name="l02016"></a>02016      dblResultPtr[i*numComp+j] = (*binaryFunction)(constValues[j], 
<a name="l02017"></a>02017                                   cast_data[i*numComp+j]);
<a name="l02018"></a>02018   }
<a name="l02019"></a>02019   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l02020"></a>02020     <span class="keywordtype">float</span>* cast_data = (<span class="keywordtype">float</span>*)data;
<a name="l02021"></a>02021     <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++)
<a name="l02022"></a>02022       <span class="keywordflow">for</span> (j = 0; j &lt; numComp; j++)
<a name="l02023"></a>02023      dblResultPtr[i*numComp+j] = (*binaryFunction)(constValues[j], 
<a name="l02024"></a>02024                                   cast_data[i*numComp+j]);
<a name="l02025"></a>02025   }
<a name="l02026"></a>02026   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l02027"></a>02027     <span class="keywordtype">double</span>* cast_data = (<span class="keywordtype">double</span>*)data;
<a name="l02028"></a>02028     <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++)
<a name="l02029"></a>02029       <span class="keywordflow">for</span> (j = 0; j &lt; numComp; j++)
<a name="l02030"></a>02030      dblResultPtr[i*numComp+j] = (*binaryFunction)(constValues[j], 
<a name="l02031"></a>02031                                   cast_data[i*numComp+j]);
<a name="l02032"></a>02032   }
<a name="l02033"></a>02033   <span class="keywordflow">else</span> {
<a name="l02034"></a>02034     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Should never reach here, error in code!\n"</span>);
<a name="l02035"></a>02035     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l02036"></a>02036   }
<a name="l02037"></a>02037 
<a name="l02038"></a>02038   <span class="comment">// create the new variable</span>
<a name="l02039"></a>02039   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var)) {
<a name="l02040"></a>02040     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l02041"></a>02041     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(var, &amp;dataset);
<a name="l02042"></a>02042     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02043"></a>02043       <span class="keywordflow">return</span> rc;
<a name="l02044"></a>02044     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, new_var_name, new_var);
<a name="l02045"></a>02045     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02046"></a>02046       <span class="keywordflow">return</span> rc; 
<a name="l02047"></a>02047   }
<a name="l02048"></a>02048   <span class="keywordflow">else</span> {
<a name="l02049"></a>02049     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l02050"></a>02050     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(var, &amp;mesh);
<a name="l02051"></a>02051     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02052"></a>02052       <span class="keywordflow">return</span> rc;
<a name="l02053"></a>02053     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, new_var_name, new_var);
<a name="l02054"></a>02054     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02055"></a>02055       <span class="keywordflow">return</span> rc; 
<a name="l02056"></a>02056   }
<a name="l02057"></a>02057   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numData, numComp, assoc, mathtype, 
<a name="l02058"></a>02058                     <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, dblResultPtr);
<a name="l02059"></a>02059   <span class="keywordflow">return</span> rc;
<a name="l02060"></a>02060 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gc734bc45c302fc3bee946dc5c938088f"></a><!-- doxytag: member="varmath.c::fc_varBinaryFunctionVarConst" ref="gc734bc45c302fc3bee946dc5c938088f" args="(FC_Variable var, int constNumComp, double *constValues, double(*binaryFunction)(double, double), char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varBinaryFunctionVarConst           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>constValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double, double)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on a variable and a constant. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new variable whose values are the results of the function applied with the constant to each data point of the variable. Use <a class="el" href="group__VariableMath.html#gff2ccc7579022d86a34fcbc204f59cb1">fc_varBinaryFunctionConstVar()</a> to apply the function in reverse order.<p>
The variable and the constant must have the same number of components.<p>
The new variable will be on the same mesh and will have the same association and math type as the variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>11/09/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constant </td></tr>
<tr><td valign="top"><em>constValues</em>&nbsp;</td><td>
input - the values of the constant </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01801">1801</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="base_8c-source.html#l00418">fc_getDataTypeText()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l02546">fc_seqVarBinaryFunctionSeqVarConst()</a>, and <a class="el" href="varmath_8c-source.html#l02284">fc_seqVarBinaryFunctionSeqVarSeqConst()</a>.<div class="fragment"><pre class="fragment"><a name="l01810"></a>01810  {
<a name="l01811"></a>01811   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01812"></a>01812   <span class="keywordtype">int</span> i, j;
<a name="l01813"></a>01813   <span class="keywordtype">int</span> numData, numComp;
<a name="l01814"></a>01814   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l01815"></a>01815   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l01816"></a>01816   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype; 
<a name="l01817"></a>01817   <span class="keywordtype">void</span> *data; 
<a name="l01818"></a>01818   <span class="keywordtype">double</span> *dblResultPtr;
<a name="l01819"></a>01819 
<a name="l01820"></a>01820   <span class="comment">// set default return value</span>
<a name="l01821"></a>01821   <span class="keywordflow">if</span> (new_var)
<a name="l01822"></a>01822     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l01823"></a>01823 
<a name="l01824"></a>01824   <span class="comment">// check input</span>
<a name="l01825"></a>01825   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var)) || constNumComp &lt; 1 || !constValues ||
<a name="l01826"></a>01826       !new_var_name || !new_var) {
<a name="l01827"></a>01827     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l01828"></a>01828     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01829"></a>01829   }
<a name="l01830"></a>01830   <span class="keywordflow">if</span> (!binaryFunction) {
<a name="l01831"></a>01831     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Function was not provided"</span>);      
<a name="l01832"></a>01832     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01833"></a>01833   }
<a name="l01834"></a>01834 
<a name="l01835"></a>01835   <span class="comment">// log message</span>
<a name="l01836"></a>01836   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing binary user operation on var = '%s' and "</span>
<a name="l01837"></a>01837            <span class="stringliteral">"a constant"</span> , <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var)-&gt;header.name);  
<a name="l01838"></a>01838 
<a name="l01839"></a>01839   <span class="comment">// get variable info</span>
<a name="l01840"></a>01840   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;numComp, &amp;assoc, 
<a name="l01841"></a>01841                  &amp;mathtype, &amp;datatype);
<a name="l01842"></a>01842   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01843"></a>01843     <span class="keywordflow">return</span> rc;
<a name="l01844"></a>01844 
<a name="l01845"></a>01845   <span class="comment">// check that variables and const are similar enough</span>
<a name="l01846"></a>01846   <span class="keywordflow">if</span> (numComp != constNumComp) {
<a name="l01847"></a>01847     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Variables and const do not have the same numComp"</span>);
<a name="l01848"></a>01848     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01849"></a>01849   }
<a name="l01850"></a>01850 
<a name="l01851"></a>01851   <span class="comment">// check that the datatype can be handled here</span>
<a name="l01852"></a>01852   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; 
<a name="l01853"></a>01853       datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01854"></a>01854     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"datatype '%s' cannot be handled"</span>,
<a name="l01855"></a>01855                  <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(datatype));
<a name="l01856"></a>01856     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01857"></a>01857   }
<a name="l01858"></a>01858 
<a name="l01859"></a>01859   <span class="comment">// get data</span>
<a name="l01860"></a>01860   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l01861"></a>01861   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01862"></a>01862     <span class="keywordflow">return</span> rc;
<a name="l01863"></a>01863 
<a name="l01864"></a>01864   <span class="comment">// calc values</span>
<a name="l01865"></a>01865   dblResultPtr = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData*numComp);
<a name="l01866"></a>01866   <span class="keywordflow">if</span> (dblResultPtr == NULL) {
<a name="l01867"></a>01867     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01868"></a>01868     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;   
<a name="l01869"></a>01869   }
<a name="l01870"></a>01870   <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l01871"></a>01871     <span class="keywordtype">int</span>* cast_data = (<span class="keywordtype">int</span>*)data;
<a name="l01872"></a>01872     <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++)
<a name="l01873"></a>01873       <span class="keywordflow">for</span> (j = 0; j &lt; numComp; j++)
<a name="l01874"></a>01874      dblResultPtr[i*numComp+j] = (*binaryFunction)(cast_data[i*numComp+j], 
<a name="l01875"></a>01875                                   constValues[j]);
<a name="l01876"></a>01876   }
<a name="l01877"></a>01877   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l01878"></a>01878     <span class="keywordtype">float</span>* cast_data = (<span class="keywordtype">float</span>*)data;
<a name="l01879"></a>01879     <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++)
<a name="l01880"></a>01880       <span class="keywordflow">for</span> (j = 0; j &lt; numComp; j++)
<a name="l01881"></a>01881      dblResultPtr[i*numComp+j] = (*binaryFunction)(cast_data[i*numComp+j], 
<a name="l01882"></a>01882                                   constValues[j]);
<a name="l01883"></a>01883   }
<a name="l01884"></a>01884   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01885"></a>01885     <span class="keywordtype">double</span>* cast_data = (<span class="keywordtype">double</span>*)data;
<a name="l01886"></a>01886     <span class="keywordflow">for</span> (i = 0; i &lt; numData; i++)
<a name="l01887"></a>01887       <span class="keywordflow">for</span> (j = 0; j &lt; numComp; j++)
<a name="l01888"></a>01888      dblResultPtr[i*numComp+j] = (*binaryFunction)(cast_data[i*numComp+j], 
<a name="l01889"></a>01889                                   constValues[j]);
<a name="l01890"></a>01890   }
<a name="l01891"></a>01891   <span class="keywordflow">else</span> {
<a name="l01892"></a>01892     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Should never reach here, error in code!\n"</span>);
<a name="l01893"></a>01893     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01894"></a>01894   }
<a name="l01895"></a>01895 
<a name="l01896"></a>01896   <span class="comment">// create the new variable</span>
<a name="l01897"></a>01897   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var)) {
<a name="l01898"></a>01898     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l01899"></a>01899     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(var, &amp;dataset);
<a name="l01900"></a>01900     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01901"></a>01901       <span class="keywordflow">return</span> rc;
<a name="l01902"></a>01902     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, new_var_name, new_var);
<a name="l01903"></a>01903     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01904"></a>01904       <span class="keywordflow">return</span> rc; 
<a name="l01905"></a>01905   }
<a name="l01906"></a>01906   <span class="keywordflow">else</span> {
<a name="l01907"></a>01907     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l01908"></a>01908     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(var, &amp;mesh);
<a name="l01909"></a>01909     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01910"></a>01910       <span class="keywordflow">return</span> rc;
<a name="l01911"></a>01911     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, new_var_name, new_var);
<a name="l01912"></a>01912     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01913"></a>01913       <span class="keywordflow">return</span> rc; 
<a name="l01914"></a>01914   }
<a name="l01915"></a>01915   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numData, numComp, assoc, mathtype, 
<a name="l01916"></a>01916                     <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, dblResultPtr);
<a name="l01917"></a>01917   <span class="keywordflow">return</span> rc;
<a name="l01918"></a>01918 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g7a7fd46e48d01ee29209c49268982f89"></a><!-- doxytag: member="varmath.c::fc_varBinaryFunctionVarVar" ref="g7a7fd46e48d01ee29209c49268982f89" args="(FC_Variable var1, FC_Variable var2, double(*binaryFunction)(double ddata1, double ddata2), char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varBinaryFunctionVarVar           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double ddata1, double ddata2)&nbsp;</td>
          <td class="paramname"> <em>binaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs binary function on two variables. 
<p>
<b>Description:</b> <p>
Given a binary function that takes two doubles and returns a double, this function creates a new variable whose values are the results of the function applied to the original variables' values.<p>
The two variables must have the same number of data points and the same number of components.<p>
The new variable will be on the same mesh and will have the same association and math type as the first variable. The function is applied per component and data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>02/26/04 R.McCoy Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var1</em>&nbsp;</td><td>
input - variable 1 </td></tr>
<tr><td valign="top"><em>var2</em>&nbsp;</td><td>
input - variable 2 </td></tr>
<tr><td valign="top"><em>binaryFunction</em>&nbsp;</td><td>
input - function that operates on two doubles and returns a double </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01611">1611</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="base_8c-source.html#l00418">fc_getDataTypeText()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l02179">fc_seqVarBinaryFunctionSeqVarSeqVar()</a>, <a class="el" href="varmath_8c-source.html#l02742">fc_seqVarBinaryFunctionSeqVarVar()</a>, and <a class="el" href="varmath_8c-source.html#l02835">fc_seqVarBinaryFunctionVarSeqVar()</a>.<div class="fragment"><pre class="fragment"><a name="l01619"></a>01619  {
<a name="l01620"></a>01620   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01621"></a>01621   <span class="keywordtype">int</span> i;
<a name="l01622"></a>01622   <span class="keywordtype">int</span> numData1, numData2, numComp1, numComp2, numTotalValues;
<a name="l01623"></a>01623   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc1, assoc2;
<a name="l01624"></a>01624   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype1, datatype2;
<a name="l01625"></a>01625   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype1, mathtype2; 
<a name="l01626"></a>01626   <span class="keywordtype">void</span> *data1, *data2; 
<a name="l01627"></a>01627   <span class="keywordtype">double</span> *dblResultPtr;
<a name="l01628"></a>01628 
<a name="l01629"></a>01629   <span class="comment">// set default return value</span>
<a name="l01630"></a>01630   <span class="keywordflow">if</span> (new_var)
<a name="l01631"></a>01631     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l01632"></a>01632 
<a name="l01633"></a>01633   <span class="comment">// check input</span>
<a name="l01634"></a>01634   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var1)) || !(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var2)) ||
<a name="l01635"></a>01635       !new_var_name || !new_var) {
<a name="l01636"></a>01636     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l01637"></a>01637     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01638"></a>01638   }
<a name="l01639"></a>01639   <span class="keywordflow">if</span> (!binaryFunction) {
<a name="l01640"></a>01640     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Function was not provided"</span>);      
<a name="l01641"></a>01641     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01642"></a>01642   }
<a name="l01643"></a>01643 
<a name="l01644"></a>01644   <span class="comment">// log message</span>
<a name="l01645"></a>01645   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing binary user operation on var1 = '%s' and "</span>
<a name="l01646"></a>01646            <span class="stringliteral">"var2 = '%s'"</span> , <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var1)-&gt;header.name,
<a name="l01647"></a>01647            <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var2)-&gt;header.name  );  
<a name="l01648"></a>01648 
<a name="l01649"></a>01649   <span class="comment">// get variable infos</span>
<a name="l01650"></a>01650   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var1, &amp;numData1, &amp;numComp1, &amp;assoc1, 
<a name="l01651"></a>01651                             &amp;mathtype1, &amp;datatype1);
<a name="l01652"></a>01652   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01653"></a>01653     <span class="keywordflow">return</span> rc;
<a name="l01654"></a>01654   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var2, &amp;numData2, &amp;numComp2, &amp;assoc2, 
<a name="l01655"></a>01655                             &amp;mathtype2, &amp;datatype2);
<a name="l01656"></a>01656   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01657"></a>01657     <span class="keywordflow">return</span> rc;
<a name="l01658"></a>01658 
<a name="l01659"></a>01659   <span class="comment">// check that variables are similar enough</span>
<a name="l01660"></a>01660   <span class="keywordflow">if</span> (numData1 != numData2 || numComp1 != numComp2) {
<a name="l01661"></a>01661     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Variables are not similar enough."</span>);
<a name="l01662"></a>01662     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01663"></a>01663   }
<a name="l01664"></a>01664 
<a name="l01665"></a>01665   <span class="comment">// check the data types that can be handled here</span>
<a name="l01666"></a>01666   <span class="keywordflow">if</span> (datatype1 != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype1 != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; 
<a name="l01667"></a>01667       datatype1 != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01668"></a>01668     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"datatype for variable 1 '%s' cannot be handled"</span>,
<a name="l01669"></a>01669                  <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(datatype1));
<a name="l01670"></a>01670     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01671"></a>01671   } 
<a name="l01672"></a>01672   <span class="keywordflow">if</span> (datatype2 != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype2 != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; 
<a name="l01673"></a>01673       datatype2 != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01674"></a>01674     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"datatype2 for variable 2 '%s' cannot be handled"</span>,
<a name="l01675"></a>01675                  <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(datatype2));
<a name="l01676"></a>01676     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01677"></a>01677   }
<a name="l01678"></a>01678 
<a name="l01679"></a>01679   numTotalValues = numData1 * numComp1;
<a name="l01680"></a>01680 
<a name="l01681"></a>01681   <span class="comment">// get data</span>
<a name="l01682"></a>01682   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var1, &amp;data1);
<a name="l01683"></a>01683   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01684"></a>01684     <span class="keywordflow">return</span> rc;
<a name="l01685"></a>01685   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var2, &amp;data2);
<a name="l01686"></a>01686   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01687"></a>01687     <span class="keywordflow">return</span> rc;
<a name="l01688"></a>01688 
<a name="l01689"></a>01689   <span class="comment">// calc values -- 9 combinations of type</span>
<a name="l01690"></a>01690   dblResultPtr = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numTotalValues);
<a name="l01691"></a>01691   <span class="keywordflow">if</span> (dblResultPtr == NULL) {
<a name="l01692"></a>01692     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01693"></a>01693     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;   
<a name="l01694"></a>01694   }
<a name="l01695"></a>01695   <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l01696"></a>01696     <span class="keywordtype">int</span>* cast_data1 = (<span class="keywordtype">int</span>*)data1;
<a name="l01697"></a>01697     <span class="keywordtype">int</span>* cast_data2 = (<span class="keywordtype">int</span>*)data2;
<a name="l01698"></a>01698     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01699"></a>01699       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01700"></a>01700   }
<a name="l01701"></a>01701   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l01702"></a>01702     <span class="keywordtype">int</span>* cast_data1 = (<span class="keywordtype">int</span>*)data1;
<a name="l01703"></a>01703     <span class="keywordtype">float</span>* cast_data2 = (<span class="keywordtype">float</span>*)data2;
<a name="l01704"></a>01704     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01705"></a>01705       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01706"></a>01706   }
<a name="l01707"></a>01707   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01708"></a>01708     <span class="keywordtype">int</span>* cast_data1 = (<span class="keywordtype">int</span>*)data1;
<a name="l01709"></a>01709     <span class="keywordtype">double</span>* cast_data2 = (<span class="keywordtype">double</span>*)data2;
<a name="l01710"></a>01710     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01711"></a>01711       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01712"></a>01712   }
<a name="l01713"></a>01713   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l01714"></a>01714     <span class="keywordtype">float</span>* cast_data1 = (<span class="keywordtype">float</span>*)data1;
<a name="l01715"></a>01715     <span class="keywordtype">int</span>* cast_data2 = (<span class="keywordtype">int</span>*)data2;
<a name="l01716"></a>01716     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01717"></a>01717       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01718"></a>01718   }
<a name="l01719"></a>01719   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l01720"></a>01720     <span class="keywordtype">float</span>* cast_data1 = (<span class="keywordtype">float</span>*)data1;
<a name="l01721"></a>01721     <span class="keywordtype">float</span>* cast_data2 = (<span class="keywordtype">float</span>*)data2;
<a name="l01722"></a>01722     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01723"></a>01723       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01724"></a>01724   }
<a name="l01725"></a>01725   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01726"></a>01726     <span class="keywordtype">float</span>* cast_data1 = (<span class="keywordtype">float</span>*)data1;
<a name="l01727"></a>01727     <span class="keywordtype">double</span>* cast_data2 = (<span class="keywordtype">double</span>*)data2;
<a name="l01728"></a>01728     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01729"></a>01729       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01730"></a>01730   }
<a name="l01731"></a>01731   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l01732"></a>01732     <span class="keywordtype">double</span>* cast_data1 = (<span class="keywordtype">double</span>*)data1;
<a name="l01733"></a>01733     <span class="keywordtype">int</span>* cast_data2 = (<span class="keywordtype">int</span>*)data2;
<a name="l01734"></a>01734     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01735"></a>01735       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01736"></a>01736   }
<a name="l01737"></a>01737   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l01738"></a>01738     <span class="keywordtype">double</span>* cast_data1 = (<span class="keywordtype">double</span>*)data1;
<a name="l01739"></a>01739     <span class="keywordtype">float</span>* cast_data2 = (<span class="keywordtype">float</span>*)data2;
<a name="l01740"></a>01740     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01741"></a>01741       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01742"></a>01742   }
<a name="l01743"></a>01743   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype1 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a> &amp;&amp; datatype2 == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01744"></a>01744     <span class="keywordtype">double</span>* cast_data1 = (<span class="keywordtype">double</span>*)data1;
<a name="l01745"></a>01745     <span class="keywordtype">double</span>* cast_data2 = (<span class="keywordtype">double</span>*)data2;
<a name="l01746"></a>01746     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01747"></a>01747       dblResultPtr[i] = (*binaryFunction)(cast_data1[i], cast_data2[i]);
<a name="l01748"></a>01748   }
<a name="l01749"></a>01749   <span class="keywordflow">else</span> {
<a name="l01750"></a>01750     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Should never reach here, error in code!\n"</span>);
<a name="l01751"></a>01751     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01752"></a>01752   }
<a name="l01753"></a>01753 
<a name="l01754"></a>01754   <span class="comment">// create the new variable -- put on same mesh as first variable</span>
<a name="l01755"></a>01755   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var1)) {
<a name="l01756"></a>01756     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l01757"></a>01757     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(var1, &amp;dataset);
<a name="l01758"></a>01758     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01759"></a>01759       <span class="keywordflow">return</span> rc;
<a name="l01760"></a>01760     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, new_var_name, new_var);
<a name="l01761"></a>01761     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01762"></a>01762       <span class="keywordflow">return</span> rc; 
<a name="l01763"></a>01763   }
<a name="l01764"></a>01764   <span class="keywordflow">else</span> {
<a name="l01765"></a>01765     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l01766"></a>01766     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(var1, &amp;mesh);
<a name="l01767"></a>01767     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01768"></a>01768       <span class="keywordflow">return</span> rc;
<a name="l01769"></a>01769     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, new_var_name, new_var);
<a name="l01770"></a>01770     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01771"></a>01771       <span class="keywordflow">return</span> rc; 
<a name="l01772"></a>01772   }
<a name="l01773"></a>01773   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numData1, numComp1, assoc1, mathtype1, 
<a name="l01774"></a>01774                     <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, dblResultPtr);
<a name="l01775"></a>01775   <span class="keywordflow">return</span> rc;
<a name="l01776"></a>01776 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd8da3c1657c0158566a30a848f76ae59"></a><!-- doxytag: member="varmath.c::fc_varOperatorConst" ref="gd8da3c1657c0158566a30a848f76ae59" args="(FC_Variable var, char *operation, int constNumComp, void *constVector, FC_DataType constType, char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varOperatorConst           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>constNumComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>constVector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a>&nbsp;</td>
          <td class="paramname"> <em>constType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a variable and a constant. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new variable with the result of that operation performed with the constant on each data point of the variable. Use <a class="el" href="group__VariableMath.html#g42db54669d16d0ce55edd29aa73e4719">fc_constOperatorVar()</a> to apply operation in reverse order.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var + const </code></li><li><code> "-" =&gt; var - const </code></li><li><code> "*" =&gt; var * const </code></li><li><code> "/" =&gt; var / const </code></li></ul>
<p>
The variables and the constant must have the same number of components.<p>
The new variable will be on the same mesh and have the same association and mathtype as the variable. The operation is performed per component and data point.<p>
If both the variable and the constant have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>02/19/04 R.McCoy Created.</li><li>11/09/03 WSK, restricted to built-in types. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - FCLib variable </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>constNumComp</em>&nbsp;</td><td>
input - number of components in constVector </td></tr>
<tr><td valign="top"><em>constVector</em>&nbsp;</td><td>
input - constant vector </td></tr>
<tr><td valign="top"><em>constType</em>&nbsp;</td><td>
input - data type of constVector </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00481">481</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="varmath_8c-source.html#l03344">_fc_binaryOperatorCore()</a>, <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l01296">fc_seqVarOperatorConst()</a>, <a class="el" href="varmath_8c-source.html#l00858">fc_seqVarOperatorSeqConst()</a>, and <a class="el" href="varNormalize_8c-source.html#l00196">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00489"></a>00489   {
<a name="l00490"></a>00490   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00491"></a>00491   <span class="keywordtype">int</span> numComp, numData;
<a name="l00492"></a>00492   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype; 
<a name="l00493"></a>00493   <span class="keywordtype">void</span> *data; 
<a name="l00494"></a>00494    
<a name="l00495"></a>00495   <span class="comment">// set default return value</span>
<a name="l00496"></a>00496   <span class="keywordflow">if</span> (new_var)
<a name="l00497"></a>00497     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l00498"></a>00498     
<a name="l00499"></a>00499   <span class="comment">// check input</span>
<a name="l00500"></a>00500   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var)) || !operation || constNumComp &lt; 1 ||
<a name="l00501"></a>00501       !constVector || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(constType) || 
<a name="l00502"></a>00502       constType == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || !new_var_name  || !new_var) {
<a name="l00503"></a>00503     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l00504"></a>00504     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00505"></a>00505   }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507   <span class="comment">// log message</span>
<a name="l00508"></a>00508   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation (var %s const), with var '%s'"</span>,
<a name="l00509"></a>00509                 operation, <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var)-&gt;header.name);
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <span class="comment">// get variable info</span>
<a name="l00512"></a>00512   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;numComp, NULL, NULL, &amp;datatype);
<a name="l00513"></a>00513   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00514"></a>00514     <span class="keywordflow">return</span> rc;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516   <span class="comment">// check that const is similar enough</span>
<a name="l00517"></a>00517   <span class="keywordflow">if</span> (numComp != constNumComp) {
<a name="l00518"></a>00518     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"constant need sot have same number of components "</span>
<a name="l00519"></a>00519                  <span class="stringliteral">"as var"</span>);
<a name="l00520"></a>00520     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00521"></a>00521   }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523   <span class="comment">// get data</span>
<a name="l00524"></a>00524   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l00525"></a>00525   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00526"></a>00526     <span class="keywordflow">return</span> rc;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="comment">// do it</span>
<a name="l00529"></a>00529   <span class="keywordflow">return</span> <a class="code" href="group__PrivateVariableMath.html#gd1a184efa1c82323a2013eae8e410d8f">_fc_binaryOperatorCore</a>(numComp, numData, data, datatype,
<a name="l00530"></a>00530                     operation, 1, constVector, constType,
<a name="l00531"></a>00531                     var, new_var_name, new_var);
<a name="l00532"></a>00532 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8c5c39c5bc7018e3d99b7c8c3590e645"></a><!-- doxytag: member="varmath.c::fc_varOperatorSeqVar" ref="g8c5c39c5bc7018e3d99b7c8c3590e645" args="(FC_Variable var1, char *operation, int numStep, FC_Variable *seq_var2, char *new_seq_var_name, FC_Variable **new_seq_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varOperatorSeqVar           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>seq_var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_seq_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>new_seq_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on a seq variable and a normal var. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new seq variable with the result of that operation between a given seq variable and a normal var applied at each sequence step. For example, one can use this to scale a seqvar's values by their mean over the sequence (e.g., time).<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var1 + var2 </code></li><li><code> "-" =&gt; var1 - var2 </code></li><li><code> "*" =&gt; var1 * var2 </code></li><li><code> "/" =&gt; var1 / var2 </code></li></ul>
<p>
The two seq variable and the normal variable must have the same number of data points and the same number of components.<p>
The seq new variable will be on the same mesh and sequence and will have the same association and mathtype as the seq variable. The operation is performed per component and data point at each sequence step.<p>
If both original variables have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<ul>
<li>01/24/06 WSK Rewrote innards to mimimize data creation.</li></ul>
<p>
<b>Modifications:</b> <ul>
<li>06/07/05 ACG Created.</li><li>01/24/06 WSK Rewrote innards to mimimize data creation. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var1</em>&nbsp;</td><td>
input var1 </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - num step in input seq var </td></tr>
<tr><td valign="top"><em>seq_var2</em>&nbsp;</td><td>
input seq var </td></tr>
<tr><td valign="top"><em>new_seq_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_seq_var</em>&nbsp;</td><td>
output - the new seq variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01201">1201</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="varmath_8c-source.html#l00386">fc_varOperatorVar()</a>.<div class="fragment"><pre class="fragment"><a name="l01208"></a>01208   {   
<a name="l01209"></a>01209   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01210"></a>01210   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> seq;
<a name="l01211"></a>01211   <a class="code" href="structFC__Variable.html">FC_Variable</a>* temp_vars;
<a name="l01212"></a>01212   <span class="keywordtype">int</span> i, j;
<a name="l01213"></a>01213 
<a name="l01214"></a>01214   <span class="comment">// default return</span>
<a name="l01215"></a>01215   <span class="keywordflow">if</span> (new_seq_var)
<a name="l01216"></a>01216     *new_seq_var = NULL;
<a name="l01217"></a>01217 
<a name="l01218"></a>01218   <span class="comment">// check input</span>
<a name="l01219"></a>01219   <span class="keywordflow">if</span> ((!<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var1)) ||
<a name="l01220"></a>01220       (!<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seq_var2)) ||
<a name="l01221"></a>01221       (new_seq_var == NULL) || new_seq_var_name == NULL){
<a name="l01222"></a>01222     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01223"></a>01223     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01224"></a>01224   }
<a name="l01225"></a>01225   <span class="comment">//other checks are done internally in varoperatorvar</span>
<a name="l01226"></a>01226 
<a name="l01227"></a>01227   <span class="comment">// log message</span>
<a name="l01228"></a>01228   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation '%s' on variable '%s'"</span>
<a name="l01229"></a>01229                 <span class="stringliteral">" and seq variable '%s'"</span>, operation,
<a name="l01230"></a>01230                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var1)-&gt;header.name,
<a name="l01231"></a>01231                 <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(seq_var2[0])-&gt;header.name);
<a name="l01232"></a>01232 
<a name="l01233"></a>01233   <span class="comment">// Get info</span>
<a name="l01234"></a>01234   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seq_var2, &amp;seq);
<a name="l01235"></a>01235   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01236"></a>01236     <span class="keywordflow">return</span> rc;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238   <span class="comment">// Make space to save temp_vars</span>
<a name="l01239"></a>01239   temp_vars = malloc(numStep*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>));
<a name="l01240"></a>01240   <span class="keywordflow">if</span> (!temp_vars) {
<a name="l01241"></a>01241     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01242"></a>01242     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01243"></a>01243   }
<a name="l01244"></a>01244 
<a name="l01245"></a>01245   <span class="comment">// Do calculation on each step of the seq variables</span>
<a name="l01246"></a>01246   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l01247"></a>01247     rc = <a class="code" href="group__VariableMath.html#g4bc1d027d0c58095361d5b4389a4739c">fc_varOperatorVar</a>(var1, operation, seq_var2[i],<span class="stringliteral">"junk_var"</span>,
<a name="l01248"></a>01248                   &amp;temp_vars[i]); 
<a name="l01249"></a>01249     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) { 
<a name="l01250"></a>01250       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l01251"></a>01251      <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(temp_vars[j]);
<a name="l01252"></a>01252       free(temp_vars);
<a name="l01253"></a>01253       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Operation failed on step %d"</span>, i);
<a name="l01254"></a>01254       <span class="keywordflow">return</span> rc;
<a name="l01255"></a>01255     }
<a name="l01256"></a>01256   }
<a name="l01257"></a>01257 
<a name="l01258"></a>01258   <span class="comment">// stitch steps into the new seq var</span>
<a name="l01259"></a>01259   rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, temp_vars, seq,
<a name="l01260"></a>01260                          new_seq_var_name, new_seq_var);
<a name="l01261"></a>01261   free(temp_vars);
<a name="l01262"></a>01262   <span class="keywordflow">return</span> rc;
<a name="l01263"></a>01263 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g4bc1d027d0c58095361d5b4389a4739c"></a><!-- doxytag: member="varmath.c::fc_varOperatorVar" ref="g4bc1d027d0c58095361d5b4389a4739c" args="(FC_Variable var1, char *operation, FC_Variable var2, char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varOperatorVar           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs built-in binary operation on two variables. 
<p>
<b>Description:</b> <p>
Given a string that represents the desired binary operation, return a new variable with the result of that operation performed on the the given variables.<p>
Supported operations are:<ul>
<li><code> "+" =&gt; var1 + var2 </code></li><li><code> "-" =&gt; var1 - var2 </code></li><li><code> "*" =&gt; var1 * var2 </code></li><li><code> "/" =&gt; var1 / var2 </code></li></ul>
<p>
The two variables must have the same number of data points and the same number of components.<p>
The new variable will be on the same mesh and have the same association and mathtype as the first variable. The operation is performed per component and data point.<p>
If both original variables have the data type FC_DT_INT, then the operation will be an integer operation and the result will have data type FC_DT_INT. Otherwise, all variable values are promoted to double and the operation will be a double operation and the result will have data type FC_DT_DOUBLE.<p>
<b>Modifications:</b> <ul>
<li>01/29/04 R.McCoy Created.</li><li>11/09/03 WSK, restricted to built-in types. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var1</em>&nbsp;</td><td>
input - variable 1 </td></tr>
<tr><td valign="top"><em>operation</em>&nbsp;</td><td>
input - operation to be performed on variables </td></tr>
<tr><td valign="top"><em>var2</em>&nbsp;</td><td>
input - variable 2 </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l00386">386</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="varmath_8c-source.html#l03344">_fc_binaryOperatorCore()</a>, <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varmath_8c-source.html#l00747">fc_seqVarOperatorSeqVar()</a>, <a class="el" href="varmath_8c-source.html#l01101">fc_seqVarOperatorVar()</a>, <a class="el" href="varmath_8c-source.html#l01201">fc_varOperatorSeqVar()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00392"></a>00392   {        
<a name="l00393"></a>00393   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00394"></a>00394   <span class="keywordtype">int</span> numData1, numData2, numComp1, numComp2;
<a name="l00395"></a>00395   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype1, datatype2;
<a name="l00396"></a>00396   <span class="keywordtype">void</span> *data1, *data2;
<a name="l00397"></a>00397    
<a name="l00398"></a>00398   <span class="comment">// set default return value</span>
<a name="l00399"></a>00399   <span class="keywordflow">if</span> (new_var)
<a name="l00400"></a>00400     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402   <span class="comment">// check input</span>
<a name="l00403"></a>00403   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var1)) || !operation || 
<a name="l00404"></a>00404       !(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var2)) || !new_var_name || !new_var) {
<a name="l00405"></a>00405     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));   
<a name="l00406"></a>00406     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00407"></a>00407   }
<a name="l00408"></a>00408  
<a name="l00409"></a>00409   <span class="comment">// log message</span>
<a name="l00410"></a>00410   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing operation (var1 %s var2), with var1 = '%s', "</span>
<a name="l00411"></a>00411            <span class="stringliteral">"var2 = '%s'"</span> , operation, <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var1)-&gt;header.name,
<a name="l00412"></a>00412            <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var2)-&gt;header.name);  
<a name="l00413"></a>00413 
<a name="l00414"></a>00414   <span class="comment">// get variable info</span>
<a name="l00415"></a>00415   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var1, &amp;numData1, &amp;numComp1, NULL, NULL, &amp;datatype1);
<a name="l00416"></a>00416   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00417"></a>00417     <span class="keywordflow">return</span> rc;
<a name="l00418"></a>00418   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var2, &amp;numData2, &amp;numComp2, NULL, NULL, &amp;datatype2);
<a name="l00419"></a>00419   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00420"></a>00420     <span class="keywordflow">return</span> rc;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   <span class="comment">// check that variables are similar enough</span>
<a name="l00423"></a>00423   <span class="keywordflow">if</span> (numData1 != numData2 || numComp1 != numComp2) {
<a name="l00424"></a>00424     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Vars need to have same number of data points "</span>
<a name="l00425"></a>00425                  <span class="stringliteral">"and same number of components"</span>);
<a name="l00426"></a>00426     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00427"></a>00427   }
<a name="l00428"></a>00428   <span class="keywordflow">if</span> ((<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var1) &amp;&amp; !<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var2)) ||
<a name="l00429"></a>00429       (!<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var1) &amp;&amp; <a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var2))) {
<a name="l00430"></a>00430     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Cannot process a mix of global and non-global vars"</span>);
<a name="l00431"></a>00431     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00432"></a>00432   }
<a name="l00433"></a>00433 
<a name="l00434"></a>00434   <span class="comment">// get data</span>
<a name="l00435"></a>00435   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var1, &amp;data1);
<a name="l00436"></a>00436   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00437"></a>00437     <span class="keywordflow">return</span> rc;
<a name="l00438"></a>00438   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var2, &amp;data2);
<a name="l00439"></a>00439   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00440"></a>00440     <span class="keywordflow">return</span> rc;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442   <span class="comment">// do it</span>
<a name="l00443"></a>00443   <span class="keywordflow">return</span> <a class="code" href="group__PrivateVariableMath.html#gd1a184efa1c82323a2013eae8e410d8f">_fc_binaryOperatorCore</a>(numComp1, numData1, data1, datatype1,
<a name="l00444"></a>00444                     operation, numData2, data2, datatype2,
<a name="l00445"></a>00445                     var1, new_var_name, new_var);
<a name="l00446"></a>00446 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g84b3f6963472cbe8c79fe1d6c1c39640"></a><!-- doxytag: member="varmath.c::fc_varUnaryFunction" ref="g84b3f6963472cbe8c79fe1d6c1c39640" args="(FC_Variable var, double(*unaryFunction)(double), char *new_var_name, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_varUnaryFunction           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double)&nbsp;</td>
          <td class="paramname"> <em>unaryFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>new_var_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performs unary function on a variable. 
<p>
<b>Description:</b> <p>
Given a unary function that takes a double and returns a double, this function creates a new variable whose values are the results of the function applied to the original variable's values.<p>
The new variable will be on the same mesh as the original and will have the same association and math type as the original. The function is performed on each component of each data point. The new variable will always have data type FC_DT_DOUBLE. This function returns with an error if the data is FC_DT_CHAR.<p>
<b>Modifications:</b> <ul>
<li>02/26/04 R.McCoy Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>var</em>&nbsp;</td><td>
input - variable </td></tr>
<tr><td valign="top"><em>unaryFunction</em>&nbsp;</td><td>
input - function that operates on a double and returns a double </td></tr>
<tr><td valign="top"><em>new_var_name</em>&nbsp;</td><td>
input - name for the new variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - the new variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="varmath_8c-source.html#l01485">1485</a> of file <a class="el" href="varmath_8c-source.html">varmath.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l05412">_fc_getVarSlot()</a>, <a class="el" href="variable_8c-source.html#l00122">fc_createGlobalVariable()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="variable_8c-source.html#l04228">fc_getDatasetFromVariable()</a>, <a class="el" href="base_8c-source.html#l00418">fc_getDataTypeText()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="series_8c-source.html#l02844">fc_euclideanDistanceBetweenCurves()</a>, <a class="el" href="varmath_8c-source.html#l02094">fc_seqVarUnaryFunction()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01492"></a>01492  {
<a name="l01493"></a>01493   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01494"></a>01494   <span class="keywordtype">int</span> i;
<a name="l01495"></a>01495   <span class="keywordtype">int</span> numData;
<a name="l01496"></a>01496   <span class="keywordtype">int</span> numComp;
<a name="l01497"></a>01497   <span class="keywordtype">int</span> numTotalValues;
<a name="l01498"></a>01498   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l01499"></a>01499   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l01500"></a>01500   <a class="code" href="group__DataTypes.html#gf4416c02a52bd37e799d442b985151b3">FC_MathType</a> mathtype;
<a name="l01501"></a>01501   <span class="keywordtype">void</span> *data;
<a name="l01502"></a>01502   <span class="keywordtype">double</span> *dblResultPtr;
<a name="l01503"></a>01503 
<a name="l01504"></a>01504   <span class="comment">// set default return value</span>
<a name="l01505"></a>01505   <span class="keywordflow">if</span> (new_var)
<a name="l01506"></a>01506     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l01507"></a>01507 
<a name="l01508"></a>01508   <span class="comment">// check input</span>
<a name="l01509"></a>01509   <span class="keywordflow">if</span> (!(<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(var)) || !new_var_name || !new_var) {
<a name="l01510"></a>01510     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01511"></a>01511     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01512"></a>01512   }
<a name="l01513"></a>01513   <span class="keywordflow">if</span> (!unaryFunction) {
<a name="l01514"></a>01514     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Function was not provided"</span>);
<a name="l01515"></a>01515     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01516"></a>01516   }
<a name="l01517"></a>01517   
<a name="l01518"></a>01518   <span class="comment">// log message</span>
<a name="l01519"></a>01519   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Performing unary user operation on variable '%s'"</span>,
<a name="l01520"></a>01520             <a class="code" href="group__PrivateVariable.html#g2b99df3fb78e3936d0976002ca3ce18f">_fc_getVarSlot</a>(var)-&gt;header.name);
<a name="l01521"></a>01521 
<a name="l01522"></a>01522   <span class="comment">// get variable info</span>
<a name="l01523"></a>01523   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(var, &amp;numData, &amp;numComp, &amp;assoc, &amp;mathtype, 
<a name="l01524"></a>01524                  &amp;datatype);
<a name="l01525"></a>01525   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01526"></a>01526     <span class="keywordflow">return</span> rc;
<a name="l01527"></a>01527 
<a name="l01528"></a>01528   <span class="comment">// check the datatype that can be handled here</span>
<a name="l01529"></a>01529   <span class="keywordflow">if</span> (datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> &amp;&amp; datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a> &amp;&amp; 
<a name="l01530"></a>01530       datatype != <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01531"></a>01531     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"the datatype = %s type cannot be handled"</span>,
<a name="l01532"></a>01532                  <a class="code" href="group__DataTypes.html#g6720a592eace2d7459eb410a3b29cd2f">fc_getDataTypeText</a>(datatype) );
<a name="l01533"></a>01533     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01534"></a>01534   }  
<a name="l01535"></a>01535 
<a name="l01536"></a>01536   numTotalValues = numData * numComp;
<a name="l01537"></a>01537 
<a name="l01538"></a>01538   <span class="comment">// get data</span>
<a name="l01539"></a>01539   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(var, &amp;data);
<a name="l01540"></a>01540   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01541"></a>01541     <span class="keywordflow">return</span> rc; 
<a name="l01542"></a>01542 
<a name="l01543"></a>01543   <span class="comment">// calc values</span>
<a name="l01544"></a>01544   dblResultPtr = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numTotalValues);
<a name="l01545"></a>01545   <span class="keywordflow">if</span> (dblResultPtr == NULL) {
<a name="l01546"></a>01546     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01547"></a>01547     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;   
<a name="l01548"></a>01548   }
<a name="l01549"></a>01549   <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>) {
<a name="l01550"></a>01550     <span class="keywordtype">int</span>* cast_data = (<span class="keywordtype">int</span>*)data;
<a name="l01551"></a>01551     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01552"></a>01552       dblResultPtr[i] = (*unaryFunction)(cast_data[i]);
<a name="l01553"></a>01553   }
<a name="l01554"></a>01554   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>) {
<a name="l01555"></a>01555     <span class="keywordtype">float</span>* cast_data = (<span class="keywordtype">float</span>*)data;
<a name="l01556"></a>01556     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01557"></a>01557       dblResultPtr[i] = (*unaryFunction)(cast_data[i]);
<a name="l01558"></a>01558   }
<a name="l01559"></a>01559   <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>) {
<a name="l01560"></a>01560     <span class="keywordtype">double</span>* cast_data = (<span class="keywordtype">double</span>*)data;
<a name="l01561"></a>01561     <span class="keywordflow">for</span> (i = 0; i &lt; numTotalValues; i++)
<a name="l01562"></a>01562       dblResultPtr[i] = (*unaryFunction)(cast_data[i]);
<a name="l01563"></a>01563   }
<a name="l01564"></a>01564 
<a name="l01565"></a>01565   <span class="comment">// create the new variable</span>
<a name="l01566"></a>01566   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(var)) {
<a name="l01567"></a>01567     <a class="code" href="structFC__Dataset.html">FC_Dataset</a> dataset;
<a name="l01568"></a>01568     rc = <a class="code" href="group__Variable.html#gf9224b61be48617fe1fea54e12c0cbe6">fc_getDatasetFromVariable</a>(var, &amp;dataset);
<a name="l01569"></a>01569     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01570"></a>01570       <span class="keywordflow">return</span> rc;
<a name="l01571"></a>01571     rc = <a class="code" href="group__Variable.html#g3de7edfd0291f0f9f3d246f3a6254925">fc_createGlobalVariable</a>(dataset, new_var_name, new_var);
<a name="l01572"></a>01572     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01573"></a>01573       <span class="keywordflow">return</span> rc; 
<a name="l01574"></a>01574   }
<a name="l01575"></a>01575   <span class="keywordflow">else</span> {
<a name="l01576"></a>01576     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l01577"></a>01577     rc = <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(var, &amp;mesh);
<a name="l01578"></a>01578     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01579"></a>01579       <span class="keywordflow">return</span> rc;
<a name="l01580"></a>01580     rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, new_var_name, new_var);
<a name="l01581"></a>01581     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01582"></a>01582       <span class="keywordflow">return</span> rc; 
<a name="l01583"></a>01583   }
<a name="l01584"></a>01584   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numData, numComp, assoc, mathtype, 
<a name="l01585"></a>01585                     <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, dblResultPtr);
<a name="l01586"></a>01586   <span class="keywordflow">return</span> rc;    
<a name="l01587"></a>01587 }
</pre></div>
<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Wed Oct 31 11:10:01 2007 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
