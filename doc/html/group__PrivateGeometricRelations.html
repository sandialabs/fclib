<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: (Private)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>(Private)<br>
<small>
[<a class="el" href="group__GeometricRelations.html">Geometric Relations</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for (Private):</div>
<div class="dynsection">
<center><table><tr><td><img src="group__PrivateGeometricRelations.gif" border="0" alt="" usemap="#group____PrivateGeometricRelations_map">
<map name="group____PrivateGeometricRelations_map">
<area shape="rect" href="group__GeometricRelations.html" title="Relationships and values which depend on the coordinates in space." alt="" coords="5,5,173,32"></map></td></tr></table></center>
</div>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Diameter helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#ge168ac2c62b1eeb928614ec8e2653807">_fc_getDiameterOutputArgsTest</a> (double *diameter, int *numPair, int **pairIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper for 'getDiameter' routines.  <a href="#ge168ac2c62b1eeb928614ec8e2653807"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#ge1d011d686fe02162622c680554e0aca">_fc_getDiameterOutputArgsTestMeshes</a> (double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> **pairMeshes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper for 'getDiameter' routines.  <a href="#ge1d011d686fe02162622c680554e0aca"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g0f82ec988ecdb9530b201a35034dd094">_fc_getDiameterOutputArgsTestSubsets</a> (double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Subset.html">FC_Subset</a> **pairSubsets)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper for 'getDiameter' routines.  <a href="#g0f82ec988ecdb9530b201a35034dd094"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g26981974d8bba75a58309981c8d36ea4">_fc_getSubsetDiameterCore</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ, double *diameter, int *numPair, int **pairIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Core code of 'getDiameter' routines.  <a href="#g26981974d8bba75a58309981c8d36ea4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gf3e5e50c85791d67ecaa4b58e3c103d2">_fc_getSubsetsDiameterCore</a> (int numSubset, <a class="el" href="structFC__Subset.html">FC_Subset</a> *subsets, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displs, double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Subset.html">FC_Subset</a> **pairSubsets)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Core code of 'getDiameter' routines.  <a href="#gf3e5e50c85791d67ecaa4b58e3c103d2"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Proximity helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g910d9e1b0685c7ef479521b4c0480905">_fc_getSubsetsProximityArgsTest</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> *mesh1, <a class="el" href="structFC__Subset.html">FC_Subset</a> *subset1, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ1, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *mesh2, <a class="el" href="structFC__Subset.html">FC_Subset</a> *subset2, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ2, double min_dist, int *numPair, int **mesh1VertIDs, int **mesh2VertIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Common argument testing for all proximity routines.  <a href="#g910d9e1b0685c7ef479521b4c0480905"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g683ad7d86a5c14d1350f0e666ae5bfa7">_fc_getSubsetsProximityCore</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset1, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ1, <a class="el" href="structFC__Subset.html">FC_Subset</a> subset2, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the proximal vertices between two displaced subsets.  <a href="#g683ad7d86a5c14d1350f0e666ae5bfa7"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Range query helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gdcc212e0f8daaf7ebb72296740115a68">_fc_createVertexBinCore</a> (int numVertex, int numDim, double *coords, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> lowers, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> uppers, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **bin_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create spatial bins for vertices for geometric queries.  <a href="#gdcc212e0f8daaf7ebb72296740115a68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gb953a6c11dee13281fafa4f08ea7e47c">_fc_getVertexIDsWithinBoundingBoxUsingVertexBin</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *bin, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> lowpoint, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> highpoint, int *numVertex_p, int **vertexIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find all vertices within a bounding box.  <a href="#gb953a6c11dee13281fafa4f08ea7e47c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g506e4d8a06fd014e8518412743a2b3c7">_fc_getVertexIDsWithinSphereUsingVertexBin</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *bin, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> center, double radius, int *numVertex_p, int **vertexIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find all vertices within a given radius of a point.  <a href="#g506e4d8a06fd014e8518412743a2b3c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g9b43dc0f4dba241e52bcff6a5943282c">_fc_geomSmoothCore</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, int doDispl, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displs, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **bins, <a class="el" href="structFC__Variable.html">FC_Variable</a> *vars, double radius, int doLocalSmooth, <a class="el" href="structFC__Variable.html">FC_Variable</a> **smooth_vars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Smooth a variable field.  <a href="#g9b43dc0f4dba241e52bcff6a5943282c"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Normals helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17">_fc_calcSurfaceNormal</a> (int numPoint, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *coords, <a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *normal)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute unit normal of surface.  <a href="#g7e5b770477c5b1839f8ee522e6980c17"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Math helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gbc21d0976226669fb4b6698b4a393d99">_fc_calcDeterminant2x2</a> (double a1, double a2, double b1, double b2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate determinant of a 2x2 matrix.  <a href="#gbc21d0976226669fb4b6698b4a393d99"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gea8933e6c516830370e0460b1e9d191a">_fc_calcDeterminant3x3</a> (double a1, double a2, double a3, double b1, double b2, double b3, double c1, double c2, double c3)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate determinant of a 3x3 matrix.  <a href="#gea8933e6c516830370e0460b1e9d191a"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Parameterization helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gda6b93e0c869be3fc8be603801ed56c9">_fc_calcQuadParams</a> (<a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> point, int *numParam, double **params)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute parameterization of a point on a quad.  <a href="#gda6b93e0c869be3fc8be603801ed56c9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g57be9af467e6c84e274d6828ae4b52b0">_fc_calcQuadLocation</a> (<a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, int numParam, double *params, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *point)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute parameterization of a point on a quad.  <a href="#g57be9af467e6c84e274d6828ae4b52b0"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Mesh entities' measurement helpers</h2></td></tr>
<tr><td colspan="2"><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#gbb6ad904da91e4639b3d7fc2046adabb">_fc_calcTriArea</a> (int numDim, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, double *area)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute surface area of a triangle.  <a href="#gbb6ad904da91e4639b3d7fc2046adabb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g9e410e3ec777fe0b682186c2f6b8b082">_fc_calcQuadArea</a> (int numDim, <a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, double *area)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute surface area of a quadrilateral.  <a href="#g9e410e3ec777fe0b682186c2f6b8b082"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g8f34c9a8ae4ccb9a33a246150ee4c5cb">_fc_calcTetVolume</a> (<a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute volume of a tetrahedron.  <a href="#g8f34c9a8ae4ccb9a33a246150ee4c5cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g2499e8c60da6ecceb94ec5e8afc9b728">_fc_calcPyramidVolume</a> (<a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute volume of a pyramid.  <a href="#g2499e8c60da6ecceb94ec5e8afc9b728"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g86a9d11aed37050aa6dfab9f43c72816">_fc_calcPrismVolume</a> (<a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute volume of a prism.  <a href="#g86a9d11aed37050aa6dfab9f43c72816"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g89c6ec257356f5632269d042f979c3de">_fc_calcHexVolume</a> (<a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *vertices, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute volume of a hex.  <a href="#g89c6ec257356f5632269d042f979c3de"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html#g52ad166d5c4ae4ffac8db3edd83ca1df">_fc_doesElementContainPoint</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int element_id, double point[3], int dim, int max_num_vert_per_face, int *num_vert_per_face, int *face_conns, double *vert_coords, int *hit_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal function for determining whether a point is located within an element.  <a href="#g52ad166d5c4ae4ffac8db3edd83ca1df"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gbc21d0976226669fb4b6698b4a393d99"></a><!-- doxytag: member="geom.c::_fc_calcDeterminant2x2" ref="gbc21d0976226669fb4b6698b4a393d99" args="(double a1, double a2, double b1, double b2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double _fc_calcDeterminant2x2           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate determinant of a 2x2 matrix. 
<p>
<b>Description:</b> <p>
Input is by rows (top row, then bottom row).<p>
<b>Modifications:</b> <ul>
<li>08/23/04 WSK created. </li></ul>

<p>Definition at line <a class="el" href="geom_8c-source.html#l06957">6957</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l06973">_fc_calcDeterminant3x3()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06958"></a>06958                                                     {
<a name="l06959"></a>06959   <span class="keywordflow">return</span> a1*b2 - a2*b1;
<a name="l06960"></a>06960 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gea8933e6c516830370e0460b1e9d191a"></a><!-- doxytag: member="geom.c::_fc_calcDeterminant3x3" ref="gea8933e6c516830370e0460b1e9d191a" args="(double a1, double a2, double a3, double b1, double b2, double b3, double c1, double c2, double c3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double _fc_calcDeterminant3x3           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>c2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>c3</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate determinant of a 3x3 matrix. 
<p>
<b>Description:</b> <p>
Input is by rows (top row, middle row, etc).<p>
<b>Modifications:</b> <ul>
<li>08/23/04 WSK created. </li></ul>

<p>Definition at line <a class="el" href="geom_8c-source.html#l06973">6973</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l06957">_fc_calcDeterminant2x2()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l07344">_fc_calcTetVolume()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06975"></a>06975                                                                {
<a name="l06976"></a>06976   <span class="keywordflow">return</span> (  a1 * <a class="code" href="group__PrivateGeometricRelations.html#gbc21d0976226669fb4b6698b4a393d99" title="Calculate determinant of a 2x2 matrix.">_fc_calcDeterminant2x2</a>(b2, b3, c2, c3)
<a name="l06977"></a>06977           - b1 * <a class="code" href="group__PrivateGeometricRelations.html#gbc21d0976226669fb4b6698b4a393d99" title="Calculate determinant of a 2x2 matrix.">_fc_calcDeterminant2x2</a>(a2, a3, c2, c3)
<a name="l06978"></a>06978           + c1 * <a class="code" href="group__PrivateGeometricRelations.html#gbc21d0976226669fb4b6698b4a393d99" title="Calculate determinant of a 2x2 matrix.">_fc_calcDeterminant2x2</a>(a2, a3, b2, b3) );
<a name="l06979"></a>06979 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g89c6ec257356f5632269d042f979c3de"></a><!-- doxytag: member="geom.c::_fc_calcHexVolume" ref="g89c6ec257356f5632269d042f979c3de" args="(FC_Coords *vertices, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcHexVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute volume of a hex. 
<p>
<b>Description:</b> <p>
Provide array of vertex coords and get the volume back.<p>
Probably only works if the hex is convex.<p>
Implementation. Divides the hex into 5 tets and sum their volumes. Probably only accurate if square faces are convex and planar.<p>
<b>Modifications:</b> <ul>
<li>8/23/04 WSK Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the tri </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - region volume </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07456">7456</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l07344">_fc_calcTetVolume()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, and <a class="el" href="geom_8c-source.html#l03808">fc_getRegionVolumes()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07459"></a>07459   {
<a name="l07460"></a>07460   <span class="keywordtype">int</span> i, j, k;
<a name="l07461"></a>07461   <span class="keywordtype">int</span> numDim = 3;
<a name="l07462"></a>07462   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> coords[4];
<a name="l07463"></a>07463   <span class="keywordtype">int</span> lookup[5][4] = { { 0, 1, 2, 5 }, { 0, 2, 3, 7 }, { 0, 5, 7, 4 },
<a name="l07464"></a>07464                        { 2, 7, 5, 6 }, { 0, 5, 2, 7 } };
<a name="l07465"></a>07465   <span class="keywordtype">double</span> temp_vol;
<a name="l07466"></a>07466 
<a name="l07467"></a>07467   *volume = 0.0;
<a name="l07468"></a>07468   <span class="keywordflow">for</span> (i = 0; i &lt; 5; i++) {
<a name="l07469"></a>07469     <span class="comment">// get coords for tet i</span>
<a name="l07470"></a>07470     <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l07471"></a>07471       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++) 
<a name="l07472"></a>07472         coords[j][k] = vertices[lookup[i][j]][k];
<a name="l07473"></a>07473     <span class="comment">// add volume for tet i</span>
<a name="l07474"></a>07474     <a class="code" href="group__PrivateGeometricRelations.html#g8f34c9a8ae4ccb9a33a246150ee4c5cb" title="Compute volume of a tetrahedron.">_fc_calcTetVolume</a>(coords, &amp;temp_vol);
<a name="l07475"></a>07475     *volume += temp_vol;
<a name="l07476"></a>07476   }
<a name="l07477"></a>07477 
<a name="l07478"></a>07478   <span class="keywordflow">return</span>;
<a name="l07479"></a>07479 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g86a9d11aed37050aa6dfab9f43c72816"></a><!-- doxytag: member="geom.c::_fc_calcPrismVolume" ref="g86a9d11aed37050aa6dfab9f43c72816" args="(FC_Coords *vertices, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcPrismVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute volume of a prism. 
<p>
<b>Description:</b> <p>
Provide array of six vertex coords and get the volume back.<p>
Implementation. Divides the prism into 3 tets and sums their volumes. Probably only accurate if square faces are convex and planar.<p>
<b>Modifications:</b> <ul>
<li>8/24/04 WSK Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the tri </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - region volume </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07416">7416</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l07344">_fc_calcTetVolume()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, and <a class="el" href="geom_8c-source.html#l03808">fc_getRegionVolumes()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07419"></a>07419   {
<a name="l07420"></a>07420   <span class="keywordtype">int</span> i, j, k;
<a name="l07421"></a>07421   <span class="keywordtype">int</span> numDim = 3;
<a name="l07422"></a>07422   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> coords[4];
<a name="l07423"></a>07423   <span class="keywordtype">int</span> lookup[3][4] = { { 0, 1, 2, 3 }, { 1, 4, 2, 3 }, { 2, 4, 5, 3 } };
<a name="l07424"></a>07424   <span class="keywordtype">double</span> temp_vol;
<a name="l07425"></a>07425 
<a name="l07426"></a>07426   *volume = 0.0;
<a name="l07427"></a>07427   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {
<a name="l07428"></a>07428     <span class="comment">// get coords for tet i</span>
<a name="l07429"></a>07429     <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l07430"></a>07430       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++) 
<a name="l07431"></a>07431         coords[j][k] = vertices[lookup[i][j]][k];
<a name="l07432"></a>07432     <span class="comment">// add volume for tet i</span>
<a name="l07433"></a>07433     <a class="code" href="group__PrivateGeometricRelations.html#g8f34c9a8ae4ccb9a33a246150ee4c5cb" title="Compute volume of a tetrahedron.">_fc_calcTetVolume</a>(coords, &amp;temp_vol);
<a name="l07434"></a>07434     *volume += temp_vol;
<a name="l07435"></a>07435   }
<a name="l07436"></a>07436 
<a name="l07437"></a>07437   <span class="keywordflow">return</span>;
<a name="l07438"></a>07438 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2499e8c60da6ecceb94ec5e8afc9b728"></a><!-- doxytag: member="geom.c::_fc_calcPyramidVolume" ref="g2499e8c60da6ecceb94ec5e8afc9b728" args="(FC_Coords *vertices, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcPyramidVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute volume of a pyramid. 
<p>
<b>Description:</b> <p>
Provide array of five vertex coords and get the volume back (the tip of the pyramid is the last last vertex).<p>
Implementation. Divides the pyramid into 2 tets and sum their volumes. Only accurate if square face is planar.<p>
<b>Modifications:</b> <ul>
<li>8/24/04 WSK Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the tri </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - region volume </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07375">7375</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l07344">_fc_calcTetVolume()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, and <a class="el" href="geom_8c-source.html#l03808">fc_getRegionVolumes()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07378"></a>07378   {
<a name="l07379"></a>07379   <span class="comment">// Note, if the square face is not concave, this works no matter which</span>
<a name="l07380"></a>07380   <span class="comment">// way you split the tet's because if you split "wrong" you get a positve</span>
<a name="l07381"></a>07381   <span class="comment">// and negative tet volume that add up to the right answer. I think.</span>
<a name="l07382"></a>07382   <span class="keywordtype">int</span> i, j, k;
<a name="l07383"></a>07383   <span class="keywordtype">int</span> numDim = 3;
<a name="l07384"></a>07384   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> coords[4];
<a name="l07385"></a>07385   <span class="keywordtype">int</span> lookup[2][4] = { { 0, 1, 3, 4 }, { 1, 2, 3, 4 } };
<a name="l07386"></a>07386   <span class="keywordtype">double</span> temp_vol;
<a name="l07387"></a>07387 
<a name="l07388"></a>07388   *volume = 0.0;
<a name="l07389"></a>07389   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l07390"></a>07390     <span class="comment">// get coords for tet i</span>
<a name="l07391"></a>07391     <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l07392"></a>07392       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++) 
<a name="l07393"></a>07393         coords[j][k] = vertices[lookup[i][j]][k];
<a name="l07394"></a>07394     <span class="comment">// add volume for tet i</span>
<a name="l07395"></a>07395     <a class="code" href="group__PrivateGeometricRelations.html#g8f34c9a8ae4ccb9a33a246150ee4c5cb" title="Compute volume of a tetrahedron.">_fc_calcTetVolume</a>(coords, &amp;temp_vol);
<a name="l07396"></a>07396     *volume += temp_vol;
<a name="l07397"></a>07397   }
<a name="l07398"></a>07398 
<a name="l07399"></a>07399   <span class="keywordflow">return</span>;
<a name="l07400"></a>07400 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g9e410e3ec777fe0b682186c2f6b8b082"></a><!-- doxytag: member="geom.c::_fc_calcQuadArea" ref="g9e410e3ec777fe0b682186c2f6b8b082" args="(int numDim, FC_Coords *vertices, double *area)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcQuadArea           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>area</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute surface area of a quadrilateral. 
<p>
<b>Description:</b> <p>
Provide array of vertex coords and get the area back. Note that if the coords are 2D, the last entry of FC_Coords should be 0.<p>
This routine works for planar convex and planar nonconvex quads. (Will return results for non-planar quads, but behavior may not be what you want).<p>
Basic procedure: divide the quad into two triangles and sum the areas of those triangles. There are two possible ways to divide a quad into triangles. This choice is important for non-convex quads and it should be chosen so that the shared edge falls within the quad. However, figuring out which way to divide quads is difficult. Instead, the procedure is to calculate the quad area for both divisions and then to choose the smaller area (the wrong division for a non-convex quad would double count area outside of the quad).<p>
<b>Modifications:</b> <ul>
<li>8/23/04 WSK Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
input - the dimensionality of coordinates </td></tr>
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the tri </td></tr>
<tr><td valign="top"><em>area</em>&nbsp;</td><td>
output - surface area </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07296">7296</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l07227">_fc_calcTriArea()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l03702">fc_getDisplacedFaceAreas()</a>, and <a class="el" href="geom_8c-source.html#l03600">fc_getFaceAreas()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07300"></a>07300   {
<a name="l07301"></a>07301   <span class="keywordtype">int</span> i, j, k;
<a name="l07302"></a>07302   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> coords[4][3];
<a name="l07303"></a>07303   <span class="keywordtype">int</span> lookup[4][3] = { { 0, 1, 2 }, { 0, 2, 3 }, { 0, 1, 3 }, { 1, 2, 3 } };
<a name="l07304"></a>07304   <span class="keywordtype">double</span> area_tri1, area_tri2, area1, area2;
<a name="l07305"></a>07305 
<a name="l07306"></a>07306   <span class="comment">// setup triangles</span>
<a name="l07307"></a>07307   <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {
<a name="l07308"></a>07308     <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l07309"></a>07309       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++) {
<a name="l07310"></a>07310         coords[i][j][k] = vertices[lookup[i][j]][k];
<a name="l07311"></a>07311       }
<a name="l07312"></a>07312     }
<a name="l07313"></a>07313   }
<a name="l07314"></a>07314 
<a name="l07315"></a>07315   <a class="code" href="group__PrivateGeometricRelations.html#gbb6ad904da91e4639b3d7fc2046adabb" title="Compute surface area of a triangle.">_fc_calcTriArea</a>(numDim, coords[0], &amp;area_tri1);
<a name="l07316"></a>07316   <a class="code" href="group__PrivateGeometricRelations.html#gbb6ad904da91e4639b3d7fc2046adabb" title="Compute surface area of a triangle.">_fc_calcTriArea</a>(numDim, coords[1], &amp;area_tri2);
<a name="l07317"></a>07317   area1 = area_tri1 + area_tri2;
<a name="l07318"></a>07318   <a class="code" href="group__PrivateGeometricRelations.html#gbb6ad904da91e4639b3d7fc2046adabb" title="Compute surface area of a triangle.">_fc_calcTriArea</a>(numDim, coords[2], &amp;area_tri1);
<a name="l07319"></a>07319   <a class="code" href="group__PrivateGeometricRelations.html#gbb6ad904da91e4639b3d7fc2046adabb" title="Compute surface area of a triangle.">_fc_calcTriArea</a>(numDim, coords[3], &amp;area_tri2);
<a name="l07320"></a>07320   area2 = area_tri1 + area_tri2;
<a name="l07321"></a>07321 
<a name="l07322"></a>07322   <span class="comment">// return smaller area</span>
<a name="l07323"></a>07323   <span class="keywordflow">if</span> (area1 &lt; area2)
<a name="l07324"></a>07324     *area = area1;
<a name="l07325"></a>07325   <span class="keywordflow">else</span>
<a name="l07326"></a>07326     *area = area2;
<a name="l07327"></a>07327   
<a name="l07328"></a>07328   <span class="keywordflow">return</span>;
<a name="l07329"></a>07329 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g57be9af467e6c84e274d6828ae4b52b0"></a><!-- doxytag: member="geom.c::_fc_calcQuadLocation" ref="g57be9af467e6c84e274d6828ae4b52b0" args="(FC_Coords *vertices, int numParam, double *params, FC_Coords *point)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcQuadLocation           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>point</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute parameterization of a point on a quad. 
<p>
<b>Description:</b> <p>
Given a point on a quad, computes the parameterization location (in u &amp; v) of that point. Combined with fc_calcQuadLocation, it can be used to find the location of a point on a quad that has been moved or distorted.<p>
I.e. given an initial quad and a point in xyz space, the points' relative position in the quad can determined as the parameters u and v. If the quad's vertices' coordinates change. The new xzy coordinates of the point can be determined from u and v and the new quad's coordinates. See fc_calcQuadLocation.<p>
Assumes that the quad is planar. Code is based on implementation in VTK (visualization toolkit). Somebody should probably check the theoretics ....<p>
<b>Modifications:</b> <ul>
<li>2003-SEP-04 Wendy Koegler Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the vertices of the quad </td></tr>
<tr><td valign="top"><em>numParam</em>&nbsp;</td><td>
input - the number of params </td></tr>
<tr><td valign="top"><em>params</em>&nbsp;</td><td>
input - the parameters of the point </td></tr>
<tr><td valign="top"><em>point</em>&nbsp;</td><td>
output - 3d coordinates of the point </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07177">7177</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>Referenced by <a class="el" href="sierra_8c-source.html#l01209">fc_evalPrestoSpotWeld()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07182"></a>07182   {
<a name="l07183"></a>07183   <span class="keywordtype">int</span> i, j;
<a name="l07184"></a>07184   <span class="keywordtype">double</span> params_m[2];
<a name="l07185"></a>07185   <span class="keywordtype">double</span> weights[4];
<a name="l07186"></a>07186   
<a name="l07187"></a>07187   <span class="comment">// FIX? default value?</span>
<a name="l07188"></a>07188 
<a name="l07189"></a>07189   <span class="keywordflow">if</span> (numParam != 2)
<a name="l07190"></a>07190     <span class="keywordflow">return</span>;
<a name="l07191"></a>07191 
<a name="l07192"></a>07192   <span class="comment">// intermediate calcs</span>
<a name="l07193"></a>07193   params_m[0] = 1. - params[0];
<a name="l07194"></a>07194   params_m[1] = 1. - params[1];
<a name="l07195"></a>07195   weights[0] = params_m[0] * params_m[1];
<a name="l07196"></a>07196   weights[1] =   params[0] * params_m[1];
<a name="l07197"></a>07197   weights[2] =   params[0] *   params[1];
<a name="l07198"></a>07198   weights[3] = params_m[0] *   params[1];
<a name="l07199"></a>07199 
<a name="l07200"></a>07200   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l07201"></a>07201     (*point)[i] = 0;
<a name="l07202"></a>07202 
<a name="l07203"></a>07203   <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) 
<a name="l07204"></a>07204     <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) 
<a name="l07205"></a>07205       (*point)[j] += vertices[i][j] * weights[i];
<a name="l07206"></a>07206 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gda6b93e0c869be3fc8be603801ed56c9"></a><!-- doxytag: member="geom.c::_fc_calcQuadParams" ref="gda6b93e0c869be3fc8be603801ed56c9" args="(FC_Coords *vertices, FC_Coords point, int *numParam, double **params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcQuadParams           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>params</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute parameterization of a point on a quad. 
<p>
<b>Description:</b> <p>
Given a point on a quad, computes the parameterization location (in u &amp; v) of that point. Combined with fc_calcQuadLocation, it can be used to find the location of a point on a quad that has been moved or distorted. (If the point is not on the surface of the quad, the closest point on the surface of the quad is parameterized.)<p>
I.e. given an initial quad and a point in xyz space, the points' relative position in the quad can determined as the parameters u and v. If the quad's vertices' coordinates change. The new xzy coordinates of the point can be determined from u and v and the new quad's coordinates. See fc_calcQuadLocation.<p>
Although this routine returns doubles, they are only gauranted to have as many significant digits as a float.<p>
<b>Modifications:</b> <ul>
<li>2003-SEP-04 Wendy Koegler Created.</li><li>2006-09-07 WSD Clarified exit conditions. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the vertices of the quad </td></tr>
<tr><td valign="top"><em>point</em>&nbsp;</td><td>
input - 3d coordinates of a point </td></tr>
<tr><td valign="top"><em>numParam</em>&nbsp;</td><td>
output - the number of params found (0 or 2) </td></tr>
<tr><td valign="top"><em>params</em>&nbsp;</td><td>
output - the parameters found </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07013">7013</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l06901">_fc_calcSurfaceNormal()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, and <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>.</p>

<p>Referenced by <a class="el" href="sierra_8c-source.html#l01209">fc_evalPrestoSpotWeld()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07018"></a>07018   {
<a name="l07019"></a>07019   <span class="keywordtype">int</span> i, j;
<a name="l07020"></a>07020   <span class="keywordtype">int</span> iter, MAX_ITER = 10;
<a name="l07021"></a>07021   <span class="keywordtype">int</span> converged;
<a name="l07022"></a>07022   <span class="keywordtype">double</span> diff[2], current[2], current_m[2];
<a name="l07023"></a>07023   <span class="keywordtype">double</span> fcol[2]; <span class="comment">// solution vector</span>
<a name="l07024"></a>07024   <span class="keywordtype">double</span> rcol[2], scol[2];  <span class="comment">// columns of the Jacobian matrix</span>
<a name="l07025"></a>07025   <span class="keywordtype">double</span> determinant;  <span class="comment">// matrix determinant</span>
<a name="l07026"></a>07026   <span class="keywordtype">double</span> weights[4];
<a name="l07027"></a>07027   <span class="keywordtype">double</span> derivs[8];
<a name="l07028"></a>07028   <span class="keywordtype">double</span> proj_point[3];
<a name="l07029"></a>07029   <a class="code" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb" title="Vector data structure.">FC_Vector</a> normal;
<a name="l07030"></a>07030   <span class="keywordtype">int</span> indices[2];
<a name="l07031"></a>07031   <span class="keywordtype">int</span> maxID; <span class="comment">// the index of the max component (which we will drop)</span>
<a name="l07032"></a>07032   <span class="keywordtype">double</span> maxComponent;
<a name="l07033"></a>07033   
<a name="l07034"></a>07034   <span class="comment">// default values</span>
<a name="l07035"></a>07035   *numParam = 0;
<a name="l07036"></a>07036   *params = NULL;
<a name="l07037"></a>07037 
<a name="l07038"></a>07038   <span class="comment">// get normal</span>
<a name="l07039"></a>07039   <a class="code" href="group__PrivateGeometricRelations.html#g7e5b770477c5b1839f8ee522e6980c17" title="Compute unit normal of surface.">_fc_calcSurfaceNormal</a>(4, vertices, &amp;normal);
<a name="l07040"></a>07040 
<a name="l07041"></a>07041   <span class="comment">// project point to plane of quad</span>
<a name="l07042"></a>07042   {
<a name="l07043"></a>07043     <span class="keywordtype">double</span> temp_point[3];
<a name="l07044"></a>07044     <span class="keywordtype">double</span> temp;
<a name="l07045"></a>07045 
<a name="l07046"></a>07046     <span class="comment">// vector from point to "origin" of plane</span>
<a name="l07047"></a>07047     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l07048"></a>07048       temp_point[i] = point[i] - vertices[0][i];
<a name="l07049"></a>07049     <span class="comment">// compute dot product</span>
<a name="l07050"></a>07050     temp = 0;
<a name="l07051"></a>07051     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l07052"></a>07052       temp += normal[i]*temp_point[i];
<a name="l07053"></a>07053     <span class="comment">// ??</span>
<a name="l07054"></a>07054     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l07055"></a>07055       proj_point[i] = point[i] - temp*normal[i];
<a name="l07056"></a>07056   }
<a name="l07057"></a>07057 
<a name="l07058"></a>07058   <span class="comment">// choose indices</span>
<a name="l07059"></a>07059   maxID = 2;  
<a name="l07060"></a>07060   maxComponent = fabs(normal[2]);
<a name="l07061"></a>07061   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l07062"></a>07062     <span class="keywordflow">if</span> (fabs(normal[i]) &gt; maxComponent) {
<a name="l07063"></a>07063       maxID = i;
<a name="l07064"></a>07064       maxComponent = fabs(normal[i]);
<a name="l07065"></a>07065     }
<a name="l07066"></a>07066   }
<a name="l07067"></a>07067   j = 0;
<a name="l07068"></a>07068   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {
<a name="l07069"></a>07069     <span class="keywordflow">if</span> (i != maxID) {
<a name="l07070"></a>07070       indices[j] = i;
<a name="l07071"></a>07071       j++;
<a name="l07072"></a>07072     }
<a name="l07073"></a>07073   }
<a name="l07074"></a>07074 
<a name="l07075"></a>07075   <span class="comment">// Use Newton's method to solve for parametric coordinates</span>
<a name="l07076"></a>07076 
<a name="l07077"></a>07077   <span class="comment">// initial guess - starting at (0, 0) cause that can be a problem point</span>
<a name="l07078"></a>07078   current[0] = current[1] = 0;
<a name="l07079"></a>07079 
<a name="l07080"></a>07080   converged = 0;
<a name="l07081"></a>07081   <span class="keywordflow">for</span> (iter = 0; iter &lt; MAX_ITER; iter++) {
<a name="l07082"></a>07082     <span class="comment">// intermediate calcs</span>
<a name="l07083"></a>07083     current_m[0] = 1. - current[0];
<a name="l07084"></a>07084     current_m[1] = 1. - current[1];
<a name="l07085"></a>07085     weights[0] = current_m[0] * current_m[1];
<a name="l07086"></a>07086     weights[1] =   current[0] * current_m[1];
<a name="l07087"></a>07087     weights[2] =   current[0] *   current[1];
<a name="l07088"></a>07088     weights[3] = current_m[0] *   current[1];
<a name="l07089"></a>07089     derivs[0] = -1 * current_m[1];
<a name="l07090"></a>07090     derivs[1] =      current_m[1];
<a name="l07091"></a>07091     derivs[2] =        current[1];
<a name="l07092"></a>07092     derivs[3] = -1 *   current[1];
<a name="l07093"></a>07093     derivs[4] = -1 * current_m[0];
<a name="l07094"></a>07094     derivs[5] = -1 *   current[0];
<a name="l07095"></a>07095     derivs[6] =        current[0];
<a name="l07096"></a>07096     derivs[7] =      current_m[0];
<a name="l07097"></a>07097 
<a name="l07098"></a>07098     <span class="comment">// calculate newton functions</span>
<a name="l07099"></a>07099     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l07100"></a>07100       fcol[i] = -1 * proj_point[indices[i]];
<a name="l07101"></a>07101       rcol[i] = scol[i] = 0.0;
<a name="l07102"></a>07102     }
<a name="l07103"></a>07103 
<a name="l07104"></a>07104     <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {
<a name="l07105"></a>07105       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) { <span class="comment">// overdetermined system, only use 2 of 3 dims</span>
<a name="l07106"></a>07106         fcol[j] += vertices[i][indices[j]] * weights[i];
<a name="l07107"></a>07107         rcol[j] += vertices[i][indices[j]] * derivs[i];
<a name="l07108"></a>07108         scol[j] += vertices[i][indices[j]] * derivs[i+4];
<a name="l07109"></a>07109       }
<a name="l07110"></a>07110     }
<a name="l07111"></a>07111 
<a name="l07112"></a>07112     determinant = rcol[0]*scol[1] - scol[0]*rcol[1];
<a name="l07113"></a>07113     <span class="comment">// FIX: check, a zero determinant is bad</span>
<a name="l07114"></a>07114     diff[0] = (fcol[0]*scol[1] - scol[0]*fcol[1])/determinant;
<a name="l07115"></a>07115     diff[1] = (rcol[0]*fcol[1] - fcol[0]*rcol[1])/determinant;
<a name="l07116"></a>07116 
<a name="l07117"></a>07117     <span class="comment">// Test for exit, and set up next guess</span>
<a name="l07118"></a>07118     <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(current[0] - diff[0], current[0]) &amp;&amp;
<a name="l07119"></a>07119      <a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(current[1] - diff[1], current[1])) {
<a name="l07120"></a>07120       converged = 1;
<a name="l07121"></a>07121       <span class="keywordflow">break</span>;
<a name="l07122"></a>07122     }
<a name="l07123"></a>07123     
<a name="l07124"></a>07124     <span class="comment">// guess for next round</span>
<a name="l07125"></a>07125     current[0] -= diff[0];
<a name="l07126"></a>07126     current[1] -= diff[1];
<a name="l07127"></a>07127   } <span class="comment">// end of iteration</span>
<a name="l07128"></a>07128 
<a name="l07129"></a>07129   <span class="comment">// debug</span>
<a name="l07130"></a>07130   <span class="comment">//printf("***iter = %d, converged = %d\n", iter, converged);</span>
<a name="l07131"></a>07131   <span class="comment">//printf("***diff        = %.20g %.20g\n", diff[0], diff[1]);</span>
<a name="l07132"></a>07132   <span class="comment">//printf("***params      = %.20g %.20g\n", current[0], current[1]);</span>
<a name="l07133"></a>07133   <span class="comment">//printf("***params-diff = %.20g %.20g\n", current[0]-diff[0], current[1]-diff[1]);</span>
<a name="l07134"></a>07134 
<a name="l07135"></a>07135   <span class="comment">// HACK - The exit condition for the loop is very stringent</span>
<a name="l07136"></a>07136   <span class="comment">// here we have a more relaxed condition</span>
<a name="l07137"></a>07137   <span class="keywordflow">if</span> (fabs(diff[0]) &lt; FLT_EPSILON &amp;&amp; fabs(diff[1]) &lt; FLT_EPSILON) {
<a name="l07138"></a>07138     converged = 1;
<a name="l07139"></a>07139   }
<a name="l07140"></a>07140 
<a name="l07141"></a>07141   <span class="keywordflow">if</span> (converged) {
<a name="l07142"></a>07142     *numParam = 2;
<a name="l07143"></a>07143     *params = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*2);
<a name="l07144"></a>07144     <span class="keywordflow">if</span> ( *params == NULL) {
<a name="l07145"></a>07145       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l07146"></a>07146       exit(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l07147"></a>07147     } 
<a name="l07148"></a>07148     (*params)[0] = current[0];
<a name="l07149"></a>07149     (*params)[1] = current[1];
<a name="l07150"></a>07150   }
<a name="l07151"></a>07151 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g7e5b770477c5b1839f8ee522e6980c17"></a><!-- doxytag: member="geom.c::_fc_calcSurfaceNormal" ref="g7e5b770477c5b1839f8ee522e6980c17" args="(int numPoint, FC_Coords *coords, FC_Vector *normal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcSurfaceNormal           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gc508ad9e9e18b66d934ef52c3d4fe8eb">FC_Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>normal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute unit normal of surface. 
<p>
<b>Description:</b> <p>
This function implements Newell's method of calculating the normal of a planar polygon. It has the advantage of providing a decent estimate of a normal if the polygon is not planar.<p>
Order of the points is important. Looking down on the plane, a counterclockwise traversal of the three points will yield a normal pointing up towards the viewer.<p>
This routine currently assumes 3D coordinates. If you are less than 3D, pad with zeros. This can't do more than 3D.<p>
Reference for Newell's method: Hill, Francis S, "Computer Graphics", Prentice Hall, 1990, pg 258.<p>
<b>Modifications:</b> <ul>
<li>2003-SEP-04 W Koegler Created: _fc_SurfaceNormal was split between this function and fc_getSurfaceNormals for better modularity.</li><li>11/3/04 WSK Renamed &amp; rewritten to use Newell's method (so will find estimate of surface normal of non-planar quads). </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numPoint</em>&nbsp;</td><td>
input - number of points (at least 3) </td></tr>
<tr><td valign="top"><em>coords</em>&nbsp;</td><td>
input - array of point coordinates (at least 3) </td></tr>
<tr><td valign="top"><em>normal</em>&nbsp;</td><td>
output - surface normal </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l06901">6901</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l07013">_fc_calcQuadParams()</a>, <a class="el" href="shape_8c-source.html#l00750">_fc_getOutwardFaceNormal()</a>, <a class="el" href="sierra_8c-source.html#l01209">fc_evalPrestoSpotWeld()</a>, <a class="el" href="geom_8c-source.html#l04542">fc_getDisplacedSurfaceNormals()</a>, <a class="el" href="geom_8c-source.html#l04448">fc_getSurfaceNormals()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06905"></a>06905   {
<a name="l06906"></a>06906   <span class="keywordtype">int</span> i;
<a name="l06907"></a>06907   <span class="keywordtype">double</span> *point1, *point2; <span class="comment">// temp pointers to points</span>
<a name="l06908"></a>06908   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> temp_norm;
<a name="l06909"></a>06909   <span class="keywordtype">double</span> magnitude;
<a name="l06910"></a>06910  
<a name="l06911"></a>06911   <span class="comment">// log message</span>
<a name="l06912"></a>06912   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Computing a normal vector."</span>);   
<a name="l06913"></a>06913  
<a name="l06914"></a>06914   <span class="comment">// init </span>
<a name="l06915"></a>06915   temp_norm[0] = 0.;
<a name="l06916"></a>06916   temp_norm[1] = 0.;
<a name="l06917"></a>06917   temp_norm[2] = 0.;
<a name="l06918"></a>06918 
<a name="l06919"></a>06919   <span class="comment">// Newell method</span>
<a name="l06920"></a>06920   <span class="keywordflow">for</span> (i = 0; i &lt; numPoint; i++) {
<a name="l06921"></a>06921     point1 = coords[i];
<a name="l06922"></a>06922     <span class="keywordflow">if</span> (i == numPoint - 1)
<a name="l06923"></a>06923       point2 = coords[0];
<a name="l06924"></a>06924     <span class="keywordflow">else</span>
<a name="l06925"></a>06925       point2 = coords[i+1];
<a name="l06926"></a>06926     temp_norm[0] += (point1[1] - point2[1])*(point1[2] + point2[2]);  
<a name="l06927"></a>06927     temp_norm[1] += (point1[2] - point2[2])*(point1[0] + point2[0]);  
<a name="l06928"></a>06928     temp_norm[2] += (point1[0] - point2[0])*(point1[1] + point2[1]);  
<a name="l06929"></a>06929   }
<a name="l06930"></a>06930 
<a name="l06931"></a>06931   <span class="comment">// Convert to unit vector</span>
<a name="l06932"></a>06932   magnitude = 0;
<a name="l06933"></a>06933   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l06934"></a>06934     magnitude += temp_norm[i]*temp_norm[i];
<a name="l06935"></a>06935   magnitude = sqrt(magnitude);
<a name="l06936"></a>06936   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l06937"></a>06937     (*normal)[i] = temp_norm[i]/magnitude;
<a name="l06938"></a>06938 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8f34c9a8ae4ccb9a33a246150ee4c5cb"></a><!-- doxytag: member="geom.c::_fc_calcTetVolume" ref="g8f34c9a8ae4ccb9a33a246150ee4c5cb" args="(FC_Coords *vertices, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcTetVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute volume of a tetrahedron. 
<p>
<b>Description:</b> <p>
Provide array of four vertex coords and get the volume back.<p>
Implementation taken from vtk: vtkTetra::ComputeVolume.<p>
<b>Modifications:</b> <ul>
<li>8/23/04 WSK Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the tri </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - surface area </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07344">7344</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l06973">_fc_calcDeterminant3x3()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l07456">_fc_calcHexVolume()</a>, <a class="el" href="geom_8c-source.html#l07416">_fc_calcPrismVolume()</a>, <a class="el" href="geom_8c-source.html#l07375">_fc_calcPyramidVolume()</a>, <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, and <a class="el" href="geom_8c-source.html#l03808">fc_getRegionVolumes()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07347"></a>07347   {
<a name="l07348"></a>07348   *volume = <a class="code" href="group__PrivateGeometricRelations.html#gea8933e6c516830370e0460b1e9d191a" title="Calculate determinant of a 3x3 matrix.">_fc_calcDeterminant3x3</a>(vertices[1][0] - vertices[0][0],
<a name="l07349"></a>07349                                    vertices[2][0] - vertices[0][0],
<a name="l07350"></a>07350                                    vertices[3][0] - vertices[0][0],
<a name="l07351"></a>07351                                    vertices[1][1] - vertices[0][1],
<a name="l07352"></a>07352                                    vertices[2][1] - vertices[0][1],
<a name="l07353"></a>07353                                    vertices[3][1] - vertices[0][1],
<a name="l07354"></a>07354                                    vertices[1][2] - vertices[0][2],
<a name="l07355"></a>07355                                    vertices[2][2] - vertices[0][2],
<a name="l07356"></a>07356                                    vertices[3][2] - vertices[0][2]) / 6.0;
<a name="l07357"></a>07357   <span class="keywordflow">return</span>;
<a name="l07358"></a>07358 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gbb6ad904da91e4639b3d7fc2046adabb"></a><!-- doxytag: member="geom.c::_fc_calcTriArea" ref="gbb6ad904da91e4639b3d7fc2046adabb" args="(int numDim, FC_Coords *vertices, double *area)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _fc_calcTriArea           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>vertices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>area</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute surface area of a triangle. 
<p>
<b>Description:</b> <p>
Provide array of three vertex coords and get the area back.<p>
<b>Modifications:</b> <ul>
<li>8/23/04 WSK Created</li><li>6/30/06 WSD Saw roundoff error w/ gcc 4 with Kahan's algorithm, switched back to Heron's which works fine. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
input - the dimensionality of coordinates </td></tr>
<tr><td valign="top"><em>vertices</em>&nbsp;</td><td>
input - the coordinates of the tri </td></tr>
<tr><td valign="top"><em>area</em>&nbsp;</td><td>
output - surface area </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07227">7227</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8c-source.html#l00163">fc_calcSquaredEuclideanDistance()</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l07296">_fc_calcQuadArea()</a>, <a class="el" href="geom_8c-source.html#l03702">fc_getDisplacedFaceAreas()</a>, and <a class="el" href="geom_8c-source.html#l03600">fc_getFaceAreas()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07231"></a>07231   {
<a name="l07232"></a>07232   <span class="keywordtype">double</span> a2, b2, c2;
<a name="l07233"></a>07233   <span class="comment">//double a, b, c, da, db, dc;</span>
<a name="l07234"></a>07234 
<a name="l07235"></a>07235   <span class="comment">// get lengths of sides of triangle</span>
<a name="l07236"></a>07236   <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(vertices[0], vertices[1], numDim, &amp;a2);
<a name="l07237"></a>07237   <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(vertices[1], vertices[2], numDim, &amp;b2);
<a name="l07238"></a>07238   <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(vertices[2], vertices[0], numDim, &amp;c2);
<a name="l07239"></a>07239 
<a name="l07240"></a>07240   <span class="comment">// A version of Heron's formula</span>
<a name="l07241"></a>07241   *area = 0.25 * sqrt(fabs(4.0*a2*c2 - (a2-b2+c2)*(a2-b2+c2)));
<a name="l07242"></a>07242 
<a name="l07243"></a>07243   <span class="comment">// Not used: found lacking on 6/30/06 by WSD. Switch back to old formula</span>
<a name="l07244"></a>07244   <span class="comment">// This formula is from pdf found on the web:</span>
<a name="l07245"></a>07245   <span class="comment">// http://www.cs.berkeley.edu/~wkahan/VtetLang.pdf</span>
<a name="l07246"></a>07246   <span class="comment">// "What has the Volume of a Tetrahedron to do with Computer</span>
<a name="l07247"></a>07247   <span class="comment">// Programming Languages?" </span>
<a name="l07248"></a>07248   <span class="comment">// by Prof. W. Kahan, Math Dept &amp; EE &amp; CS Dept at Berkeley</span>
<a name="l07249"></a>07249   <span class="comment">//</span>
<a name="l07250"></a>07250   <span class="comment">// It is supposed to be more accurate in terms of roundoff error</span>
<a name="l07251"></a>07251   <span class="comment">// than the typical Heron's formula and other methods. </span>
<a name="l07252"></a>07252   <span class="comment">/*</span>
<a name="l07253"></a>07253 <span class="comment">  if (b &gt; c)</span>
<a name="l07254"></a>07254 <span class="comment">    da = (b - a) + c;</span>
<a name="l07255"></a>07255 <span class="comment">  else </span>
<a name="l07256"></a>07256 <span class="comment">    da = (c - a) + b;</span>
<a name="l07257"></a>07257 <span class="comment">  if (a &gt; c)</span>
<a name="l07258"></a>07258 <span class="comment">    db = (a - b) + c;</span>
<a name="l07259"></a>07259 <span class="comment">  else</span>
<a name="l07260"></a>07260 <span class="comment">    db = (c - b) + a;</span>
<a name="l07261"></a>07261 <span class="comment">  if (a &gt; b)</span>
<a name="l07262"></a>07262 <span class="comment">    dc = (a - c) + b;</span>
<a name="l07263"></a>07263 <span class="comment">  else</span>
<a name="l07264"></a>07264 <span class="comment">    dc = (b - c) + a;</span>
<a name="l07265"></a>07265 <span class="comment">  *area = 0.25 * sqrt((a+b+c)*da*db*dc);</span>
<a name="l07266"></a>07266 <span class="comment">  */</span>
<a name="l07267"></a>07267 
<a name="l07268"></a>07268   <span class="keywordflow">return</span>;
<a name="l07269"></a>07269 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gdcc212e0f8daaf7ebb72296740115a68"></a><!-- doxytag: member="geom.c::_fc_createVertexBinCore" ref="gdcc212e0f8daaf7ebb72296740115a68" args="(int numVertex, int numDim, double *coords, FC_Coords lowers, FC_Coords uppers, FC_VertexBin **bin_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_createVertexBinCore           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numVertex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>uppers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>bin_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create spatial bins for vertices for geometric queries. 
<p>
<b>Description:</b> <p>
Create an <a class="el" href="structFC__VertexBin.html" title="Spatially binned vertex IDs.">FC_VertexBin</a> to use for geometric queries. The user is responsible for freeing the created <a class="el" href="structFC__VertexBin.html" title="Spatially binned vertex IDs.">FC_VertexBin</a> by calling <a class="el" href="group__GeometricRelations.html#g61af43e397e8863e3b1d4b60b033daef" title="Clear memory in an FC_VertexBin.">fc_freeVertexBin()</a>.<p>
The algorithm attempts to create bins of roughly equal width in each dimension, and that hold on average about 1 vertex each. Given the Widths of the bounding box of the mesh (Wx,Wy,Wz) and the number of vertices (numVertex) and our requirement of one vertex per bin we can write a conservation of vertices:<p>
Wx * Wy * Wz ~ (Wbin)^3 * numVertex<p>
where Wbin is the bin width for each dimension. However, the bin widths are restricted so that the number of bins in the bounding box of the mesh is an integer. Given that<p>
Wbin-x * nx = Wx<p>
We first choose nx (number of bins in x direction) as<p>
nx = (truncate to int) Wx * cubic_root(numVertex / (Wx*Wy*Wz))<p>
(except if nx &lt; 1, then nx = 1) and then calculate the actual bin width<p>
Wbin-x = Wx / nx<p>
And repeat for z and y.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000048">Todo:</a></b></dt><dd><ul>
<li>Check that this works with 2D coords</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>03/08/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numVertex</em>&nbsp;</td><td>
input - number of verts to go into the vertex bin </td></tr>
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
input - dimensionsality of * coords </td></tr>
<tr><td valign="top"><em>coords</em>&nbsp;</td><td>
input - coords of vertices </td></tr>
<tr><td valign="top"><em>lowers</em>&nbsp;</td><td>
input - the bounding box of the point set </td></tr>
<tr><td valign="top"><em>uppers</em>&nbsp;</td><td>
input - the bounding box of the point set </td></tr>
<tr><td valign="top"><em>bin_p</em>&nbsp;</td><td>
output - bin </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l06179">6179</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8h-source.html#l00220">FC_VertexBin::binWidths</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="geom_8h-source.html#l00216">FC_VertexBin::lowerCoords</a>, <a class="el" href="geom_8h-source.html#l00219">FC_VertexBin::numBins</a>, <a class="el" href="geom_8h-source.html#l00221">FC_VertexBin::numVertex</a>, <a class="el" href="geom_8h-source.html#l00217">FC_VertexBin::upperCoords</a>, <a class="el" href="geom_8h-source.html#l00222">FC_VertexBin::vertexIDs</a>, and <a class="el" href="geom_8h-source.html#l00218">FC_VertexBin::widths</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l05589">fc_createDisplacedMeshVertexBin()</a>, and <a class="el" href="geom_8c-source.html#l05522">fc_createMeshVertexBin()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06188"></a>06188 {
<a name="l06189"></a>06189   <span class="comment">//FC_ReturnCode rc;</span>
<a name="l06190"></a>06190   <span class="keywordtype">int</span> i, j, I, J, K;
<a name="l06191"></a>06191   <span class="keywordtype">double</span> volume, density;   <span class="comment">// number of points per unit volume, but cube root</span>
<a name="l06192"></a>06192   <span class="keywordtype">int</span> icoords[3] = { 0, 0, 0 };          <span class="comment">// i j k coords of a bin</span>
<a name="l06193"></a>06193   <span class="keywordtype">void</span>* temp;
<a name="l06194"></a>06194   <a class="code" href="structFC__VertexBin.html" title="Spatially binned vertex IDs.">FC_VertexBin</a>* bin;
<a name="l06195"></a>06195 
<a name="l06196"></a>06196   <span class="comment">// default output</span>
<a name="l06197"></a>06197   <span class="keywordflow">if</span> (bin_p)
<a name="l06198"></a>06198     *bin_p = NULL;
<a name="l06199"></a>06199 
<a name="l06200"></a>06200   <span class="comment">// Check input</span>
<a name="l06201"></a>06201   <span class="keywordflow">if</span> (bin_p == NULL) {
<a name="l06202"></a>06202     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l06203"></a>06203     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06204"></a>06204   }
<a name="l06205"></a>06205   
<a name="l06206"></a>06206   <span class="comment">// log message</span>
<a name="l06207"></a>06207   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Creating spatial bins for vertices."</span>);
<a name="l06208"></a>06208 
<a name="l06209"></a>06209   <span class="comment">// Setup basics</span>
<a name="l06210"></a>06210   bin = calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="structFC__VertexBin.html" title="Spatially binned vertex IDs.">FC_VertexBin</a>));
<a name="l06211"></a>06211   <span class="keywordflow">if</span> (bin == NULL) {
<a name="l06212"></a>06212     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06213"></a>06213     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06214"></a>06214   }
<a name="l06215"></a>06215   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l06216"></a>06216     bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[i] = lowers[i];
<a name="l06217"></a>06217     bin-&gt;<a class="code" href="structFC__VertexBin.html#f1793ac2823dd0e600860ea10a043eb8">upperCoords</a>[i] = uppers[i];
<a name="l06218"></a>06218     bin-&gt;<a class="code" href="structFC__VertexBin.html#bb883b93149f6441a37a7ec9b730d49e">widths</a>[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#f1793ac2823dd0e600860ea10a043eb8">upperCoords</a>[i] - bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[i];
<a name="l06219"></a>06219   }
<a name="l06220"></a>06220 
<a name="l06221"></a>06221   <span class="comment">// determine number of bins (at least 1 bin in each dimension)</span>
<a name="l06222"></a>06222   volume = 1;
<a name="l06223"></a>06223   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l06224"></a>06224     volume *= bin-&gt;<a class="code" href="structFC__VertexBin.html#bb883b93149f6441a37a7ec9b730d49e">widths</a>[i];
<a name="l06225"></a>06225   density = pow(numVertex/volume, 1./3.);
<a name="l06226"></a>06226   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l06227"></a>06227     bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] = (int)(bin-&gt;<a class="code" href="structFC__VertexBin.html#bb883b93149f6441a37a7ec9b730d49e">widths</a>[i]*density); <span class="comment">// truncate</span>
<a name="l06228"></a>06228     <span class="keywordflow">if</span> (bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] &lt; 1) {
<a name="l06229"></a>06229       bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] = 1;
<a name="l06230"></a>06230       bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#bb883b93149f6441a37a7ec9b730d49e">widths</a>[i];
<a name="l06231"></a>06231     }
<a name="l06232"></a>06232     <span class="keywordflow">else</span>
<a name="l06233"></a>06233       bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#bb883b93149f6441a37a7ec9b730d49e">widths</a>[i]/bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i];
<a name="l06234"></a>06234   }
<a name="l06235"></a>06235 
<a name="l06236"></a>06236   <span class="comment">// make space for bins</span>
<a name="l06237"></a>06237   bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a> = malloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[0]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>**));
<a name="l06238"></a>06238   bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a> = malloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[0]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>***));
<a name="l06239"></a>06239   <span class="keywordflow">if</span> ( bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a> == NULL ||  bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a> == NULL) {
<a name="l06240"></a>06240     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06241"></a>06241     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06242"></a>06242   } 
<a name="l06243"></a>06243   <span class="keywordflow">for</span> (i = 0; i &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[0]; i++) {
<a name="l06244"></a>06244     bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[i] = malloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[1]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l06245"></a>06245     bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i] = malloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[1]*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>**));
<a name="l06246"></a>06246     <span class="keywordflow">if</span> ( bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[i] == NULL ||  bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i] == NULL) {
<a name="l06247"></a>06247       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06248"></a>06248       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06249"></a>06249     } 
<a name="l06250"></a>06250     <span class="keywordflow">for</span> (j = 0; j &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[1]; j++) {
<a name="l06251"></a>06251       bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[i][j] = calloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[2], <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l06252"></a>06252       bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i][j] = calloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[2], <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>*));
<a name="l06253"></a>06253       <span class="keywordflow">if</span> ( bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[i][j] == NULL ||  bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i][j] == NULL) {
<a name="l06254"></a>06254         <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06255"></a>06255         <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06256"></a>06256       } 
<a name="l06257"></a>06257     }
<a name="l06258"></a>06258   }
<a name="l06259"></a>06259 
<a name="l06260"></a>06260   <span class="comment">// Put vertices in the bins</span>
<a name="l06261"></a>06261   <span class="comment">// Usually cells on boundaries of bins land in next bin up</span>
<a name="l06262"></a>06262   <span class="comment">// (except for highest bin)</span>
<a name="l06263"></a>06263   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++) {
<a name="l06264"></a>06264     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++) { 
<a name="l06265"></a>06265       icoords[j] = (int) ((coords[i*numDim+j] - bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[j]) / 
<a name="l06266"></a>06266         bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[j]);
<a name="l06267"></a>06267       <span class="comment">// check boundaries</span>
<a name="l06268"></a>06268       <span class="keywordflow">if</span> (icoords[j] &lt; 0)
<a name="l06269"></a>06269         icoords[j] = 0;
<a name="l06270"></a>06270       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (icoords[j] == bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[j])
<a name="l06271"></a>06271         icoords[j] = bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[j] - 1;
<a name="l06272"></a>06272     }
<a name="l06273"></a>06273     <span class="keywordflow">for</span> (j = numDim; j &lt; 3; j++)
<a name="l06274"></a>06274       icoords[j] = 0;
<a name="l06275"></a>06275     I = icoords[0];
<a name="l06276"></a>06276     J = icoords[1];
<a name="l06277"></a>06277     K = icoords[2];
<a name="l06278"></a>06278     temp = realloc(bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[I][J][K], 
<a name="l06279"></a>06279                    (1 + bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[I][J][K])*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l06280"></a>06280     <span class="keywordflow">if</span> (temp == NULL) {
<a name="l06281"></a>06281       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06282"></a>06282       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06283"></a>06283     }
<a name="l06284"></a>06284     bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[I][J][K] = temp;
<a name="l06285"></a>06285     bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[I][J][K][bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[I][J][K]] = i;
<a name="l06286"></a>06286     bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[I][J][K]++;
<a name="l06287"></a>06287   }
<a name="l06288"></a>06288   
<a name="l06289"></a>06289   *bin_p = bin;
<a name="l06290"></a>06290   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l06291"></a>06291 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g52ad166d5c4ae4ffac8db3edd83ca1df"></a><!-- doxytag: member="geom.c::_fc_doesElementContainPoint" ref="g52ad166d5c4ae4ffac8db3edd83ca1df" args="(FC_Mesh mesh, int element_id, double point[3], int dim, int max_num_vert_per_face, int *num_vert_per_face, int *face_conns, double *vert_coords, int *hit_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_doesElementContainPoint           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>element_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>point</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max_num_vert_per_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>num_vert_per_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>face_conns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>vert_coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>hit_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal function for determining whether a point is located within an element. 
<p>
<b>Description:</b> <p>
This internal function determines whether a point resides inside of an element or not. The function requires a number of inputs, including information about the mesh's faces and vertex coordinates (which can be obtained with <a class="el" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr()</a> and <a class="el" href="group__Mesh.html#g8e318f4b17572413004acf14b18deb2b" title="Return face connectivities.">fc_getMeshFaceConnsPtr()</a>).<p>
This function obtains all of the element's faces and then breaks each face into a collection of triangles. A ray-triangle intersection computation is performed with each triangle. If the point is inside the element, there will only be one intersection with a triangle. This function tries to detect when an intersection point happens to fall on the edge between two triangles (by verifying the distance is the same). In the case where the input point is lies in one of the element's faces, it is counted as being contained within the element.<p>
note: it is possible for multiple elements to contain an element if (a) the elements overlap, or (b) the point lies on a vertex or face the two elements have in common.<p>
<b>Modifications:</b> <ul>
<li>03/20/2008 CDU Initial version </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - The mesh this element belong to </td></tr>
<tr><td valign="top"><em>element_id</em>&nbsp;</td><td>
input - The id of the mesh element being examined </td></tr>
<tr><td valign="top"><em>point</em>&nbsp;</td><td>
input - The xyz coordinate being evaluated </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
input - The dimension of the coordinates (must be 3) </td></tr>
<tr><td valign="top"><em>max_num_vert_per_face</em>&nbsp;</td><td>
input - maximum number of vertices a face can have </td></tr>
<tr><td valign="top"><em>num_vert_per_face</em>&nbsp;</td><td>
input - number of vertices each face has </td></tr>
<tr><td valign="top"><em>face_conns</em>&nbsp;</td><td>
input - face connectivity list </td></tr>
<tr><td valign="top"><em>vert_coords</em>&nbsp;</td><td>
input - coordinates for each vertex </td></tr>
<tr><td valign="top"><em>hit_type</em>&nbsp;</td><td>
output - Result (0=does not contain, 1=containts, 2=contains, but point is on a face) </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l07629">7629</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="util_8c-source.html#l00606">fc_eqd()</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l07501">fc_getIntersectionBetweenRayAndTriangle()</a>, <a class="el" href="topo_8c-source.html#l00116">fc_getMeshEntityChildren()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="util_8c-source.html#l00691">fc_gtd()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l07774">fc_doesElementContainPoint()</a>, and <a class="el" href="geom_8c-source.html#l07852">fc_getElementsThatContainPoint()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l07639"></a>07639  {
<a name="l07640"></a>07640 
<a name="l07641"></a>07641   <span class="keywordtype">int</span> i,j;
<a name="l07642"></a>07642   <span class="keywordtype">int</span> num_faces;
<a name="l07643"></a>07643   <span class="keywordtype">int</span> *face_ids;
<a name="l07644"></a>07644 
<a name="l07645"></a>07645 
<a name="l07646"></a>07646   <span class="keywordtype">int</span> found_positive_hit, found_negative_hit;
<a name="l07647"></a>07647   <span class="keywordtype">double</span> t_val_positive, t_val_negative;
<a name="l07648"></a>07648   <span class="keywordtype">int</span> face_offset;
<a name="l07649"></a>07649   <span class="keywordtype">double</span> t;
<a name="l07650"></a>07650   <span class="keywordtype">int</span> hit;
<a name="l07651"></a>07651 
<a name="l07652"></a>07652   <span class="comment">//In theory, we should do the test multiple times with randomly</span>
<a name="l07653"></a>07653   <span class="comment">//generated directions. This helps weed out corner cases where</span>
<a name="l07654"></a>07654   <span class="comment">//an edge/vertex happens to be in just the wrong spot. However, if we</span>
<a name="l07655"></a>07655   <span class="comment">//compare the distance of all he intersections, and consider t=0.0 to</span>
<a name="l07656"></a>07656   <span class="comment">//be a special case, I believe we can live with a single direction.</span>
<a name="l07657"></a>07657   <span class="keywordtype">double</span> ray_direction[3] = {1.0, 0.0, 0.0};
<a name="l07658"></a>07658 
<a name="l07659"></a>07659 
<a name="l07660"></a>07660   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l07661"></a>07661 
<a name="l07662"></a>07662   <span class="comment">//Check inputs. Note: Mesh is checked in following step</span>
<a name="l07663"></a>07663   <span class="keywordflow">if</span>(  (element_id&lt;0) || (!point) || (!ray_direction) || 
<a name="l07664"></a>07664        (max_num_vert_per_face&lt;=0) || (!num_vert_per_face) ||
<a name="l07665"></a>07665        (!vert_coords) || (!hit_type) ) {
<a name="l07666"></a>07666     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l07667"></a>07667     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l07668"></a>07668   }
<a name="l07669"></a>07669 
<a name="l07670"></a>07670   <span class="keywordflow">if</span>(dim!=3){
<a name="l07671"></a>07671     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Containment functions only work with 3-Dimensional data"</span>);
<a name="l07672"></a>07672     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l07673"></a>07673   }
<a name="l07674"></a>07674 
<a name="l07675"></a>07675   *hit_type = 0; <span class="comment">//clear the output</span>
<a name="l07676"></a>07676 
<a name="l07677"></a>07677  
<a name="l07678"></a>07678   <span class="comment">//Need to get all the faces for this element</span>
<a name="l07679"></a>07679   rc = <a class="code" href="group__TopologyRelations.html#g08edc0183a4bb0e44eb226ea75177fd8" title="Get the entities which make up the specified entity.">fc_getMeshEntityChildren</a>(mesh, 
<a name="l07680"></a>07680                     <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, element_id, <span class="comment">//Parent: element </span>
<a name="l07681"></a>07681                     <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>,                <span class="comment">//Children: faces</span>
<a name="l07682"></a>07682                     &amp;num_faces, &amp;face_ids);
<a name="l07683"></a>07683   <span class="keywordflow">if</span>(rc!=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>) <span class="keywordflow">return</span> rc;
<a name="l07684"></a>07684 
<a name="l07685"></a>07685   found_positive_hit = found_negative_hit = 0;
<a name="l07686"></a>07686 
<a name="l07687"></a>07687   <span class="comment">//Scan through all faces of element</span>
<a name="l07688"></a>07688   <span class="keywordflow">for</span>(i=0; (i&lt;num_faces); i++){
<a name="l07689"></a>07689 
<a name="l07690"></a>07690     <span class="keywordflow">if</span>(num_vert_per_face[ face_ids[i] ] &lt; 3){
<a name="l07691"></a>07691       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Element face must have at least 3 vertices for hit test"</span>);
<a name="l07692"></a>07692       free(face_ids);
<a name="l07693"></a>07693       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l07694"></a>07694     }
<a name="l07695"></a>07695 
<a name="l07696"></a>07696     face_offset = max_num_vert_per_face * face_ids[i]; <span class="comment">//Shorthand</span>
<a name="l07697"></a>07697 
<a name="l07698"></a>07698     <span class="comment">//Break each face into a set of 1 or more triangles</span>
<a name="l07699"></a>07699     <span class="keywordflow">for</span>(j=0; (j&lt;num_vert_per_face[ face_ids[i] ] - 2); j++){
<a name="l07700"></a>07700       hit =  <a class="code" href="group__GeometricRelations.html#gb706686d41226f0e2177c70415abf76d" title="Deteremine where a ray intersects with a triangle.">fc_getIntersectionBetweenRayAndTriangle</a>(
<a name="l07701"></a>07701                point, <span class="comment">//Point is ray's origin</span>
<a name="l07702"></a>07702                ray_direction,
<a name="l07703"></a>07703                      &amp;vert_coords[ dim * face_conns[ face_offset + 0   ] ], <span class="comment">//triangle point 0</span>
<a name="l07704"></a>07704                &amp;vert_coords[ dim * face_conns[ face_offset + j+1 ] ], <span class="comment">//triangle point 1</span>
<a name="l07705"></a>07705                &amp;vert_coords[ dim * face_conns[ face_offset + j+2 ] ], <span class="comment">//triangle point 2</span>
<a name="l07706"></a>07706                &amp;t,NULL,NULL); <span class="comment">//Only care about t, the distance to triangle</span>
<a name="l07707"></a>07707 
<a name="l07708"></a>07708       <span class="keywordflow">if</span>(hit){
<a name="l07709"></a>07709 
<a name="l07710"></a>07710      <span class="keywordflow">if</span>((<a class="code" href="group__PublicFloatingPoint.html#g586cfa132ea1f36cba13311e8e994c03" title="Test if two doubles are equal, assuming double precision.">fc_eqd</a>(t,0.0)) || (<a class="code" href="group__PublicFloatingPoint.html#g586cfa132ea1f36cba13311e8e994c03" title="Test if two doubles are equal, assuming double precision.">fc_eqd</a>(t,-0.0)) ){
<a name="l07711"></a>07711        *hit_type = 2; <span class="comment">//point is on a face</span>
<a name="l07712"></a>07712        free(face_ids);
<a name="l07713"></a>07713        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l07714"></a>07714 
<a name="l07715"></a>07715      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#ge819a6954dbe19d55f2b8bf1f01fa186" title="Test if the first double is greater than the second double, assuming double precision...">fc_gtd</a>(t,0.0)){
<a name="l07716"></a>07716 
<a name="l07717"></a>07717        <span class="keywordflow">if</span>(found_positive_hit){
<a name="l07718"></a>07718 
<a name="l07719"></a>07719          <span class="keywordflow">if</span>(t!=t_val_positive){
<a name="l07720"></a>07720            <span class="comment">//Hit more than one place. Bail out.</span>
<a name="l07721"></a>07721            free(face_ids);
<a name="l07722"></a>07722            <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l07723"></a>07723          }
<a name="l07724"></a>07724          <span class="comment">//Otherwise, this must have been a common edge/vertex, keep going</span>
<a name="l07725"></a>07725        } <span class="keywordflow">else</span> {
<a name="l07726"></a>07726          <span class="comment">//First unique hit, record distance so we can count intersections</span>
<a name="l07727"></a>07727          t_val_positive = t;
<a name="l07728"></a>07728          found_positive_hit = 1;
<a name="l07729"></a>07729        }
<a name="l07730"></a>07730      } <span class="keywordflow">else</span> { <span class="comment">//negative hit</span>
<a name="l07731"></a>07731        
<a name="l07732"></a>07732        <span class="keywordflow">if</span>(found_negative_hit){
<a name="l07733"></a>07733          <span class="keywordflow">if</span>(t!=t_val_negative){
<a name="l07734"></a>07734            <span class="comment">//Hit more than one place. Bail out.</span>
<a name="l07735"></a>07735            free(face_ids);
<a name="l07736"></a>07736            <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l07737"></a>07737          }
<a name="l07738"></a>07738          <span class="comment">//Otherwise, this must have been a common edge/vertex, keep going</span>
<a name="l07739"></a>07739        } <span class="keywordflow">else</span> {
<a name="l07740"></a>07740          <span class="comment">//First unique hit, record distance so we can count intersecrions</span>
<a name="l07741"></a>07741          t_val_negative = t;
<a name="l07742"></a>07742          found_negative_hit = 1;
<a name="l07743"></a>07743        }
<a name="l07744"></a>07744      }
<a name="l07745"></a>07745       }
<a name="l07746"></a>07746     }
<a name="l07747"></a>07747   }
<a name="l07748"></a>07748   *hit_type = found_positive_hit &amp;&amp; found_negative_hit;
<a name="l07749"></a>07749   free(face_ids);
<a name="l07750"></a>07750   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l07751"></a>07751 
<a name="l07752"></a>07752 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g9b43dc0f4dba241e52bcff6a5943282c"></a><!-- doxytag: member="geom.c::_fc_geomSmoothCore" ref="g9b43dc0f4dba241e52bcff6a5943282c" args="(int numMesh, FC_Mesh *meshes, int doDispl, FC_Variable *displs, FC_VertexBin **bins, FC_Variable *vars, double radius, int doLocalSmooth, FC_Variable **smooth_vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_geomSmoothCore           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doDispl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doLocalSmooth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>smooth_vars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smooth a variable field. 
<p>
<b>Description:</b> <p>
This routine creates a "smoothed" version of the original variable where each data point in the smoothed variable is the average of all data points within the given radius of the original data point. It uses the vertex bins created using <a class="el" href="group__GeometricRelations.html#g8c37e5e697cade766ceb41e4a3ec2eac" title="Create spatial bins for vertices for geometric queries.">fc_createMeshVertexBin()</a>. Non-scalar variables are averaged component-wise. (Note that only entities that completely fall within the radius are used for the smoothing.) The smoothed variable will always have data type of double.<p>
Because the vertex bins are per mesh, if you want to smooth a variable over all meshes, you must provide handles for the variable on all of the meshes and the appropriate vertex bins).<p>
<b>Modifications:</b> <ul>
<li>03/09/04 WSK, Created.</li><li>04/26/04 WSK, added handling for smoothing element associated vars </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - the number of meshes the variable is on </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - the meshes </td></tr>
<tr><td valign="top"><em>doDispl</em>&nbsp;</td><td>
input - flag for whether to do displacment </td></tr>
<tr><td valign="top"><em>displs</em>&nbsp;</td><td>
input - for each mesh, the displacement variable </td></tr>
<tr><td valign="top"><em>bins</em>&nbsp;</td><td>
input - for each mesh, its vertex bin </td></tr>
<tr><td valign="top"><em>vars</em>&nbsp;</td><td>
input - for each mesh, the variable to smooth </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - the kernel radius </td></tr>
<tr><td valign="top"><em>doLocalSmooth</em>&nbsp;</td><td>
input - flag for whether smoothing is done over one mesh or all </td></tr>
<tr><td valign="top"><em>smooth_vars</em>&nbsp;</td><td>
output - the smoothed vars </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l06615">6615</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00192">FC_AT_EDGE</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="base_8h-source.html#l00194">FC_AT_FACE</a>, <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00197">FC_AT_WHOLE_MESH</a>, <a class="el" href="variable_8c-source.html#l00286">fc_createVariable()</a>, <a class="el" href="base_8h-source.html#l00139">FC_DT_CHAR</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00149">FC_DT_FLOAT</a>, <a class="el" href="base_8h-source.html#l00143">FC_DT_INT</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="base_8c-source.html#l00550">fc_getElementTypeNumVertex()</a>, <a class="el" href="geom_8c-source.html#l05786">fc_getEntitiesWithinSphere()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="mesh_8c-source.html#l03571">fc_getMeshEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03762">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l03061">fc_getMeshElementType()</a>, <a class="el" href="mesh_8c-source.html#l03691">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="variable_8c-source.html#l05392">fc_getMeshFromVariable()</a>, <a class="el" href="mesh_8c-source.html#l02989">fc_getMeshNumVertex()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l05715">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l05433">fc_getVariableInfo()</a>, <a class="el" href="variable_8c-source.html#l05276">fc_getVariableName()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00604">fc_setVariableDataPtr()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="seriesAnalyzer_8c-source.html#l00102">numComponent</a>, and <a class="el" href="subsetter_8c-source.html#l00115">var_name</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l05900">fc_displacedGeomSmoothVariable()</a>, and <a class="el" href="geom_8c-source.html#l05864">fc_geomSmoothVariable()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06625"></a>06625   {
<a name="l06626"></a>06626   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l06627"></a>06627   <span class="keywordtype">int</span> i, j, k, m, n;
<a name="l06628"></a>06628   <span class="keywordtype">char</span>* <a class="code" href="subsetter_8c.html#4b703ba1f7a1288de40089aa611b9abf">var_name</a>, *temp_name;
<a name="l06629"></a>06629   <span class="keywordtype">int</span> dim, <a class="code" href="seriesAnalyzer_8c.html#9ba814c62f21460639802c7771e86fa6">numComponent</a>, temp_dim, temp_numComponent;
<a name="l06630"></a>06630   <span class="keywordtype">int</span> numDataPoints[numMesh];
<a name="l06631"></a>06631   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> temp_mesh;
<a name="l06632"></a>06632   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc, temp_assoc;
<a name="l06633"></a>06633   <a class="code" href="group__DataTypes.html#g60d16c50c365cd12f1f61ce8f4cebb20" title="Possible ways of organizing data values.">FC_MathType</a> mathtype, temp_mathtype;
<a name="l06634"></a>06634   <a class="code" href="group__DataTypes.html#gcca24e957488bb76e40a84ea651975d9" title="Possible data types.">FC_DataType</a> datatype, temp_datatype;
<a name="l06635"></a>06635   <span class="keywordtype">int</span> numID, *ids;
<a name="l06636"></a>06636   <span class="keywordtype">double</span>* coords[numMesh];
<a name="l06637"></a>06637   <span class="keywordtype">int</span> maxNumVertPerFace[numMesh], *numVertPerFaces[numMesh];
<a name="l06638"></a>06638   <span class="keywordtype">int</span>* edgeConns[numMesh], *faceConns[numMesh], *elemConns[numMesh];
<a name="l06639"></a>06639   <span class="keywordtype">int</span> num;
<a name="l06640"></a>06640   <span class="keywordtype">double</span> *sums;
<a name="l06641"></a>06641   <span class="keywordtype">void</span> *old_datas[numMesh];
<a name="l06642"></a>06642   <span class="keywordtype">double</span> *new_datas[numMesh];
<a name="l06643"></a>06643 
<a name="l06644"></a>06644   <span class="comment">// default output</span>
<a name="l06645"></a>06645   <span class="keywordflow">if</span> (smooth_vars)
<a name="l06646"></a>06646     *smooth_vars = NULL;
<a name="l06647"></a>06647 
<a name="l06648"></a>06648   <span class="comment">// check input</span>
<a name="l06649"></a>06649   <span class="keywordflow">if</span> (numMesh &lt; 1 || !meshes || (doDispl &amp;&amp; !displs) || !bins || !vars || 
<a name="l06650"></a>06650       radius &lt;= 0. ||  !smooth_vars) {
<a name="l06651"></a>06651     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l06652"></a>06652     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06653"></a>06653   }
<a name="l06654"></a>06654   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06655"></a>06655     <span class="keywordflow">if</span> (doDispl &amp;&amp; !<a class="code" href="group__GeometricRelations.html#g904f6ade0783bc52bee008d10e7b6a36" title="Test to see if variable can be used as displacment variable.">fc_isValidDisplacementVariable</a>(meshes[i], displs[i])) {
<a name="l06656"></a>06656       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"displ[%d] is not a valid displ var"</span>, i);
<a name="l06657"></a>06657       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06658"></a>06658     }
<a name="l06659"></a>06659     <a class="code" href="group__Variable.html#g6808d2015766d9b530b93375f42296a3" title="Get the parent mesh of the variable.">fc_getMeshFromVariable</a>(vars[i], &amp;temp_mesh);
<a name="l06660"></a>06660     <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(meshes[i]) || !bins[i] || 
<a name="l06661"></a>06661      !<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(vars[i]) || 
<a name="l06662"></a>06662      !<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_mesh, bins[i]-&gt;mesh) || 
<a name="l06663"></a>06663         !<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(temp_mesh, meshes[i]) ) {
<a name="l06664"></a>06664       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"bins or vars do not match meshes"</span>);
<a name="l06665"></a>06665       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06666"></a>06666     }
<a name="l06667"></a>06667   }
<a name="l06668"></a>06668   
<a name="l06669"></a>06669   <span class="comment">// log message</span>
<a name="l06670"></a>06670   <span class="keywordflow">if</span> (doDispl) {
<a name="l06671"></a>06671     <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Smoothing a variable on displaced meshes"</span>);
<a name="l06672"></a>06672   }
<a name="l06673"></a>06673   <span class="keywordflow">else</span> {
<a name="l06674"></a>06674     <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Smoothing a variable."</span>);
<a name="l06675"></a>06675   }
<a name="l06676"></a>06676   
<a name="l06677"></a>06677   <span class="comment">// get info &amp; more checking</span>
<a name="l06678"></a>06678   rc = <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(meshes[0], &amp;dim);
<a name="l06679"></a>06679   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06680"></a>06680     <span class="keywordflow">return</span> rc;
<a name="l06681"></a>06681   rc = <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(vars[0], &amp;numDataPoints[0], &amp;numComponent,
<a name="l06682"></a>06682                           &amp;assoc, &amp;mathtype, &amp;datatype);
<a name="l06683"></a>06683   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06684"></a>06684     <span class="keywordflow">return</span> rc;
<a name="l06685"></a>06685   <span class="keywordflow">if</span> (datatype == <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d91103921fcb19c46b788b514185b6f596">FC_DT_CHAR</a>) {
<a name="l06686"></a>06686     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't handle FC_DT_CHAR data"</span>);
<a name="l06687"></a>06687     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l06688"></a>06688   }
<a name="l06689"></a>06689   <span class="comment">// All variables must have same dim, numComponent, assoc, mathtype, datatype</span>
<a name="l06690"></a>06690   <span class="keywordflow">for</span> (i = 1; i &lt; numMesh; i++) {
<a name="l06691"></a>06691     <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(meshes[i], &amp;temp_dim);
<a name="l06692"></a>06692     <a class="code" href="group__Variable.html#gcd52b4ee0552c63ff2819e5f30549cbc" title="Get information about a variable.">fc_getVariableInfo</a>(vars[i], &amp;numDataPoints[i], &amp;temp_numComponent,
<a name="l06693"></a>06693                        &amp;temp_assoc, &amp;temp_mathtype, &amp;temp_datatype);
<a name="l06694"></a>06694     <span class="keywordflow">if</span> (temp_dim != dim || temp_numComponent != numComponent ||
<a name="l06695"></a>06695         temp_assoc != assoc || temp_mathtype != mathtype ||
<a name="l06696"></a>06696         temp_datatype != datatype) {
<a name="l06697"></a>06697       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Variables do not match"</span>);
<a name="l06698"></a>06698       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06699"></a>06699     }
<a name="l06700"></a>06700   }
<a name="l06701"></a>06701   
<a name="l06702"></a>06702   <span class="comment">// For each mesh, get coords &amp; variable data, make room for new data</span>
<a name="l06703"></a>06703   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06704"></a>06704     <span class="keywordflow">if</span> (doDispl) 
<a name="l06705"></a>06705       rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(meshes[i], displs[i], &amp;coords[i]);
<a name="l06706"></a>06706     <span class="keywordflow">else</span>
<a name="l06707"></a>06707       rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(meshes[i], &amp;coords[i]);
<a name="l06708"></a>06708     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06709"></a>06709       <span class="keywordflow">return</span> rc;
<a name="l06710"></a>06710     <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>)
<a name="l06711"></a>06711       <a class="code" href="group__Mesh.html#gcae096882dec5f984503869f5f64acfc" title="Return edge connectivities.">fc_getMeshEdgeConnsPtr</a>(meshes[i], &amp;edgeConns[i]);
<a name="l06712"></a>06712     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>)
<a name="l06713"></a>06713       <a class="code" href="group__Mesh.html#g8e318f4b17572413004acf14b18deb2b" title="Return face connectivities.">fc_getMeshFaceConnsPtr</a>(meshes[i], &amp;numVertPerFaces[i],
<a name="l06714"></a>06714                     &amp;maxNumVertPerFace[i], &amp;faceConns[i]);
<a name="l06715"></a>06715     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>)
<a name="l06716"></a>06716       <a class="code" href="group__Mesh.html#g19906bcae562d226991740da142000c0" title="Return element to vertex connectivities for the mesh.">fc_getMeshElementConnsPtr</a>(meshes[i], &amp;elemConns[i]);
<a name="l06717"></a>06717     <a class="code" href="group__Variable.html#g40a4d68cafd7134b908b78d053d3c47d" title="Get the data in a variable.">fc_getVariableDataPtr</a>(vars[i], &amp;old_datas[i]);
<a name="l06718"></a>06718     new_datas[i] = (<span class="keywordtype">double</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*
<a name="l06719"></a>06719                                    numDataPoints[i]*numComponent);
<a name="l06720"></a>06720     <span class="keywordflow">if</span> (new_datas[i] == NULL) {
<a name="l06721"></a>06721       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06722"></a>06722       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06723"></a>06723     }
<a name="l06724"></a>06724   }
<a name="l06725"></a>06725 
<a name="l06726"></a>06726   <span class="comment">// for each data point </span>
<a name="l06727"></a>06727   <span class="comment">// 1) find center</span>
<a name="l06728"></a>06728   <span class="comment">// 2) find all other points on all meshes that fall within radius </span>
<a name="l06729"></a>06729   <span class="comment">//   ( 2A) make sure have current point)</span>
<a name="l06730"></a>06730   <span class="comment">// 3) sum all contributions &amp; divide by number of data points</span>
<a name="l06731"></a>06731   sums = (<span class="keywordtype">double</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numComponent);
<a name="l06732"></a>06732   <span class="keywordflow">if</span> (sums == NULL)  {
<a name="l06733"></a>06733     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06734"></a>06734     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06735"></a>06735   }
<a name="l06736"></a>06736   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06737"></a>06737     <span class="keywordflow">for</span> (j = 0; j &lt; numDataPoints[i]; j++) {
<a name="l06738"></a>06738       <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> center;
<a name="l06739"></a>06739 
<a name="l06740"></a>06740       <span class="comment">// Find center</span>
<a name="l06741"></a>06741       <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>) {
<a name="l06742"></a>06742         <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++)
<a name="l06743"></a>06743           center[k] = coords[i][j*dim + k];
<a name="l06744"></a>06744       }
<a name="l06745"></a>06745       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af62b7e38452f200e9abd5767534b43d670">FC_AT_WHOLE_MESH</a>) {
<a name="l06746"></a>06746         <span class="keywordtype">int</span> numVert;
<a name="l06747"></a>06747         <a class="code" href="group__Mesh.html#g9dca153475c9927e7497fd827cfd5562" title="Return the number of vertices in a mesh.">fc_getMeshNumVertex</a>(meshes[i], &amp;numVert);
<a name="l06748"></a>06748         <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++)
<a name="l06749"></a>06749           center[k] = 0;
<a name="l06750"></a>06750         <span class="keywordflow">for</span> (k = 0; k &lt; numVert; k++)
<a name="l06751"></a>06751           <span class="keywordflow">for</span> (m = 0; m &lt; dim; m++)
<a name="l06752"></a>06752             center[m] += coords[i][k*dim + m];
<a name="l06753"></a>06753         <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++) 
<a name="l06754"></a>06754           center[k] /= numVert;
<a name="l06755"></a>06755       }
<a name="l06756"></a>06756       <span class="keywordflow">else</span> {
<a name="l06757"></a>06757         <span class="comment">// Centroid of this edge, face or element</span>
<a name="l06758"></a>06758         <span class="keywordtype">int</span> numVert, *vertIDs;
<a name="l06759"></a>06759         <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af633c84fbf48ae06b5f39adac0b92fbaed">FC_AT_EDGE</a>) {
<a name="l06760"></a>06760           numVert = 2;
<a name="l06761"></a>06761           vertIDs = &amp;edgeConns[i][j*2];
<a name="l06762"></a>06762         }
<a name="l06763"></a>06763         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af640a4ba10b4045dfe3aef0e0c0588cbd0">FC_AT_FACE</a>) {
<a name="l06764"></a>06764           numVert = numVertPerFaces[i][j];
<a name="l06765"></a>06765           vertIDs = &amp;faceConns[i][j*maxNumVertPerFace[i]];
<a name="l06766"></a>06766         }
<a name="l06767"></a>06767         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>) {
<a name="l06768"></a>06768        <a class="code" href="group__DataTypes.html#g57a0abe7a63cc2c6c9fb0a3db339884a" title="Possible element types.">FC_ElementType</a> elemType;
<a name="l06769"></a>06769        <a class="code" href="group__Mesh.html#g1c1684ecf98e82a0ab18f7f9dbdddfc5" title="Returns type of elements in the mesh.">fc_getMeshElementType</a>(meshes[i], &amp;elemType);
<a name="l06770"></a>06770           numVert = <a class="code" href="group__DataTypes.html#g2a400f7126e79f149032162c87c4eee8" title="Returns number of vertices in a type of element.">fc_getElementTypeNumVertex</a>(elemType);
<a name="l06771"></a>06771           vertIDs = &amp;elemConns[i][j*numVert];
<a name="l06772"></a>06772         }
<a name="l06773"></a>06773         <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++)
<a name="l06774"></a>06774           center[k] = 0;
<a name="l06775"></a>06775         <span class="keywordflow">for</span> (k = 0; k &lt; numVert; k++)
<a name="l06776"></a>06776           <span class="keywordflow">for</span> (m = 0; m &lt; dim; m++)
<a name="l06777"></a>06777             center[m] += coords[i][vertIDs[k]*dim + m];
<a name="l06778"></a>06778         <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++) 
<a name="l06779"></a>06779           center[k] /= numVert;
<a name="l06780"></a>06780       }
<a name="l06781"></a>06781  
<a name="l06782"></a>06782       <span class="comment">// find geometric neighbors on each mesh &amp; add their values</span>
<a name="l06783"></a>06783       num = 0;
<a name="l06784"></a>06784       <span class="keywordflow">for</span> (k = 0; k &lt; numComponent; k++)
<a name="l06785"></a>06785         sums[k] = 0;
<a name="l06786"></a>06786       <span class="keywordflow">for</span> (k = (doLocalSmooth?i:0); k &lt; (doLocalSmooth?i+1:numMesh); k++) {
<a name="l06787"></a>06787         rc = <a class="code" href="group__GeometricRelations.html#ga54b4d882e664a4973368b093c274e34" title="Find all entities within a sphere.">fc_getEntitiesWithinSphere</a>(meshes[k], bins[k], center, radius, 
<a name="l06788"></a>06788                                         assoc, &amp;numID, &amp;ids);
<a name="l06789"></a>06789         <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06790"></a>06790           <span class="keywordflow">return</span> rc;
<a name="l06791"></a>06791 
<a name="l06792"></a>06792         <span class="comment">// make sure we include the current entity</span>
<a name="l06793"></a>06793         <span class="keywordflow">if</span> (k == i) {
<a name="l06794"></a>06794           <span class="keywordtype">int</span> found = 0;
<a name="l06795"></a>06795           <span class="keywordflow">for</span> (m = 0; m &lt; numID; m++) {
<a name="l06796"></a>06796             <span class="keywordflow">if</span> (ids[m] == j) {
<a name="l06797"></a>06797               found = 1;
<a name="l06798"></a>06798               <span class="keywordflow">break</span>;
<a name="l06799"></a>06799             }
<a name="l06800"></a>06800           }
<a name="l06801"></a>06801           <span class="keywordflow">if</span> (!found) {
<a name="l06802"></a>06802             <span class="keywordtype">int</span>* temp = realloc(ids, (numID+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l06803"></a>06803             <span class="keywordflow">if</span> (!temp) {
<a name="l06804"></a>06804               <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06805"></a>06805               <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06806"></a>06806             }
<a name="l06807"></a>06807             ids = temp;
<a name="l06808"></a>06808             ids[numID] = j;
<a name="l06809"></a>06809             numID++;
<a name="l06810"></a>06810           }
<a name="l06811"></a>06811         }
<a name="l06812"></a>06812 
<a name="l06813"></a>06813         <span class="comment">// add to our cumulative sums</span>
<a name="l06814"></a>06814         <span class="keywordflow">for</span> (m = 0; m &lt; numID; m++) {
<a name="l06815"></a>06815           <span class="keywordflow">for</span> (n = 0; n &lt; numComponent; n++) {
<a name="l06816"></a>06816             <span class="keywordflow">switch</span>(datatype) {
<a name="l06817"></a>06817             <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d963896eb450c264fe236185788362b270">FC_DT_INT</a>:
<a name="l06818"></a>06818               sums[n] += ((<span class="keywordtype">int</span>*)(old_datas[k]))[ids[m]*numComponent+n];
<a name="l06819"></a>06819               <span class="keywordflow">break</span>;
<a name="l06820"></a>06820             <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9b32c04c999cf2998e57c184acc553eb7">FC_DT_FLOAT</a>:
<a name="l06821"></a>06821               sums[n] += ((<span class="keywordtype">float</span>*)(old_datas[k]))[ids[m]*numComponent+n];
<a name="l06822"></a>06822               <span class="keywordflow">break</span>;
<a name="l06823"></a>06823             <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>:
<a name="l06824"></a>06824               sums[n] += ((<span class="keywordtype">double</span>*)(old_datas[k]))[ids[m]*numComponent+n];
<a name="l06825"></a>06825               <span class="keywordflow">break</span>;
<a name="l06826"></a>06826             <span class="keywordflow">default</span>:
<a name="l06827"></a>06827               <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l06828"></a>06828             }
<a name="l06829"></a>06829           }
<a name="l06830"></a>06830           num++;
<a name="l06831"></a>06831         }
<a name="l06832"></a>06832         free(ids);
<a name="l06833"></a>06833       }
<a name="l06834"></a>06834       <span class="keywordflow">for</span> (k = 0; k &lt; numComponent; k++)
<a name="l06835"></a>06835         new_datas[i][j*numComponent+k] = sums[k]/num;
<a name="l06836"></a>06836     }
<a name="l06837"></a>06837   }
<a name="l06838"></a>06838   free(sums);
<a name="l06839"></a>06839   <span class="keywordflow">if</span> (doDispl) {
<a name="l06840"></a>06840     <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++)
<a name="l06841"></a>06841       free(coords[i]);
<a name="l06842"></a>06842   }
<a name="l06843"></a>06843 
<a name="l06844"></a>06844   <span class="comment">// create new vars</span>
<a name="l06845"></a>06845   *smooth_vars = (<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>*)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html" title="Variable Handle.">FC_Variable</a>));
<a name="l06846"></a>06846   <span class="keywordflow">if</span> (*smooth_vars == NULL) {
<a name="l06847"></a>06847     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"memory allocation error"</span>);
<a name="l06848"></a>06848     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06849"></a>06849   }
<a name="l06850"></a>06850   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06851"></a>06851     rc = <a class="code" href="group__Variable.html#g233584b319c5dd90a13582fc9ac3484e" title="Return name of a variable.">fc_getVariableName</a>(vars[i], &amp;var_name);
<a name="l06852"></a>06852     temp_name = (<span class="keywordtype">char</span>*)malloc((strlen(var_name) + 10)*<span class="keyword">sizeof</span>(char));
<a name="l06853"></a>06853     sprintf(temp_name, <span class="stringliteral">"%s_smoothed"</span>, var_name);
<a name="l06854"></a>06854     free(var_name);
<a name="l06855"></a>06855     rc = <a class="code" href="group__Variable.html#ga2ffd025a786dbe93fc7f8defb969631" title="Create a new variable.">fc_createVariable</a>(meshes[i], temp_name, &amp;(*smooth_vars)[i]);
<a name="l06856"></a>06856     free(temp_name);
<a name="l06857"></a>06857     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06858"></a>06858       <span class="keywordflow">return</span> rc;
<a name="l06859"></a>06859     rc = <a class="code" href="group__Variable.html#g87015cda75e038cc73c1d584537d81fc" title="Set the pointer to the variable data.">fc_setVariableDataPtr</a>((*smooth_vars)[i], numDataPoints[i], 
<a name="l06860"></a>06860                numComponent, assoc, mathtype, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>, new_datas[i]);
<a name="l06861"></a>06861     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06862"></a>06862       <span class="keywordflow">return</span> rc;
<a name="l06863"></a>06863     <span class="comment">// don't free new_datas[i]</span>
<a name="l06864"></a>06864   }
<a name="l06865"></a>06865   
<a name="l06866"></a>06866   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l06867"></a>06867 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge168ac2c62b1eeb928614ec8e2653807"></a><!-- doxytag: member="geom.c::_fc_getDiameterOutputArgsTest" ref="ge168ac2c62b1eeb928614ec8e2653807" args="(double *diameter, int *numPair, int **pairIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getDiameterOutputArgsTest           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper for 'getDiameter' routines. 
<p>
Sets the default return values of output args and tests that output arg values are sane.<p>
<b>Modifications:</b> <ul>
<li>6/27/05 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l02127">2127</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l01699">fc_getDisplacedMeshDiameter()</a>, <a class="el" href="geom_8c-source.html#l01790">fc_getDisplacedSubsetDiameter()</a>, <a class="el" href="geom_8c-source.html#l01649">fc_getMeshDiameter()</a>, and <a class="el" href="geom_8c-source.html#l01753">fc_getSubsetDiameter()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02132"></a>02132   {
<a name="l02133"></a>02133   <span class="comment">// default return</span>
<a name="l02134"></a>02134   <span class="keywordflow">if</span> (diameter)
<a name="l02135"></a>02135     *diameter = -1;
<a name="l02136"></a>02136   <span class="keywordflow">if</span> (numPair)
<a name="l02137"></a>02137     *numPair = -1;
<a name="l02138"></a>02138   <span class="keywordflow">if</span> (pairIDs)
<a name="l02139"></a>02139     *pairIDs = NULL;
<a name="l02140"></a>02140   
<a name="l02141"></a>02141   <span class="comment">// test output args</span>
<a name="l02142"></a>02142   <span class="keywordflow">if</span> (!diameter) {
<a name="l02143"></a>02143     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02144"></a>02144     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02145"></a>02145   }
<a name="l02146"></a>02146   <span class="keywordflow">if</span> ((numPair &amp;&amp; !pairIDs) || (!numPair &amp;&amp; pairIDs)) {
<a name="l02147"></a>02147     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Did not provide both numPair &amp; pairIDs for "</span>
<a name="l02148"></a>02148                  <span class="stringliteral">"returned vertex IDs"</span>);
<a name="l02149"></a>02149     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02150"></a>02150   }
<a name="l02151"></a>02151   
<a name="l02152"></a>02152   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02153"></a>02153 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge1d011d686fe02162622c680554e0aca"></a><!-- doxytag: member="geom.c::_fc_getDiameterOutputArgsTestMeshes" ref="ge1d011d686fe02162622c680554e0aca" args="(double *diameter, int *numPair, int **pairIDs, FC_Mesh **pairMeshes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getDiameterOutputArgsTestMeshes           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> **&nbsp;</td>
          <td class="paramname"> <em>pairMeshes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper for 'getDiameter' routines. 
<p>
Sets the default return values of output args and tests that output arg values are sane.<p>
<b>Modifications:</b> <ul>
<li>3/13/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairMeshes</em>&nbsp;</td><td>
output - owning meshes for the verts </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l02165">2165</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l01929">fc_getDisplacedMeshesDiameter()</a>, and <a class="el" href="geom_8c-source.html#l01841">fc_getMeshesDiameter()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02171"></a>02171   {
<a name="l02172"></a>02172   <span class="comment">// default return</span>
<a name="l02173"></a>02173   <span class="keywordflow">if</span> (diameter)
<a name="l02174"></a>02174     *diameter = -1;
<a name="l02175"></a>02175   <span class="keywordflow">if</span> (numPair)
<a name="l02176"></a>02176     *numPair = -1;
<a name="l02177"></a>02177   <span class="keywordflow">if</span> (pairIDs)
<a name="l02178"></a>02178     *pairIDs = NULL;
<a name="l02179"></a>02179   <span class="keywordflow">if</span> (pairMeshes)
<a name="l02180"></a>02180     *pairMeshes = NULL;
<a name="l02181"></a>02181   
<a name="l02182"></a>02182   <span class="comment">// test output args</span>
<a name="l02183"></a>02183   <span class="keywordflow">if</span> (!diameter) {
<a name="l02184"></a>02184     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02185"></a>02185     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02186"></a>02186   }
<a name="l02187"></a>02187   <span class="keywordflow">if</span> ( (numPair &amp;&amp; (!pairIDs || !pairMeshes)) || 
<a name="l02188"></a>02188        (!numPair &amp;&amp; (pairIDs || pairMeshes)) ) {
<a name="l02189"></a>02189     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Did not provide both numPair &amp; pairIDs for "</span>
<a name="l02190"></a>02190                  <span class="stringliteral">"returned vertex IDs"</span>);
<a name="l02191"></a>02191     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02192"></a>02192   }
<a name="l02193"></a>02193   
<a name="l02194"></a>02194   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02195"></a>02195 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g0f82ec988ecdb9530b201a35034dd094"></a><!-- doxytag: member="geom.c::_fc_getDiameterOutputArgsTestSubsets" ref="g0f82ec988ecdb9530b201a35034dd094" args="(double *diameter, int *numPair, int **pairIDs, FC_Subset **pairSubsets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getDiameterOutputArgsTestSubsets           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>pairSubsets</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper for 'getDiameter' routines. 
<p>
Sets the default return values of output args and tests that output arg values are sane.<p>
<b>Modifications:</b> <ul>
<li>3/13/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairSubsets</em>&nbsp;</td><td>
output - owning subsets for the verts </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l02207">2207</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l02068">fc_getDisplacedSubsetsDiameter()</a>, and <a class="el" href="geom_8c-source.html#l02019">fc_getSubsetsDiameter()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02213"></a>02213   {
<a name="l02214"></a>02214   <span class="comment">// default return</span>
<a name="l02215"></a>02215   <span class="keywordflow">if</span> (diameter)
<a name="l02216"></a>02216     *diameter = -1;
<a name="l02217"></a>02217   <span class="keywordflow">if</span> (numPair)
<a name="l02218"></a>02218     *numPair = -1;
<a name="l02219"></a>02219   <span class="keywordflow">if</span> (pairIDs)
<a name="l02220"></a>02220     *pairIDs = NULL;
<a name="l02221"></a>02221   <span class="keywordflow">if</span> (pairSubsets)
<a name="l02222"></a>02222     *pairSubsets = NULL;
<a name="l02223"></a>02223   
<a name="l02224"></a>02224   <span class="comment">// test output args</span>
<a name="l02225"></a>02225   <span class="keywordflow">if</span> (!diameter) {
<a name="l02226"></a>02226     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l02227"></a>02227     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02228"></a>02228   }
<a name="l02229"></a>02229   <span class="keywordflow">if</span> ( (numPair &amp;&amp; (!pairIDs || !pairSubsets)) || 
<a name="l02230"></a>02230        (!numPair &amp;&amp; (pairIDs || pairSubsets)) ) {
<a name="l02231"></a>02231     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Did not provide both numPair &amp; pairIDs for "</span>
<a name="l02232"></a>02232                  <span class="stringliteral">"returned vertex IDs"</span>);
<a name="l02233"></a>02233     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02234"></a>02234   }
<a name="l02235"></a>02235   
<a name="l02236"></a>02236   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02237"></a>02237 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g26981974d8bba75a58309981c8d36ea4"></a><!-- doxytag: member="geom.c::_fc_getSubsetDiameterCore" ref="g26981974d8bba75a58309981c8d36ea4" args="(FC_Subset subset, FC_Variable *displ, double *diameter, int *numPair, int **pairIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getSubsetDiameterCore           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Core code of 'getDiameter' routines. 
<p>
Implements brute force comparison of all vertices.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000033">Todo:</a></b></dt><dd>This routine will be very slow for point sets. The best optimization is to find the convex hull of the set and then brute force search only the points of the hull polygon. However, the 3D convex hull algorithm is not easy to implement so I punted -WSD.</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000033">Todo:</a></b></dt><dd>This routine should probably be replaced by <a class="el" href="group__PrivateGeometricRelations.html#gf3e5e50c85791d67ecaa4b58e3c103d2" title="Core code of &#39;getDiameter&#39; routines.">_fc_getSubsetsDiameterCore()</a> so that the core code isn't duplicated.</dd></dl>
<b>Modifications:</b> <ul>
<li>6/27/05 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - a subset </td></tr>
<tr><td valign="top"><em>displ</em>&nbsp;</td><td>
input - pointer to displ (NULL = no displ) </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l02256">2256</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="geom_8c-source.html#l00163">fc_calcSquaredEuclideanDistance()</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l01699">fc_getDisplacedMeshDiameter()</a>, <a class="el" href="geom_8c-source.html#l01790">fc_getDisplacedSubsetDiameter()</a>, <a class="el" href="geom_8c-source.html#l01649">fc_getMeshDiameter()</a>, and <a class="el" href="geom_8c-source.html#l01753">fc_getSubsetDiameter()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02263"></a>02263   {
<a name="l02264"></a>02264   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02265"></a>02265   <span class="keywordtype">int</span> i, j;
<a name="l02266"></a>02266   <span class="keywordtype">int</span> numDim, numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l02267"></a>02267   <span class="keywordtype">double</span> *coords_p, temp;
<a name="l02268"></a>02268   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh;
<a name="l02269"></a>02269   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l02270"></a>02270   <span class="keywordtype">int</span> doPairs = 0, num = 0, maxNum = 0, *ids;
<a name="l02271"></a>02271   <span class="keywordtype">double</span> diameter2 = -1; <span class="comment">// squared diameter;</span>
<a name="l02272"></a>02272   
<a name="l02273"></a>02273   <span class="comment">// setup I</span>
<a name="l02274"></a>02274   <span class="keywordflow">if</span> (numPair &amp;&amp; pairIDs)
<a name="l02275"></a>02275     doPairs = 1;
<a name="l02276"></a>02276   rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l02277"></a>02277   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02278"></a>02278     <span class="keywordflow">return</span> rc;
<a name="l02279"></a>02279   rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;assoc);
<a name="l02280"></a>02280   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02281"></a>02281     <span class="keywordflow">return</span> rc;
<a name="l02282"></a>02282   
<a name="l02283"></a>02283   <span class="comment">// get vertices of the members</span>
<a name="l02284"></a>02284   rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l02285"></a>02285   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02286"></a>02286     <span class="keywordflow">return</span> rc;
<a name="l02287"></a>02287   rc = <a class="code" href="group__TopologyRelations.html#gd652ffb3bbe366c1a882a4e0fa34c499" title="Change the type of mesh entities.">fc_changeMeshEntityType</a>(mesh, assoc, numMember, memberIDs, 
<a name="l02288"></a>02288                                <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l02289"></a>02289   free(memberIDs);
<a name="l02290"></a>02290 
<a name="l02291"></a>02291   <span class="comment">// Special case: if 0 vertex - return error!</span>
<a name="l02292"></a>02292   <span class="keywordflow">if</span> (numVertex == 0) {
<a name="l02293"></a>02293     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members, diameter is undefined."</span>);
<a name="l02294"></a>02294     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02295"></a>02295   }
<a name="l02296"></a>02296   <span class="comment">// Special case: if 1 vertex - return 0</span>
<a name="l02297"></a>02297   <span class="keywordflow">if</span> (numVertex == 1) {
<a name="l02298"></a>02298     free(vertexIDs);
<a name="l02299"></a>02299     *diameter = 0.;
<a name="l02300"></a>02300     <span class="keywordflow">if</span> (doPairs)
<a name="l02301"></a>02301       *numPair = 0;
<a name="l02302"></a>02302     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02303"></a>02303   }
<a name="l02304"></a>02304 
<a name="l02305"></a>02305   <span class="comment">// setup II</span>
<a name="l02306"></a>02306   rc = <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(mesh, &amp;numDim);
<a name="l02307"></a>02307   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02308"></a>02308     <span class="keywordflow">return</span> rc;
<a name="l02309"></a>02309   <span class="keywordflow">if</span> (displ) {
<a name="l02310"></a>02310     rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(mesh, *displ, &amp;coords_p);
<a name="l02311"></a>02311     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02312"></a>02312       <span class="keywordflow">return</span> rc;
<a name="l02313"></a>02313   } 
<a name="l02314"></a>02314   <span class="keywordflow">else</span> {
<a name="l02315"></a>02315     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l02316"></a>02316     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02317"></a>02317       <span class="keywordflow">return</span> rc;
<a name="l02318"></a>02318   }
<a name="l02319"></a>02319 
<a name="l02320"></a>02320   <span class="comment">// Start off with space for at least 1 pair</span>
<a name="l02321"></a>02321   <span class="keywordflow">if</span> (doPairs) {
<a name="l02322"></a>02322     ids = (<span class="keywordtype">int</span>*)malloc(2*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02323"></a>02323     num = 0;
<a name="l02324"></a>02324     maxNum = 1;
<a name="l02325"></a>02325   }
<a name="l02326"></a>02326   <span class="comment">// Do it</span>
<a name="l02327"></a>02327   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++) {
<a name="l02328"></a>02328     <span class="keywordflow">for</span> (j = i+1; j &lt; numVertex; j++) {
<a name="l02329"></a>02329       <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(&amp;coords_p[vertexIDs[i]*numDim], 
<a name="l02330"></a>02330                           &amp;coords_p[vertexIDs[j]*numDim],
<a name="l02331"></a>02331                           numDim, &amp;temp);
<a name="l02332"></a>02332       <span class="keywordflow">if</span> (temp &gt; diameter2) {
<a name="l02333"></a>02333      diameter2 = temp;
<a name="l02334"></a>02334      <span class="keywordflow">if</span> (doPairs) {
<a name="l02335"></a>02335        ids[0] = vertexIDs[i];
<a name="l02336"></a>02336        ids[1] = vertexIDs[j];
<a name="l02337"></a>02337        num = 1;
<a name="l02338"></a>02338      }
<a name="l02339"></a>02339       }
<a name="l02340"></a>02340       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doPairs &amp;&amp; <a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(temp, diameter2)) {
<a name="l02341"></a>02341      <span class="keywordflow">if</span> (num+1 &gt; maxNum) {
<a name="l02342"></a>02342        ids = (<span class="keywordtype">int</span>*)realloc(ids, 4*maxNum*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02343"></a>02343        <span class="keywordflow">if</span> (!ids)
<a name="l02344"></a>02344          <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02345"></a>02345        maxNum *= 2;
<a name="l02346"></a>02346      }
<a name="l02347"></a>02347      ids[num*2] = vertexIDs[i];
<a name="l02348"></a>02348      ids[num*2+1] = vertexIDs[j];
<a name="l02349"></a>02349      num++;
<a name="l02350"></a>02350       }
<a name="l02351"></a>02351     }
<a name="l02352"></a>02352   }
<a name="l02353"></a>02353   <span class="keywordflow">if</span> (displ)
<a name="l02354"></a>02354     free(coords_p);
<a name="l02355"></a>02355   free(vertexIDs);
<a name="l02356"></a>02356 
<a name="l02357"></a>02357   <span class="comment">// Return?</span>
<a name="l02358"></a>02358   *diameter = sqrt(diameter2);
<a name="l02359"></a>02359   <span class="keywordflow">if</span> (doPairs) {
<a name="l02360"></a>02360     *numPair = num;
<a name="l02361"></a>02361     *pairIDs = (<span class="keywordtype">int</span>*)realloc(ids, 2*num*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); <span class="comment">// squeeze</span>
<a name="l02362"></a>02362   }
<a name="l02363"></a>02363 
<a name="l02364"></a>02364   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02365"></a>02365 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf3e5e50c85791d67ecaa4b58e3c103d2"></a><!-- doxytag: member="geom.c::_fc_getSubsetsDiameterCore" ref="gf3e5e50c85791d67ecaa4b58e3c103d2" args="(int numSubset, FC_Subset *subsets, FC_Variable *displs, double *diameter, int *numPair, int **pairIDs, FC_Subset **pairSubsets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getSubsetsDiameterCore           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numSubset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>pairSubsets</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Core code of 'getDiameter' routines. 
<p>
Implements brute force comparison of all vertices.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000035">Todo:</a></b></dt><dd>This routine will be very slow for point sets. The best optimization is to find the convex hull of the set and then brute force search only the points of the hull polygon. However, the 3D convex hull algorithm is not easy to implement so I punted -WSD.</dd></dl>
<b>Modifications:</b> <ul>
<li>6/27/05 WSD Created.</li><li>3/9/06 WSD Changed to do multiple subsets. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numSubset</em>&nbsp;</td><td>
input - number of subsets </td></tr>
<tr><td valign="top"><em>subsets</em>&nbsp;</td><td>
input - a subset </td></tr>
<tr><td valign="top"><em>displs</em>&nbsp;</td><td>
input - array of displs (NULL = no displ) </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairSubsets</em>&nbsp;</td><td>
output - Subsets of the vertex pairs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l02382">2382</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="geom_8c-source.html#l00163">fc_calcSquaredEuclideanDistance()</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="subset_8c-source.html#l02782">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l01929">fc_getDisplacedMeshesDiameter()</a>, <a class="el" href="geom_8c-source.html#l02068">fc_getDisplacedSubsetsDiameter()</a>, <a class="el" href="geom_8c-source.html#l01841">fc_getMeshesDiameter()</a>, and <a class="el" href="geom_8c-source.html#l02019">fc_getSubsetsDiameter()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l02391"></a>02391   {
<a name="l02392"></a>02392   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l02393"></a>02393   <span class="keywordtype">int</span> i, j, i_s, j_s;
<a name="l02394"></a>02394   <span class="keywordtype">int</span> numDim, numVerts[numSubset], *vertIDs[numSubset], numTotalVert;
<a name="l02395"></a>02395   <span class="keywordtype">int</span> numMember, *memberIDs;
<a name="l02396"></a>02396   <span class="keywordtype">double</span> *coords[numSubset], temp;
<a name="l02397"></a>02397   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> meshes[numSubset];
<a name="l02398"></a>02398   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>* subs = NULL, *temp_subs;
<a name="l02399"></a>02399   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc;
<a name="l02400"></a>02400   <span class="keywordtype">int</span> doPairs = 0, num = 0, maxNum = 1, *ids = NULL, *temp_ids;
<a name="l02401"></a>02401   <span class="keywordtype">double</span> diameter2 = -1; <span class="comment">// squared diameter</span>
<a name="l02402"></a>02402   
<a name="l02403"></a>02403   <span class="comment">// assume args are o.k.</span>
<a name="l02404"></a>02404   <span class="comment">// FIX: assume numDim is the same for all subsets,</span>
<a name="l02405"></a>02405   <span class="comment">// pass as an argument!?</span>
<a name="l02406"></a>02406 
<a name="l02407"></a>02407   <span class="comment">// setup I</span>
<a name="l02408"></a>02408   <span class="keywordflow">if</span> (numPair &amp;&amp; pairSubsets &amp;&amp; pairIDs)
<a name="l02409"></a>02409     doPairs = 1;
<a name="l02410"></a>02410 
<a name="l02411"></a>02411   <span class="comment">// Get vertIDs per subset</span>
<a name="l02412"></a>02412   numTotalVert = 0;
<a name="l02413"></a>02413   <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++) {
<a name="l02414"></a>02414     rc = <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(subsets[i], &amp;meshes[i]);
<a name="l02415"></a>02415     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02416"></a>02416       <span class="keywordflow">return</span> rc;
<a name="l02417"></a>02417     rc = <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(meshes[i], &amp;numDim); <span class="comment">// FIX</span>
<a name="l02418"></a>02418     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02419"></a>02419       <span class="keywordflow">return</span> rc; 
<a name="l02420"></a>02420     rc = <a class="code" href="group__Subset.html#g815857d0e2d573d0418a3892229c0d83" title="Get information about a subset.">fc_getSubsetInfo</a>(subsets[i], &amp;numMember, NULL, &amp;assoc);
<a name="l02421"></a>02421     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02422"></a>02422       <span class="keywordflow">return</span> rc;
<a name="l02423"></a>02423     <span class="comment">// get vertices of the members</span>
<a name="l02424"></a>02424     rc = <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subsets[i], &amp;numMember, &amp;memberIDs);
<a name="l02425"></a>02425     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02426"></a>02426       <span class="keywordflow">return</span> rc;
<a name="l02427"></a>02427     <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>) {
<a name="l02428"></a>02428       numVerts[i] = numMember;
<a name="l02429"></a>02429       vertIDs[i] = memberIDs;
<a name="l02430"></a>02430     }
<a name="l02431"></a>02431     <span class="keywordflow">else</span> {
<a name="l02432"></a>02432       rc = <a class="code" href="group__TopologyRelations.html#gd652ffb3bbe366c1a882a4e0fa34c499" title="Change the type of mesh entities.">fc_changeMeshEntityType</a>(meshes[i], assoc, numMember, memberIDs, 
<a name="l02433"></a>02433                        <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, 1, &amp;numVerts[i], &amp;vertIDs[i]);
<a name="l02434"></a>02434       free(memberIDs);
<a name="l02435"></a>02435       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02436"></a>02436      <span class="keywordflow">return</span> rc;
<a name="l02437"></a>02437     }
<a name="l02438"></a>02438     numTotalVert += numVerts[i];
<a name="l02439"></a>02439   }
<a name="l02440"></a>02440 
<a name="l02441"></a>02441   <span class="comment">// Special case: if 0 vertex - return error!</span>
<a name="l02442"></a>02442   <span class="keywordflow">if</span> (numTotalVert == 0) {
<a name="l02443"></a>02443     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Subsets have 0 members, diameter is undefined."</span>);
<a name="l02444"></a>02444     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l02445"></a>02445   }
<a name="l02446"></a>02446   <span class="comment">// Special case: if 1 vertex - return 0</span>
<a name="l02447"></a>02447   <span class="keywordflow">if</span> (numTotalVert == 1) {
<a name="l02448"></a>02448     <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++)
<a name="l02449"></a>02449       free(vertIDs[i]);
<a name="l02450"></a>02450     *diameter = 0.;
<a name="l02451"></a>02451     <span class="keywordflow">if</span> (doPairs)
<a name="l02452"></a>02452       *numPair = 0;
<a name="l02453"></a>02453     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02454"></a>02454   }
<a name="l02455"></a>02455 
<a name="l02456"></a>02456   <span class="comment">// Get the coords</span>
<a name="l02457"></a>02457   <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++) {
<a name="l02458"></a>02458     <span class="keywordflow">if</span> (displs) 
<a name="l02459"></a>02459       rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(meshes[i], displs[i], &amp;coords[i]);
<a name="l02460"></a>02460     <span class="keywordflow">else</span> 
<a name="l02461"></a>02461       rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(meshes[i], &amp;coords[i]);
<a name="l02462"></a>02462     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l02463"></a>02463       <span class="keywordflow">return</span> rc;
<a name="l02464"></a>02464   }
<a name="l02465"></a>02465 
<a name="l02466"></a>02466   <span class="comment">// Start off with space for at least 1 pair</span>
<a name="l02467"></a>02467   <span class="keywordflow">if</span> (doPairs) {
<a name="l02468"></a>02468     ids = (<span class="keywordtype">int</span>*)malloc(2*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02469"></a>02469     subs = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)malloc(2*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02470"></a>02470     num = 0;
<a name="l02471"></a>02471     maxNum = 1;
<a name="l02472"></a>02472   }
<a name="l02473"></a>02473   <span class="comment">// Note: diameter2 starts at -1</span>
<a name="l02474"></a>02474   <span class="comment">// Do within each subset</span>
<a name="l02475"></a>02475   <span class="keywordflow">for</span> (i_s = 0; i_s &lt; numSubset; i_s++) {
<a name="l02476"></a>02476     <span class="keywordflow">for</span> (i = 0; i &lt; numVerts[i_s]; i++) {
<a name="l02477"></a>02477       <span class="keywordflow">for</span> (j = i+1; j &lt; numVerts[i_s]; j++) {
<a name="l02478"></a>02478      <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(&amp;coords[i_s][vertIDs[i_s][i]*numDim], 
<a name="l02479"></a>02479                          &amp;coords[i_s][vertIDs[i_s][j]*numDim],
<a name="l02480"></a>02480                          numDim, &amp;temp);
<a name="l02481"></a>02481      <span class="keywordflow">if</span> (temp &gt; diameter2) {
<a name="l02482"></a>02482        diameter2 = temp;
<a name="l02483"></a>02483        <span class="keywordflow">if</span> (doPairs) {
<a name="l02484"></a>02484          ids[0] = vertIDs[i_s][i];
<a name="l02485"></a>02485          ids[1] = vertIDs[i_s][j];
<a name="l02486"></a>02486          subs[0] = subsets[i_s];
<a name="l02487"></a>02487          subs[1] = subsets[i_s];
<a name="l02488"></a>02488          num = 1;
<a name="l02489"></a>02489        }
<a name="l02490"></a>02490      }
<a name="l02491"></a>02491      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doPairs &amp;&amp; <a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(temp, diameter2)) {
<a name="l02492"></a>02492        <span class="keywordflow">if</span> (num+1 &gt; maxNum) {
<a name="l02493"></a>02493          temp_ids = (<span class="keywordtype">int</span>*)realloc(ids, 4*maxNum*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02494"></a>02494          temp_subs = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)realloc(subs, 4*maxNum*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02495"></a>02495          <span class="keywordflow">if</span> (!temp_ids || !temp_subs)
<a name="l02496"></a>02496            <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02497"></a>02497          ids = temp_ids;
<a name="l02498"></a>02498          subs = temp_subs;
<a name="l02499"></a>02499          maxNum *= 2;
<a name="l02500"></a>02500        }
<a name="l02501"></a>02501        ids[num*2] = vertIDs[i_s][i];
<a name="l02502"></a>02502        ids[num*2+1] = vertIDs[i_s][j];
<a name="l02503"></a>02503        subs[num*2] = subsets[i_s];
<a name="l02504"></a>02504        subs[num*2+1] = subsets[i_s];
<a name="l02505"></a>02505        num++;
<a name="l02506"></a>02506      }
<a name="l02507"></a>02507       }
<a name="l02508"></a>02508     }
<a name="l02509"></a>02509   }
<a name="l02510"></a>02510   <span class="comment">// check each vertex in one subset against all verts in other subsets</span>
<a name="l02511"></a>02511   <span class="keywordflow">for</span> (i_s = 0; i_s &lt; numSubset; i_s++) {
<a name="l02512"></a>02512     <span class="keywordflow">for</span> (i = 0; i &lt; numVerts[i_s]; i++) {
<a name="l02513"></a>02513       <span class="keywordflow">for</span> (j_s = i_s+1; j_s &lt; numSubset; j_s++) {
<a name="l02514"></a>02514      <span class="keywordflow">for</span> (j = 0; j &lt; numVerts[j_s]; j++) {
<a name="l02515"></a>02515        <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(&amp;coords[i_s][vertIDs[i_s][i]*numDim], 
<a name="l02516"></a>02516                            &amp;coords[j_s][vertIDs[j_s][j]*numDim],
<a name="l02517"></a>02517                            numDim, &amp;temp);
<a name="l02518"></a>02518        <span class="keywordflow">if</span> (temp &gt; diameter2) {
<a name="l02519"></a>02519          diameter2 = temp;
<a name="l02520"></a>02520          <span class="keywordflow">if</span> (doPairs) {
<a name="l02521"></a>02521            ids[0] = vertIDs[i_s][i];
<a name="l02522"></a>02522            ids[1] = vertIDs[j_s][j];
<a name="l02523"></a>02523            subs[0] = subsets[i_s];
<a name="l02524"></a>02524            subs[1] = subsets[j_s];
<a name="l02525"></a>02525            num = 1;
<a name="l02526"></a>02526          }
<a name="l02527"></a>02527        }
<a name="l02528"></a>02528        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doPairs &amp;&amp; <a class="code" href="group__PublicFloatingPoint.html#g9eab7a99d9f08eee22764c6916f46f51" title="Test equality of two values with double precision.">FC_DBL_EQUIV</a>(temp, diameter2)) {
<a name="l02529"></a>02529          <span class="keywordflow">if</span> (num+1 &gt; maxNum) {
<a name="l02530"></a>02530            temp_ids = (<span class="keywordtype">int</span>*)realloc(ids, 4*maxNum*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02531"></a>02531            temp_subs = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)realloc(subs, 4*maxNum*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02532"></a>02532            <span class="keywordflow">if</span> (!temp_ids || !temp_subs)
<a name="l02533"></a>02533           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l02534"></a>02534            maxNum*= 2;
<a name="l02535"></a>02535            ids = temp_ids;
<a name="l02536"></a>02536            subs = temp_subs;
<a name="l02537"></a>02537          }
<a name="l02538"></a>02538          ids[num*2] = vertIDs[i_s][i];
<a name="l02539"></a>02539          ids[num*2+1] = vertIDs[j_s][j];
<a name="l02540"></a>02540          subs[num*2] = subsets[i_s];
<a name="l02541"></a>02541          subs[num*2+1] = subsets[j_s];
<a name="l02542"></a>02542          num++;
<a name="l02543"></a>02543        }
<a name="l02544"></a>02544      }
<a name="l02545"></a>02545       }
<a name="l02546"></a>02546     }
<a name="l02547"></a>02547   }
<a name="l02548"></a>02548   <span class="keywordflow">if</span> (displs) 
<a name="l02549"></a>02549     <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++)
<a name="l02550"></a>02550       free(coords[i]);
<a name="l02551"></a>02551   <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++)
<a name="l02552"></a>02552     free(vertIDs[i]);
<a name="l02553"></a>02553   
<a name="l02554"></a>02554   <span class="comment">// Return?</span>
<a name="l02555"></a>02555   *diameter = sqrt(diameter2);
<a name="l02556"></a>02556   <span class="keywordflow">if</span> (doPairs) {
<a name="l02557"></a>02557     *numPair = num;
<a name="l02558"></a>02558     *pairSubsets = (<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>*)realloc(subs, 2*num*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a>));
<a name="l02559"></a>02559     *pairIDs = (<span class="keywordtype">int</span>*)realloc(ids, 2*num*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)); <span class="comment">// squeeze</span>
<a name="l02560"></a>02560   }
<a name="l02561"></a>02561 
<a name="l02562"></a>02562   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l02563"></a>02563 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g910d9e1b0685c7ef479521b4c0480905"></a><!-- doxytag: member="geom.c::_fc_getSubsetsProximityArgsTest" ref="g910d9e1b0685c7ef479521b4c0480905" args="(FC_Mesh *mesh1, FC_Subset *subset1, FC_Variable *displ1, FC_Mesh *mesh2, FC_Subset *subset2, FC_Variable *displ2, double min_dist, int *numPair, int **mesh1VertIDs, int **mesh2VertIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getSubsetsProximityArgsTest           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>mesh1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>subset1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>mesh2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>subset2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh1VertIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh2VertIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Common argument testing for all proximity routines. 
<p>
<b>Description:</b> <p>
<b>Modifications:</b> <ul>
<li>03/14/2006 WSD Created.</li><li>03/16/2006 WSD changed behavior so that if NULLs are passed in for the vertIDs, will return after 1st match. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh1</em>&nbsp;</td><td>
input - the first mesh </td></tr>
<tr><td valign="top"><em>subset1</em>&nbsp;</td><td>
input - the first subset </td></tr>
<tr><td valign="top"><em>displ1</em>&nbsp;</td><td>
input - the displs on the first mesh/subset </td></tr>
<tr><td valign="top"><em>mesh2</em>&nbsp;</td><td>
input - the first mesh </td></tr>
<tr><td valign="top"><em>subset2</em>&nbsp;</td><td>
input - the second subset </td></tr>
<tr><td valign="top"><em>displ2</em>&nbsp;</td><td>
input - the disps on the 2nd mesh/subset </td></tr>
<tr><td valign="top"><em>min_dist</em>&nbsp;</td><td>
input - the distance cutoff </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - the number of vertex pairs found </td></tr>
<tr><td valign="top"><em>mesh1VertIDs</em>&nbsp;</td><td>
output - ids of the mesh1 verts (order matters), user is responsible for freeing </td></tr>
<tr><td valign="top"><em>mesh2VertIDs</em>&nbsp;</td><td>
output - ids of the mesh2 verts (order matters), user is responsible for freeing </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l05181">5181</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="subset_8c-source.html#l02622">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="util_8c-source.html#l00365">fc_lt()</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l04981">fc_getDisplacedMeshesProximity()</a>, <a class="el" href="geom_8c-source.html#l05133">fc_getDisplacedSubsetsProximity()</a>, <a class="el" href="geom_8c-source.html#l04897">fc_getMeshesProximity()</a>, and <a class="el" href="geom_8c-source.html#l05068">fc_getSubsetsProximity()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l05194"></a>05194   {
<a name="l05195"></a>05195   <span class="keywordtype">int</span> numDim1, numDim2;
<a name="l05196"></a>05196   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> temp_mesh1, temp_mesh2;
<a name="l05197"></a>05197 
<a name="l05198"></a>05198   <span class="comment">// default returns</span>
<a name="l05199"></a>05199   <span class="keywordflow">if</span> (numPair)
<a name="l05200"></a>05200     *numPair = -1;
<a name="l05201"></a>05201   <span class="keywordflow">if</span> (mesh1VertIDs)
<a name="l05202"></a>05202     *mesh1VertIDs = NULL;
<a name="l05203"></a>05203   <span class="keywordflow">if</span> (mesh2VertIDs)
<a name="l05204"></a>05204     *mesh2VertIDs = NULL;
<a name="l05205"></a>05205 
<a name="l05206"></a>05206   <span class="comment">// test input</span>
<a name="l05207"></a>05207   <span class="comment">// It is o.k. to pass in mesh1VertIDs = NULL &amp;&amp; mesh2VertIDs = NULL</span>
<a name="l05208"></a>05208   <span class="keywordflow">if</span> (!numPair || (!mesh1VertIDs &amp;&amp; mesh2VertIDs) ||
<a name="l05209"></a>05209       (mesh1VertIDs &amp;&amp; !mesh2VertIDs)) { 
<a name="l05210"></a>05210     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l05211"></a>05211     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l05212"></a>05212   }
<a name="l05213"></a>05213   <span class="keywordflow">if</span> ( (mesh1 &amp;&amp; !<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(*mesh1)) ||
<a name="l05214"></a>05214        (mesh2 &amp;&amp; !<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(*mesh2)) ||
<a name="l05215"></a>05215        (subset1 &amp;&amp; !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(*subset1)) ||
<a name="l05216"></a>05216        (subset2 &amp;&amp; !<a class="code" href="group__Subset.html#g63bf248cb60435e458ea038036d6af90" title="Check that the handle refers to a valid subset.">fc_isSubsetValid</a>(*subset2)) ||
<a name="l05217"></a>05217        (displ1 &amp;&amp; !<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(*displ1)) ||
<a name="l05218"></a>05218        (displ2 &amp;&amp; !<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(*displ2)) ||
<a name="l05219"></a>05219        <a class="code" href="group__PublicFloatingPoint.html#g7558acdb496578930135c922532f372b" title="Test if the first double is less than the second double.">fc_lt</a>(min_dist, 0., DBL_EPSILON, DBL_MIN) ) { 
<a name="l05220"></a>05220     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l05221"></a>05221     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l05222"></a>05222   }
<a name="l05223"></a>05223   <span class="comment">// If have 1, have to have the other, and can't be equal</span>
<a name="l05224"></a>05224   <span class="comment">// (NOTE displ1 == displ2 implies mesh1 = mesh2, so not testing that</span>
<a name="l05225"></a>05225   <span class="keywordflow">if</span> ( (mesh1 &amp;&amp; !mesh2) || (!mesh1 &amp;&amp; mesh2) ||
<a name="l05226"></a>05226        (subset1 &amp;&amp; !subset2) || (!subset1 &amp;&amp; subset2) ||
<a name="l05227"></a>05227        (displ1 &amp;&amp; !displ2) || (!displ1 &amp;&amp; displ2) || 
<a name="l05228"></a>05228        (mesh1 &amp;&amp; !displ1 &amp;&amp; <a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(*mesh1, *mesh2)) ||
<a name="l05229"></a>05229        (mesh1 &amp;&amp; displ1 &amp;&amp; <a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(*displ1, *displ2)) || 
<a name="l05230"></a>05230        (subset1 &amp;&amp; !displ1 &amp;&amp; <a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(*subset1, *subset2)) || 
<a name="l05231"></a>05231        (subset1 &amp;&amp; displ1 &amp;&amp; (<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(*subset1, *subset2) &amp;&amp;
<a name="l05232"></a>05232                      <a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(*displ1, *displ2))) ) {
<a name="l05233"></a>05233     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l05234"></a>05234     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l05235"></a>05235   }
<a name="l05236"></a>05236   <span class="comment">// some setup for further testing</span>
<a name="l05237"></a>05237   <span class="keywordflow">if</span> (mesh1) 
<a name="l05238"></a>05238     temp_mesh1 = *mesh1;
<a name="l05239"></a>05239   <span class="keywordflow">else</span>
<a name="l05240"></a>05240     <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(*subset1, &amp;temp_mesh1);
<a name="l05241"></a>05241   <span class="keywordflow">if</span> (mesh2)
<a name="l05242"></a>05242     temp_mesh2 = *mesh2;
<a name="l05243"></a>05243   <span class="keywordflow">else</span>
<a name="l05244"></a>05244     <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(*subset2, &amp;temp_mesh2);
<a name="l05245"></a>05245   <span class="comment">// more tests</span>
<a name="l05246"></a>05246   <span class="keywordflow">if</span> ( (displ1 &amp;&amp; !<a class="code" href="group__GeometricRelations.html#g904f6ade0783bc52bee008d10e7b6a36" title="Test to see if variable can be used as displacment variable.">fc_isValidDisplacementVariable</a>(temp_mesh1, *displ1)) ||
<a name="l05247"></a>05247        (displ2 &amp;&amp; !<a class="code" href="group__GeometricRelations.html#g904f6ade0783bc52bee008d10e7b6a36" title="Test to see if variable can be used as displacment variable.">fc_isValidDisplacementVariable</a>(temp_mesh2, *displ2))) {
<a name="l05248"></a>05248     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l05249"></a>05249     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l05250"></a>05250   }
<a name="l05251"></a>05251   <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(temp_mesh1, &amp;numDim1);
<a name="l05252"></a>05252   <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(temp_mesh2, &amp;numDim2);
<a name="l05253"></a>05253   <span class="keywordflow">if</span> (numDim1 != numDim2) {
<a name="l05254"></a>05254     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Meshes must have same numDim (%d != %d)"</span>,
<a name="l05255"></a>05255                  numDim1, numDim2);
<a name="l05256"></a>05256     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l05257"></a>05257   }
<a name="l05258"></a>05258 
<a name="l05259"></a>05259   <span class="comment">// made it past tests</span>
<a name="l05260"></a>05260   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l05261"></a>05261 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g683ad7d86a5c14d1350f0e666ae5bfa7"></a><!-- doxytag: member="geom.c::_fc_getSubsetsProximityCore" ref="g683ad7d86a5c14d1350f0e666ae5bfa7" args="(FC_Subset subset1, FC_Variable *displ1, FC_Subset subset2, FC_Variable *displ2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getSubsetsProximityCore           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh1VertIDs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh2VertIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the proximal vertices between two displaced subsets. 
<p>
<b>Description:</b> <p>
This returns all vertex pairs that are less than or equal to min_dist apart. Vertices may show up in more than one pair. (In the extrememe case if you put in min_dist = infinity, you would end up with each vertex being connected to all vertices of the other subset.)<p>
The routine can be forced to return "early", after the first match is found, if you use NULL for the last two arguments (the vertex arrays). In this case, the returned numPair is really a flag for whether a pair was found or not and will never be greater than 1 even if there are more than one possible pairs.<p>
Note, passing in min_dist = 0 will find overlapping vertices, or if subsets are on the same mesh, will find common vertices.<p>
Note, subsets may be closer together than any of the vertex pairs (imagine 1 vertex of one mesh very close to middle of a face of another mesh. the vert to face distance is less than distance to the face's verts).<p>
Will return if error if subset1 == subset2 AND displ1 == displ2. (subset1 can be the same as subset2 if displ1 != displ2)<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000040">Todo:</a></b></dt><dd>(performance) Restrict the brute force search to vertices in the bounding box overlap</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000040">Todo:</a></b></dt><dd>(performance) make the pairs grow by greater than 1 each time</dd></dl>
<b>Modifications:</b> <ul>
<li>02/14/2006 WSD Created.</li><li>03/16/2006 WSD changed behavior so that if NULLs are passed in for the vertIDs, will return after 1st match. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset1</em>&nbsp;</td><td>
input - the first subset </td></tr>
<tr><td valign="top"><em>displ1</em>&nbsp;</td><td>
input - the displacements on the mesh of the first subset </td></tr>
<tr><td valign="top"><em>subset2</em>&nbsp;</td><td>
input - the second subset </td></tr>
<tr><td valign="top"><em>displ2</em>&nbsp;</td><td>
input - the displacements on the mesh of the second subset </td></tr>
<tr><td valign="top"><em>min_dist</em>&nbsp;</td><td>
input - the distance cutoff </td></tr>
<tr><td valign="top"><em>numPair_p</em>&nbsp;</td><td>
output - the number of vertex pairs found </td></tr>
<tr><td valign="top"><em>mesh1VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh1 verts (order matters), user is responsible for freeing </td></tr>
<tr><td valign="top"><em>mesh2VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh2 verts (order matters), user is responsible for freeing </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l05303">5303</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00191">FC_AT_VERTEX</a>, <a class="el" href="geom_8c-source.html#l00163">fc_calcSquaredEuclideanDistance()</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="geom_8c-source.html#l00480">fc_getBoundingBoxesOverlap()</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="geom_8c-source.html#l00956">fc_getDisplacedSubsetBoundingBox()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02953">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l02741">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l02902">fc_getSubsetAssociationType()</a>, <a class="el" href="geom_8c-source.html#l00847">fc_getSubsetBoundingBox()</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="util_8c-source.html#l00390">fc_lteq()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l04981">fc_getDisplacedMeshesProximity()</a>, <a class="el" href="geom_8c-source.html#l05133">fc_getDisplacedSubsetsProximity()</a>, <a class="el" href="geom_8c-source.html#l04897">fc_getMeshesProximity()</a>, and <a class="el" href="geom_8c-source.html#l05068">fc_getSubsetsProximity()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l05316"></a>05316   {
<a name="l05317"></a>05317   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l05318"></a>05318   <span class="keywordtype">int</span> i, j;
<a name="l05319"></a>05319   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> mesh1, mesh2;
<a name="l05320"></a>05320   <span class="keywordtype">int</span> numDim, temp_numDim, overlap_flag;
<a name="l05321"></a>05321   <span class="keywordtype">int</span> numMember1, numMember2, *memberIDs1, *memberIDs2;
<a name="l05322"></a>05322   <span class="keywordtype">int</span> numVert1, numVert2, *vertIDs1, *vertIDs2;
<a name="l05323"></a>05323   <a class="code" href="group__DataTypes.html#g28b7cdba59395ddc988888d01dd19af6" title="Possible association of the data to the mesh.">FC_AssociationType</a> assoc1, assoc2;
<a name="l05324"></a>05324   <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> lowers1, uppers1, lowers2, uppers2, lowers3, uppers3;
<a name="l05325"></a>05325   <span class="keywordtype">double</span> *coords1, *coords2;
<a name="l05326"></a>05326   <span class="keywordtype">double</span> min_dist2, distance2; <span class="comment">// squared versions of min_dist &amp; distance</span>
<a name="l05327"></a>05327   <span class="keywordtype">int</span> numPair = 0, *mesh1VertIDs = NULL, *mesh2VertIDs = NULL;
<a name="l05328"></a>05328   <span class="keywordtype">int</span> *temp1, *temp2;
<a name="l05329"></a>05329   <span class="keywordtype">int</span> doDispl = 0, doPairs = 0;
<a name="l05330"></a>05330 
<a name="l05331"></a>05331   <span class="comment">// assume args all tested &amp; defaults set</span>
<a name="l05332"></a>05332 
<a name="l05333"></a>05333   <span class="comment">// setup</span>
<a name="l05334"></a>05334   <span class="keywordflow">if</span> (displ1 &amp;&amp; displ2)
<a name="l05335"></a>05335     doDispl = 1;
<a name="l05336"></a>05336   <span class="keywordflow">if</span> (mesh1VertIDs_p &amp;&amp; mesh2VertIDs_p)
<a name="l05337"></a>05337     doPairs = 1;
<a name="l05338"></a>05338   <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(subset1, &amp;mesh1);
<a name="l05339"></a>05339   <a class="code" href="group__Subset.html#gddbb3a2f8c43289a3c3754f1546462bc" title="Get the parent mesh of the subset.">fc_getMeshFromSubset</a>(subset2, &amp;mesh2);
<a name="l05340"></a>05340 
<a name="l05341"></a>05341   <span class="comment">// plus one more test:</span>
<a name="l05342"></a>05342   <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(mesh1, &amp;numDim);
<a name="l05343"></a>05343   <a class="code" href="group__Mesh.html#g1dbe9de126f08baea03de91a37b0258b" title="Returns dimensionality of the mesh coordinates.">fc_getMeshDim</a>(mesh2, &amp;temp_numDim);
<a name="l05344"></a>05344   <span class="keywordflow">if</span> (numDim != temp_numDim) {
<a name="l05345"></a>05345     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Meshes must have same numDim (%d != %d)"</span>,
<a name="l05346"></a>05346                  numDim, temp_numDim);
<a name="l05347"></a>05347     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l05348"></a>05348   }
<a name="l05349"></a>05349 
<a name="l05350"></a>05350   <span class="comment">// Compute bounding boxes +/- min_dist/2</span>
<a name="l05351"></a>05351   <span class="keywordflow">if</span> (doDispl) {
<a name="l05352"></a>05352     rc = <a class="code" href="group__GeometricRelations.html#g8e8800e31f2800dfca72e864e4518a0b" title="Compute bounding box of subset of a displaced mesh.">fc_getDisplacedSubsetBoundingBox</a>(subset1, *displ1, &amp;numDim, &amp;lowers1, 
<a name="l05353"></a>05353                            &amp;uppers1);
<a name="l05354"></a>05354     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05355"></a>05355       <span class="keywordflow">return</span> rc;
<a name="l05356"></a>05356     rc = <a class="code" href="group__GeometricRelations.html#g8e8800e31f2800dfca72e864e4518a0b" title="Compute bounding box of subset of a displaced mesh.">fc_getDisplacedSubsetBoundingBox</a>(subset2, *displ2, &amp;numDim, &amp;lowers2, 
<a name="l05357"></a>05357                            &amp;uppers2);
<a name="l05358"></a>05358     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05359"></a>05359       <span class="keywordflow">return</span> rc;
<a name="l05360"></a>05360   }
<a name="l05361"></a>05361   <span class="keywordflow">else</span> {
<a name="l05362"></a>05362     rc = <a class="code" href="group__GeometricRelations.html#gac16d03bbbd1911f25ef27a23cb57321" title="Compute bounding box of subset.">fc_getSubsetBoundingBox</a>(subset1, &amp;numDim, &amp;lowers1, &amp;uppers1);
<a name="l05363"></a>05363     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05364"></a>05364       <span class="keywordflow">return</span> rc;
<a name="l05365"></a>05365     rc = <a class="code" href="group__GeometricRelations.html#gac16d03bbbd1911f25ef27a23cb57321" title="Compute bounding box of subset.">fc_getSubsetBoundingBox</a>(subset2, &amp;numDim, &amp;lowers2, &amp;uppers2);
<a name="l05366"></a>05366     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05367"></a>05367       <span class="keywordflow">return</span> rc;
<a name="l05368"></a>05368   }
<a name="l05369"></a>05369   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l05370"></a>05370     lowers1[i] -= min_dist/2.;
<a name="l05371"></a>05371     lowers2[i] -= min_dist/2.;
<a name="l05372"></a>05372     uppers1[i] += min_dist/2.;
<a name="l05373"></a>05373     uppers2[i] += min_dist/2.;
<a name="l05374"></a>05374   }
<a name="l05375"></a>05375   rc = <a class="code" href="group__GeometricRelations.html#gfe4be82f944d00c9359e2b27f8a05514" title="Determine if two bounding boxes overlap in space.">fc_getBoundingBoxesOverlap</a>(numDim, lowers1, uppers1, lowers2, uppers2, 
<a name="l05376"></a>05376                       &amp;overlap_flag, &amp;lowers3, &amp;uppers3);
<a name="l05377"></a>05377   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05378"></a>05378     <span class="keywordflow">return</span> rc;
<a name="l05379"></a>05379 
<a name="l05380"></a>05380   <span class="comment">// early return if no overlap</span>
<a name="l05381"></a>05381   <span class="keywordflow">if</span> (overlap_flag == 0) {
<a name="l05382"></a>05382     *numPair_p = 0;
<a name="l05383"></a>05383     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l05384"></a>05384   }
<a name="l05385"></a>05385 
<a name="l05386"></a>05386   <span class="comment">// convert subset members to verts (if needed)</span>
<a name="l05387"></a>05387   <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(subset1, &amp;assoc1);
<a name="l05388"></a>05388   <a class="code" href="group__Subset.html#g7e34b0e8a2f9d42c44f0ee4ea00f5e8a" title="Get subset&amp;#39;s association type.">fc_getSubsetAssociationType</a>(subset2, &amp;assoc2);
<a name="l05389"></a>05389   <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset1, &amp;numMember1, &amp;memberIDs1);
<a name="l05390"></a>05390   <a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(subset2, &amp;numMember2, &amp;memberIDs2);
<a name="l05391"></a>05391   <span class="keywordflow">if</span> (assoc1 == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>) {
<a name="l05392"></a>05392     numVert1 = numMember1;
<a name="l05393"></a>05393     vertIDs1 = memberIDs1;
<a name="l05394"></a>05394   }
<a name="l05395"></a>05395   <span class="keywordflow">else</span> {
<a name="l05396"></a>05396     <a class="code" href="group__TopologyRelations.html#gd652ffb3bbe366c1a882a4e0fa34c499" title="Change the type of mesh entities.">fc_changeMeshEntityType</a>(mesh1, assoc1, numMember1, memberIDs1,
<a name="l05397"></a>05397                    <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, 0, &amp;numVert1, &amp;vertIDs1);
<a name="l05398"></a>05398     free(memberIDs1);
<a name="l05399"></a>05399   }
<a name="l05400"></a>05400   <span class="keywordflow">if</span> (assoc2 == <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>) {
<a name="l05401"></a>05401     numVert2 = numMember2;
<a name="l05402"></a>05402     vertIDs2 = memberIDs2;
<a name="l05403"></a>05403   }
<a name="l05404"></a>05404   <span class="keywordflow">else</span> {
<a name="l05405"></a>05405     <a class="code" href="group__TopologyRelations.html#gd652ffb3bbe366c1a882a4e0fa34c499" title="Change the type of mesh entities.">fc_changeMeshEntityType</a>(mesh2, assoc2, numMember2, memberIDs2,
<a name="l05406"></a>05406                    <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af644ec6296999025f1ac12940f0c8e36d3">FC_AT_VERTEX</a>, 0, &amp;numVert2, &amp;vertIDs2);
<a name="l05407"></a>05407     free(memberIDs2);
<a name="l05408"></a>05408   }
<a name="l05409"></a>05409 
<a name="l05410"></a>05410   <span class="comment">// get coords</span>
<a name="l05411"></a>05411   <span class="keywordflow">if</span> (doDispl) {
<a name="l05412"></a>05412     rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(mesh1, *displ1, &amp;coords1);
<a name="l05413"></a>05413     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05414"></a>05414       <span class="keywordflow">return</span> rc;
<a name="l05415"></a>05415     rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(mesh2, *displ2, &amp;coords2);
<a name="l05416"></a>05416     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05417"></a>05417       <span class="keywordflow">return</span> rc;
<a name="l05418"></a>05418   }
<a name="l05419"></a>05419   <span class="keywordflow">else</span> {
<a name="l05420"></a>05420     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(mesh1, &amp;coords1);
<a name="l05421"></a>05421     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05422"></a>05422       <span class="keywordflow">return</span> rc;
<a name="l05423"></a>05423     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(mesh2, &amp;coords2);
<a name="l05424"></a>05424     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l05425"></a>05425       <span class="keywordflow">return</span> rc;
<a name="l05426"></a>05426   }
<a name="l05427"></a>05427 
<a name="l05428"></a>05428   <span class="comment">// FIX make this better </span>
<a name="l05429"></a>05429   <span class="comment">// 1) have smarter realloc of pairs - grow by *2</span>
<a name="l05430"></a>05430   <span class="comment">// 2) could just test vertices in the overlap</span>
<a name="l05431"></a>05431   <span class="comment">// 3) set up two sets of loops - switch from the first</span>
<a name="l05432"></a>05432   <span class="comment">//    after the first pair is found so don't have the</span>
<a name="l05433"></a>05433   <span class="comment">//    doPairs test in every loop</span>
<a name="l05434"></a>05434   
<a name="l05435"></a>05435   <span class="comment">// If find a pair, add to pairs</span>
<a name="l05436"></a>05436   <span class="comment">// Note: early return if not doing pairs</span>
<a name="l05437"></a>05437   min_dist2 = min_dist*min_dist;
<a name="l05438"></a>05438   <span class="keywordflow">for</span> (i = 0; i &lt; numVert1; i++) {
<a name="l05439"></a>05439     <span class="keywordtype">int</span> vertID1 = vertIDs1[i];
<a name="l05440"></a>05440     <span class="keywordflow">for</span> (j = 0; j &lt; numVert2; j++) {
<a name="l05441"></a>05441       <span class="keywordtype">int</span> vertID2 = vertIDs2[j];
<a name="l05442"></a>05442       <a class="code" href="group__GeometricRelations.html#gf1520cdaf3f984812aae127263fcd864" title="Compute the squared distance between two vertices.">fc_calcSquaredEuclideanDistance</a>(&amp;coords1[vertID1*numDim], 
<a name="l05443"></a>05443                           &amp;coords2[vertID2*numDim], numDim,
<a name="l05444"></a>05444                           &amp;distance2);
<a name="l05445"></a>05445       <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#gb186f78f32c105103d134949d7dd8a43" title="Test if the first double is less than or equal to the second double.">fc_lteq</a>(distance2, min_dist2, DBL_EPSILON, DBL_MIN)) {
<a name="l05446"></a>05446      <span class="keywordflow">if</span> (!doPairs) {
<a name="l05447"></a>05447        *numPair_p = 1;
<a name="l05448"></a>05448        free(vertIDs1);
<a name="l05449"></a>05449        free(vertIDs2);
<a name="l05450"></a>05450        <span class="keywordflow">if</span> (doDispl) {
<a name="l05451"></a>05451          free(coords1);
<a name="l05452"></a>05452          free(coords2);
<a name="l05453"></a>05453        }
<a name="l05454"></a>05454        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l05455"></a>05455      }
<a name="l05456"></a>05456      temp1 = realloc(mesh1VertIDs, (numPair+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l05457"></a>05457      temp2 = realloc(mesh2VertIDs, (numPair+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l05458"></a>05458      <span class="keywordflow">if</span> (!temp1 || !temp2) {
<a name="l05459"></a>05459        free(mesh1VertIDs); free(mesh2VertIDs);
<a name="l05460"></a>05460        <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l05461"></a>05461        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l05462"></a>05462      }
<a name="l05463"></a>05463      mesh1VertIDs = temp1;
<a name="l05464"></a>05464      mesh2VertIDs = temp2;
<a name="l05465"></a>05465      mesh1VertIDs[numPair] = vertID1;
<a name="l05466"></a>05466      mesh2VertIDs[numPair] = vertID2;
<a name="l05467"></a>05467      numPair++;
<a name="l05468"></a>05468       }
<a name="l05469"></a>05469     }
<a name="l05470"></a>05470   }
<a name="l05471"></a>05471   free(vertIDs1);
<a name="l05472"></a>05472   free(vertIDs2);
<a name="l05473"></a>05473   <span class="keywordflow">if</span> (doDispl) {
<a name="l05474"></a>05474     free(coords1);
<a name="l05475"></a>05475     free(coords2);
<a name="l05476"></a>05476   }
<a name="l05477"></a>05477 
<a name="l05478"></a>05478   <span class="comment">// set return values</span>
<a name="l05479"></a>05479   *numPair_p = numPair;
<a name="l05480"></a>05480   <span class="keywordflow">if</span> (doPairs) { <span class="comment">// in case numPair is zero</span>
<a name="l05481"></a>05481     *mesh1VertIDs_p = mesh1VertIDs;
<a name="l05482"></a>05482     *mesh2VertIDs_p = mesh2VertIDs;
<a name="l05483"></a>05483   }
<a name="l05484"></a>05484 
<a name="l05485"></a>05485   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l05486"></a>05486 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gb953a6c11dee13281fafa4f08ea7e47c"></a><!-- doxytag: member="geom.c::_fc_getVertexIDsWithinBoundingBoxUsingVertexBin" ref="gb953a6c11dee13281fafa4f08ea7e47c" args="(FC_Mesh mesh, FC_VertexBin *bin, FC_Coords lowpoint, FC_Coords highpoint, int *numVertex_p, int **vertexIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getVertexIDsWithinBoundingBoxUsingVertexBin           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *&nbsp;</td>
          <td class="paramname"> <em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numVertex_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>vertexIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find all vertices within a bounding box. 
<p>
<b>Description:</b> <p>
Takes two points describing a bounding box and returns the IDs of all vertices which are within the bounding box (including those on its boundary), regardless of the connectivity information in the mesh. To use this routine, you must first call fc_createMeshVertexBin to make the vertex bins used for searching.<p>
The returned ID array is created by this routine, but it is the responsibility of the caller to free it.<p>
<b>Modifications:</b> <ul>
<li>10/27/04 WSK, Created.</li><li>2/21/04 WSD can now handle displaced mesh </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>bin</em>&nbsp;</td><td>
input - vertex bin for mesh </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
input - lower corner of bb </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
input - upper corner of bb </td></tr>
<tr><td valign="top"><em>numVertex_p</em>&nbsp;</td><td>
output - number of vertices within radius </td></tr>
<tr><td valign="top"><em>vertexIDs_p</em>&nbsp;</td><td>
output - array of vertex IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l06312">6312</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8h-source.html#l00220">FC_VertexBin::binWidths</a>, <a class="el" href="geom_8h-source.html#l00211">FC_VertexBin::displ</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="geom_8c-source.html#l00444">fc_isBoundingBoxValid()</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="util_8c-source.html#l00968">fc_sortIntArray()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="geom_8h-source.html#l00216">FC_VertexBin::lowerCoords</a>, <a class="el" href="geom_8h-source.html#l00210">FC_VertexBin::mesh</a>, <a class="el" href="geom_8h-source.html#l00219">FC_VertexBin::numBins</a>, <a class="el" href="geom_8h-source.html#l00212">FC_VertexBin::numDim</a>, <a class="el" href="geom_8h-source.html#l00221">FC_VertexBin::numVertex</a>, <a class="el" href="geom_8h-source.html#l00217">FC_VertexBin::upperCoords</a>, and <a class="el" href="geom_8h-source.html#l00222">FC_VertexBin::vertexIDs</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l05704">fc_getEntitiesWithinBoundingBox()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06320"></a>06320 {
<a name="l06321"></a>06321   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l06322"></a>06322   <span class="keywordtype">int</span> i, j, k, m, n;
<a name="l06323"></a>06323   <span class="keywordtype">int</span> numVert, maxNumVert, *vertIDs, *temp;
<a name="l06324"></a>06324   <span class="keywordtype">int</span> lowerICoords[3] = { 0, 0, 0 };
<a name="l06325"></a>06325   <span class="keywordtype">int</span> upperICoords[3] = { 0, 0, 0 };
<a name="l06326"></a>06326   <span class="keywordtype">double</span> lower, upper;
<a name="l06327"></a>06327   <span class="keywordtype">int</span> intersects = 1; <span class="comment">// true;</span>
<a name="l06328"></a>06328   <span class="keywordtype">double</span>* coords;
<a name="l06329"></a>06329   <span class="keywordtype">int</span> do_displ;
<a name="l06330"></a>06330 
<a name="l06331"></a>06331   <span class="comment">// default return</span>
<a name="l06332"></a>06332   <span class="keywordflow">if</span> (numVertex_p)
<a name="l06333"></a>06333     *numVertex_p = -1;
<a name="l06334"></a>06334   <span class="keywordflow">if</span> (vertexIDs_p)
<a name="l06335"></a>06335     *vertexIDs_p = NULL;
<a name="l06336"></a>06336   
<a name="l06337"></a>06337   <span class="comment">// check input</span>
<a name="l06338"></a>06338   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || !bin || !<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(mesh, bin-&gt;<a class="code" href="structFC__VertexBin.html#908401321f7019827fd4e1e9f075677b">mesh</a>) || 
<a name="l06339"></a>06339       !<a class="code" href="group__GeometricRelations.html#g12f99d1cd737e4142a178c78e8ea07c6" title="Determine if a bounding box is valid.">fc_isBoundingBoxValid</a>(bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>, lowpoint, highpoint) || 
<a name="l06340"></a>06340       !numVertex_p || !vertexIDs_p) {
<a name="l06341"></a>06341     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l06342"></a>06342     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06343"></a>06343   }
<a name="l06344"></a>06344 
<a name="l06345"></a>06345   <span class="comment">// log message</span>
<a name="l06346"></a>06346   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Finding vertices within given bounding box."</span>);  
<a name="l06347"></a>06347   
<a name="l06348"></a>06348   <span class="comment">// determine i,j,k bounding box for bins = intersection with bounding box</span>
<a name="l06349"></a>06349   <span class="keywordflow">for</span> (i = 0; i &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>; i++) {
<a name="l06350"></a>06350     lower = lowpoint[i];
<a name="l06351"></a>06351     upper = highpoint[i];
<a name="l06352"></a>06352     <span class="comment">// special case - no intersection</span>
<a name="l06353"></a>06353     <span class="keywordflow">if</span> (lower &gt; bin-&gt;<a class="code" href="structFC__VertexBin.html#f1793ac2823dd0e600860ea10a043eb8">upperCoords</a>[i] || upper &lt; bin-&gt;lowerCoords[i]) {
<a name="l06354"></a>06354       intersects = 0; <span class="comment">// false</span>
<a name="l06355"></a>06355       <span class="keywordflow">break</span>;
<a name="l06356"></a>06356     }
<a name="l06357"></a>06357     <span class="keywordflow">else</span> {
<a name="l06358"></a>06358       lowerICoords[i] = (int) ((lower - bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[i])/bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[i]);
<a name="l06359"></a>06359       upperICoords[i] = (int) ((upper - bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[i])/bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[i]);
<a name="l06360"></a>06360       <span class="keywordflow">if</span> (lowerICoords[i] &lt; 0)
<a name="l06361"></a>06361         lowerICoords[i] = 0;
<a name="l06362"></a>06362       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lowerICoords[i] &gt;= bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i])
<a name="l06363"></a>06363         lowerICoords[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] - 1;
<a name="l06364"></a>06364       <span class="keywordflow">if</span> (upperICoords[i] &lt; 0)
<a name="l06365"></a>06365         upperICoords[i] = 0;
<a name="l06366"></a>06366       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (upperICoords[i] &gt;= bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i])
<a name="l06367"></a>06367         upperICoords[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] - 1;
<a name="l06368"></a>06368     }
<a name="l06369"></a>06369   }
<a name="l06370"></a>06370 
<a name="l06371"></a>06371   <span class="comment">// early return</span>
<a name="l06372"></a>06372   <span class="keywordflow">if</span> (intersects == 0) {
<a name="l06373"></a>06373     *numVertex_p = 0;
<a name="l06374"></a>06374     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; 
<a name="l06375"></a>06375   }
<a name="l06376"></a>06376 
<a name="l06377"></a>06377   <span class="comment">// Setup</span>
<a name="l06378"></a>06378   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(bin-&gt;<a class="code" href="structFC__VertexBin.html#41ced94f898bd264641a5f220bf24ac6">displ</a>)) {
<a name="l06379"></a>06379     do_displ = 1;
<a name="l06380"></a>06380     rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(mesh, bin-&gt;<a class="code" href="structFC__VertexBin.html#41ced94f898bd264641a5f220bf24ac6">displ</a>, &amp;coords);
<a name="l06381"></a>06381   }
<a name="l06382"></a>06382   <span class="keywordflow">else</span> {
<a name="l06383"></a>06383     do_displ = 0;
<a name="l06384"></a>06384     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l06385"></a>06385   }
<a name="l06386"></a>06386   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06387"></a>06387     <span class="keywordflow">return</span> rc;
<a name="l06388"></a>06388   numVert = 0;
<a name="l06389"></a>06389   maxNumVert = 0;
<a name="l06390"></a>06390   vertIDs = NULL;
<a name="l06391"></a>06391 
<a name="l06392"></a>06392   <span class="comment">// just check vertices in bins in i,j,k bounding box</span>
<a name="l06393"></a>06393   <span class="keywordflow">for</span> (i = lowerICoords[0]; i &lt;= upperICoords[0]; i++) {
<a name="l06394"></a>06394     <span class="keywordflow">for</span> (j = lowerICoords[1]; j &lt;= upperICoords[1]; j++) {
<a name="l06395"></a>06395       <span class="keywordflow">for</span> (k = lowerICoords[2]; k &lt;= upperICoords[2]; k++) {
<a name="l06396"></a>06396         <span class="keywordflow">for</span> (m = 0; m &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[i][j][k]; m++) {
<a name="l06397"></a>06397        <span class="keywordtype">int</span> vertID = bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i][j][k][m];
<a name="l06398"></a>06398        intersects = 1;
<a name="l06399"></a>06399           <span class="keywordflow">for</span> (n = 0; n &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>; n++) {
<a name="l06400"></a>06400          <span class="keywordflow">if</span> (coords[vertID*bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>+n] &lt; lowpoint[n] ||
<a name="l06401"></a>06401           coords[vertID*bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>+n] &gt; highpoint[n]) {
<a name="l06402"></a>06402            intersects = 0;
<a name="l06403"></a>06403            <span class="keywordflow">break</span>;
<a name="l06404"></a>06404          }
<a name="l06405"></a>06405        }
<a name="l06406"></a>06406           <span class="keywordflow">if</span> (intersects) {
<a name="l06407"></a>06407          <span class="keywordflow">if</span> (numVert == maxNumVert) {
<a name="l06408"></a>06408            <span class="keywordflow">if</span> (maxNumVert == 0)
<a name="l06409"></a>06409           maxNumVert = 2;
<a name="l06410"></a>06410            <span class="keywordflow">else</span>
<a name="l06411"></a>06411           maxNumVert *= 2;
<a name="l06412"></a>06412            temp = realloc(vertIDs, maxNumVert*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l06413"></a>06413            <span class="keywordflow">if</span> (!temp) {
<a name="l06414"></a>06414           free(vertIDs);
<a name="l06415"></a>06415           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06416"></a>06416           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06417"></a>06417            }
<a name="l06418"></a>06418            vertIDs = temp;
<a name="l06419"></a>06419          }
<a name="l06420"></a>06420             vertIDs[numVert] = bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i][j][k][m];
<a name="l06421"></a>06421             numVert++;
<a name="l06422"></a>06422           }
<a name="l06423"></a>06423         }
<a name="l06424"></a>06424       }
<a name="l06425"></a>06425     }
<a name="l06426"></a>06426   }
<a name="l06427"></a>06427   <span class="keywordflow">if</span> (do_displ)
<a name="l06428"></a>06428     free(coords);
<a name="l06429"></a>06429 
<a name="l06430"></a>06430   <span class="comment">// organize results</span>
<a name="l06431"></a>06431   <span class="keywordflow">if</span> (numVert &gt; 0) 
<a name="l06432"></a>06432     <a class="code" href="group__MiscUtilities.html#gab968abc681049a5e7c96f2552bbbbdc" title="Sort an int array.">fc_sortIntArray</a>(numVert, vertIDs);
<a name="l06433"></a>06433   *numVertex_p = numVert;
<a name="l06434"></a>06434   *vertexIDs_p = vertIDs;
<a name="l06435"></a>06435 
<a name="l06436"></a>06436   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l06437"></a>06437 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g506e4d8a06fd014e8518412743a2b3c7"></a><!-- doxytag: member="geom.c::_fc_getVertexIDsWithinSphereUsingVertexBin" ref="g506e4d8a06fd014e8518412743a2b3c7" args="(FC_Mesh mesh, FC_VertexBin *bin, FC_Coords center, double radius, int *numVertex_p, int **vertexIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4">FC_ReturnCode</a> _fc_getVertexIDsWithinSphereUsingVertexBin           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *&nbsp;</td>
          <td class="paramname"> <em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numVertex_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>vertexIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find all vertices within a given radius of a point. 
<p>
<b>Description:</b> <p>
Takes a point and a radius, and returns the IDs of all vertices which are within the described sphere, regardless of the element (connectivity) information in the mesh. To use this routine, you must first call fc_createMeshVertexBin to make the vertex bins used for searching.<p>
The returned ID array is created by this routine, but it is the responsibility of the caller to free it.<p>
This routine will produce the same results as fc_markGeomNeighbors. It should be used when you plan to perform multiple queries.<p>
<b>Modifications:</b> <ul>
<li>03/09/04 WSK, Created.</li><li>06/30/04 WSK Changed interface to return int array. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>bin</em>&nbsp;</td><td>
input - vertex bins </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
input - center of sphere </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - radius of sphere </td></tr>
<tr><td valign="top"><em>numVertex_p</em>&nbsp;</td><td>
output - number of vertices within radius </td></tr>
<tr><td valign="top"><em>vertexIDs_p</em>&nbsp;</td><td>
output - array of vertex IDs </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="geom_8c-source.html#l06462">6462</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.</p>

<p>References <a class="el" href="geom_8h-source.html#l00220">FC_VertexBin::binWidths</a>, <a class="el" href="geom_8h-source.html#l00211">FC_VertexBin::displ</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l03436">fc_getMeshCoordsPtr()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02742">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l05156">fc_isVariableValid()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00188">fc_printfLogMessage</a>, <a class="el" href="util_8c-source.html#l00968">fc_sortIntArray()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="geom_8h-source.html#l00216">FC_VertexBin::lowerCoords</a>, <a class="el" href="geom_8h-source.html#l00210">FC_VertexBin::mesh</a>, <a class="el" href="geom_8h-source.html#l00219">FC_VertexBin::numBins</a>, <a class="el" href="geom_8h-source.html#l00212">FC_VertexBin::numDim</a>, <a class="el" href="geom_8h-source.html#l00221">FC_VertexBin::numVertex</a>, <a class="el" href="geom_8h-source.html#l00217">FC_VertexBin::upperCoords</a>, and <a class="el" href="geom_8h-source.html#l00222">FC_VertexBin::vertexIDs</a>.</p>

<p>Referenced by <a class="el" href="geom_8c-source.html#l05786">fc_getEntitiesWithinSphere()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l06470"></a>06470 {
<a name="l06471"></a>06471   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l06472"></a>06472   <span class="keywordtype">int</span> i, j, k, m, n;
<a name="l06473"></a>06473   <span class="keywordtype">int</span> numVert, maxNumVert, *vertIDs, *temp;
<a name="l06474"></a>06474   <span class="keywordtype">double</span> r2, t2, d;
<a name="l06475"></a>06475   <span class="keywordtype">int</span> lowerICoords[3] = { 0, 0, 0 };
<a name="l06476"></a>06476   <span class="keywordtype">int</span> upperICoords[3] = { 0, 0, 0 };
<a name="l06477"></a>06477   <span class="keywordtype">double</span> lower, upper;
<a name="l06478"></a>06478   <span class="keywordtype">int</span> intersects = 1; <span class="comment">// true;</span>
<a name="l06479"></a>06479   <span class="keywordtype">double</span>* coords;
<a name="l06480"></a>06480   <span class="keywordtype">int</span> do_displ;
<a name="l06481"></a>06481 
<a name="l06482"></a>06482   <span class="comment">// default return</span>
<a name="l06483"></a>06483   <span class="keywordflow">if</span> (numVertex_p)
<a name="l06484"></a>06484     *numVertex_p = -1;
<a name="l06485"></a>06485   <span class="keywordflow">if</span> (vertexIDs_p)
<a name="l06486"></a>06486     *vertexIDs_p = NULL;
<a name="l06487"></a>06487   
<a name="l06488"></a>06488   <span class="comment">// check input</span>
<a name="l06489"></a>06489   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gab6b9ca1bc6e1e7d549ce9fcd396a5e6" title="Check that the handle refers to a valid mesh.">fc_isMeshValid</a>(mesh) || !bin || !<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(mesh, bin-&gt;<a class="code" href="structFC__VertexBin.html#908401321f7019827fd4e1e9f075677b">mesh</a>) || 
<a name="l06490"></a>06490       !center || radius &lt; 0. || !numVertex_p || !vertexIDs_p) {
<a name="l06491"></a>06491     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>));
<a name="l06492"></a>06492     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>;
<a name="l06493"></a>06493   }
<a name="l06494"></a>06494 
<a name="l06495"></a>06495   <span class="comment">// log message</span>
<a name="l06496"></a>06496   <a class="code" href="group__Library.html#g7e9664a8765cc08c313df880421c496b" title="Print a log message to stdout.">fc_printfLogMessage</a>(<span class="stringliteral">"Finding vertices within a sphere"</span>);  
<a name="l06497"></a>06497   
<a name="l06498"></a>06498   <span class="comment">// algorithm - Most efficient algorithm would only need to search bins</span>
<a name="l06499"></a>06499   <span class="comment">// that intersect boundary of the sphere - do not take  vertices from bins</span>
<a name="l06500"></a>06500   <span class="comment">// completely outside of sphere and take all vertices from bins completely</span>
<a name="l06501"></a>06501   <span class="comment">// inside of sphere. But determining intersection of sphere with the bins</span>
<a name="l06502"></a>06502   <span class="comment">// is difficult. So instead, here we search all bins that intersect or</span>
<a name="l06503"></a>06503   <span class="comment">// are within the bounding box of the sphere. </span>
<a name="l06504"></a>06504 
<a name="l06505"></a>06505   <span class="comment">// determine i,j,k bounding box for bins = intersection with sphere's bounding box</span>
<a name="l06506"></a>06506   <span class="keywordflow">for</span> (i = 0; i &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>; i++) {
<a name="l06507"></a>06507     lower = center[i] - radius;
<a name="l06508"></a>06508     upper = center[i] + radius;
<a name="l06509"></a>06509     <span class="comment">// special case - no intersection</span>
<a name="l06510"></a>06510     <span class="keywordflow">if</span> (lower &gt; bin-&gt;<a class="code" href="structFC__VertexBin.html#f1793ac2823dd0e600860ea10a043eb8">upperCoords</a>[i] || upper &lt; bin-&gt;lowerCoords[i]) {
<a name="l06511"></a>06511       intersects = 0; <span class="comment">// false</span>
<a name="l06512"></a>06512       <span class="keywordflow">break</span>;
<a name="l06513"></a>06513     }
<a name="l06514"></a>06514     <span class="keywordflow">else</span> {
<a name="l06515"></a>06515       lowerICoords[i] = (int) ((lower - bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[i])/bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[i]);
<a name="l06516"></a>06516       upperICoords[i] = (int) ((upper - bin-&gt;<a class="code" href="structFC__VertexBin.html#25f807510dcd5d24d50c231d4f942dbb">lowerCoords</a>[i])/bin-&gt;<a class="code" href="structFC__VertexBin.html#54aeaa64f0036f16fd7626ec621478ef">binWidths</a>[i]);
<a name="l06517"></a>06517       <span class="keywordflow">if</span> (lowerICoords[i] &lt; 0)
<a name="l06518"></a>06518         lowerICoords[i] = 0;
<a name="l06519"></a>06519       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lowerICoords[i] &gt;= bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i])
<a name="l06520"></a>06520         lowerICoords[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] - 1;
<a name="l06521"></a>06521       <span class="keywordflow">if</span> (upperICoords[i] &lt; 0)
<a name="l06522"></a>06522         upperICoords[i] = 0;
<a name="l06523"></a>06523       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (upperICoords[i] &gt;= bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i])
<a name="l06524"></a>06524         upperICoords[i] = bin-&gt;<a class="code" href="structFC__VertexBin.html#efbf1b841598c83b2d054a22b5e5adc2">numBins</a>[i] - 1;
<a name="l06525"></a>06525     }
<a name="l06526"></a>06526   }
<a name="l06527"></a>06527 
<a name="l06528"></a>06528   <span class="comment">// early return</span>
<a name="l06529"></a>06529   <span class="keywordflow">if</span> (intersects == 0) {
<a name="l06530"></a>06530     *numVertex_p = 0;
<a name="l06531"></a>06531     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>; 
<a name="l06532"></a>06532   }
<a name="l06533"></a>06533 
<a name="l06534"></a>06534   <span class="comment">// Setup</span>
<a name="l06535"></a>06535   <span class="keywordflow">if</span> (<a class="code" href="group__Variable.html#g31f5830cdcafcce9ffec2c8bb2ff46e2" title="Check that the handle refers to a valid variable.">fc_isVariableValid</a>(bin-&gt;<a class="code" href="structFC__VertexBin.html#41ced94f898bd264641a5f220bf24ac6">displ</a>)) {
<a name="l06536"></a>06536     do_displ = 1;
<a name="l06537"></a>06537     rc = <a class="code" href="group__GeometricRelations.html#g49b9b92b6a40c6646c0640b38a1f0eee" title="Create displaced vertex coordinates.">fc_getDisplacedMeshCoords</a>(mesh, bin-&gt;<a class="code" href="structFC__VertexBin.html#41ced94f898bd264641a5f220bf24ac6">displ</a>, &amp;coords);
<a name="l06538"></a>06538   }
<a name="l06539"></a>06539   <span class="keywordflow">else</span> {
<a name="l06540"></a>06540     do_displ = 0;
<a name="l06541"></a>06541     rc = <a class="code" href="group__Mesh.html#gff8561557c19ae03be9ff18cc73a6823" title="Return the vertex coordinates of the mesh.">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l06542"></a>06542   }
<a name="l06543"></a>06543   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>)
<a name="l06544"></a>06544     <span class="keywordflow">return</span> rc;
<a name="l06545"></a>06545   numVert = 0;
<a name="l06546"></a>06546   maxNumVert = 0;
<a name="l06547"></a>06547   vertIDs = NULL;
<a name="l06548"></a>06548 
<a name="l06549"></a>06549   <span class="comment">// just check vertices in bins in i,j,k bounding box</span>
<a name="l06550"></a>06550   r2 = radius * radius; 
<a name="l06551"></a>06551   <span class="keywordflow">for</span> (i = lowerICoords[0]; i &lt;= upperICoords[0]; i++) {
<a name="l06552"></a>06552     <span class="keywordflow">for</span> (j = lowerICoords[1]; j &lt;= upperICoords[1]; j++) {
<a name="l06553"></a>06553       <span class="keywordflow">for</span> (k = lowerICoords[2]; k &lt;= upperICoords[2]; k++) {
<a name="l06554"></a>06554         <span class="keywordflow">for</span> (m = 0; m &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#a54dee0baf9b3a319ae4b78506fdced3">numVertex</a>[i][j][k]; m++) {
<a name="l06555"></a>06555           t2 = 0;
<a name="l06556"></a>06556           <span class="keywordflow">for</span> (n = 0; n &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>; n++) {
<a name="l06557"></a>06557             d = center[n] - coords[bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i][j][k][m]*bin-&gt;<a class="code" href="structFC__VertexBin.html#2a8c28019d0e003f20d25831292f63f5">numDim</a>+n];
<a name="l06558"></a>06558             t2 += d * d;
<a name="l06559"></a>06559           }
<a name="l06560"></a>06560           <span class="keywordflow">if</span> (t2 &lt;= r2) {
<a name="l06561"></a>06561          <span class="keywordflow">if</span> (numVert == maxNumVert) {
<a name="l06562"></a>06562            <span class="keywordflow">if</span> (maxNumVert == 0)
<a name="l06563"></a>06563           maxNumVert = 2;
<a name="l06564"></a>06564            <span class="keywordflow">else</span>
<a name="l06565"></a>06565           maxNumVert *= 2;
<a name="l06566"></a>06566            temp = realloc(vertIDs, maxNumVert*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l06567"></a>06567            <span class="keywordflow">if</span> (!temp) {
<a name="l06568"></a>06568           free(vertIDs);
<a name="l06569"></a>06569           <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l06570"></a>06570           <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l06571"></a>06571            }
<a name="l06572"></a>06572            vertIDs = temp;
<a name="l06573"></a>06573          }
<a name="l06574"></a>06574             vertIDs[numVert] = bin-&gt;<a class="code" href="structFC__VertexBin.html#d7d435969c360e7e4f19ffc0558209c9">vertexIDs</a>[i][j][k][m];
<a name="l06575"></a>06575             numVert++;
<a name="l06576"></a>06576           }
<a name="l06577"></a>06577         }
<a name="l06578"></a>06578       }
<a name="l06579"></a>06579     }
<a name="l06580"></a>06580   }
<a name="l06581"></a>06581   <span class="keywordflow">if</span> (do_displ)
<a name="l06582"></a>06582     free(coords);
<a name="l06583"></a>06583 
<a name="l06584"></a>06584   <span class="comment">// organize results</span>
<a name="l06585"></a>06585   <span class="keywordflow">if</span> (numVert &gt; 0)
<a name="l06586"></a>06586     <a class="code" href="group__MiscUtilities.html#gab968abc681049a5e7c96f2552bbbbdc" title="Sort an int array.">fc_sortIntArray</a>(numVert, vertIDs);
<a name="l06587"></a>06587   *numVertex_p = numVert;
<a name="l06588"></a>06588   *vertexIDs_p = vertIDs;
<a name="l06589"></a>06589 
<a name="l06590"></a>06590   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l06591"></a>06591 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:21 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
