<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>FCLib: Geometric Relations</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>Geometric Relations<br>
<small>
[<a class="el" href="group__API.html">FCLib API</a>]</small>
</h1>
<p>
Collaboration diagram for Geometric Relations:<hr><a name="_details"></a><h2>Detailed Description</h2>
Relationships and values which depend on the coordinates in space. 
<p>
<b>Description:</b> <p>
The geometric functions compute relationships and values which depend on the coordinates of mesh vertices. For example, computing the distances between vertices, the element and vertex normals of surfaces, etc. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PrivateGeometricRelations.html">(Private)</a></td></tr>

<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Spatially binned vertex IDs.  <a href="structFC__VertexBin.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>General geometry</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gb2950eac8ed0ef2ea89db89bcac653c8">fc_calcEuclideanDistance</a> (<a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> v1Coords, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> v2Coords, int dim, double *distance)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the distance between two vertices.  <a href="#gb2950eac8ed0ef2ea89db89bcac653c8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g69030cccac839d01b0a3fbc573a20254">fc_calcSquaredEuclideanDistance</a> (<a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> v1Coords, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> v2Coords, int dim, double *distance2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the squared distance between two vertices.  <a href="#g69030cccac839d01b0a3fbc573a20254"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g4972191f68d5f52d1c0acbb0254c6eb6">fc_calcAngleBetweenVectors</a> (<a class="el" href="group__SimpleDataObjects.html#g84c64ce1a8b6f4beca59ee9140f3f109">FC_Vector</a> vector1, <a class="el" href="group__SimpleDataObjects.html#g84c64ce1a8b6f4beca59ee9140f3f109">FC_Vector</a> vector2, double *diff_angle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine angle between two vectors.  <a href="#g4972191f68d5f52d1c0acbb0254c6eb6"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Displaced coordinates</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> variable)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test to see if variable can be used as displacment variable.  <a href="#gcffba2f092986b21bf1fc2e2e50c8d6e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ, double **displaced_coords)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create displaced vertex coordinates.  <a href="#g78716e2414d2a11d92097b70f5d8431c"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Bounding boxes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gecdc6fb052fa5d9dc695fcd6be58c808">fc_isBoundingBoxValid</a> (int numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if a bounding box is valid.  <a href="#gecdc6fb052fa5d9dc695fcd6be58c808"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g5fff397d0b7779f3d2133bd0147c72e9">fc_getBoundingBoxesOverlap</a> (int numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowpoint1, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> highpoint1, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowpoint2, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> highpoint2, int *overlap_flag, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *overlap_lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *overlap_highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if two bounding boxes overlap in space.  <a href="#g5fff397d0b7779f3d2133bd0147c72e9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gf5cb2b10ac399d18fa138f8206083190">fc_combineBoundingBoxes</a> (int numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowpoint1, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> highpoint1, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowpoint2, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> highpoint2, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *combine_lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *combine_highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine the bounding box of two bounding boxes.  <a href="#gf5cb2b10ac399d18fa138f8206083190"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g2b4340615ac4674f35b401a11ea4cdbe">fc_getMeshBoundingBox</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int *numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute mesh bounding box.  <a href="#g2b4340615ac4674f35b401a11ea4cdbe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#ge4b483059d881b6adbdf4d5d24399d4a">fc_getDisplacedMeshBoundingBox</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, int *numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute displaced mesh bounding box.  <a href="#ge4b483059d881b6adbdf4d5d24399d4a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gea0c3be70612767ac91c6c9b6d9b8be2">fc_getSubsetBoundingBox</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, int *numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute bounding box of subset.  <a href="#gea0c3be70612767ac91c6c9b6d9b8be2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gcd393977ed8c8b505edb6402ab20afa7">fc_getDisplacedSubsetBoundingBox</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, int *numDim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *highpoint)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute bounding box of subset of a displaced mesh.  <a href="#gcd393977ed8c8b505edb6402ab20afa7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g1cc5bff2291dd32af7c24bc43d83cbbe">fc_createBoundingBoxMesh</a> (<a class="el" href="structFC__Dataset.html">FC_Dataset</a> dest_ds, char *bb_name, int dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowerCoords, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> upperCoords, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *bb_mesh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a mesh that represents a bounding box.  <a href="#g1cc5bff2291dd32af7c24bc43d83cbbe"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Projected bounding boxes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g94257f304b660eff0908ee4f1b721713">fc_projectedElementBoundingBoxIntersection</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int elemID_1, int elemID_2, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> proj_normal, int *intersectval)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns indication if the bounding boxes of 2 elements, when projected onto the same planar surface (given a projection direction) haven any intersection.  <a href="#g94257f304b660eff0908ee4f1b721713"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g95b267fcaa314e0fcddd0c72b53ccbeb">fc_projectedSubsetElementBoundingBoxIntersection</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> compelemIDs, <a class="el" href="structFC__Subset.html">FC_Subset</a> refelemIDs, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> proj_normal, <a class="el" href="structFC__Subset.html">FC_Subset</a> *intersectingrefIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a subset of elements ids and a reference subset of element ids, projects those elements onto the same plane and calculates which elements of the reference subset have bounding boxes in the projected plane that are intersected by the bounding boxes of the comparison elements in the projected plane.  <a href="#g95b267fcaa314e0fcddd0c72b53ccbeb"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Diameter (max distance between any points in a point set)</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g4d0810ecf214489a94f56073aa141164">fc_getMeshDiameter</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, double *diameter, int *numPair, int **pairIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a mesh.  <a href="#g4d0810ecf214489a94f56073aa141164"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gbdf584cf3ab769dfc6f68ea84a2aa259">fc_getDisplacedMeshDiameter</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, double *diameter, int *numPair, int **pairIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a displaced mesh.  <a href="#gbdf584cf3ab769dfc6f68ea84a2aa259"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g065a93ebc03ea18a0c7c25ad237f78da">fc_getSubsetDiameter</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, double *diameter, int *numPair, int **pairIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a subset.  <a href="#g065a93ebc03ea18a0c7c25ad237f78da"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g582f174f144644a7c2e2ff22e53b8349">fc_getDisplacedSubsetDiameter</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, double *diameter, int *numPair, int **pairIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a displaced subset.  <a href="#g582f174f144644a7c2e2ff22e53b8349"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#ga827e7709fded608a7de79dde212552d">fc_getMeshesDiameter</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> **pairMeshes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a group of meshes.  <a href="#ga827e7709fded608a7de79dde212552d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g3bab08f74e326575f1454f564401df60">fc_getDisplacedMeshesDiameter</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displs, double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> **pairMeshes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a group of displaced meshes.  <a href="#g3bab08f74e326575f1454f564401df60"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gc6a90cc1b35e9acb6c94c2857b11e730">fc_getSubsetsDiameter</a> (int numSubset, <a class="el" href="structFC__Subset.html">FC_Subset</a> *subsets, double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Subset.html">FC_Subset</a> **pairSubsets)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a group of subsets.  <a href="#gc6a90cc1b35e9acb6c94c2857b11e730"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g7da48dd54f4ae3e1a20ec50854d87c41">fc_getDisplacedSubsetsDiameter</a> (int numSubset, <a class="el" href="structFC__Subset.html">FC_Subset</a> *subsets, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displs, double *diameter, int *numPair, int **pairIDs, <a class="el" href="structFC__Subset.html">FC_Subset</a> **pairSubsets)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the diameter of a group of displaced subsets.  <a href="#g7da48dd54f4ae3e1a20ec50854d87c41"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Centroid</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g25e99a690489a8e823cae6b9afc1ee65">fc_getMeshCentroid</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute centroid of mesh.  <a href="#g25e99a690489a8e823cae6b9afc1ee65"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g020ce5685953cc5e0c9920a2705db4b8">fc_getDisplacedMeshCentroid</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute centroid of displaced mesh.  <a href="#g020ce5685953cc5e0c9920a2705db4b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g0085e109c1963d937aeffa915fa81ceb">fc_getVariableWeightedMeshCentroid</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> weightsVar, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute variable weighted centroid of a mesh.  <a href="#g0085e109c1963d937aeffa915fa81ceb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#ga33e8f8750201b783262d71628c1d455">fc_getVariableWeightedDisplacedMeshCentroid</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> weightsVar, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute variable weighted centroid of a displaced mesh.  <a href="#ga33e8f8750201b783262d71628c1d455"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gbbaa194dd7ef7e6ef0d1d47831ba73f1">fc_getSubsetCentroid</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute centroid of a subset.  <a href="#gbbaa194dd7ef7e6ef0d1d47831ba73f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g757d8d181b71dd7b850364012ec4a332">fc_getDisplacedSubsetCentroid</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute centroid of a displaced subset.  <a href="#g757d8d181b71dd7b850364012ec4a332"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#ge82d1284fda2ed5b7fe3d041ba86742b">fc_getVariableWeightedSubsetCentroid</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="structFC__Variable.html">FC_Variable</a> weightsVar, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute centroid of a subset.  <a href="#ge82d1284fda2ed5b7fe3d041ba86742b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g212cbb848ec9d75fa5fa6f2a59f0d6d7">fc_getVariableWeightedDisplacedSubsetCentroid</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> weightsVar, int *dim, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute centroid of a displaced subset.  <a href="#g212cbb848ec9d75fa5fa6f2a59f0d6d7"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Mesh entities' measurements</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g942ca3d5601ded5ad4f6cde5ff3ec767">fc_getEdgeLengths</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> *edge_lengths)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the edge lengths of the mesh.  <a href="#g942ca3d5601ded5ad4f6cde5ff3ec767"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g723de1cc925a8cc252e36dd7cea01fd6">fc_getDisplacedEdgeLengths</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> *edge_lengths)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the edge lengths of the displaced mesh.  <a href="#g723de1cc925a8cc252e36dd7cea01fd6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gf2bc95dcfbc5842503038dfc47e43efa">fc_getFaceAreas</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> *face_areas)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the face areas of the mesh.  <a href="#gf2bc95dcfbc5842503038dfc47e43efa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g98f8038ecb056169cbe084080b997d9f">fc_getDisplacedFaceAreas</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> *face_areas)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the face areas of the displaced mesh.  <a href="#g98f8038ecb056169cbe084080b997d9f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gf7687aa264403fd9234d8b1ff133a6b7">fc_getRegionVolumes</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> *region_volumes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the region volumes of the mesh.  <a href="#gf7687aa264403fd9234d8b1ff133a6b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g05ba60b4aa725ef7d7938e64925ba75b">fc_getDisplacedRegionVolumes</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> *region_volumes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the region volumes of the displaced mesh.  <a href="#g05ba60b4aa725ef7d7938e64925ba75b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g417caea8baaef8a0a90964ea0af9fa40">fc_getMeshVolume</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a variable with the volume of the mesh.  <a href="#g417caea8baaef8a0a90964ea0af9fa40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gff3eb4d9d53d3b0c73b850ee4df4e057">fc_getDisplacedMeshVolume</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute displaced mesh volume.  <a href="#gff3eb4d9d53d3b0c73b850ee4df4e057"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gad13734d528eba302b4bd4f3ce3216f6">fc_getSubsetVolume</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subs, int doStrict, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a variable with the volume of the subset.  <a href="#gad13734d528eba302b4bd4f3ce3216f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g9ecba1f193ba8c621994332a5a0e4c29">fc_getDisplacedSubsetVolume</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subs, int doStrict, <a class="el" href="structFC__Variable.html">FC_Variable</a> coord_displ, double *volume)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a variable with the volume of the subset on the displaced mesh.  <a href="#g9ecba1f193ba8c621994332a5a0e4c29"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gcf76b8606254cc1a1c610ccd31760cdf">fc_getSubsetArea</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset, double *area)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a variable with the area of the subset.  <a href="#gcf76b8606254cc1a1c610ccd31760cdf"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Normals</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gceec77d10551423fb5b7511cbf18e235">fc_getSurfaceNormals</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute surface normals on all elements in a mesh.  <a href="#gceec77d10551423fb5b7511cbf18e235"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g907e473afb0077c1d57ce68fc7f7f010">fc_getDisplacedSurfaceNormals</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> *new_var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute surface normals on all elements in a mesh.  <a href="#g907e473afb0077c1d57ce68fc7f7f010"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Deformation</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#ge355b22e62bfc67b4249a29a121f5d1e">fc_calcMeshDeformationUsingRefVertex</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int vertexID, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> **deform)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculation the deformation of a mesh.  <a href="#ge355b22e62bfc67b4249a29a121f5d1e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g04f6cd1bed86b5ac1092571e0f1488a8">fc_calcMeshDeformationUsingCentroid</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displ, <a class="el" href="structFC__Variable.html">FC_Variable</a> **deform)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculation the deformation of a mesh.  <a href="#g04f6cd1bed86b5ac1092571e0f1488a8"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Proximity</h2></td></tr>
<tr><td colspan="2">Use these routines to test if meshes and subsets are close to each other. The actual test is to find pairs of vertices (one from each mesh/subset) that are less than or equal to a specified distance cutoff. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gd1dec7883e2d655b16909d6527052850">fc_getMeshesProximity</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh1, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the proximal vertices between two meshes.  <a href="#gd1dec7883e2d655b16909d6527052850"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g3a6d67e6a4a8d3791f6b9d640c6ecc89">fc_getDisplacedMeshesProximity</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh1, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ1, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh2, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the proximal vertices between two displaced meshes.  <a href="#g3a6d67e6a4a8d3791f6b9d640c6ecc89"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g29e5532aa97ec9d43456579e8e1b26ea">fc_getSubsetsProximity</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset1, <a class="el" href="structFC__Subset.html">FC_Subset</a> subset2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the proximal vertices between two subsets.  <a href="#g29e5532aa97ec9d43456579e8e1b26ea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#ga4fb02306f46b1fbb7034d67d605aabe">fc_getDisplacedSubsetsProximity</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> subset1, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ1, <a class="el" href="structFC__Subset.html">FC_Subset</a> subset2, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the proximal vertices between two displaced subsets.  <a href="#ga4fb02306f46b1fbb7034d67d605aabe"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Range queries and variable smoothing</h2></td></tr>
<tr><td colspan="2">There are no subset versions of these routines since the searching data structure is per mesh. To find the entities of a subset within a range: do the range search on the mesh, then use <a class="el" href="group__Subset.html#gdc68d18522eac86b0c3eeb655e91f80b">fc_createSubsetIntersection()</a> to "AND" that with the original subset. The result are the members of the subset that fall within the range. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g9aab2b1ce3bf7747aa6adcf63fb590c4">fc_createMeshVertexBin</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **bin_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create spatial bins for vertices for geometric queries.  <a href="#g9aab2b1ce3bf7747aa6adcf63fb590c4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g13a84b3949ab3282b49164477058ed08">fc_createDisplacedMeshVertexBin</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__Variable.html">FC_Variable</a> displ, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **bin_p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create spatial bins for vertices for geometric queries.  <a href="#g13a84b3949ab3282b49164477058ed08"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g97239416a845a919c1b1feec0829b87b">fc_freeVertexBin</a> (<a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *bin)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clear memory in an <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a>.  <a href="#g97239416a845a919c1b1feec0829b87b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g9f337bd2e04f0188991e127207a9abc3">fc_getEntitiesWithinBoundingBox</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *bin, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowpoint, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> highpoint, <a class="el" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc, int *numEntity, int **entityIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find all entities within a bounding box.  <a href="#g9f337bd2e04f0188991e127207a9abc3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g77c54eb65c09c6f4d062ed151cd68208">fc_getEntitiesWithinSphere</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *bin, <a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> center, double radius, <a class="el" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc, int *numEntity, int **entityIDs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find all entities within a sphere.  <a href="#g77c54eb65c09c6f4d062ed151cd68208"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g67640d07d8800682e439c9c1fac80ac1">fc_geomSmoothVariable</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **bins, <a class="el" href="structFC__Variable.html">FC_Variable</a> *vars, double radius, int doLocalSmooth, <a class="el" href="structFC__Variable.html">FC_Variable</a> **smooth_vars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Smooth a variable field.  <a href="#g67640d07d8800682e439c9c1fac80ac1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g0eea52651232dc59994a09f1e09ab703">fc_displacedGeomSmoothVariable</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, <a class="el" href="structFC__Variable.html">FC_Variable</a> *displs, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **displBins, <a class="el" href="structFC__Variable.html">FC_Variable</a> *vars, double radius, int doLocalSmooth, <a class="el" href="structFC__Variable.html">FC_Variable</a> **smooth_vars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Smooth a variable field on a displaced mesh.  <a href="#g0eea52651232dc59994a09f1e09ab703"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#gdec6e11c949a404fee73eba96891be0d">fc_geomSmoothSeqVariable</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **bins, int numStep, <a class="el" href="structFC__Variable.html">FC_Variable</a> **seqVars, double radius, int doLocalSmooth, <a class="el" href="structFC__Variable.html">FC_Variable</a> ***smooth_seq_vars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Smooth a sequence variable field.  <a href="#gdec6e11c949a404fee73eba96891be0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricRelations.html#g7964e351cf79f69108b69771c24edea0">fc_displacedGeomSmoothSeqVariable</a> (int numMesh, <a class="el" href="structFC__Mesh.html">FC_Mesh</a> *meshes, int numStep1, <a class="el" href="structFC__Variable.html">FC_Variable</a> **seqDispls, <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> ***displBins, int numStep2, <a class="el" href="structFC__Variable.html">FC_Variable</a> **seqVars, double radius, int doLocalSmooth, <a class="el" href="structFC__Variable.html">FC_Variable</a> ***smooth_seq_vars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Smooth each step of a sequence variable on a displaced mesh.  <a href="#g7964e351cf79f69108b69771c24edea0"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g4972191f68d5f52d1c0acbb0254c6eb6"></a><!-- doxytag: member="geom.c::fc_calcAngleBetweenVectors" ref="g4972191f68d5f52d1c0acbb0254c6eb6" args="(FC_Vector vector1, FC_Vector vector2, double *diff_angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_calcAngleBetweenVectors           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g84c64ce1a8b6f4beca59ee9140f3f109">FC_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>vector1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g84c64ce1a8b6f4beca59ee9140f3f109">FC_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>vector2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diff_angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determine angle between two vectors. 
<p>
<b>Description:</b> <p>
Determine angle between two vectors. Because of the return val of acos, vals for the angle are limited to 0-&gt;180 degrees.<p>
<b>Modifications:</b> <ul>
<li>01/16/06 ACG revised from old surface_grow when switched from old recursive algorithm to new WSK method for getSurfaceSides.</li><li>01/16/06 ACG moved here from shape.</li><li>06/01/06 ACG changing comparison from DBL_EQUIV to VALUE_EQUIV with a greater epsilon becuase some cases that should have been rounded off were not. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vector1</em>&nbsp;</td><td>
input - 1st normal </td></tr>
<tr><td valign="top"><em>vector2</em>&nbsp;</td><td>
input - 2nd normal </td></tr>
<tr><td valign="top"><em>diff_angle</em>&nbsp;</td><td>
output - angle for normal comparison </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00215">215</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="util_8h-source.html#l00174">FC_PI</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="util_8h-source.html#l00085">FC_VALUE_EQUIV</a>.
<p>
Referenced by <a class="el" href="shape_8c-source.html#l00893">_fc_createShapePartsFromFaceInfoList()</a>, <a class="el" href="shape_8c-source.html#l03005">fc_createLargeAndOpposingSidesOrder()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00219"></a>00219   {
<a name="l00220"></a>00220 
<a name="l00221"></a>00221   <span class="keywordtype">double</span> tempA, tempB, magA, magB, dotprod, diffrad;
<a name="l00222"></a>00222   <span class="keywordtype">int</span> j;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <span class="comment">//default return values</span>
<a name="l00226"></a>00226   <span class="keywordflow">if</span> (diff_angle)
<a name="l00227"></a>00227     *diff_angle = -1;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229   <span class="keywordflow">if</span>(vector1 == NULL || vector2 == NULL || !diff_angle){
<a name="l00230"></a>00230     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00231"></a>00231     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00232"></a>00232   }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting angle between two vectors"</span>);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   tempA = 0;
<a name="l00237"></a>00237   tempB = 0;
<a name="l00238"></a>00238   dotprod = 0;
<a name="l00239"></a>00239   <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++){
<a name="l00240"></a>00240     tempA+=vector1[j]*vector1[j];
<a name="l00241"></a>00241     tempB+=vector2[j]*vector2[j];
<a name="l00242"></a>00242     dotprod+=vector1[j]*vector2[j];
<a name="l00243"></a>00243   }
<a name="l00244"></a>00244   magA = sqrt(tempA);
<a name="l00245"></a>00245   magB = sqrt(tempB);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247   <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>(magA,0.0) || <a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>(magB,0.0) ||
<a name="l00248"></a>00248       <a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>((magA*magB),0.0)){
<a name="l00249"></a>00249     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Zero magitude input vector"</span>);
<a name="l00250"></a>00250     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00251"></a>00251   }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   dotprod/=(magA*magB);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g24024939f4d5dcab7a65652aa4e71cce">FC_VALUE_EQUIV</a>(dotprod,-1,(1000*DBL_EPSILON),DBL_MIN)){ <span class="comment">//round</span>
<a name="l00256"></a>00256     dotprod = -1;
<a name="l00257"></a>00257   }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g24024939f4d5dcab7a65652aa4e71cce">FC_VALUE_EQUIV</a>(dotprod,1,(1000*DBL_EPSILON),DBL_MIN)){ <span class="comment">//round</span>
<a name="l00258"></a>00258     dotprod = 1;
<a name="l00259"></a>00259   }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <span class="keywordflow">if</span> (dotprod &lt; -1 || dotprod &gt; 1){
<a name="l00262"></a>00262     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid val for dot prod arg to acos: %20g\n"</span>,dotprod);
<a name="l00263"></a>00263     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"magA = %10g magB = %10g vector1 = (%10g,%10g,%10g) vector2 = (%10g,%10g,%10g) dotprod = %10g\n"</span>,magA, magB,vector1[0],vector1[1],vector1[2],vector2[0],vector2[1],vector2[2],dotprod);
<a name="l00264"></a>00264     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l00265"></a>00265   }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   diffrad = acos(dotprod); <span class="comment">//will go between 0 and pi rad</span>
<a name="l00268"></a>00268   *diff_angle = diffrad*180./<a class="code" href="group__MiscUtilities.html#g0143d40c3cb2fd8d5ed18838b108c1b0">FC_PI</a>;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>; 
<a name="l00271"></a>00271 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gb2950eac8ed0ef2ea89db89bcac653c8"></a><!-- doxytag: member="geom.c::fc_calcEuclideanDistance" ref="gb2950eac8ed0ef2ea89db89bcac653c8" args="(FC_Coords v1Coords, FC_Coords v2Coords, int dim, double *distance)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_calcEuclideanDistance           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>v1Coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>v2Coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>distance</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the distance between two vertices. 
<p>
<b>Description:</b> <p>
Computes the euclidean distance between the two sets of vertex coordinates<p>
It's cheaper to compute the squared euclidean distance than the euclidean distance. If you want to compare distances, it's faster to compute and compare the squared euclidean distance (see <a class="el" href="group__GeometricRelations.html#g69030cccac839d01b0a3fbc573a20254">fc_calcSquaredEuclideanDistance()</a>).<p>
<b>Modifications:</b> <ul>
<li>07-AUG-2002 Natalie Rooney Created.</li><li>28-AUG-2002 Natalie Rooney Changing inputs to be Vectors instead of float arrays.</li><li>2003-AUG-05 W Koegler Moved from displacement.c to here, made internal calculations use doubles, minor name change.</li><li>6/14/2006 WSD Guts moved to <a class="el" href="group__GeometricRelations.html#g69030cccac839d01b0a3fbc573a20254">fc_calcSquaredEuclideanDistance()</a>. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>v1Coords</em>&nbsp;</td><td>
input - coordinates of one vertex </td></tr>
<tr><td valign="top"><em>v2Coords</em>&nbsp;</td><td>
input - coordinates of the other vertex </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
input - number of dimensions in the coords </td></tr>
<tr><td valign="top"><em>distance</em>&nbsp;</td><td>
output - distance between the two vertices </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00116">116</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l00163">fc_calcSquaredEuclideanDistance()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l03503">fc_getDisplacedEdgeLengths()</a>, and <a class="el" href="geom_8c-source.html#l03415">fc_getEdgeLengths()</a>.<div class="fragment"><pre class="fragment"><a name="l00121"></a>00121   {
<a name="l00122"></a>00122   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00123"></a>00123   <span class="keywordtype">double</span> dist2;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="comment">// default output</span>
<a name="l00126"></a>00126   <span class="keywordflow">if</span> (distance)
<a name="l00127"></a>00127     *distance = -1;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129   <span class="comment">// check input</span>
<a name="l00130"></a>00130   <span class="keywordflow">if</span> (distance == NULL) {
<a name="l00131"></a>00131     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00132"></a>00132     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00133"></a>00133   }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   <span class="comment">// log message</span>
<a name="l00136"></a>00136   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Calculating euclidean distance."</span>);
<a name="l00137"></a>00137   
<a name="l00138"></a>00138   <span class="comment">// do it</span>
<a name="l00139"></a>00139   rc = <a class="code" href="group__GeometricRelations.html#g69030cccac839d01b0a3fbc573a20254">fc_calcSquaredEuclideanDistance</a>(v1Coords, v2Coords, dim, &amp;dist2);
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00141"></a>00141     <span class="keywordflow">return</span> rc;
<a name="l00142"></a>00142   *distance = sqrt(dist2);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00145"></a>00145 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g04f6cd1bed86b5ac1092571e0f1488a8"></a><!-- doxytag: member="geom.c::fc_calcMeshDeformationUsingCentroid" ref="g04f6cd1bed86b5ac1092571e0f1488a8" args="(FC_Mesh mesh, int numStep, FC_Variable *displ, FC_Variable **deform)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_calcMeshDeformationUsingCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>deform</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculation the deformation of a mesh. 
<p>
<b>Description:</b> <p>
The displacement variable that is used to define changing mesh geometry is a combination of mesh translation, rotation, and deformation. This routine attempts to extract the deformation component. It assumes that deformation is zero in the first step.<p>
This routines assumes that there is no rotation, and then uses the centroid of the mesh to calculate the translation component. The deformation component is then the displacement minus the translation. This routine will not perform well if deformation noticeably affects the centroid of the mesh.<p>
<b>Modifications:</b> <ul>
<li>04/19/05 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - number of steps in displacement variable </td></tr>
<tr><td valign="top"><em>displ</em>&nbsp;</td><td>
input - the displacement variable </td></tr>
<tr><td valign="top"><em>deform</em>&nbsp;</td><td>
output - the deformation variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04764">4764</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="variable_8c-source.html#l00348">fc_createSeqVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="geom_8c-source.html#l02656">fc_getDisplacedMeshCentroid()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l04649">fc_getVariableDataAsDataType()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="util_8h-source.html#l00085">FC_VALUE_EQUIV</a>.<div class="fragment"><pre class="fragment"><a name="l04769"></a>04769   {
<a name="l04770"></a>04770   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04771"></a>04771   <span class="keywordtype">int</span> i, j, k;
<a name="l04772"></a>04772   <span class="keywordtype">int</span> numDim, numVertex, temp_numStep;
<a name="l04773"></a>04773   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> sequence;
<a name="l04774"></a>04774   <span class="keywordtype">double</span>* displ_data, *deform_data;
<a name="l04775"></a>04775   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> orig, current;
<a name="l04776"></a>04776   
<a name="l04777"></a>04777   <span class="comment">// default output</span>
<a name="l04778"></a>04778   <span class="keywordflow">if</span> (deform)
<a name="l04779"></a>04779     *deform = NULL;
<a name="l04780"></a>04780 
<a name="l04781"></a>04781   <span class="comment">// check input</span>
<a name="l04782"></a>04782   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, displ) ||
<a name="l04783"></a>04783       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, displ[0])) {
<a name="l04784"></a>04784     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04785"></a>04785     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04786"></a>04786   }
<a name="l04787"></a>04787 
<a name="l04788"></a>04788   <span class="comment">// setup</span>
<a name="l04789"></a>04789   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(displ[0], &amp;numVertex, &amp;numDim, NULL, NULL, NULL);
<a name="l04790"></a>04790   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04791"></a>04791     <span class="keywordflow">return</span> rc;
<a name="l04792"></a>04792   
<a name="l04793"></a>04793   <span class="comment">// create the deformation variable</span>
<a name="l04794"></a>04794   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, displ, &amp;sequence);
<a name="l04795"></a>04795   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04796"></a>04796     <span class="keywordflow">return</span> rc;
<a name="l04797"></a>04797   rc = <a class="code" href="group__Variable.html#gada4bacc9679592ff8b27c538570c1da">fc_createSeqVariable</a>(mesh, sequence, <span class="stringliteral">"deformation"</span>, &amp;temp_numStep,
<a name="l04798"></a>04798                    deform);
<a name="l04799"></a>04799   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04800"></a>04800     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Could not create sequence variable"</span>);
<a name="l04801"></a>04801     <span class="keywordflow">return</span> rc;
<a name="l04802"></a>04802   }
<a name="l04803"></a>04803 
<a name="l04804"></a>04804   <span class="comment">// Set the data</span>
<a name="l04805"></a>04805   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l04806"></a>04806     <span class="comment">// get the displacement of the centroid</span>
<a name="l04807"></a>04807     rc = <a class="code" href="group__GeometricRelations.html#g020ce5685953cc5e0c9920a2705db4b8">fc_getDisplacedMeshCentroid</a>(mesh, displ[i], &amp;numDim, &amp;current);
<a name="l04808"></a>04808     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04809"></a>04809       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Could not get centroid"</span>);
<a name="l04810"></a>04810       <span class="keywordflow">return</span> rc;
<a name="l04811"></a>04811     }
<a name="l04812"></a>04812     <span class="keywordflow">if</span> (i == 0) {
<a name="l04813"></a>04813       <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++) 
<a name="l04814"></a>04814      orig[j] = current[j];
<a name="l04815"></a>04815     }
<a name="l04816"></a>04816 
<a name="l04817"></a>04817     <span class="comment">// create and set deform data</span>
<a name="l04818"></a>04818     rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(displ[i], <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>,
<a name="l04819"></a>04819                           (<span class="keywordtype">void</span>**)&amp;displ_data);
<a name="l04820"></a>04820     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04821"></a>04821       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Could not get displ data as double"</span>);
<a name="l04822"></a>04822       <span class="keywordflow">return</span> rc;
<a name="l04823"></a>04823     }
<a name="l04824"></a>04824     deform_data = (<span class="keywordtype">double</span>*)malloc(numDim*numVertex*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l04825"></a>04825     <span class="keywordflow">if</span> (!deform_data) {
<a name="l04826"></a>04826       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l04827"></a>04827       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l04828"></a>04828     }
<a name="l04829"></a>04829     <span class="comment">// IMPORTANT! To prevent bad roundoff errors, check that values are </span>
<a name="l04830"></a>04830     <span class="comment">// different before subtracting. If they are not different, answer is 0!</span>
<a name="l04831"></a>04831     <span class="comment">// (Using FC_VALUE_EQUIV instead of FC_DBL_EQUIV because of roundoff in </span>
<a name="l04832"></a>04832     <span class="comment">// centroid calculation, have to be more flexible)</span>
<a name="l04833"></a>04833     <span class="keywordflow">for</span> (j = 0; j &lt; numVertex; j++) {
<a name="l04834"></a>04834       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++) {
<a name="l04835"></a>04835      <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g24024939f4d5dcab7a65652aa4e71cce">FC_VALUE_EQUIV</a>(displ_data[j*numDim+k] + orig[k], current[k],
<a name="l04836"></a>04836                   100*DBL_EPSILON, DBL_MIN))
<a name="l04837"></a>04837        deform_data[j*numDim+k] = 0.;
<a name="l04838"></a>04838      <span class="keywordflow">else</span>
<a name="l04839"></a>04839        deform_data[j*numDim+k] = displ_data[j*numDim+k] + orig[k] - current[k];
<a name="l04840"></a>04840       }
<a name="l04841"></a>04841     }
<a name="l04842"></a>04842     rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>((*deform)[i], numVertex, numDim, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 
<a name="l04843"></a>04843                       <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, deform_data);
<a name="l04844"></a>04844     free(displ_data);
<a name="l04845"></a>04845   }
<a name="l04846"></a>04846 
<a name="l04847"></a>04847   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04848"></a>04848 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge355b22e62bfc67b4249a29a121f5d1e"></a><!-- doxytag: member="geom.c::fc_calcMeshDeformationUsingRefVertex" ref="ge355b22e62bfc67b4249a29a121f5d1e" args="(FC_Mesh mesh, int vertexID, int numStep, FC_Variable *displ, FC_Variable **deform)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_calcMeshDeformationUsingRefVertex           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>vertexID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>deform</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculation the deformation of a mesh. 
<p>
<b>Description:</b> <p>
The displacement variable that is used to define changing mesh geometry is a combination of mesh translation, rotation, and deformation. This routine attempts to extract the deformation component. It assumes that deformation is zero in the first step.<p>
This routines assumes that there is no rotation, and then uses the supplied reference vertex to calculate the translation component. The deformation component is then the displacement minus the translation. This routine will not perform well if the reference vertex is in a region that deforms.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000039">Todo:</a></b></dt><dd>Want to add two more routines: 1) takes 3 points &amp; so might handles rotation, 2) use optimization to find transformation matrix that minimizes deformation - most robust and automatic.</dd></dl>
<b>Modifications:</b> <ul>
<li>04/19/05 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>vertexID</em>&nbsp;</td><td>
input - vertex to use as translation reference </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - number of steps in displacement variable </td></tr>
<tr><td valign="top"><em>displ</em>&nbsp;</td><td>
input - the displacement variable </td></tr>
<tr><td valign="top"><em>deform</em>&nbsp;</td><td>
output - the deformation variable </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04650">4650</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="variable_8c-source.html#l00348">fc_createSeqVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="variable_8c-source.html#l04649">fc_getVariableDataAsDataType()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="util_8h-source.html#l00085">FC_VALUE_EQUIV</a>.<div class="fragment"><pre class="fragment"><a name="l04656"></a>04656   {
<a name="l04657"></a>04657   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04658"></a>04658   <span class="keywordtype">int</span> i, j, k;
<a name="l04659"></a>04659   <span class="keywordtype">int</span> numDim, numVertex, temp_numStep;
<a name="l04660"></a>04660   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> sequence;
<a name="l04661"></a>04661   <span class="keywordtype">double</span>* displ_coords, *current, orig[3];
<a name="l04662"></a>04662   <span class="keywordtype">double</span>* displ_data, *deform_data;
<a name="l04663"></a>04663   
<a name="l04664"></a>04664   <span class="comment">// default output</span>
<a name="l04665"></a>04665   <span class="keywordflow">if</span> (deform)
<a name="l04666"></a>04666     *deform = NULL;
<a name="l04667"></a>04667 
<a name="l04668"></a>04668   <span class="comment">// check input</span>
<a name="l04669"></a>04669   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || vertexID &lt; 0 || 
<a name="l04670"></a>04670       !<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, displ) ||
<a name="l04671"></a>04671       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, displ[0])) {
<a name="l04672"></a>04672     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04673"></a>04673     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04674"></a>04674   }
<a name="l04675"></a>04675 
<a name="l04676"></a>04676   <span class="comment">// setup</span>
<a name="l04677"></a>04677   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(displ[0], &amp;numVertex, &amp;numDim, NULL, NULL, NULL);
<a name="l04678"></a>04678   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04679"></a>04679     <span class="keywordflow">return</span> rc;
<a name="l04680"></a>04680   
<a name="l04681"></a>04681   <span class="comment">// more checking</span>
<a name="l04682"></a>04682   <span class="keywordflow">if</span> (vertexID &gt;= numVertex) {
<a name="l04683"></a>04683     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"The vertex ID is out of range"</span>);
<a name="l04684"></a>04684     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04685"></a>04685   }
<a name="l04686"></a>04686   
<a name="l04687"></a>04687   <span class="comment">// create the deformation variable</span>
<a name="l04688"></a>04688   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, displ, &amp;sequence);
<a name="l04689"></a>04689   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04690"></a>04690     <span class="keywordflow">return</span> rc;
<a name="l04691"></a>04691   rc = <a class="code" href="group__Variable.html#gada4bacc9679592ff8b27c538570c1da">fc_createSeqVariable</a>(mesh, sequence, <span class="stringliteral">"deformation"</span>, &amp;temp_numStep,
<a name="l04692"></a>04692                    deform);
<a name="l04693"></a>04693   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04694"></a>04694     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Could not create sequence variable"</span>);
<a name="l04695"></a>04695     <span class="keywordflow">return</span> rc;
<a name="l04696"></a>04696   }
<a name="l04697"></a>04697 
<a name="l04698"></a>04698   <span class="comment">// Set the data</span>
<a name="l04699"></a>04699   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l04700"></a>04700     <span class="comment">// get the displacement of the vertex</span>
<a name="l04701"></a>04701     <span class="comment">// (might be slightly more efficient to calc this on our own)</span>
<a name="l04702"></a>04702     rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, displ[i], &amp;displ_coords);
<a name="l04703"></a>04703     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04704"></a>04704       <span class="keywordflow">return</span> rc;
<a name="l04705"></a>04705     current = &amp;displ_coords[vertexID*numDim];
<a name="l04706"></a>04706     <span class="keywordflow">if</span> (i == 0) 
<a name="l04707"></a>04707       <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l04708"></a>04708      orig[j] = current[j];
<a name="l04709"></a>04709     
<a name="l04710"></a>04710     <span class="comment">// create and set deform data</span>
<a name="l04711"></a>04711     rc = <a class="code" href="group__Variable.html#g717ba43c5ff38b3e711f5a38625e670e">fc_getVariableDataAsDataType</a>(displ[i], <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>,
<a name="l04712"></a>04712                           (<span class="keywordtype">void</span>**)&amp;displ_data);
<a name="l04713"></a>04713     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04714"></a>04714       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Could not get displ data as double"</span>);
<a name="l04715"></a>04715       <span class="keywordflow">return</span> rc;
<a name="l04716"></a>04716     }
<a name="l04717"></a>04717     deform_data = (<span class="keywordtype">double</span>*)malloc(numDim*numVertex*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l04718"></a>04718     <span class="keywordflow">if</span> (!deform_data) {
<a name="l04719"></a>04719       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l04720"></a>04720       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l04721"></a>04721     }
<a name="l04722"></a>04722     <span class="comment">// IMPORTANT! To prevent bad roundoff errors, check that values are </span>
<a name="l04723"></a>04723     <span class="comment">// different before subtracting. If they are not different, answer is 0!</span>
<a name="l04724"></a>04724     <span class="comment">// (Using FC_VALUE_EQUIV instead of FC_DBL_EQUIV because of roundoff in </span>
<a name="l04725"></a>04725     <span class="comment">// centroid calculation, have to be more flexible)</span>
<a name="l04726"></a>04726     <span class="keywordflow">for</span> (j = 0; j &lt; numVertex; j++) {
<a name="l04727"></a>04727       <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++) {
<a name="l04728"></a>04728      <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g24024939f4d5dcab7a65652aa4e71cce">FC_VALUE_EQUIV</a>(displ_data[j*numDim+k] + orig[k], current[k],
<a name="l04729"></a>04729                   100*DBL_EPSILON, DBL_MIN))
<a name="l04730"></a>04730        deform_data[j*numDim+k] = 0.;
<a name="l04731"></a>04731      <span class="keywordflow">else</span>
<a name="l04732"></a>04732        deform_data[j*numDim+k] = displ_data[j*numDim+k] + orig[k] - current[k];
<a name="l04733"></a>04733       }
<a name="l04734"></a>04734     }
<a name="l04735"></a>04735     free(displ_coords);
<a name="l04736"></a>04736     rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>((*deform)[i], numVertex, numDim, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 
<a name="l04737"></a>04737                       <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, deform_data);
<a name="l04738"></a>04738     free(displ_data);
<a name="l04739"></a>04739   }
<a name="l04740"></a>04740   
<a name="l04741"></a>04741   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04742"></a>04742 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g69030cccac839d01b0a3fbc573a20254"></a><!-- doxytag: member="geom.c::fc_calcSquaredEuclideanDistance" ref="g69030cccac839d01b0a3fbc573a20254" args="(FC_Coords v1Coords, FC_Coords v2Coords, int dim, double *distance2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_calcSquaredEuclideanDistance           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>v1Coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>v2Coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>distance2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the squared distance between two vertices. 
<p>
<b>Description:</b> <p>
Computes the squared euclidean distance between the two sets of vertex coordinates.<p>
It's cheaper to compute the squared euclidean distance than the euclidean distance. If you want to compare distances, it's faster to compute and compare the squared euclidean distance.<p>
<b>Modifications:</b> <ul>
<li>6/14/2006 WSD Created. Contains old guts of fc_calcEuclideanDistance. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>v1Coords</em>&nbsp;</td><td>
input - coordinates of one vertex </td></tr>
<tr><td valign="top"><em>v2Coords</em>&nbsp;</td><td>
input - coordinates of the other vertex </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
input - number of dimensions in the coords </td></tr>
<tr><td valign="top"><em>distance2</em>&nbsp;</td><td>
output - distance between the two vertices </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00163">163</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l07227">_fc_calcTriArea()</a>, <a class="el" href="geom_8c-source.html#l02256">_fc_getSubsetDiameterCore()</a>, <a class="el" href="geom_8c-source.html#l02382">_fc_getSubsetsDiameterCore()</a>, <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="geom_8c-source.html#l00116">fc_calcEuclideanDistance()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00168"></a>00168   {
<a name="l00169"></a>00169   <span class="keywordtype">int</span> i;
<a name="l00170"></a>00170   <span class="keywordtype">double</span> sumOfSquares, difference;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="comment">// default output</span>
<a name="l00173"></a>00173   <span class="keywordflow">if</span> (distance2)
<a name="l00174"></a>00174     *distance2 = -1;
<a name="l00175"></a>00175   
<a name="l00176"></a>00176   <span class="comment">// check input</span>
<a name="l00177"></a>00177   <span class="keywordflow">if</span> (v1Coords == NULL || v2Coords == NULL || dim &lt; 1 || dim &gt; 3 ||
<a name="l00178"></a>00178       distance2 == NULL) {
<a name="l00179"></a>00179     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00180"></a>00180     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00181"></a>00181   }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183   <span class="comment">// log message</span>
<a name="l00184"></a>00184   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Calculating squared euclidean distance."</span>);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   sumOfSquares = 0.;
<a name="l00187"></a>00187   <span class="keywordflow">for</span> (i = 0; i &lt; dim; i++ ) {
<a name="l00188"></a>00188     difference = v1Coords[i] - v2Coords[i];
<a name="l00189"></a>00189     sumOfSquares += difference * difference;
<a name="l00190"></a>00190   }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   *distance2 = sumOfSquares;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00195"></a>00195 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf5cb2b10ac399d18fa138f8206083190"></a><!-- doxytag: member="geom.c::fc_combineBoundingBoxes" ref="gf5cb2b10ac399d18fa138f8206083190" args="(int numDim, FC_Coords lowpoint1, FC_Coords highpoint1, FC_Coords lowpoint2, FC_Coords highpoint2, FC_Coords *combine_lowpoint, FC_Coords *combine_highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_combineBoundingBoxes           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>combine_lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>combine_highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determine the bounding box of two bounding boxes. 
<p>
<b>Description:</b> <p>
Returns the bounding box that contains the given bounding boxes.<p>
<b>Modifications:</b> <ul>
<li>10/27/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
input - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint1</em>&nbsp;</td><td>
input - lower left corner of bbox 1 </td></tr>
<tr><td valign="top"><em>highpoint1</em>&nbsp;</td><td>
input - upper right corner of bbox 1 </td></tr>
<tr><td valign="top"><em>lowpoint2</em>&nbsp;</td><td>
input - lower left corner of bbox 2 </td></tr>
<tr><td valign="top"><em>highpoint2</em>&nbsp;</td><td>
input - upper right corner of bbox 2 </td></tr>
<tr><td valign="top"><em>combine_lowpoint</em>&nbsp;</td><td>
output - (optional) lower left corner of combined bbox </td></tr>
<tr><td valign="top"><em>combine_highpoint</em>&nbsp;</td><td>
output - (optional) upper right corner of combined bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00614">614</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="geom_8c-source.html#l00444">fc_isBoundingBoxValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="extents_8c-source.html#l00075">combine_bb()</a>, <a class="el" href="threshBoundBox_8c-source.html#l00454">find_and_print_bbs()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00624"></a>00624   {
<a name="l00625"></a>00625   <span class="keywordtype">int</span> i;
<a name="l00626"></a>00626  
<a name="l00627"></a>00627   <span class="comment">// default returns</span>
<a name="l00628"></a>00628   <span class="keywordflow">if</span> (combine_lowpoint) 
<a name="l00629"></a>00629     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00630"></a>00630       (*combine_lowpoint)[i] = -1.;
<a name="l00631"></a>00631   <span class="keywordflow">if</span> (combine_highpoint) 
<a name="l00632"></a>00632     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00633"></a>00633       (*combine_highpoint)[i] = -2.; <span class="comment">// makes bb invalid</span>
<a name="l00634"></a>00634 
<a name="l00635"></a>00635   <span class="comment">// check input</span>
<a name="l00636"></a>00636   <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricRelations.html#gecdc6fb052fa5d9dc695fcd6be58c808">fc_isBoundingBoxValid</a>(numDim, lowpoint1, highpoint1) ||
<a name="l00637"></a>00637       !<a class="code" href="group__GeometricRelations.html#gecdc6fb052fa5d9dc695fcd6be58c808">fc_isBoundingBoxValid</a>(numDim, lowpoint2, highpoint2) ||
<a name="l00638"></a>00638       !combine_lowpoint || !combine_highpoint) {
<a name="l00639"></a>00639     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00640"></a>00640     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00641"></a>00641   }
<a name="l00642"></a>00642   
<a name="l00643"></a>00643   <span class="comment">// log message</span>
<a name="l00644"></a>00644   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting bounding box of bounding boxes"</span>);   
<a name="l00645"></a>00645 
<a name="l00646"></a>00646   <span class="comment">// return the bb if asked for</span>
<a name="l00647"></a>00647   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l00648"></a>00648     <span class="keywordflow">if</span> (lowpoint1[i] &lt; lowpoint2[i])
<a name="l00649"></a>00649       (*combine_lowpoint)[i] = lowpoint1[i];
<a name="l00650"></a>00650     <span class="keywordflow">else</span>
<a name="l00651"></a>00651       (*combine_lowpoint)[i] = lowpoint2[i];
<a name="l00652"></a>00652     <span class="keywordflow">if</span> (highpoint1[i] &gt; highpoint2[i])
<a name="l00653"></a>00653       (*combine_highpoint)[i] = highpoint1[i];
<a name="l00654"></a>00654     <span class="keywordflow">else</span>
<a name="l00655"></a>00655       (*combine_highpoint)[i] = highpoint2[i];
<a name="l00656"></a>00656   }
<a name="l00657"></a>00657   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++) {
<a name="l00658"></a>00658     (*combine_lowpoint)[i] = 0.;
<a name="l00659"></a>00659     (*combine_highpoint)[i] = 0.;
<a name="l00660"></a>00660   }
<a name="l00661"></a>00661   
<a name="l00662"></a>00662   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00663"></a>00663 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g1cc5bff2291dd32af7c24bc43d83cbbe"></a><!-- doxytag: member="geom.c::fc_createBoundingBoxMesh" ref="g1cc5bff2291dd32af7c24bc43d83cbbe" args="(FC_Dataset dest_ds, char *bb_name, int dim, FC_Coords lowerCoords, FC_Coords upperCoords, FC_Mesh *bb_mesh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createBoundingBoxMesh           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Dataset.html">FC_Dataset</a>&nbsp;</td>
          <td class="paramname"> <em>dest_ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>bb_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowerCoords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>upperCoords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>bb_mesh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a mesh that represents a bounding box. 
<p>
<b>Description:</b> <p>
Returns a mesh, made of line elements, that represents a bounding box. This is useful for visualizing bounding boxes.<p>
<b>Modifications:</b> <ul>
<li>02/19/04 WSK, created. </li></ul>

<p>
Definition at line <a class="el" href="geom_8c-source.html#l01069">1069</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="mesh_8c-source.html#l00119">fc_createMesh()</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="dataset_8c-source.html#l00762">fc_isDatasetValid()</a>, <a class="el" href="base_8c-source.html#l00773">FC_NULL_MESH</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="mesh_8c-source.html#l00193">fc_setMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l00321">fc_setMeshElementConns()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="bb2exo_8c-source.html#l00068">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01076"></a>01076   {
<a name="l01077"></a>01077   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01078"></a>01078   <span class="keywordtype">int</span> i;
<a name="l01079"></a>01079   <span class="keywordtype">int</span> numVertex[3] = { 2, 4, 8 }; 
<a name="l01080"></a>01080   <span class="keywordtype">int</span> numElement[3] = { 1, 4, 12 };
<a name="l01081"></a>01081   <span class="keywordtype">int</span> conns[3][12*2] = { { 0, 1 },
<a name="l01082"></a>01082                 { 0, 1,
<a name="l01083"></a>01083                   1, 2,
<a name="l01084"></a>01084                   2, 3,
<a name="l01085"></a>01085                   3, 0 },
<a name="l01086"></a>01086                 { 0, 1,
<a name="l01087"></a>01087                   1, 2,
<a name="l01088"></a>01088                   2, 3,
<a name="l01089"></a>01089                   3, 0,
<a name="l01090"></a>01090                   4, 5,
<a name="l01091"></a>01091                   5, 6,
<a name="l01092"></a>01092                   6, 7,
<a name="l01093"></a>01093                   7, 4,
<a name="l01094"></a>01094                   0, 4,
<a name="l01095"></a>01095                   1, 5,
<a name="l01096"></a>01096                   2, 6,
<a name="l01097"></a>01097                   3, 7 } };
<a name="l01098"></a>01098   <span class="keywordtype">double</span> coords[8*3];
<a name="l01099"></a>01099 
<a name="l01100"></a>01100   <span class="comment">// default return</span>
<a name="l01101"></a>01101   <span class="keywordflow">if</span> (bb_mesh)
<a name="l01102"></a>01102     *bb_mesh = <a class="code" href="group__Handles.html#gae2d5f3d9f81cdfbf228e0dca85c9c75">FC_NULL_MESH</a>;
<a name="l01103"></a>01103 
<a name="l01104"></a>01104   <span class="comment">// check input</span>
<a name="l01105"></a>01105   <span class="keywordflow">if</span> (!<a class="code" href="group__Dataset.html#g77092c7248e1cff8cf5a4035e19658da">fc_isDatasetValid</a>(dest_ds) || !bb_name || dim &lt; 1 || dim &gt; 3 ||
<a name="l01106"></a>01106       !lowerCoords || !upperCoords || !bb_mesh) {
<a name="l01107"></a>01107     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01108"></a>01108     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01109"></a>01109   }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111   <span class="comment">// log message</span>
<a name="l01112"></a>01112   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Creating a mesh representing bounding box."</span>);   
<a name="l01113"></a>01113 
<a name="l01114"></a>01114   rc = <a class="code" href="group__Mesh.html#gfeb2fbc7f7fce6d00b6946d43b56e0bb">fc_createMesh</a>(dest_ds, bb_name, bb_mesh);
<a name="l01115"></a>01115   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01116"></a>01116     <span class="keywordflow">return</span> rc;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118   <span class="keywordflow">if</span> (dim == 1) {
<a name="l01119"></a>01119     coords[0] = lowerCoords[0];
<a name="l01120"></a>01120     coords[1] = upperCoords[0];
<a name="l01121"></a>01121   }
<a name="l01122"></a>01122   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) {
<a name="l01123"></a>01123     <span class="comment">// x coords</span>
<a name="l01124"></a>01124     coords[0] =   lowerCoords[0];
<a name="l01125"></a>01125     coords[1*2] = upperCoords[0];
<a name="l01126"></a>01126     coords[2*2] = upperCoords[0];
<a name="l01127"></a>01127     coords[3*2] = lowerCoords[0];
<a name="l01128"></a>01128     <span class="comment">// y coords</span>
<a name="l01129"></a>01129     coords[1] =     lowerCoords[1];
<a name="l01130"></a>01130     coords[1*2+1] = lowerCoords[1];
<a name="l01131"></a>01131     coords[2*2+1] = upperCoords[1];
<a name="l01132"></a>01132     coords[3*2+1] = upperCoords[1];
<a name="l01133"></a>01133   }
<a name="l01134"></a>01134   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3) {
<a name="l01135"></a>01135     <span class="comment">// x coords</span>
<a name="l01136"></a>01136     coords[0] =   lowerCoords[0];
<a name="l01137"></a>01137     coords[1*3] = upperCoords[0];
<a name="l01138"></a>01138     coords[2*3] = upperCoords[0];
<a name="l01139"></a>01139     coords[3*3] = lowerCoords[0];
<a name="l01140"></a>01140     coords[4*3] = lowerCoords[0];
<a name="l01141"></a>01141     coords[5*3] = upperCoords[0];
<a name="l01142"></a>01142     coords[6*3] = upperCoords[0];
<a name="l01143"></a>01143     coords[7*3] = lowerCoords[0];
<a name="l01144"></a>01144     <span class="comment">// y coords</span>
<a name="l01145"></a>01145     coords[1] =     lowerCoords[1];
<a name="l01146"></a>01146     coords[1*3+1] = lowerCoords[1];
<a name="l01147"></a>01147     coords[2*3+1] = upperCoords[1];
<a name="l01148"></a>01148     coords[3*3+1] = upperCoords[1];
<a name="l01149"></a>01149     coords[4*3+1] = lowerCoords[1];
<a name="l01150"></a>01150     coords[5*3+1] = lowerCoords[1];
<a name="l01151"></a>01151     coords[6*3+1] = upperCoords[1];
<a name="l01152"></a>01152     coords[7*3+1] = upperCoords[1];
<a name="l01153"></a>01153     <span class="comment">// z coords</span>
<a name="l01154"></a>01154     <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++)
<a name="l01155"></a>01155       coords[i*3+2] = lowerCoords[2];
<a name="l01156"></a>01156     <span class="keywordflow">for</span> (i = 4; i &lt; 8; i++)
<a name="l01157"></a>01157       coords[i*3+2] = upperCoords[2];
<a name="l01158"></a>01158   }
<a name="l01159"></a>01159 
<a name="l01160"></a>01160   rc = <a class="code" href="group__Mesh.html#ga17885c11234d1a1421cdb1a7d118315">fc_setMeshCoords</a>(*bb_mesh, dim, numVertex[dim-1], coords);
<a name="l01161"></a>01161   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01162"></a>01162     <span class="keywordflow">return</span> rc;
<a name="l01163"></a>01163   rc = <a class="code" href="group__Mesh.html#gd5ca47af0316847926ce72532ae605a9">fc_setMeshElementConns</a>(*bb_mesh, <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>, numElement[dim-1], 
<a name="l01164"></a>01164                      conns[dim-1]);
<a name="l01165"></a>01165   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01166"></a>01166     <span class="keywordflow">return</span> rc;
<a name="l01167"></a>01167   
<a name="l01168"></a>01168   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l01169"></a>01169 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g13a84b3949ab3282b49164477058ed08"></a><!-- doxytag: member="geom.c::fc_createDisplacedMeshVertexBin" ref="g13a84b3949ab3282b49164477058ed08" args="(FC_Mesh mesh, FC_Variable displ, FC_VertexBin **bin_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createDisplacedMeshVertexBin           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>bin_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create spatial bins for vertices for geometric queries. 
<p>
<b>Description:</b> <p>
Create an <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> to use for geometric queries. This version creates bins of the displaced vertices of the mesh. The user is responsible for freeing the created <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> by calling <a class="el" href="group__GeometricRelations.html#g97239416a845a919c1b1feec0829b87b">fc_freeVertexBin()</a>.<p>
This is a wrapper around <a class="el" href="group__PrivateGeometricRelations.html#gfc3b6a5ec244ab7fe84154fa49473597">_fc_createVertexBinCore()</a> which does all the work.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000043">Todo:</a></b></dt><dd>Check that this works with 1D &amp; 2D coords</dd></dl>
<b>Modifications:</b> <ul>
<li>03/08/04 WSK, created.</li><li>02/20/06 WSD, moved core code into _fc_createVertexBinCore so could easily extend to dislaced and subset cases. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>displ</em>&nbsp;</td><td>
input - displacement variable </td></tr>
<tr><td valign="top"><em>bin_p</em>&nbsp;</td><td>
output - bin </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05589">5589</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06179">_fc_createVertexBinCore()</a>, <a class="el" href="geom_8c-source.html#l00763">fc_getDisplacedMeshBoundingBox()</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="threshBoundBox_8c-source.html#l00083">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05594"></a>05594 {
<a name="l05595"></a>05595   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05596"></a>05596   <span class="keywordtype">int</span> numDim, numVertex;
<a name="l05597"></a>05597   <span class="keywordtype">double</span>* coords;
<a name="l05598"></a>05598   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowers, uppers;
<a name="l05599"></a>05599 
<a name="l05600"></a>05600   <span class="comment">// default output</span>
<a name="l05601"></a>05601   <span class="keywordflow">if</span> (bin_p)
<a name="l05602"></a>05602     *bin_p = NULL;
<a name="l05603"></a>05603 
<a name="l05604"></a>05604   <span class="comment">// Check input</span>
<a name="l05605"></a>05605   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l05606"></a>05606       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, displ) || !bin_p) {
<a name="l05607"></a>05607     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l05608"></a>05608     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05609"></a>05609   }
<a name="l05610"></a>05610   
<a name="l05611"></a>05611   <span class="comment">// log message</span>
<a name="l05612"></a>05612   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Creating spatial bins for displaced vertices."</span>);  
<a name="l05613"></a>05613   
<a name="l05614"></a>05614   <span class="comment">// Get info from mesh</span>
<a name="l05615"></a>05615   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l05616"></a>05616   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05617"></a>05617     <span class="keywordflow">return</span> rc;
<a name="l05618"></a>05618   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, displ, &amp;coords);
<a name="l05619"></a>05619   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05620"></a>05620     <span class="keywordflow">return</span> rc;
<a name="l05621"></a>05621 
<a name="l05622"></a>05622   <span class="comment">// do it</span>
<a name="l05623"></a>05623   rc = <a class="code" href="group__GeometricRelations.html#ge4b483059d881b6adbdf4d5d24399d4a">fc_getDisplacedMeshBoundingBox</a>(mesh, displ, &amp;numDim, &amp;lowers, &amp;uppers);
<a name="l05624"></a>05624   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) 
<a name="l05625"></a>05625     <span class="keywordflow">return</span> rc;
<a name="l05626"></a>05626   rc = <a class="code" href="group__PrivateGeometricRelations.html#gfc3b6a5ec244ab7fe84154fa49473597">_fc_createVertexBinCore</a>(numVertex, numDim, coords, lowers, uppers,
<a name="l05627"></a>05627                       bin_p);
<a name="l05628"></a>05628   free(coords);
<a name="l05629"></a>05629   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05630"></a>05630     <span class="keywordflow">return</span> rc;
<a name="l05631"></a>05631   (*bin_p)-&gt;mesh = mesh;
<a name="l05632"></a>05632   (*bin_p)-&gt;displ = displ;
<a name="l05633"></a>05633   (*bin_p)-&gt;numDim = numDim;
<a name="l05634"></a>05634 
<a name="l05635"></a>05635   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l05636"></a>05636 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g9aab2b1ce3bf7747aa6adcf63fb590c4"></a><!-- doxytag: member="geom.c::fc_createMeshVertexBin" ref="g9aab2b1ce3bf7747aa6adcf63fb590c4" args="(FC_Mesh mesh, FC_VertexBin **bin_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_createMeshVertexBin           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>bin_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create spatial bins for vertices for geometric queries. 
<p>
<b>Description:</b> <p>
Create an <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> to use for geometric queries. The user is responsible for freeing the created <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> by calling <a class="el" href="group__GeometricRelations.html#g97239416a845a919c1b1feec0829b87b">fc_freeVertexBin()</a>.<p>
This is a wrapper around <a class="el" href="group__PrivateGeometricRelations.html#gfc3b6a5ec244ab7fe84154fa49473597">_fc_createVertexBinCore()</a> which does all the work.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000042">Todo:</a></b></dt><dd>Check that this works with 1D &amp; 2D coords</dd></dl>
<b>Modifications:</b> <ul>
<li>03/08/04 WSK, created.</li><li>02/20/06 WSD, moved core code into _fc_createVertexBinCore so could easily extend to dislaced and subset cases. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>bin_p</em>&nbsp;</td><td>
output - bin </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05522">5522</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06179">_fc_createVertexBinCore()</a>, <a class="el" href="geom_8c-source.html#l00686">fc_getMeshBoundingBox()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05526"></a>05526 {
<a name="l05527"></a>05527   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05528"></a>05528   <span class="keywordtype">int</span> numDim, numVertex;
<a name="l05529"></a>05529   <span class="keywordtype">double</span>* coords;
<a name="l05530"></a>05530   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> lowers, uppers;
<a name="l05531"></a>05531 
<a name="l05532"></a>05532   <span class="comment">// default output</span>
<a name="l05533"></a>05533   <span class="keywordflow">if</span> (bin_p)
<a name="l05534"></a>05534     *bin_p = NULL;
<a name="l05535"></a>05535 
<a name="l05536"></a>05536   <span class="comment">// Check input</span>
<a name="l05537"></a>05537   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || bin_p == NULL) {
<a name="l05538"></a>05538     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l05539"></a>05539     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05540"></a>05540   }
<a name="l05541"></a>05541   
<a name="l05542"></a>05542   <span class="comment">// log message</span>
<a name="l05543"></a>05543   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Creating spatial bins for vertices."</span>);  
<a name="l05544"></a>05544   
<a name="l05545"></a>05545   <span class="comment">// Get info from mesh</span>
<a name="l05546"></a>05546   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l05547"></a>05547   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05548"></a>05548     <span class="keywordflow">return</span> rc;
<a name="l05549"></a>05549   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l05550"></a>05550   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05551"></a>05551     <span class="keywordflow">return</span> rc;
<a name="l05552"></a>05552 
<a name="l05553"></a>05553   <span class="comment">// do it</span>
<a name="l05554"></a>05554   rc = <a class="code" href="group__GeometricRelations.html#g2b4340615ac4674f35b401a11ea4cdbe">fc_getMeshBoundingBox</a>(mesh, &amp;numDim, &amp;lowers, &amp;uppers);
<a name="l05555"></a>05555   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) 
<a name="l05556"></a>05556     <span class="keywordflow">return</span> rc;
<a name="l05557"></a>05557   rc = <a class="code" href="group__PrivateGeometricRelations.html#gfc3b6a5ec244ab7fe84154fa49473597">_fc_createVertexBinCore</a>(numVertex, numDim, coords, lowers, uppers,
<a name="l05558"></a>05558                       bin_p);
<a name="l05559"></a>05559   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05560"></a>05560     <span class="keywordflow">return</span> rc;
<a name="l05561"></a>05561   (*bin_p)-&gt;mesh = mesh;
<a name="l05562"></a>05562   (*bin_p)-&gt;displ = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l05563"></a>05563   (*bin_p)-&gt;numDim = numDim;
<a name="l05564"></a>05564 
<a name="l05565"></a>05565   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l05566"></a>05566 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g7964e351cf79f69108b69771c24edea0"></a><!-- doxytag: member="geom.c::fc_displacedGeomSmoothSeqVariable" ref="g7964e351cf79f69108b69771c24edea0" args="(int numMesh, FC_Mesh *meshes, int numStep1, FC_Variable **seqDispls, FC_VertexBin ***displBins, int numStep2, FC_Variable **seqVars, double radius, int doLocalSmooth, FC_Variable ***smooth_seq_vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_displacedGeomSmoothSeqVariable           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>seqDispls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> ***&nbsp;</td>
          <td class="paramname"> <em>displBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>seqVars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doLocalSmooth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> ***&nbsp;</td>
          <td class="paramname"> <em>smooth_seq_vars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smooth each step of a sequence variable on a displaced mesh. 
<p>
<b>Description:</b> <p>
Wrapper that calls fc_displacedGeomSmoothVariables() under the hood. NOTE that unlike fc_geomSmoothSeqVariable, one has to input an array of displaced vertex bins for each step of the seqVariable.<p>
<b>Modifications:</b> <ul>
<li>2/28/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - the number of meshes to provide values </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - the meshes </td></tr>
<tr><td valign="top"><em>numStep1</em>&nbsp;</td><td>
input - the number of steps for each displ variable </td></tr>
<tr><td valign="top"><em>seqDispls</em>&nbsp;</td><td>
input - for each mesh, the displ seq var </td></tr>
<tr><td valign="top"><em>displBins</em>&nbsp;</td><td>
input - for each mesh, its displaced vertex bins </td></tr>
<tr><td valign="top"><em>numStep2</em>&nbsp;</td><td>
input - the number of steps for each seq variable </td></tr>
<tr><td valign="top"><em>seqVars</em>&nbsp;</td><td>
input - for each mesh, the seq vars to smooth </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - the kernel radius </td></tr>
<tr><td valign="top"><em>doLocalSmooth</em>&nbsp;</td><td>
input - flag for whether smoothing is done over one mesh or all </td></tr>
<tr><td valign="top"><em>smooth_seq_vars</em>&nbsp;</td><td>
output: the smoothed seq vars </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l06028">6028</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="geom_8c-source.html#l05900">fc_displacedGeomSmoothVariable()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varSmooth_8c-source.html#l00069">main()</a>.<div class="fragment"><pre class="fragment"><a name="l06039"></a>06039                                             : the smoothed seq vars */
<a name="l06040"></a>06040 ) {
<a name="l06041"></a>06041   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l06042"></a>06042   <span class="keywordtype">int</span> i, j;
<a name="l06043"></a>06043   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> temp_mesh;
<a name="l06044"></a>06044   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> sequence;
<a name="l06045"></a>06045   <a class="code" href="structFC__Variable.html">FC_Variable</a> *temp_smooth;
<a name="l06046"></a>06046   <a class="code" href="structFC__Variable.html">FC_Variable</a> **smooth_vars, *temp_seqVar;
<a name="l06047"></a>06047   
<a name="l06048"></a>06048   <span class="comment">// default output</span>
<a name="l06049"></a>06049   <span class="keywordflow">if</span> (smooth_seq_vars)
<a name="l06050"></a>06050     *smooth_seq_vars = NULL;
<a name="l06051"></a>06051 
<a name="l06052"></a>06052   <span class="keywordflow">if</span> (numMesh &lt; 1 || !meshes || numStep1 &lt; 0 || !seqDispls || !displBins || 
<a name="l06053"></a>06053       numStep2 &lt; 0 || numStep2 != numStep1 || !seqVars || radius &lt;= 0. || 
<a name="l06054"></a>06054       !smooth_seq_vars) {
<a name="l06055"></a>06055     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l06056"></a>06056     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l06057"></a>06057   }
<a name="l06058"></a>06058   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06059"></a>06059     <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(meshes[i]) || 
<a name="l06060"></a>06060      !<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep1, seqDispls[i]) || !displBins[i] ||
<a name="l06061"></a>06061         !<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep2, seqVars[i]) ||
<a name="l06062"></a>06062      <a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(seqVars[i][0])) {
<a name="l06063"></a>06063       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l06064"></a>06064       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l06065"></a>06065     }
<a name="l06066"></a>06066     <span class="keywordflow">for</span> (j = 0; j &lt; numStep1; j++) {
<a name="l06067"></a>06067       <span class="keywordflow">if</span> (!displBins[i][j] || !<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(displBins[i][j]-&gt;mesh, meshes[i]) || 
<a name="l06068"></a>06068        !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(meshes[i], seqDispls[i][j])) {
<a name="l06069"></a>06069      <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"bad bin or not a valid displ var"</span>);
<a name="l06070"></a>06070      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l06071"></a>06071       }
<a name="l06072"></a>06072     }
<a name="l06073"></a>06073     <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(seqVars[i][0], &amp;temp_mesh);
<a name="l06074"></a>06074     <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(temp_mesh, meshes[i])) {
<a name="l06075"></a>06075       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"vars do not match meshes"</span>);
<a name="l06076"></a>06076       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l06077"></a>06077     }
<a name="l06078"></a>06078   }
<a name="l06079"></a>06079 
<a name="l06080"></a>06080   <span class="comment">// make room for smoothed vars (this will become *smooth_seq_vars)</span>
<a name="l06081"></a>06081   smooth_vars = (<a class="code" href="structFC__Variable.html">FC_Variable</a>**)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>*));
<a name="l06082"></a>06082   <span class="keywordflow">if</span> (!smooth_vars) {
<a name="l06083"></a>06083     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l06084"></a>06084     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l06085"></a>06085   }
<a name="l06086"></a>06086   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06087"></a>06087     smooth_vars[i] = (FC_Variable*)malloc(numStep1*<span class="keyword">sizeof</span>(FC_Variable));
<a name="l06088"></a>06088     <span class="keywordflow">if</span> (!smooth_vars[i]) {
<a name="l06089"></a>06089       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l06090"></a>06090         free(smooth_vars[j]);
<a name="l06091"></a>06091       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l06092"></a>06092       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l06093"></a>06093     }
<a name="l06094"></a>06094   }
<a name="l06095"></a>06095 
<a name="l06096"></a>06096   <span class="comment">// smooth each time step (have to rearrange handles going in &amp; out)</span>
<a name="l06097"></a>06097   <span class="keywordflow">for</span> (i = 0; i &lt; numStep1; i++) {
<a name="l06098"></a>06098     FC_Variable temp_displs[numMesh];
<a name="l06099"></a>06099     FC_Variable temp_vars[numMesh];
<a name="l06100"></a>06100     <a class="code" href="structFC__VertexBin.html">FC_VertexBin</a>* temp_bins[numMesh];
<a name="l06101"></a>06101     <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++) {
<a name="l06102"></a>06102       temp_displs[j] = seqDispls[j][i];
<a name="l06103"></a>06103       temp_vars[j] = seqVars[j][i];
<a name="l06104"></a>06104       temp_bins[j] = displBins[j][i];
<a name="l06105"></a>06105     }
<a name="l06106"></a>06106     rc = <a class="code" href="group__GeometricRelations.html#g0eea52651232dc59994a09f1e09ab703">fc_displacedGeomSmoothVariable</a>(numMesh, meshes, temp_displs, temp_bins,
<a name="l06107"></a>06107                          temp_vars, radius, doLocalSmooth, &amp;temp_smooth);
<a name="l06108"></a>06108     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l06109"></a>06109       <span class="keywordflow">return</span> rc;
<a name="l06110"></a>06110     <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++)
<a name="l06111"></a>06111       smooth_vars[j][i] = temp_smooth[j];
<a name="l06112"></a>06112     free(temp_smooth);
<a name="l06113"></a>06113   }
<a name="l06114"></a>06114   
<a name="l06115"></a>06115   <span class="comment">// convert the smoothed vars to seq vars</span>
<a name="l06116"></a>06116   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep1, seqVars[0], &amp;sequence);
<a name="l06117"></a>06117   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l06118"></a>06118     <span class="keywordflow">return</span> rc;
<a name="l06119"></a>06119   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06120"></a>06120     rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep1, smooth_vars[i],
<a name="l06121"></a>06121                                           sequence, NULL, &amp;temp_seqVar);
<a name="l06122"></a>06122     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l06123"></a>06123       <span class="keywordflow">return</span> rc;
<a name="l06124"></a>06124     free(temp_seqVar);
<a name="l06125"></a>06125   }
<a name="l06126"></a>06126 
<a name="l06127"></a>06127   <span class="comment">// our array of basic handles is the same as the array of seqVar handles</span>
<a name="l06128"></a>06128   *smooth_seq_vars = smooth_vars;
<a name="l06129"></a>06129 
<a name="l06130"></a>06130   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l06131"></a>06131 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g0eea52651232dc59994a09f1e09ab703"></a><!-- doxytag: member="geom.c::fc_displacedGeomSmoothVariable" ref="g0eea52651232dc59994a09f1e09ab703" args="(int numMesh, FC_Mesh *meshes, FC_Variable *displs, FC_VertexBin **displBins, FC_Variable *vars, double radius, int doLocalSmooth, FC_Variable **smooth_vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_displacedGeomSmoothVariable           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>displBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doLocalSmooth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>smooth_vars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smooth a variable field on a displaced mesh. 
<p>
<b>Description:</b> <p>
This routine creates a "smoothed" version of the original variable where each data point in the smoothed variable is the average of all data points within the given radius of the original data point. It uses the vertex bins created using <a class="el" href="group__GeometricRelations.html#g13a84b3949ab3282b49164477058ed08">fc_createDisplacedMeshVertexBin()</a>. Non-scalar variables are averaged component-wise. (Note that only entities that completely fall within the radius are used for the smoothing.) The smoothed variable will always have data type of double.<p>
Because the vertex bins are per mesh, if you want to smooth a variable over all meshes, you must provide handles for the variable on all of the meshes and the appropriate vertex bins).<p>
<b>Modifications:</b> <ul>
<li>03/09/04 WSK, Created.</li><li>04/26/04 WSK, added handling for smoothing element associated vars </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - the number of meshes the variable is on </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - the meshes </td></tr>
<tr><td valign="top"><em>displs</em>&nbsp;</td><td>
input - for each mesh, the displacement variable </td></tr>
<tr><td valign="top"><em>displBins</em>&nbsp;</td><td>
input - for each mesh, its displaced vertex bin </td></tr>
<tr><td valign="top"><em>vars</em>&nbsp;</td><td>
input - for each mesh, the variable to smooth </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - the kernel radius </td></tr>
<tr><td valign="top"><em>doLocalSmooth</em>&nbsp;</td><td>
input - flag for whether smoothing is done over one mesh or all </td></tr>
<tr><td valign="top"><em>smooth_vars</em>&nbsp;</td><td>
output - the smoothed vars </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05900">5900</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06615">_fc_geomSmoothCore()</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l06028">fc_displacedGeomSmoothSeqVariable()</a>, and <a class="el" href="threshBoundBox_8c-source.html#l00083">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05910"></a>05910   {
<a name="l05911"></a>05911   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#g7a13c722796dd6dd0a1c5fa10820ade3">_fc_geomSmoothCore</a>(numMesh, meshes, 1, displs, displBins, vars,
<a name="l05912"></a>05912                    radius, doLocalSmooth, smooth_vars);
<a name="l05913"></a>05913 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g97239416a845a919c1b1feec0829b87b"></a><!-- doxytag: member="geom.c::fc_freeVertexBin" ref="g97239416a845a919c1b1feec0829b87b" args="(FC_VertexBin *bin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fc_freeVertexBin           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *&nbsp;</td>
          <td class="paramname"> <em>bin</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear memory in an <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a>. 
<p>
<b>Description:</b> <p>
Releases allocated memory in an <a class="el" href="structFC__VertexBin.html">FC_VertexBin</a>.<p>
<b>Modifications:</b> <ul>
<li>03/08/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>bin</em>&nbsp;</td><td>
input/output - bin </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05649">5649</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="geom_8h-source.html#l00219">FC_VertexBin::numBins</a>, <a class="el" href="geom_8h-source.html#l00221">FC_VertexBin::numVertex</a>, and <a class="el" href="geom_8h-source.html#l00222">FC_VertexBin::vertexIDs</a>.
<p>
Referenced by <a class="el" href="threshBoundBox_8c-source.html#l00083">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05652"></a>05652 {
<a name="l05653"></a>05653   <span class="keywordtype">int</span> i, j, k;
<a name="l05654"></a>05654 
<a name="l05655"></a>05655   <span class="comment">// Check input</span>
<a name="l05656"></a>05656   <span class="keywordflow">if</span> (bin == NULL)
<a name="l05657"></a>05657     <span class="keywordflow">return</span>;
<a name="l05658"></a>05658 
<a name="l05659"></a>05659   <span class="comment">// log message</span>
<a name="l05660"></a>05660   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Freeing vertex bins."</span>);       
<a name="l05661"></a>05661 
<a name="l05662"></a>05662   <span class="comment">// Clear dynamically allocated storage</span>
<a name="l05663"></a>05663   <span class="keywordflow">for</span> (i = 0; i &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#97e75d951abcab856e3733b7edd3c232">numBins</a>[0]; i++) {
<a name="l05664"></a>05664     <span class="keywordflow">for</span> (j = 0; j &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#97e75d951abcab856e3733b7edd3c232">numBins</a>[1]; j++) {
<a name="l05665"></a>05665       <span class="keywordflow">for</span> (k = 0; k &lt; bin-&gt;<a class="code" href="structFC__VertexBin.html#97e75d951abcab856e3733b7edd3c232">numBins</a>[2]; k++) 
<a name="l05666"></a>05666         free(bin-&gt;<a class="code" href="structFC__VertexBin.html#84aeceb91b0a3da439c03351d252bbcc">vertexIDs</a>[i][j][k]);
<a name="l05667"></a>05667       free(bin-&gt;<a class="code" href="structFC__VertexBin.html#bf8bcb25c140a4e78c4fe0ba71b47cca">numVertex</a>[i][j]);
<a name="l05668"></a>05668       free(bin-&gt;<a class="code" href="structFC__VertexBin.html#84aeceb91b0a3da439c03351d252bbcc">vertexIDs</a>[i][j]);
<a name="l05669"></a>05669     }
<a name="l05670"></a>05670     free(bin-&gt;<a class="code" href="structFC__VertexBin.html#bf8bcb25c140a4e78c4fe0ba71b47cca">numVertex</a>[i]);
<a name="l05671"></a>05671     free(bin-&gt;<a class="code" href="structFC__VertexBin.html#84aeceb91b0a3da439c03351d252bbcc">vertexIDs</a>[i]);
<a name="l05672"></a>05672   }
<a name="l05673"></a>05673   free(bin-&gt;<a class="code" href="structFC__VertexBin.html#bf8bcb25c140a4e78c4fe0ba71b47cca">numVertex</a>);
<a name="l05674"></a>05674   free(bin-&gt;<a class="code" href="structFC__VertexBin.html#84aeceb91b0a3da439c03351d252bbcc">vertexIDs</a>);
<a name="l05675"></a>05675   bin-&gt;<a class="code" href="structFC__VertexBin.html#bf8bcb25c140a4e78c4fe0ba71b47cca">numVertex</a> = NULL;
<a name="l05676"></a>05676   bin-&gt;<a class="code" href="structFC__VertexBin.html#84aeceb91b0a3da439c03351d252bbcc">vertexIDs</a> = NULL;
<a name="l05677"></a>05677 
<a name="l05678"></a>05678   free(bin);
<a name="l05679"></a>05679 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gdec6e11c949a404fee73eba96891be0d"></a><!-- doxytag: member="geom.c::fc_geomSmoothSeqVariable" ref="gdec6e11c949a404fee73eba96891be0d" args="(int numMesh, FC_Mesh *meshes, FC_VertexBin **bins, int numStep, FC_Variable **seqVars, double radius, int doLocalSmooth, FC_Variable ***smooth_seq_vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_geomSmoothSeqVariable           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>seqVars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doLocalSmooth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> ***&nbsp;</td>
          <td class="paramname"> <em>smooth_seq_vars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smooth a sequence variable field. 
<p>
<b>Description:</b> <p>
Wrapper that calls fc_geomSmoothVariables() under the hood.<p>
<b>Modifications:</b> <ul>
<li>10/11/04 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - the number of meshes to provide values </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - the meshes </td></tr>
<tr><td valign="top"><em>bins</em>&nbsp;</td><td>
input - for each mesh, its vertex bin </td></tr>
<tr><td valign="top"><em>numStep</em>&nbsp;</td><td>
input - the number of steps for each seq variable </td></tr>
<tr><td valign="top"><em>seqVars</em>&nbsp;</td><td>
input - for each mesh, the seq vars to smooth </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - the kernel radius </td></tr>
<tr><td valign="top"><em>doLocalSmooth</em>&nbsp;</td><td>
input - flag for whether smoothing is done over one mesh or all </td></tr>
<tr><td valign="top"><em>smooth_seq_vars</em>&nbsp;</td><td>
output: the smoothed seq vars </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05926">5926</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l01665">fc_convertVariablesToSeqVariable()</a>, <a class="el" href="geom_8c-source.html#l05864">fc_geomSmoothVariable()</a>, <a class="el" href="variable_8c-source.html#l04268">fc_getMeshFromVariable()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04193">fc_getSequenceFromSeqVariable()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l04054">fc_isSeqVariableValid()</a>, <a class="el" href="variable_8c-source.html#l04119">fc_isVariableGlobal()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="varSmooth_8c-source.html#l00069">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05934"></a>05934                                             : the smoothed seq vars */
<a name="l05935"></a>05935 ) {
<a name="l05936"></a>05936   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05937"></a>05937   <span class="keywordtype">int</span> i, j;
<a name="l05938"></a>05938   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> temp_mesh;
<a name="l05939"></a>05939   <a class="code" href="structFC__Sequence.html">FC_Sequence</a> sequence;
<a name="l05940"></a>05940   <a class="code" href="structFC__Variable.html">FC_Variable</a> *temp_smooth;
<a name="l05941"></a>05941   <a class="code" href="structFC__Variable.html">FC_Variable</a> **smooth_vars, *temp_seqVar;
<a name="l05942"></a>05942   
<a name="l05943"></a>05943   <span class="comment">// default output</span>
<a name="l05944"></a>05944   <span class="keywordflow">if</span> (smooth_seq_vars)
<a name="l05945"></a>05945     *smooth_seq_vars = NULL;
<a name="l05946"></a>05946 
<a name="l05947"></a>05947   <span class="keywordflow">if</span> (numMesh &lt; 1 || !meshes || !bins || numStep &lt; 0 || !seqVars ||
<a name="l05948"></a>05948       radius &lt;= 0. || !smooth_seq_vars) {
<a name="l05949"></a>05949     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l05950"></a>05950     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05951"></a>05951   }
<a name="l05952"></a>05952   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l05953"></a>05953     <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(meshes[i]) || !bins[i] ||
<a name="l05954"></a>05954         !<a class="code" href="group__Variable.html#g6da3e04586ef55d558c3300b10ab0cb6">fc_isSeqVariableValid</a>(numStep, seqVars[i]) ||
<a name="l05955"></a>05955      <a class="code" href="group__Variable.html#gb955e49911e5be0218cdb3dde8283165">fc_isVariableGlobal</a>(seqVars[i][0])) {
<a name="l05956"></a>05956       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l05957"></a>05957       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05958"></a>05958     }
<a name="l05959"></a>05959     <a class="code" href="group__Variable.html#g18aa101c04f3d2189a1f1e4d68c9dc2a">fc_getMeshFromVariable</a>(seqVars[i][0], &amp;temp_mesh);
<a name="l05960"></a>05960     <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(bins[i]-&gt;mesh, meshes[i]) || 
<a name="l05961"></a>05961         !<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(temp_mesh, meshes[i]) ) {
<a name="l05962"></a>05962       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"bins or vars do not match meshes"</span>);
<a name="l05963"></a>05963       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05964"></a>05964     }
<a name="l05965"></a>05965   }
<a name="l05966"></a>05966 
<a name="l05967"></a>05967   <span class="comment">// make room for smoothed vars (this will become *smooth_seq_vars)</span>
<a name="l05968"></a>05968   smooth_vars = (<a class="code" href="structFC__Variable.html">FC_Variable</a>**)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Variable.html">FC_Variable</a>*));
<a name="l05969"></a>05969   <span class="keywordflow">if</span> (!smooth_vars) {
<a name="l05970"></a>05970     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l05971"></a>05971     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l05972"></a>05972   }
<a name="l05973"></a>05973   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l05974"></a>05974     smooth_vars[i] = (FC_Variable*)malloc(numStep*<span class="keyword">sizeof</span>(FC_Variable));
<a name="l05975"></a>05975     <span class="keywordflow">if</span> (!smooth_vars[i]) {
<a name="l05976"></a>05976       <span class="keywordflow">for</span> (j = 0; j &lt; i-1; j++)
<a name="l05977"></a>05977         free(smooth_vars[j]);
<a name="l05978"></a>05978       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l05979"></a>05979       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l05980"></a>05980     }
<a name="l05981"></a>05981   }
<a name="l05982"></a>05982 
<a name="l05983"></a>05983   <span class="comment">// smooth each time step (have to rearrange handles going in &amp; out)</span>
<a name="l05984"></a>05984   <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l05985"></a>05985     FC_Variable temp_vars[numMesh];
<a name="l05986"></a>05986     <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++)
<a name="l05987"></a>05987       temp_vars[j] = seqVars[j][i];
<a name="l05988"></a>05988     rc = <a class="code" href="group__GeometricRelations.html#g67640d07d8800682e439c9c1fac80ac1">fc_geomSmoothVariable</a>(numMesh, meshes, bins, temp_vars,
<a name="l05989"></a>05989                                radius, doLocalSmooth, &amp;temp_smooth);
<a name="l05990"></a>05990     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05991"></a>05991       <span class="keywordflow">return</span> rc;
<a name="l05992"></a>05992     <span class="keywordflow">for</span> (j = 0; j &lt; numMesh; j++)
<a name="l05993"></a>05993       smooth_vars[j][i] = temp_smooth[j];
<a name="l05994"></a>05994     free(temp_smooth);
<a name="l05995"></a>05995   }
<a name="l05996"></a>05996   
<a name="l05997"></a>05997   <span class="comment">// convert the smoothed vars to seq vars</span>
<a name="l05998"></a>05998   rc = <a class="code" href="group__Variable.html#gea428de5a2584716f6e2bc77cd339544">fc_getSequenceFromSeqVariable</a>(numStep, seqVars[0], &amp;sequence);
<a name="l05999"></a>05999   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l06000"></a>06000     <span class="keywordflow">return</span> rc;
<a name="l06001"></a>06001   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l06002"></a>06002     rc = <a class="code" href="group__Variable.html#g61fe9ebf0de41291042f685580b6d272">fc_convertVariablesToSeqVariable</a>(numStep, smooth_vars[i],
<a name="l06003"></a>06003                                           sequence, NULL, &amp;temp_seqVar);
<a name="l06004"></a>06004     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l06005"></a>06005       <span class="keywordflow">return</span> rc;
<a name="l06006"></a>06006     free(temp_seqVar);
<a name="l06007"></a>06007   }
<a name="l06008"></a>06008 
<a name="l06009"></a>06009   <span class="comment">// our array of basic handles is the same as the array of seqVar handles</span>
<a name="l06010"></a>06010   *smooth_seq_vars = smooth_vars;
<a name="l06011"></a>06011 
<a name="l06012"></a>06012   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l06013"></a>06013 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g67640d07d8800682e439c9c1fac80ac1"></a><!-- doxytag: member="geom.c::fc_geomSmoothVariable" ref="g67640d07d8800682e439c9c1fac80ac1" args="(int numMesh, FC_Mesh *meshes, FC_VertexBin **bins, FC_Variable *vars, double radius, int doLocalSmooth, FC_Variable **smooth_vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_geomSmoothVariable           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> **&nbsp;</td>
          <td class="paramname"> <em>bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doLocalSmooth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> **&nbsp;</td>
          <td class="paramname"> <em>smooth_vars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smooth a variable field. 
<p>
<b>Description:</b> <p>
This routine creates a "smoothed" version of the original variable where each data point in the smoothed variable is the average of all data points within the given radius of the original data point. It uses the vertex bins created using <a class="el" href="group__GeometricRelations.html#g9aab2b1ce3bf7747aa6adcf63fb590c4">fc_createMeshVertexBin()</a>. Non-scalar variables are averaged component-wise. (Note that only entities that completely fall within the radius are used for the smoothing.) The smoothed variable will always have data type of double.<p>
Because the vertex bins are per mesh, if you want to smooth a variable over all meshes, you must provide handles for the variable on all of the meshes and the appropriate vertex bins).<p>
<b>Modifications:</b> <ul>
<li>03/09/04 WSK, Created.</li><li>04/26/04 WSK, added handling for smoothing element associated vars </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - the number of meshes the variable is on </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - the meshes </td></tr>
<tr><td valign="top"><em>bins</em>&nbsp;</td><td>
input - for each mesh, its vertex bin </td></tr>
<tr><td valign="top"><em>vars</em>&nbsp;</td><td>
input - for each mesh, the variable to smooth </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - the kernel radius </td></tr>
<tr><td valign="top"><em>doLocalSmooth</em>&nbsp;</td><td>
input - if true, only points on local mesh are used for smoothing if false, points on all meshes are used for smoothing </td></tr>
<tr><td valign="top"><em>smooth_vars</em>&nbsp;</td><td>
output - the smoothed vars </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05864">5864</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06615">_fc_geomSmoothCore()</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l05926">fc_geomSmoothSeqVariable()</a>, and <a class="el" href="threshBoundBox_8c-source.html#l00083">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05873"></a>05873   {
<a name="l05874"></a>05874   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#g7a13c722796dd6dd0a1c5fa10820ade3">_fc_geomSmoothCore</a>(numMesh, meshes, 0, NULL, bins, vars,
<a name="l05875"></a>05875                    radius, doLocalSmooth, smooth_vars);
<a name="l05876"></a>05876 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g5fff397d0b7779f3d2133bd0147c72e9"></a><!-- doxytag: member="geom.c::fc_getBoundingBoxesOverlap" ref="g5fff397d0b7779f3d2133bd0147c72e9" args="(int numDim, FC_Coords lowpoint1, FC_Coords highpoint1, FC_Coords lowpoint2, FC_Coords highpoint2, int *overlap_flag, FC_Coords *overlap_lowpoint, FC_Coords *overlap_highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getBoundingBoxesOverlap           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>overlap_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>overlap_lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>overlap_highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determine if two bounding boxes overlap in space. 
<p>
<b>Description:</b> <p>
Returns a flag which will be 0 if the bounding boxes do not overlap and greater than 1 if they do. The flag also indicates the type of overlap where 1 = bb1 is inside of bb2, 2 = bb2 is inside of bb1, 3 = bb1 is the same as bb2, and 4 = partial overlap.<p>
Note that a bb can still be inside of another if they share a boundary. If the bounding boxes do intersect, the bounding box of the overlap can be returned.<p>
<b>Modifications:</b> <ul>
<li>10/27/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
input - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint1</em>&nbsp;</td><td>
input - lower left corner of bbox 1 </td></tr>
<tr><td valign="top"><em>highpoint1</em>&nbsp;</td><td>
input - upper right corner of bbox 1 </td></tr>
<tr><td valign="top"><em>lowpoint2</em>&nbsp;</td><td>
input - lower left corner of bbox 2 </td></tr>
<tr><td valign="top"><em>highpoint2</em>&nbsp;</td><td>
input - upper right corner of bbox 2 </td></tr>
<tr><td valign="top"><em>overlap_flag</em>&nbsp;</td><td>
output - 0 = no overlap, 1 = they do overlap, -1 = error </td></tr>
<tr><td valign="top"><em>overlap_lowpoint</em>&nbsp;</td><td>
output - (optional) lower left corner of overlap bbox </td></tr>
<tr><td valign="top"><em>overlap_highpoint</em>&nbsp;</td><td>
output - (optional) upper right corner of overlap bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00480">480</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="util_8c-source.html#l00691">fc_gtd()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="geom_8c-source.html#l00444">fc_isBoundingBoxValid()</a>, <a class="el" href="util_8c-source.html#l00645">fc_ltd()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, and <a class="el" href="threshBoundBox_8c-source.html#l00454">find_and_print_bbs()</a>.<div class="fragment"><pre class="fragment"><a name="l00492"></a>00492   {
<a name="l00493"></a>00493   <span class="keywordtype">int</span> i;
<a name="l00494"></a>00494   <span class="keywordtype">int</span> oneIsTwo, oneInsideTwo, twoInsideOne;
<a name="l00495"></a>00495  
<a name="l00496"></a>00496   <span class="comment">// default returns</span>
<a name="l00497"></a>00497   <span class="keywordflow">if</span> (overlap_flag)
<a name="l00498"></a>00498     *overlap_flag = -1;
<a name="l00499"></a>00499   <span class="keywordflow">if</span> (overlap_lowpoint) 
<a name="l00500"></a>00500     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00501"></a>00501       (*overlap_lowpoint)[i] = -1.;
<a name="l00502"></a>00502   <span class="keywordflow">if</span> (overlap_highpoint) 
<a name="l00503"></a>00503     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00504"></a>00504       (*overlap_highpoint)[i] = -2.; <span class="comment">// makes bb invalid</span>
<a name="l00505"></a>00505 
<a name="l00506"></a>00506   <span class="comment">// check input</span>
<a name="l00507"></a>00507   <span class="keywordflow">if</span> (numDim &lt; 1 || numDim &gt; 3 || !lowpoint1 || !highpoint1 || !lowpoint2 || 
<a name="l00508"></a>00508       !highpoint2 || !overlap_flag ||
<a name="l00509"></a>00509       !<a class="code" href="group__GeometricRelations.html#gecdc6fb052fa5d9dc695fcd6be58c808">fc_isBoundingBoxValid</a>(numDim, lowpoint1, highpoint1) ||
<a name="l00510"></a>00510       !<a class="code" href="group__GeometricRelations.html#gecdc6fb052fa5d9dc695fcd6be58c808">fc_isBoundingBoxValid</a>(numDim, lowpoint2, highpoint2) ) {
<a name="l00511"></a>00511     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00512"></a>00512     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00513"></a>00513   }
<a name="l00514"></a>00514   
<a name="l00515"></a>00515   <span class="comment">// log message</span>
<a name="l00516"></a>00516   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting bounding box overlap"</span>);   
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <span class="comment">// look for no overlap - if either high1 &lt; low2 or low1 &gt; high2 </span>
<a name="l00519"></a>00519   *overlap_flag = 1;
<a name="l00520"></a>00520   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l00521"></a>00521     <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g0e8dadc920de512f0695f7fab65b9072">fc_ltd</a>(highpoint1[i], lowpoint2[i]) ||
<a name="l00522"></a>00522      <a class="code" href="group__PublicFloatingPoint.html#g94f8391d98988b0cff3796b546140f3d">fc_gtd</a>(lowpoint1[i], highpoint2[i])) {
<a name="l00523"></a>00523       *overlap_flag = 0; <span class="comment">// has to overlap in all dimensions</span>
<a name="l00524"></a>00524       <span class="keywordflow">break</span>;
<a name="l00525"></a>00525     }
<a name="l00526"></a>00526   }
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="comment">// if they don't overlap, we're done</span>
<a name="l00529"></a>00529   <span class="keywordflow">if</span> (*overlap_flag == 0)
<a name="l00530"></a>00530     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 
<a name="l00533"></a>00533   <span class="comment">// figure out what kind of overlap</span>
<a name="l00534"></a>00534   oneIsTwo = 0;
<a name="l00535"></a>00535   oneInsideTwo = 0;
<a name="l00536"></a>00536   twoInsideOne = 0;
<a name="l00537"></a>00537   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l00538"></a>00538     <span class="keywordtype">int</span> lowDblEquiv = <a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>(lowpoint1[i], lowpoint2[i]);
<a name="l00539"></a>00539     <span class="keywordtype">int</span> highDblEquiv = <a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>(highpoint1[i], highpoint2[i]); 
<a name="l00540"></a>00540     <span class="keywordflow">if</span> (lowDblEquiv &amp;&amp; highDblEquiv)
<a name="l00541"></a>00541       oneIsTwo++;
<a name="l00542"></a>00542     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (( lowpoint1[i]  &gt;= lowpoint2[i]  || lowDblEquiv ) &amp;&amp; 
<a name="l00543"></a>00543           ( highpoint1[i] &lt;= highpoint2[i] || highDblEquiv ))
<a name="l00544"></a>00544       oneInsideTwo++;
<a name="l00545"></a>00545     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (( lowpoint2[i]  &gt;= lowpoint1[i]  || lowDblEquiv ) &amp;&amp;
<a name="l00546"></a>00546              ( highpoint2[i] &lt;= highpoint1[i] || highDblEquiv ))
<a name="l00547"></a>00547       twoInsideOne++;
<a name="l00548"></a>00548   }
<a name="l00549"></a>00549   
<a name="l00550"></a>00550   <span class="comment">// set overlap flag &amp; set overlap bb if requested</span>
<a name="l00551"></a>00551   <span class="keywordflow">if</span> (oneIsTwo == numDim || oneInsideTwo == numDim) {
<a name="l00552"></a>00552     <span class="keywordflow">if</span> (oneIsTwo == numDim)
<a name="l00553"></a>00553       *overlap_flag = 3;
<a name="l00554"></a>00554     <span class="keywordflow">else</span>
<a name="l00555"></a>00555       *overlap_flag = 1;
<a name="l00556"></a>00556     <span class="keywordflow">if</span> (overlap_lowpoint) 
<a name="l00557"></a>00557       <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) 
<a name="l00558"></a>00558         (*overlap_lowpoint)[i] = lowpoint1[i];
<a name="l00559"></a>00559     <span class="keywordflow">if</span> (overlap_highpoint)
<a name="l00560"></a>00560       <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l00561"></a>00561         (*overlap_highpoint)[i] = highpoint1[i];
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (twoInsideOne == numDim) {
<a name="l00564"></a>00564     *overlap_flag = 2;
<a name="l00565"></a>00565     <span class="keywordflow">if</span> (overlap_lowpoint) 
<a name="l00566"></a>00566       <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) 
<a name="l00567"></a>00567         (*overlap_lowpoint)[i] = lowpoint2[i];
<a name="l00568"></a>00568     <span class="keywordflow">if</span> (overlap_highpoint)
<a name="l00569"></a>00569       <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l00570"></a>00570         (*overlap_highpoint)[i] = highpoint2[i];
<a name="l00571"></a>00571   }
<a name="l00572"></a>00572   <span class="keywordflow">else</span> {
<a name="l00573"></a>00573     *overlap_flag = 4;
<a name="l00574"></a>00574     <span class="keywordflow">if</span> (overlap_lowpoint) {
<a name="l00575"></a>00575       <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l00576"></a>00576         <span class="keywordflow">if</span> (lowpoint1[i] &gt; lowpoint2[i])
<a name="l00577"></a>00577           (*overlap_lowpoint)[i] = lowpoint1[i];
<a name="l00578"></a>00578         <span class="keywordflow">else</span>
<a name="l00579"></a>00579           (*overlap_lowpoint)[i] = lowpoint2[i];
<a name="l00580"></a>00580       }
<a name="l00581"></a>00581     }
<a name="l00582"></a>00582     <span class="keywordflow">if</span> (overlap_highpoint) {
<a name="l00583"></a>00583       <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l00584"></a>00584         <span class="keywordflow">if</span> (highpoint1[i] &lt; highpoint2[i])
<a name="l00585"></a>00585           (*overlap_highpoint)[i] = highpoint1[i];
<a name="l00586"></a>00586         <span class="keywordflow">else</span>
<a name="l00587"></a>00587           (*overlap_highpoint)[i] = highpoint2[i];
<a name="l00588"></a>00588       }
<a name="l00589"></a>00589     }
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592   <span class="comment">// if numDim &lt; 3, fill in rest of FC_Coords with zeros</span>
<a name="l00593"></a>00593   <span class="keywordflow">if</span> (overlap_lowpoint) 
<a name="l00594"></a>00594     <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l00595"></a>00595       (*overlap_lowpoint)[i] = 0.;
<a name="l00596"></a>00596   <span class="keywordflow">if</span> (overlap_highpoint)
<a name="l00597"></a>00597     <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l00598"></a>00598       (*overlap_highpoint)[i] = 0.;
<a name="l00599"></a>00599     
<a name="l00600"></a>00600   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00601"></a>00601 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g723de1cc925a8cc252e36dd7cea01fd6"></a><!-- doxytag: member="geom.c::fc_getDisplacedEdgeLengths" ref="g723de1cc925a8cc252e36dd7cea01fd6" args="(FC_Mesh mesh, FC_Variable coord_displ, FC_Variable *edge_lengths)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedEdgeLengths           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>edge_lengths</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the edge lengths of the displaced mesh. 
<p>
<b>Description:</b> <p>
If the mesh is made of 1D elements (i.e. lines)only lines, the length variable will be associated with the elements. Otherwise it will be associated with the edges of the mesh.<p>
This routine will return with an error if the elements of the mesh are not at least 2D (e.g. it is an error to ask for lengths of a point mesh)<p>
<b>Modifications:</b> <ul>
<li>11/01/04 WSK created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coordinated displacements </td></tr>
<tr><td valign="top"><em>edge_lengths</em>&nbsp;</td><td>
output - edge lengths variable handle </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03503">3503</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="geom_8c-source.html#l00116">fc_calcEuclideanDistance()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02790">fc_getMeshEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="mesh_8c-source.html#l02380">fc_getMeshNumEdge()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="edgeStats_8c-source.html#l00063">get_and_print_lengths()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l03507"></a>03507   {
<a name="l03508"></a>03508   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03509"></a>03509   <span class="keywordtype">int</span> i, j, k;
<a name="l03510"></a>03510   <span class="keywordtype">int</span> dim, numEdge;
<a name="l03511"></a>03511   <span class="keywordtype">double</span> *lengths;
<a name="l03512"></a>03512   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03513"></a>03513   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l03514"></a>03514   <span class="keywordtype">int</span> *edgeConns;
<a name="l03515"></a>03515   <span class="keywordtype">double</span>* coords;
<a name="l03516"></a>03516   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> points[2] = { { 0., 0., 0.}, { 0., 0., 0.} };
<a name="l03517"></a>03517   
<a name="l03518"></a>03518   <span class="comment">// default return</span>
<a name="l03519"></a>03519   <span class="keywordflow">if</span> (edge_lengths) 
<a name="l03520"></a>03520     *edge_lengths = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03521"></a>03521 
<a name="l03522"></a>03522   <span class="comment">// check input</span>
<a name="l03523"></a>03523   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l03524"></a>03524       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) ||
<a name="l03525"></a>03525       edge_lengths == NULL) {
<a name="l03526"></a>03526     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03527"></a>03527     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03528"></a>03528   }
<a name="l03529"></a>03529     
<a name="l03530"></a>03530   <span class="comment">// log message</span>
<a name="l03531"></a>03531   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the edge lengths of the displaced mesh."</span>);  
<a name="l03532"></a>03532 
<a name="l03533"></a>03533   <span class="comment">// setup &amp; more checking</span>
<a name="l03534"></a>03534   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, NULL, &amp;elemType);
<a name="l03535"></a>03535   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03536"></a>03536     <span class="keywordflow">return</span> rc;
<a name="l03537"></a>03537   rc = <a class="code" href="group__Mesh.html#g0526437d03be312b52b0bbe8bc60a701">fc_getMeshNumEdge</a>(mesh, &amp;numEdge);
<a name="l03538"></a>03538   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03539"></a>03539     <span class="keywordflow">return</span> rc;
<a name="l03540"></a>03540   rc = <a class="code" href="group__Mesh.html#gf2e80f30f86823573a2a2e516234eab8">fc_getMeshEdgeConnsPtr</a>(mesh, &amp;edgeConns);
<a name="l03541"></a>03541   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03542"></a>03542     <span class="keywordflow">return</span> rc;
<a name="l03543"></a>03543   <span class="keywordflow">if</span> (numEdge &lt; 1 &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>) {
<a name="l03544"></a>03544     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03545"></a>03545     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03546"></a>03546   }
<a name="l03547"></a>03547   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l03548"></a>03548   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) 
<a name="l03549"></a>03549     <span class="keywordflow">return</span> rc;
<a name="l03550"></a>03550   
<a name="l03551"></a>03551   <span class="comment">// compute edge lengths</span>
<a name="l03552"></a>03552   lengths = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * numEdge);
<a name="l03553"></a>03553   <span class="keywordflow">if</span> (lengths == NULL ) {
<a name="l03554"></a>03554     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03555"></a>03555     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03556"></a>03556   }
<a name="l03557"></a>03557   <span class="keywordflow">for</span> (i = 0; i &lt; numEdge; i++) {
<a name="l03558"></a>03558     <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) 
<a name="l03559"></a>03559       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++)
<a name="l03560"></a>03560      points[j][k] = coords[dim*edgeConns[i*2+j] + k];
<a name="l03561"></a>03561     <a class="code" href="group__GeometricRelations.html#gb2950eac8ed0ef2ea89db89bcac653c8">fc_calcEuclideanDistance</a>(points[0], points[1], dim, &amp;lengths[i]);
<a name="l03562"></a>03562   }
<a name="l03563"></a>03563   free(coords);
<a name="l03564"></a>03564 
<a name="l03565"></a>03565   <span class="comment">// create new variable</span>
<a name="l03566"></a>03566   <span class="keywordflow">if</span> (elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>)
<a name="l03567"></a>03567     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>;
<a name="l03568"></a>03568   <span class="keywordflow">else</span>
<a name="l03569"></a>03569     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a>;
<a name="l03570"></a>03570   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"displaced_edge_lengths"</span>, edge_lengths);
<a name="l03571"></a>03571   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l03572"></a>03572     free(lengths);
<a name="l03573"></a>03573     <span class="keywordflow">return</span> rc;
<a name="l03574"></a>03574   }
<a name="l03575"></a>03575   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*edge_lengths, numEdge, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03576"></a>03576                              <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, lengths);
<a name="l03577"></a>03577   <span class="comment">// don't free lengths!</span>
<a name="l03578"></a>03578   
<a name="l03579"></a>03579   <span class="keywordflow">return</span> rc;
<a name="l03580"></a>03580 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g98f8038ecb056169cbe084080b997d9f"></a><!-- doxytag: member="geom.c::fc_getDisplacedFaceAreas" ref="g98f8038ecb056169cbe084080b997d9f" args="(FC_Mesh mesh, FC_Variable coord_displ, FC_Variable *face_areas)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedFaceAreas           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>face_areas</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the face areas of the displaced mesh. 
<p>
<b>Description:</b> <p>
If the mesh is made of 2D elements (i.e. tris and quads), the area variable will be associated with the elements. Otherwise it will be associated with the faces of the mesh.<p>
This routine will return with an error if the elements of the mesh are not at least 2D (e.g. it is an error to ask for areas of an edge mesh).<p>
This routine assumes that faces are planar.<p>
<b>Modifications:</b> <ul>
<li>11/1/04 WSK, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coordinated displacements </td></tr>
<tr><td valign="top"><em>face_areas</em>&nbsp;</td><td>
output - face areas variable handle </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03702">3702</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l07296">_fc_calcQuadArea()</a>, <a class="el" href="geom_8c-source.html#l07227">_fc_calcTriArea()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="base_8c-source.html#l00384">fc_getElementTypeText()</a>, <a class="el" href="mesh_8c-source.html#l02910">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02841">fc_getMeshFaceTypesPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="mesh_8c-source.html#l02427">fc_getMeshNumFace()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03706"></a>03706   {
<a name="l03707"></a>03707   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03708"></a>03708   <span class="keywordtype">int</span> i, j, k;
<a name="l03709"></a>03709   <span class="keywordtype">int</span> dim, numFace;
<a name="l03710"></a>03710   <span class="keywordtype">double</span> *areas;
<a name="l03711"></a>03711   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03712"></a>03712   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType, *faceTypes;
<a name="l03713"></a>03713   <span class="keywordtype">double</span>* coords;
<a name="l03714"></a>03714   <span class="keywordtype">int</span> maxNumVertPerFace, *numVertPerFaces, *faceConns;
<a name="l03715"></a>03715   <span class="comment">// buffer for coords of face</span>
<a name="l03716"></a>03716   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> points[4] = { { 0., 0., 0.}, { 0., 0., 0.},
<a name="l03717"></a>03717                  { 0., 0., 0.}, { 0., 0., 0.} };  
<a name="l03718"></a>03718   
<a name="l03719"></a>03719   <span class="comment">// default return</span>
<a name="l03720"></a>03720   <span class="keywordflow">if</span> (face_areas) 
<a name="l03721"></a>03721     *face_areas = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03722"></a>03722 
<a name="l03723"></a>03723   <span class="comment">// check input</span>
<a name="l03724"></a>03724   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l03725"></a>03725       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) ||
<a name="l03726"></a>03726       face_areas == NULL) {
<a name="l03727"></a>03727     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03728"></a>03728     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03729"></a>03729   }
<a name="l03730"></a>03730     
<a name="l03731"></a>03731   <span class="comment">// log message</span>
<a name="l03732"></a>03732   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the face areas of the displaced mesh."</span>);  
<a name="l03733"></a>03733 
<a name="l03734"></a>03734   <span class="comment">// setup &amp; more checking</span>
<a name="l03735"></a>03735   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, NULL, &amp;elemType);
<a name="l03736"></a>03736   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03737"></a>03737     <span class="keywordflow">return</span> rc;
<a name="l03738"></a>03738   rc = <a class="code" href="group__Mesh.html#g0f4d7e58dc5936fc8f3824cbce0bf7c4">fc_getMeshNumFace</a>(mesh, &amp;numFace);
<a name="l03739"></a>03739   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03740"></a>03740     <span class="keywordflow">return</span> rc;
<a name="l03741"></a>03741   rc = <a class="code" href="group__Mesh.html#g216435eac0f72ad3ccb35e44b2df6ca5">fc_getMeshFaceConnsPtr</a>(mesh, &amp;numVertPerFaces, &amp;maxNumVertPerFace,
<a name="l03742"></a>03742                      &amp;faceConns);
<a name="l03743"></a>03743   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03744"></a>03744     <span class="keywordflow">return</span> rc;
<a name="l03745"></a>03745   rc = <a class="code" href="group__Mesh.html#g0d44e57289411649dd174c54bc25264a">fc_getMeshFaceTypesPtr</a>(mesh, &amp;faceTypes);
<a name="l03746"></a>03746   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03747"></a>03747     <span class="keywordflow">return</span> rc;
<a name="l03748"></a>03748   <span class="keywordflow">if</span> (numFace == 0 &amp;&amp; !(elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a> || elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>)) {
<a name="l03749"></a>03749     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03750"></a>03750     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03751"></a>03751   }
<a name="l03752"></a>03752   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l03753"></a>03753   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03754"></a>03754     <span class="keywordflow">return</span> rc;
<a name="l03755"></a>03755   
<a name="l03756"></a>03756   <span class="comment">// compute face areas</span>
<a name="l03757"></a>03757   areas = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * numFace);
<a name="l03758"></a>03758   <span class="keywordflow">if</span> (areas == NULL ) {
<a name="l03759"></a>03759     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03760"></a>03760     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03761"></a>03761   } 
<a name="l03762"></a>03762   <span class="keywordflow">for</span> (i = 0; i &lt; numFace; i++) {
<a name="l03763"></a>03763     <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerFaces[i]; j++)
<a name="l03764"></a>03764       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++) 
<a name="l03765"></a>03765         points[j][k] = coords[dim*faceConns[i*maxNumVertPerFace+j] + k];
<a name="l03766"></a>03766     <span class="keywordflow">switch</span> (faceTypes[i]) {
<a name="l03767"></a>03767     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>:   <a class="code" href="group__PrivateGeometricRelations.html#gd284766d3899ab073eaaf310d5835f12">_fc_calcTriArea</a>(dim, points, &amp;areas[i]);   <span class="keywordflow">break</span>;
<a name="l03768"></a>03768     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>:  <a class="code" href="group__PrivateGeometricRelations.html#gb817182a39647bc03d2a0faaffab900d">_fc_calcQuadArea</a>(dim, points, &amp;areas[i]);  <span class="keywordflow">break</span>;
<a name="l03769"></a>03769     <span class="keywordflow">default</span>:
<a name="l03770"></a>03770       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Unexpected face type %s encountered"</span>,
<a name="l03771"></a>03771                             <a class="code" href="group__DataTypes.html#gb3fcc2417d4e38eb3cbd511a42048acd">fc_getElementTypeText</a>(faceTypes[i]));
<a name="l03772"></a>03772       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03773"></a>03773     }
<a name="l03774"></a>03774   }
<a name="l03775"></a>03775   free(coords);
<a name="l03776"></a>03776 
<a name="l03777"></a>03777   <span class="comment">// create new variable</span>
<a name="l03778"></a>03778   <span class="keywordflow">if</span> (elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a> || elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>)
<a name="l03779"></a>03779     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>;
<a name="l03780"></a>03780   <span class="keywordflow">else</span>
<a name="l03781"></a>03781     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>;
<a name="l03782"></a>03782   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"displaced_face_areas"</span>, face_areas);
<a name="l03783"></a>03783   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l03784"></a>03784     free(areas);
<a name="l03785"></a>03785     <span class="keywordflow">return</span> rc;
<a name="l03786"></a>03786   }
<a name="l03787"></a>03787   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*face_areas, numFace, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03788"></a>03788                     <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, areas);
<a name="l03789"></a>03789   <span class="comment">// don't free areas! </span>
<a name="l03790"></a>03790   
<a name="l03791"></a>03791   <span class="keywordflow">return</span> rc;
<a name="l03792"></a>03792 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge4b483059d881b6adbdf4d5d24399d4a"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshBoundingBox" ref="ge4b483059d881b6adbdf4d5d24399d4a" args="(FC_Mesh mesh, FC_Variable coord_displ, int *numDim, FC_Coords *lowpoint, FC_Coords *highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshBoundingBox           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute displaced mesh bounding box. 
<p>
<b>Description:</b> <p>
See <a class="el" href="group__GeometricRelations.html#g2b4340615ac4674f35b401a11ea4cdbe">fc_getMeshBoundingBox()</a> for a description of bounding boxes.<p>
Gets the bounding box of the mesh after displacing the coordinates with the given variable.<p>
<b>Modifications:</b> <ul>
<li>10/27/04 WSK, Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
output - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
output - lower left corner of bbox </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
output - upper right corner of bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00763">763</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l05589">fc_createDisplacedMeshVertexBin()</a>, <a class="el" href="geom_8c-source.html#l00956">fc_getDisplacedSubsetBoundingBox()</a>, and <a class="el" href="extents_8c-source.html#l00098">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00769"></a>00769   {
<a name="l00770"></a>00770   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00771"></a>00771   <span class="keywordtype">int</span> i, j;
<a name="l00772"></a>00772   <span class="keywordtype">int</span> numVertex;
<a name="l00773"></a>00773   <span class="keywordtype">double</span> *coords, temp;
<a name="l00774"></a>00774   <span class="comment">// must initalize all entries of coords to 0 in case numDim &lt; 3</span>
<a name="l00775"></a>00775   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> low = { 0., 0., 0. }, high = { 0., 0., 0. };
<a name="l00776"></a>00776 
<a name="l00777"></a>00777   <span class="comment">// set default output</span>
<a name="l00778"></a>00778   <span class="keywordflow">if</span> (numDim)
<a name="l00779"></a>00779     *numDim = -1;
<a name="l00780"></a>00780   <span class="keywordflow">if</span> (lowpoint) 
<a name="l00781"></a>00781     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00782"></a>00782       (*lowpoint)[i] = -1.;
<a name="l00783"></a>00783   <span class="keywordflow">if</span> (highpoint) 
<a name="l00784"></a>00784     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00785"></a>00785       (*highpoint)[i] = -2.; <span class="comment">// makes bb invalid</span>
<a name="l00786"></a>00786 
<a name="l00787"></a>00787   <span class="comment">// check input</span>
<a name="l00788"></a>00788   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l00789"></a>00789       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) || 
<a name="l00790"></a>00790       !numDim || !lowpoint || !highpoint) {
<a name="l00791"></a>00791     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00792"></a>00792     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00793"></a>00793   }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795   <span class="comment">// log message</span>
<a name="l00796"></a>00796   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced mesh bounding box."</span>);  
<a name="l00797"></a>00797 
<a name="l00798"></a>00798   <span class="comment">// setup</span>
<a name="l00799"></a>00799   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, numDim, &amp;numVertex, NULL, NULL);
<a name="l00800"></a>00800   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00801"></a>00801     <span class="keywordflow">return</span> rc;
<a name="l00802"></a>00802   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l00803"></a>00803   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00804"></a>00804     <span class="keywordflow">return</span> rc;
<a name="l00805"></a>00805   
<a name="l00806"></a>00806   <span class="comment">// initialize  - start with 1st point</span>
<a name="l00807"></a>00807   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++) 
<a name="l00808"></a>00808     low[i] = high[i] = coords[i];
<a name="l00809"></a>00809   
<a name="l00810"></a>00810   <span class="comment">// find min &amp; max in each dim</span>
<a name="l00811"></a>00811   <span class="keywordflow">for</span> (i = 1; i &lt; numVertex; i++) {
<a name="l00812"></a>00812     <span class="keywordflow">for</span> (j = 0; j &lt; *numDim; j++) {
<a name="l00813"></a>00813       temp = coords[i*(*numDim)+j];
<a name="l00814"></a>00814       <span class="keywordflow">if</span> (temp &lt; low[j])
<a name="l00815"></a>00815         low[j] = temp;
<a name="l00816"></a>00816       <span class="keywordflow">if</span> (temp &gt; high[j])
<a name="l00817"></a>00817         high[j] = temp;
<a name="l00818"></a>00818     }
<a name="l00819"></a>00819   }
<a name="l00820"></a>00820   free(coords);
<a name="l00821"></a>00821 
<a name="l00822"></a>00822   <span class="comment">// set return values</span>
<a name="l00823"></a>00823   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++) {
<a name="l00824"></a>00824     (*lowpoint)[i] = low[i];
<a name="l00825"></a>00825     (*highpoint)[i] = high[i];
<a name="l00826"></a>00826   }
<a name="l00827"></a>00827 
<a name="l00828"></a>00828   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00829"></a>00829 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g020ce5685953cc5e0c9920a2705db4b8"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshCentroid" ref="g020ce5685953cc5e0c9920a2705db4b8" args="(FC_Mesh mesh, FC_Variable coord_displ, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute centroid of displaced mesh. 
<p>
<b>Description:</b> <p>
The centroid is the geometric center of the mesh and is calculated by averaging the coordinates in each dimension.<p>
<b>Modifications:</b> <ul>
<li>10/29/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of coords </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02656">2656</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l04764">fc_calcMeshDeformationUsingCentroid()</a>, and <a class="el" href="geom_8c-source.html#l03036">fc_getDisplacedSubsetCentroid()</a>.<div class="fragment"><pre class="fragment"><a name="l02661"></a>02661   {
<a name="l02662"></a>02662   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02663"></a>02663   <span class="keywordtype">int</span> i, j;
<a name="l02664"></a>02664   <span class="keywordtype">int</span> numVertex, numDim;
<a name="l02665"></a>02665   <span class="keywordtype">double</span> *coords;
<a name="l02666"></a>02666   <span class="keywordtype">double</span> coords_sum[3];
<a name="l02667"></a>02667   
<a name="l02668"></a>02668   <span class="comment">// default output</span>
<a name="l02669"></a>02669   <span class="keywordflow">if</span> (dim)
<a name="l02670"></a>02670     *dim = -1;
<a name="l02671"></a>02671   <span class="keywordflow">if</span> (center) {
<a name="l02672"></a>02672     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02673"></a>02673       (*center)[i] = -1.;
<a name="l02674"></a>02674   }
<a name="l02675"></a>02675 
<a name="l02676"></a>02676   <span class="comment">// check input</span>
<a name="l02677"></a>02677   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l02678"></a>02678       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) || 
<a name="l02679"></a>02679       !dim || !center) {
<a name="l02680"></a>02680     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02681"></a>02681     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02682"></a>02682   }
<a name="l02683"></a>02683 
<a name="l02684"></a>02684   <span class="comment">// log message</span>
<a name="l02685"></a>02685   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced mesh centroid."</span>);  
<a name="l02686"></a>02686   
<a name="l02687"></a>02687   <span class="comment">// get vertices </span>
<a name="l02688"></a>02688   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l02689"></a>02689   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02690"></a>02690     <span class="keywordflow">return</span> rc;
<a name="l02691"></a>02691   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l02692"></a>02692   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) 
<a name="l02693"></a>02693     <span class="keywordflow">return</span> rc;
<a name="l02694"></a>02694   
<a name="l02695"></a>02695   <span class="comment">// initialize sums</span>
<a name="l02696"></a>02696   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02697"></a>02697     coords_sum[i] = 0.;
<a name="l02698"></a>02698   
<a name="l02699"></a>02699   <span class="comment">// collect sums</span>
<a name="l02700"></a>02700   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++)
<a name="l02701"></a>02701     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l02702"></a>02702       coords_sum[j] += coords[i*numDim + j];
<a name="l02703"></a>02703   free(coords);
<a name="l02704"></a>02704   
<a name="l02705"></a>02705   <span class="comment">// calculate centroids</span>
<a name="l02706"></a>02706   *dim = numDim;
<a name="l02707"></a>02707   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l02708"></a>02708     (*center)[i] = coords_sum[i]/numVertex;
<a name="l02709"></a>02709   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l02710"></a>02710     (*center)[i] = 0.;
<a name="l02711"></a>02711 
<a name="l02712"></a>02712   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l02713"></a>02713 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g78716e2414d2a11d92097b70f5d8431c"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshCoords" ref="g78716e2414d2a11d92097b70f5d8431c" args="(FC_Mesh mesh, FC_Variable displ, double **displaced_coords)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshCoords           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>displaced_coords</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create displaced vertex coordinates. 
<p>
<b>Description:</b> <p>
Create vertex coordinates which are the sum of the vertex coordinates and a displacement variable. Unlike the call 'fc_getMeshCoords', the caller is responsible for freeing the created coordinates.<p>
The variable to use as displacements must be associated with vertices and have the same dimensionality as the vertices.<p>
<b>Modifications:</b> <ul>
<li>2003-SEP-04 W Koegler Moved code from getDisplacedSurfaceNormals here</li><li>01/29/04 WSK, Changed to return double array instead of array of _FC_Vertex. Now can be a public function and more generally useful. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>displ</em>&nbsp;</td><td>
input - variable to displace coordinates by </td></tr>
<tr><td valign="top"><em>displaced_coords</em>&nbsp;</td><td>
output - array of coords in XYZXYZ... order </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00352">352</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l06615">_fc_geomSmoothCore()</a>, <a class="el" href="geom_8c-source.html#l02256">_fc_getSubsetDiameterCore()</a>, <a class="el" href="geom_8c-source.html#l02382">_fc_getSubsetsDiameterCore()</a>, <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="geom_8c-source.html#l04650">fc_calcMeshDeformationUsingRefVertex()</a>, <a class="el" href="geom_8c-source.html#l05589">fc_createDisplacedMeshVertexBin()</a>, <a class="el" href="sierra_8c-source.html#l01209">fc_evalPrestoSpotWeld()</a>, <a class="el" href="geom_8c-source.html#l03503">fc_getDisplacedEdgeLengths()</a>, <a class="el" href="geom_8c-source.html#l03702">fc_getDisplacedFaceAreas()</a>, <a class="el" href="geom_8c-source.html#l00763">fc_getDisplacedMeshBoundingBox()</a>, <a class="el" href="geom_8c-source.html#l02656">fc_getDisplacedMeshCentroid()</a>, <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, <a class="el" href="geom_8c-source.html#l00956">fc_getDisplacedSubsetBoundingBox()</a>, <a class="el" href="geom_8c-source.html#l03036">fc_getDisplacedSubsetCentroid()</a>, <a class="el" href="geom_8c-source.html#l04542">fc_getDisplacedSurfaceNormals()</a>, <a class="el" href="geom_8c-source.html#l02836">fc_getVariableWeightedDisplacedMeshCentroid()</a>, <a class="el" href="geom_8c-source.html#l03267">fc_getVariableWeightedDisplacedSubsetCentroid()</a>, <a class="el" href="gaplines_8c-source.html#l00240">getLinesAsVectors()</a>, and <a class="el" href="geomExtract_8c-source.html#l00060">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00356"></a>00356   {
<a name="l00357"></a>00357   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00358"></a>00358   <span class="keywordtype">int</span> i;
<a name="l00359"></a>00359   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype;
<a name="l00360"></a>00360   <span class="keywordtype">int</span> numData, dataDim;
<a name="l00361"></a>00361   <span class="keywordtype">double</span>* coords;
<a name="l00362"></a>00362   <span class="keywordtype">double</span>* temp_displ_coords;
<a name="l00363"></a>00363   <span class="keywordtype">void</span>* data;
<a name="l00364"></a>00364   
<a name="l00365"></a>00365   <span class="comment">// default return</span>
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (displaced_coords)
<a name="l00367"></a>00367     *displaced_coords = NULL;
<a name="l00368"></a>00368 
<a name="l00369"></a>00369   <span class="comment">// check input</span>
<a name="l00370"></a>00370   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l00371"></a>00371       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, displ) ||
<a name="l00372"></a>00372       displaced_coords == NULL) {
<a name="l00373"></a>00373     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00374"></a>00374     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00375"></a>00375   }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377   <span class="comment">// log message</span>
<a name="l00378"></a>00378   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced vertex coordinates."</span>);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   <span class="comment">// get info &amp; big data</span>
<a name="l00381"></a>00381   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(displ, &amp;numData, &amp;dataDim, NULL, NULL, &amp;datatype);
<a name="l00382"></a>00382   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00383"></a>00383     <span class="keywordflow">return</span> rc;
<a name="l00384"></a>00384   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l00385"></a>00385   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00386"></a>00386     <span class="keywordflow">return</span> rc;
<a name="l00387"></a>00387   <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(displ, &amp;data);
<a name="l00388"></a>00388   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00389"></a>00389     <span class="keywordflow">return</span> rc;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391   <span class="comment">// make the displacement coords</span>
<a name="l00392"></a>00392   temp_displ_coords = (<span class="keywordtype">double</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*numData*dataDim);
<a name="l00393"></a>00393   <span class="keywordflow">if</span> ( temp_displ_coords == NULL) {
<a name="l00394"></a>00394     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l00395"></a>00395     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l00396"></a>00396   } 
<a name="l00397"></a>00397   <span class="keywordflow">switch</span> (datatype) {
<a name="l00398"></a>00398   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>: {
<a name="l00399"></a>00399     <span class="keywordtype">int</span> *cast_data = (<span class="keywordtype">int</span>*)data;
<a name="l00400"></a>00400     <span class="keywordflow">for</span> (i = 0; i &lt; numData*dataDim; i++)
<a name="l00401"></a>00401       temp_displ_coords[i] = coords[i] + cast_data[i];
<a name="l00402"></a>00402   } <span class="keywordflow">break</span>;
<a name="l00403"></a>00403   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>: {
<a name="l00404"></a>00404     <span class="keywordtype">float</span> *cast_data = (<span class="keywordtype">float</span>*)data;
<a name="l00405"></a>00405     <span class="keywordflow">for</span> (i = 0; i &lt; numData*dataDim; i++)
<a name="l00406"></a>00406       temp_displ_coords[i] = coords[i] + cast_data[i];
<a name="l00407"></a>00407   } <span class="keywordflow">break</span>;
<a name="l00408"></a>00408   <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>: {
<a name="l00409"></a>00409     <span class="keywordtype">double</span> *cast_data = (<span class="keywordtype">double</span>*)data;
<a name="l00410"></a>00410     <span class="keywordflow">for</span> (i = 0; i &lt; numData*dataDim; i++)
<a name="l00411"></a>00411       temp_displ_coords[i] = coords[i] + cast_data[i];
<a name="l00412"></a>00412   } <span class="keywordflow">break</span>;
<a name="l00413"></a>00413   <span class="keywordflow">default</span>:
<a name="l00414"></a>00414     free(temp_displ_coords);
<a name="l00415"></a>00415     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l00416"></a>00416   }  
<a name="l00417"></a>00417   *displaced_coords = temp_displ_coords;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00420"></a>00420 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gbdf584cf3ab769dfc6f68ea84a2aa259"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshDiameter" ref="gbdf584cf3ab769dfc6f68ea84a2aa259" args="(FC_Mesh mesh, FC_Variable coord_displ, double *diameter, int *numPair, int **pairIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshDiameter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a displaced mesh. 
<p>
This routine returns the diameter of the set of displaced vertices that make up the mesh. For more details see <a class="el" href="group__GeometricRelations.html#g4d0810ecf214489a94f56073aa141164">fc_getMeshDiameter()</a>.<p>
<b>Modifications:</b> <ul>
<li>6/27/05 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - A mesh </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - the coordinate displacements </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01699">1699</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02127">_fc_getDiameterOutputArgsTest()</a>, <a class="el" href="geom_8c-source.html#l02256">_fc_getSubsetDiameterCore()</a>, <a class="el" href="subset_8c-source.html#l01178">fc_addMemberToSubset()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l01706"></a>01706   {
<a name="l01707"></a>01707   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01708"></a>01708   <a class="code" href="structFC__Subset.html">FC_Subset</a> subset;
<a name="l01709"></a>01709 
<a name="l01710"></a>01710   <span class="comment">// log message</span>
<a name="l01711"></a>01711   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced mesh diameter."</span>);
<a name="l01712"></a>01712 
<a name="l01713"></a>01713   <span class="comment">// set default returns &amp; test output args</span>
<a name="l01714"></a>01714   rc = <a class="code" href="group__PrivateGeometricRelations.html#ge6ea8457b23e18e1945b23fe328fbbd1">_fc_getDiameterOutputArgsTest</a>(diameter, numPair, pairIDs);
<a name="l01715"></a>01715   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01716"></a>01716     <span class="keywordflow">return</span> rc;
<a name="l01717"></a>01717 
<a name="l01718"></a>01718   <span class="comment">// test input</span>
<a name="l01719"></a>01719   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l01720"></a>01720       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ)) {
<a name="l01721"></a>01721     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01722"></a>01722     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01723"></a>01723   }
<a name="l01724"></a>01724 
<a name="l01725"></a>01725   <span class="comment">// Create subset that is whole</span>
<a name="l01726"></a>01726   rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subset);
<a name="l01727"></a>01727   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01728"></a>01728     <span class="keywordflow">return</span> rc;
<a name="l01729"></a>01729   rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subset, 0);
<a name="l01730"></a>01730   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01731"></a>01731     <span class="keywordflow">return</span> rc;
<a name="l01732"></a>01732 
<a name="l01733"></a>01733   <span class="comment">// Send to core getSubsetDiameter code</span>
<a name="l01734"></a>01734   rc = <a class="code" href="group__PrivateGeometricRelations.html#g7b6c20a9dc1adb93878b76c326d656ac">_fc_getSubsetDiameterCore</a>(subset, &amp;coord_displ, diameter, numPair, pairIDs);
<a name="l01735"></a>01735 
<a name="l01736"></a>01736   <span class="comment">// Cleanup &amp; return</span>
<a name="l01737"></a>01737   <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subset);
<a name="l01738"></a>01738   <span class="keywordflow">return</span> rc;
<a name="l01739"></a>01739 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g3bab08f74e326575f1454f564401df60"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshesDiameter" ref="g3bab08f74e326575f1454f564401df60" args="(int numMesh, FC_Mesh *meshes, FC_Variable *displs, double *diameter, int *numPair, int **pairIDs, FC_Mesh **pairMeshes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshesDiameter           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> **&nbsp;</td>
          <td class="paramname"> <em>pairMeshes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a group of displaced meshes. 
<p>
This routine returns the diameter of the set of displaced vertices that make up a group of meshes. For more details see <a class="el" href="group__GeometricRelations.html#ga827e7709fded608a7de79dde212552d">fc_getMeshesDiameter()</a>.<p>
<b>Modifications:</b> <ul>
<li>3/9/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - number of meshes </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - Array of meshes </td></tr>
<tr><td valign="top"><em>displs</em>&nbsp;</td><td>
input - the coordinate displacements </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairMeshes</em>&nbsp;</td><td>
output - the meshes of the pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01929">1929</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02165">_fc_getDiameterOutputArgsTestMeshes()</a>, <a class="el" href="geom_8c-source.html#l02382">_fc_getSubsetsDiameterCore()</a>, <a class="el" href="subset_8c-source.html#l01178">fc_addMemberToSubset()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l01938"></a>01938   {
<a name="l01939"></a>01939   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01940"></a>01940   <span class="keywordtype">int</span> i;
<a name="l01941"></a>01941   <a class="code" href="structFC__Subset.html">FC_Subset</a>* subsets, *pairSubs;
<a name="l01942"></a>01942 
<a name="l01943"></a>01943   <span class="comment">// log message</span>
<a name="l01944"></a>01944   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced meshes diameter."</span>);
<a name="l01945"></a>01945 
<a name="l01946"></a>01946   <span class="comment">// set default returns &amp; test output args</span>
<a name="l01947"></a>01947   rc = <a class="code" href="group__PrivateGeometricRelations.html#gf5861c53412f3b68b23d9279d1b83da0">_fc_getDiameterOutputArgsTestMeshes</a>(diameter, numPair, pairIDs,
<a name="l01948"></a>01948                             pairMeshes);
<a name="l01949"></a>01949   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01950"></a>01950     <span class="keywordflow">return</span> rc;
<a name="l01951"></a>01951 
<a name="l01952"></a>01952   <span class="comment">// test input</span>
<a name="l01953"></a>01953   <span class="keywordflow">if</span> (numMesh &lt; 1 || !meshes || !displs) {
<a name="l01954"></a>01954     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01955"></a>01955     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01956"></a>01956   }
<a name="l01957"></a>01957   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l01958"></a>01958     <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(meshes[i]) || 
<a name="l01959"></a>01959      !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(meshes[i], displs[i])) {
<a name="l01960"></a>01960       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01961"></a>01961       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01962"></a>01962     }
<a name="l01963"></a>01963   }
<a name="l01964"></a>01964 
<a name="l01965"></a>01965   <span class="comment">// Create subsets that are whole</span>
<a name="l01966"></a>01966   subsets = (<a class="code" href="structFC__Subset.html">FC_Subset</a>*)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html">FC_Subset</a>));
<a name="l01967"></a>01967   <span class="keywordflow">if</span> (!subsets) {
<a name="l01968"></a>01968     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01969"></a>01969     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01970"></a>01970   }
<a name="l01971"></a>01971   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l01972"></a>01972     rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(meshes[i], <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subsets[i]);
<a name="l01973"></a>01973     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01974"></a>01974       <span class="keywordflow">return</span> rc;
<a name="l01975"></a>01975     rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subsets[i], 0);
<a name="l01976"></a>01976     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01977"></a>01977       <span class="keywordflow">return</span> rc;
<a name="l01978"></a>01978   }
<a name="l01979"></a>01979 
<a name="l01980"></a>01980   <span class="comment">// Send to core getSubsetDiameter code</span>
<a name="l01981"></a>01981   rc = <a class="code" href="group__PrivateGeometricRelations.html#gc3ff82fc255522698bef399215b8639b">_fc_getSubsetsDiameterCore</a>(numMesh, subsets, displs, diameter, 
<a name="l01982"></a>01982                       numPair, pairIDs, &amp;pairSubs);
<a name="l01983"></a>01983 
<a name="l01984"></a>01984   <span class="comment">// convert pairSubs to pairMeshes</span>
<a name="l01985"></a>01985   <span class="keywordflow">if</span> (rc == <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a> &amp;&amp; numPair &amp;&amp; *numPair &gt; 0) {
<a name="l01986"></a>01986     <a class="code" href="structFC__Mesh.html">FC_Mesh</a>* subMeshes;
<a name="l01987"></a>01987     subMeshes = (<a class="code" href="structFC__Mesh.html">FC_Mesh</a>*)malloc(2*(*numPair)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Mesh.html">FC_Mesh</a>));
<a name="l01988"></a>01988     <span class="keywordflow">if</span> (!subMeshes) {
<a name="l01989"></a>01989       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01990"></a>01990       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01991"></a>01991     }
<a name="l01992"></a>01992     <span class="keywordflow">for</span> (i = 0; i &lt; 2*(*numPair); i++) {
<a name="l01993"></a>01993       rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(pairSubs[i], &amp;subMeshes[i]);
<a name="l01994"></a>01994       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01995"></a>01995       <span class="keywordflow">return</span> rc;
<a name="l01996"></a>01996     }
<a name="l01997"></a>01997     *pairMeshes = subMeshes;
<a name="l01998"></a>01998     free(pairSubs);
<a name="l01999"></a>01999   }
<a name="l02000"></a>02000 
<a name="l02001"></a>02001   <span class="comment">// Cleanup &amp; return</span>
<a name="l02002"></a>02002   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++)
<a name="l02003"></a>02003     <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subsets[i]);
<a name="l02004"></a>02004   free(subsets);
<a name="l02005"></a>02005 
<a name="l02006"></a>02006   <span class="keywordflow">return</span> rc;
<a name="l02007"></a>02007 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g3a6d67e6a4a8d3791f6b9d640c6ecc89"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshesProximity" ref="g3a6d67e6a4a8d3791f6b9d640c6ecc89" args="(FC_Mesh mesh1, FC_Variable displ1, FC_Mesh mesh2, FC_Variable displ2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshesProximity           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh1VertIDs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh2VertIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the proximal vertices between two displaced meshes. 
<p>
<b>Description:</b> <p>
This returns all vertex pairs that are less than or equal to min_dist apart. Vertices may show up in more than one pair. (In the extrememe case if you put in min_dist = infinity, you would end up with each vertex being connected to all vertices of the other mesh.)<p>
The routine can be forced to return "early", after the first match is found, if you use NULL for the last two arguments (the vertex arrays). In this case, the returned numPair is really a flag for whether a pair was found or not and will never be greater than 1 even if there are more than one possible pairs.<p>
Note, passing in min_dist = 0 will find overlapping vertices.<p>
Note, meshes may be closer together than any of the vertex pairs (imagine 1 vertex of one mesh very close to middle of a face of another mesh. the vert to face distance is less than distance to the face's verts).<p>
Will return if error if mesh1 == mesh2 AND displ1 == displ2. (mesh1 can be the same as mesh2 if displ1 != displ2)<p>
<b>Modifications:</b> <ul>
<li>02/14/2006 WSD Created.</li><li>03/14/2006 WSD guts common to all proximity routines to a common core routine.</li><li>03/16/2006 WSD changed behavior so that if NULLs are passed in for the vertIDs, will return after 1st match. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh1</em>&nbsp;</td><td>
input - the first mesh </td></tr>
<tr><td valign="top"><em>displ1</em>&nbsp;</td><td>
input - the displacements on the first mesh </td></tr>
<tr><td valign="top"><em>mesh2</em>&nbsp;</td><td>
input - the second mesh </td></tr>
<tr><td valign="top"><em>displ2</em>&nbsp;</td><td>
input - the displacements on the second mesh </td></tr>
<tr><td valign="top"><em>min_dist</em>&nbsp;</td><td>
input - the distance cutoff </td></tr>
<tr><td valign="top"><em>numPair_p</em>&nbsp;</td><td>
output - the number of vertex pairs found </td></tr>
<tr><td valign="top"><em>mesh1VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh1 verts (order matters), user is responsible for freeing </td></tr>
<tr><td valign="top"><em>mesh2VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh2 verts (order matters), user is responsible for freeing </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04981">4981</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l05181">_fc_getSubsetsProximityArgsTest()</a>, <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="subset_8c-source.html#l01178">fc_addMemberToSubset()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l04992"></a>04992   {
<a name="l04993"></a>04993   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04994"></a>04994   <a class="code" href="structFC__Subset.html">FC_Subset</a> subset1, subset2;
<a name="l04995"></a>04995 
<a name="l04996"></a>04996   <span class="comment">// argument testing &amp; default returns</span>
<a name="l04997"></a>04997   rc = <a class="code" href="group__PrivateGeometricRelations.html#gd6f42749fc51c2c345947d616aea2c2e">_fc_getSubsetsProximityArgsTest</a>(&amp;mesh1, NULL, &amp;displ1, &amp;mesh2,
<a name="l04998"></a>04998                            NULL, &amp;displ2, min_dist, numPair_p,
<a name="l04999"></a>04999                            mesh1VertIDs_p, mesh2VertIDs_p);
<a name="l05000"></a>05000   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05001"></a>05001     <span class="keywordflow">return</span> rc;
<a name="l05002"></a>05002 
<a name="l05003"></a>05003   <span class="comment">// log message</span>
<a name="l05004"></a>05004   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced meshes proximity"</span>);
<a name="l05005"></a>05005 
<a name="l05006"></a>05006   <span class="comment">// convert to subsets that are whole</span>
<a name="l05007"></a>05007   rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh1, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subset1);
<a name="l05008"></a>05008   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05009"></a>05009     <span class="keywordflow">return</span> rc;
<a name="l05010"></a>05010   rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subset1, 0);
<a name="l05011"></a>05011   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05012"></a>05012     <span class="keywordflow">return</span> rc;
<a name="l05013"></a>05013   rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh2, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subset2);
<a name="l05014"></a>05014   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05015"></a>05015     <span class="keywordflow">return</span> rc;
<a name="l05016"></a>05016   rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subset2, 0);
<a name="l05017"></a>05017   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05018"></a>05018     <span class="keywordflow">return</span> rc;
<a name="l05019"></a>05019 
<a name="l05020"></a>05020   <span class="comment">// do it</span>
<a name="l05021"></a>05021   rc = <a class="code" href="group__PrivateGeometricRelations.html#gb8a027025dc64581aaf438723d9f62d8">_fc_getSubsetsProximityCore</a>(subset1, &amp;displ1, subset2, &amp;displ2,
<a name="l05022"></a>05022                        min_dist, numPair_p, mesh1VertIDs_p,
<a name="l05023"></a>05023                        mesh2VertIDs_p);
<a name="l05024"></a>05024 
<a name="l05025"></a>05025   <span class="comment">// cleanup</span>
<a name="l05026"></a>05026   <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subset1);
<a name="l05027"></a>05027   <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subset2);
<a name="l05028"></a>05028 
<a name="l05029"></a>05029   <span class="keywordflow">return</span> rc;
<a name="l05030"></a>05030 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gff3eb4d9d53d3b0c73b850ee4df4e057"></a><!-- doxytag: member="geom.c::fc_getDisplacedMeshVolume" ref="gff3eb4d9d53d3b0c73b850ee4df4e057" args="(FC_Mesh mesh, FC_Variable coord_displ, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedMeshVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute displaced mesh volume. 
<p>
<b>Description:</b> <p>
Gets the volume of the mesh after displacing the coordinates with the given variable.<p>
This will return with an error and vol = -1 if the elements of the mesh are not 3D (e.g. it is an error to ask for volumes of a quad mesh).<p>
This routine uses fc_getDisplacedRegionVolumes and therefore has the same assumptions fc_getDisplacedRegionVolumes does.<p>
<b>Modifications:</b> <ul>
<li>12/03/04 ACG, Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - volume of mesh </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04065">4065</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="statistics_8c-source.html#l00303">fc_getVariableSum()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="volumeSegments_8c-source.html#l00334">calcSegmentsVolumes()</a>.<div class="fragment"><pre class="fragment"><a name="l04069"></a>04069   {
<a name="l04070"></a>04070 
<a name="l04071"></a>04071   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04072"></a>04072   <a class="code" href="structFC__Variable.html">FC_Variable</a> elemvols;
<a name="l04073"></a>04073   <span class="keywordtype">double</span> vol;
<a name="l04074"></a>04074 
<a name="l04075"></a>04075   <span class="comment">// default return</span>
<a name="l04076"></a>04076   <span class="keywordflow">if</span> (volume)
<a name="l04077"></a>04077     *volume = -1;
<a name="l04078"></a>04078 
<a name="l04079"></a>04079   <span class="comment">// test input</span>
<a name="l04080"></a>04080   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l04081"></a>04081       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) || !volume) {
<a name="l04082"></a>04082     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04083"></a>04083     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04084"></a>04084   }
<a name="l04085"></a>04085 
<a name="l04086"></a>04086   <span class="comment">// log message</span>
<a name="l04087"></a>04087   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Calculating volume of displaced mesh"</span>);
<a name="l04088"></a>04088 
<a name="l04089"></a>04089   <span class="comment">//this will test if mesh and the coord_displ are valid</span>
<a name="l04090"></a>04090   rc = <a class="code" href="group__GeometricRelations.html#g05ba60b4aa725ef7d7938e64925ba75b">fc_getDisplacedRegionVolumes</a>(mesh,coord_displ,&amp;elemvols);
<a name="l04091"></a>04091   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04092"></a>04092     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04093"></a>04093     <span class="keywordflow">return</span> rc;
<a name="l04094"></a>04094   }
<a name="l04095"></a>04095   rc = <a class="code" href="group__Statistics.html#ge08935af09502122f5f080bb2eb952a3">fc_getVariableSum</a>(elemvols,&amp;vol);
<a name="l04096"></a>04096   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04097"></a>04097     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04098"></a>04098     <span class="keywordflow">return</span> rc;
<a name="l04099"></a>04099   }
<a name="l04100"></a>04100 
<a name="l04101"></a>04101   <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04102"></a>04102   *volume = vol;
<a name="l04103"></a>04103   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04104"></a>04104 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g05ba60b4aa725ef7d7938e64925ba75b"></a><!-- doxytag: member="geom.c::fc_getDisplacedRegionVolumes" ref="g05ba60b4aa725ef7d7938e64925ba75b" args="(FC_Mesh mesh, FC_Variable coord_displ, FC_Variable *region_volumes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedRegionVolumes           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>region_volumes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the region volumes of the displaced mesh. 
<p>
<b>Description:</b> <p>
This will return with an error if the elements of the mesh are not 3D (e.g. it is an error to ask for volumes of a quad mesh).<p>
This routine assumes that the faces of the regions are planar.<p>
<b>Modifications:</b> <ul>
<li>11/01/04 WSK, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coordinated displacements </td></tr>
<tr><td valign="top"><em>region_volumes</em>&nbsp;</td><td>
output - region volumes variable handle </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03900">3900</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l07456">_fc_calcHexVolume()</a>, <a class="el" href="geom_8c-source.html#l07416">_fc_calcPrismVolume()</a>, <a class="el" href="geom_8c-source.html#l07375">_fc_calcPyramidVolume()</a>, <a class="el" href="geom_8c-source.html#l07344">_fc_calcTetVolume()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="base_8c-source.html#l00549">fc_getElementTypeNumVertex()</a>, <a class="el" href="base_8c-source.html#l00384">fc_getElementTypeText()</a>, <a class="el" href="mesh_8c-source.html#l02981">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l04065">fc_getDisplacedMeshVolume()</a>, and <a class="el" href="geom_8c-source.html#l04240">fc_getDisplacedSubsetVolume()</a>.<div class="fragment"><pre class="fragment"><a name="l03904"></a>03904   {
<a name="l03905"></a>03905   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03906"></a>03906   <span class="keywordtype">int</span> i, j, k;
<a name="l03907"></a>03907   <span class="keywordtype">int</span> dim, numElement, numVertPerElem;
<a name="l03908"></a>03908   <span class="keywordtype">double</span> *vols;
<a name="l03909"></a>03909   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l03910"></a>03910   <span class="keywordtype">double</span>* coords;
<a name="l03911"></a>03911   <span class="keywordtype">int</span>* conns;
<a name="l03912"></a>03912   <span class="comment">// buffer for coords of the region</span>
<a name="l03913"></a>03913   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> points[8] = { { 0., 0., 0.}, { 0., 0., 0.},
<a name="l03914"></a>03914                  { 0., 0., 0.}, { 0., 0., 0.},
<a name="l03915"></a>03915                  { 0., 0., 0.}, { 0., 0., 0.},
<a name="l03916"></a>03916                  { 0., 0., 0.}, { 0., 0., 0.} };   
<a name="l03917"></a>03917 
<a name="l03918"></a>03918   <span class="comment">// default return</span>
<a name="l03919"></a>03919   <span class="keywordflow">if</span> (region_volumes) 
<a name="l03920"></a>03920     *region_volumes = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03921"></a>03921   
<a name="l03922"></a>03922   <span class="comment">// check input</span>
<a name="l03923"></a>03923   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l03924"></a>03924       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) ||
<a name="l03925"></a>03925       region_volumes == NULL) {
<a name="l03926"></a>03926     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03927"></a>03927     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03928"></a>03928   }
<a name="l03929"></a>03929   
<a name="l03930"></a>03930   <span class="comment">// log message</span>
<a name="l03931"></a>03931   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the region volumes of the displaced mesh."</span>);  
<a name="l03932"></a>03932   
<a name="l03933"></a>03933   <span class="comment">// setup &amp; more checking</span>
<a name="l03934"></a>03934   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, &amp;numElement, &amp;elemType);
<a name="l03935"></a>03935   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03936"></a>03936     <span class="keywordflow">return</span> rc;
<a name="l03937"></a>03937   <span class="keywordflow">if</span> (elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a> &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a> &amp;&amp; 
<a name="l03938"></a>03938       elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a> &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>) {
<a name="l03939"></a>03939     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03940"></a>03940     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03941"></a>03941   }
<a name="l03942"></a>03942   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l03943"></a>03943   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03944"></a>03944     <span class="keywordflow">return</span> rc;
<a name="l03945"></a>03945 
<a name="l03946"></a>03946   rc = <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(mesh, &amp;conns);
<a name="l03947"></a>03947   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03948"></a>03948     <span class="keywordflow">return</span> rc;
<a name="l03949"></a>03949   numVertPerElem = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(elemType);
<a name="l03950"></a>03950   
<a name="l03951"></a>03951   <span class="comment">// compute element volumes</span>
<a name="l03952"></a>03952   vols = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * numElement);
<a name="l03953"></a>03953   <span class="keywordflow">if</span> (vols == NULL ) {
<a name="l03954"></a>03954     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03955"></a>03955     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03956"></a>03956   } 
<a name="l03957"></a>03957   <span class="keywordflow">for</span> (i = 0; i &lt; numElement; i++) {
<a name="l03958"></a>03958     <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerElem; j++)
<a name="l03959"></a>03959       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++) 
<a name="l03960"></a>03960         points[j][k] = coords[dim*conns[i*numVertPerElem+j] + k];
<a name="l03961"></a>03961     <span class="keywordflow">switch</span> (elemType) {
<a name="l03962"></a>03962     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a>:      <a class="code" href="group__PrivateGeometricRelations.html#g52628920b39574a4fa2280913ace4046">_fc_calcTetVolume</a>(points, &amp;vols[i]);      <span class="keywordflow">break</span>;
<a name="l03963"></a>03963     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a>:  <a class="code" href="group__PrivateGeometricRelations.html#g687b2ddb6667e3f37189e4294057d1a3">_fc_calcPyramidVolume</a>(points, &amp;vols[i]);  <span class="keywordflow">break</span>;
<a name="l03964"></a>03964     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a>:    <a class="code" href="group__PrivateGeometricRelations.html#gdfeb042b46ada6ecd247abbe460570aa">_fc_calcPrismVolume</a>(points, &amp;vols[i]);    <span class="keywordflow">break</span>;
<a name="l03965"></a>03965     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>:      <a class="code" href="group__PrivateGeometricRelations.html#g520a713351463f90e452887d18703cd9">_fc_calcHexVolume</a>(points, &amp;vols[i]);      <span class="keywordflow">break</span>;
<a name="l03966"></a>03966     <span class="keywordflow">default</span>:
<a name="l03967"></a>03967       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Unexpected element type %s encountered"</span>,
<a name="l03968"></a>03968                             <a class="code" href="group__DataTypes.html#gb3fcc2417d4e38eb3cbd511a42048acd">fc_getElementTypeText</a>(elemType));
<a name="l03969"></a>03969       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03970"></a>03970     }
<a name="l03971"></a>03971   }
<a name="l03972"></a>03972   free(coords);
<a name="l03973"></a>03973 
<a name="l03974"></a>03974   <span class="comment">// create new variable</span>
<a name="l03975"></a>03975   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"region_volumes"</span>, region_volumes);
<a name="l03976"></a>03976   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l03977"></a>03977     free(vols);
<a name="l03978"></a>03978     <span class="keywordflow">return</span> rc;
<a name="l03979"></a>03979   }
<a name="l03980"></a>03980   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*region_volumes, numElement, 1, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>,
<a name="l03981"></a>03981                              <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, vols);
<a name="l03982"></a>03982   <span class="comment">// don't free vols!</span>
<a name="l03983"></a>03983   
<a name="l03984"></a>03984   <span class="keywordflow">return</span> rc;
<a name="l03985"></a>03985 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gcd393977ed8c8b505edb6402ab20afa7"></a><!-- doxytag: member="geom.c::fc_getDisplacedSubsetBoundingBox" ref="gcd393977ed8c8b505edb6402ab20afa7" args="(FC_Subset subset, FC_Variable coord_displ, int *numDim, FC_Coords *lowpoint, FC_Coords *highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSubsetBoundingBox           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute bounding box of subset of a displaced mesh. 
<p>
<b>Description:</b> <p>
See <a class="el" href="group__GeometricRelations.html#g2b4340615ac4674f35b401a11ea4cdbe">fc_getMeshBoundingBox()</a> for a description of bounding boxes.<p>
Gets the bounding box of the subset after displacing the coordinates of the parent mesh with the given variable.<p>
Returns with an error if nothing is marked.<p>
<b>Modifications:</b> <ul>
<li>10/27/04 WSK, Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset handle </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
output - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
output - lower left corner of bbox </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
output - upper right corner of bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00956">956</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l00763">fc_getDisplacedMeshBoundingBox()</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02172">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01754">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="threshBoundBox_8c-source.html#l00454">find_and_print_bbs()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00963"></a>00963 {
<a name="l00964"></a>00964   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00965"></a>00965   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l00966"></a>00966   <span class="keywordtype">int</span> i, j;
<a name="l00967"></a>00967   <span class="keywordtype">int</span> numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l00968"></a>00968   <span class="keywordtype">double</span> *coords, temp;
<a name="l00969"></a>00969   <span class="comment">// must initalize all entries of coords to 0 in case numDim &lt; 3</span>
<a name="l00970"></a>00970   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> low = { 0., 0., 0. }, high = { 0., 0., 0. };
<a name="l00971"></a>00971   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l00972"></a>00972 
<a name="l00973"></a>00973   <span class="comment">// default output</span>
<a name="l00974"></a>00974   <span class="keywordflow">if</span> (numDim)
<a name="l00975"></a>00975     *numDim = -1;
<a name="l00976"></a>00976   <span class="keywordflow">if</span> (lowpoint) 
<a name="l00977"></a>00977     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00978"></a>00978       (*lowpoint)[i] = -1.;
<a name="l00979"></a>00979   <span class="keywordflow">if</span> (highpoint) 
<a name="l00980"></a>00980     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00981"></a>00981       (*highpoint)[i] = -2.; <span class="comment">// makes bb invalid</span>
<a name="l00982"></a>00982 
<a name="l00983"></a>00983   <span class="comment">// check input </span>
<a name="l00984"></a>00984   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !numDim || !lowpoint || !highpoint) {
<a name="l00985"></a>00985     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00986"></a>00986     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00987"></a>00987   }  
<a name="l00988"></a>00988   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l00989"></a>00989   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00990"></a>00990     <span class="keywordflow">return</span> rc;
<a name="l00991"></a>00991   <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ)) {
<a name="l00992"></a>00992     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00993"></a>00993     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00994"></a>00994   }  
<a name="l00995"></a>00995 
<a name="l00996"></a>00996   <span class="comment">// log message</span>
<a name="l00997"></a>00997   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced subset bounding box"</span>);    
<a name="l00998"></a>00998   
<a name="l00999"></a>00999   <span class="comment">// setup I</span>
<a name="l01000"></a>01000   rc = <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;assoc);
<a name="l01001"></a>01001   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01002"></a>01002     <span class="keywordflow">return</span> rc;
<a name="l01003"></a>01003 
<a name="l01004"></a>01004   <span class="comment">// Error case: if subset has zero members - return error</span>
<a name="l01005"></a>01005   <span class="keywordflow">if</span> (numMember == 0 ) {
<a name="l01006"></a>01006     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members"</span>);
<a name="l01007"></a>01007     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01008"></a>01008   }
<a name="l01009"></a>01009   
<a name="l01010"></a>01010   <span class="comment">// --- special case -- whole association</span>
<a name="l01011"></a>01011   <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) 
<a name="l01012"></a>01012     <span class="keywordflow">return</span> <a class="code" href="group__GeometricRelations.html#ge4b483059d881b6adbdf4d5d24399d4a">fc_getDisplacedMeshBoundingBox</a>(mesh, coord_displ, numDim, lowpoint, 
<a name="l01013"></a>01013                                           highpoint);
<a name="l01014"></a>01014 
<a name="l01015"></a>01015   <span class="comment">// get vertices of the members</span>
<a name="l01016"></a>01016   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l01017"></a>01017   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01018"></a>01018     <span class="keywordflow">return</span> rc;
<a name="l01019"></a>01019   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, assoc, numMember, memberIDs, 
<a name="l01020"></a>01020                                <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l01021"></a>01021   free(memberIDs);
<a name="l01022"></a>01022 
<a name="l01023"></a>01023   <span class="comment">// setup II</span>
<a name="l01024"></a>01024   rc = <a class="code" href="group__Mesh.html#geaea4205623196e6b1b58da0b4b82b20">fc_getMeshDim</a>(mesh, numDim);
<a name="l01025"></a>01025   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01026"></a>01026     <span class="keywordflow">return</span> rc;
<a name="l01027"></a>01027   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l01028"></a>01028   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01029"></a>01029     <span class="keywordflow">return</span> rc;
<a name="l01030"></a>01030 
<a name="l01031"></a>01031   <span class="comment">// initialize - start with 1st point</span>
<a name="l01032"></a>01032   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++)
<a name="l01033"></a>01033     low[i] = high[i] = coords[vertexIDs[0]*(*numDim)+i];
<a name="l01034"></a>01034 
<a name="l01035"></a>01035   <span class="comment">// find min &amp; max in each dim</span>
<a name="l01036"></a>01036   <span class="keywordflow">for</span> (i = 1; i &lt; numVertex; i++) {
<a name="l01037"></a>01037     <span class="keywordflow">for</span> (j = 0; j &lt; *numDim; j++) {
<a name="l01038"></a>01038       temp = coords[vertexIDs[i]*(*numDim)+j];
<a name="l01039"></a>01039       <span class="keywordflow">if</span> (temp &lt; low[j])
<a name="l01040"></a>01040         low[j] = temp;
<a name="l01041"></a>01041       <span class="keywordflow">if</span> (temp &gt; high[j])
<a name="l01042"></a>01042         high[j] = temp;
<a name="l01043"></a>01043     }
<a name="l01044"></a>01044   }
<a name="l01045"></a>01045   free(vertexIDs);
<a name="l01046"></a>01046   free(coords);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048   <span class="comment">// set return values</span>
<a name="l01049"></a>01049   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++) {
<a name="l01050"></a>01050     (*lowpoint)[i] = low[i];
<a name="l01051"></a>01051     (*highpoint)[i] = high[i];
<a name="l01052"></a>01052   }
<a name="l01053"></a>01053 
<a name="l01054"></a>01054   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l01055"></a>01055 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g757d8d181b71dd7b850364012ec4a332"></a><!-- doxytag: member="geom.c::fc_getDisplacedSubsetCentroid" ref="g757d8d181b71dd7b850364012ec4a332" args="(FC_Subset subset, FC_Variable coord_displ, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSubsetCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute centroid of a displaced subset. 
<p>
<b>Description:</b> <p>
The centroid is the geometric center of the subset and is calculated by averaging the coordinates in each dimension. Also called center of mass or center of gravity.<p>
<b>Modifications:</b> <ul>
<li>10/29/04 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of coords </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03036">3036</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l02656">fc_getDisplacedMeshCentroid()</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02172">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01754">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03041"></a>03041   {
<a name="l03042"></a>03042   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03043"></a>03043   <span class="keywordtype">int</span> i, j;
<a name="l03044"></a>03044   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l03045"></a>03045   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03046"></a>03046   <span class="keywordtype">int</span> numDim, numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l03047"></a>03047   <span class="keywordtype">double</span> *coords;
<a name="l03048"></a>03048   <span class="keywordtype">double</span> coords_sum[3];
<a name="l03049"></a>03049   
<a name="l03050"></a>03050   <span class="comment">// default</span>
<a name="l03051"></a>03051   <span class="keywordflow">if</span> (dim)
<a name="l03052"></a>03052     *dim = -1;
<a name="l03053"></a>03053   <span class="keywordflow">if</span> (center) {
<a name="l03054"></a>03054     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03055"></a>03055       (*center)[i] = -1.;
<a name="l03056"></a>03056   }
<a name="l03057"></a>03057 
<a name="l03058"></a>03058   <span class="comment">// check input</span>
<a name="l03059"></a>03059   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !dim || !center) {
<a name="l03060"></a>03060     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03061"></a>03061     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03062"></a>03062   }
<a name="l03063"></a>03063   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l03064"></a>03064   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03065"></a>03065     <span class="keywordflow">return</span> rc;
<a name="l03066"></a>03066   <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ)) {
<a name="l03067"></a>03067     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03068"></a>03068     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03069"></a>03069   }
<a name="l03070"></a>03070 
<a name="l03071"></a>03071   <span class="comment">// log message</span>
<a name="l03072"></a>03072   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced subset centroid."</span>);  
<a name="l03073"></a>03073   
<a name="l03074"></a>03074   <span class="comment">// setup I</span>
<a name="l03075"></a>03075   rc = <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;assoc);
<a name="l03076"></a>03076   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03077"></a>03077     <span class="keywordflow">return</span> rc;
<a name="l03078"></a>03078 
<a name="l03079"></a>03079   <span class="comment">// Error case: if subset has zero members - return error</span>
<a name="l03080"></a>03080   <span class="keywordflow">if</span> (numMember == 0 ) {
<a name="l03081"></a>03081     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members"</span>);
<a name="l03082"></a>03082     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03083"></a>03083   }
<a name="l03084"></a>03084   
<a name="l03085"></a>03085   <span class="comment">// special case -- whole association</span>
<a name="l03086"></a>03086   <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) 
<a name="l03087"></a>03087     <span class="keywordflow">return</span> <a class="code" href="group__GeometricRelations.html#g020ce5685953cc5e0c9920a2705db4b8">fc_getDisplacedMeshCentroid</a>(mesh, coord_displ, dim, center);
<a name="l03088"></a>03088     
<a name="l03089"></a>03089   <span class="comment">// setup II</span>
<a name="l03090"></a>03090   rc = <a class="code" href="group__Mesh.html#geaea4205623196e6b1b58da0b4b82b20">fc_getMeshDim</a>(mesh, &amp;numDim);
<a name="l03091"></a>03091   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03092"></a>03092     <span class="keywordflow">return</span> rc;
<a name="l03093"></a>03093   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l03094"></a>03094   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03095"></a>03095     <span class="keywordflow">return</span> rc;
<a name="l03096"></a>03096   
<a name="l03097"></a>03097   <span class="comment">// get vertices of the members</span>
<a name="l03098"></a>03098   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l03099"></a>03099   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03100"></a>03100     <span class="keywordflow">return</span> rc;
<a name="l03101"></a>03101   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, assoc, numMember, memberIDs, 
<a name="l03102"></a>03102                                <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l03103"></a>03103   free(memberIDs);
<a name="l03104"></a>03104 
<a name="l03105"></a>03105   <span class="comment">// calculate coordinate sums</span>
<a name="l03106"></a>03106   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03107"></a>03107     coords_sum[i] = 0.;
<a name="l03108"></a>03108   
<a name="l03109"></a>03109   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++)
<a name="l03110"></a>03110     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l03111"></a>03111       coords_sum[j] += coords[vertexIDs[i]*numDim + j];
<a name="l03112"></a>03112   free(vertexIDs);
<a name="l03113"></a>03113   free(coords);
<a name="l03114"></a>03114   
<a name="l03115"></a>03115   <span class="comment">// calculate centroids</span>
<a name="l03116"></a>03116   *dim = numDim;
<a name="l03117"></a>03117   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l03118"></a>03118     (*center)[i] = coords_sum[i]/numVertex;
<a name="l03119"></a>03119   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l03120"></a>03120     (*center)[i] = 0.;
<a name="l03121"></a>03121   
<a name="l03122"></a>03122   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l03123"></a>03123 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g582f174f144644a7c2e2ff22e53b8349"></a><!-- doxytag: member="geom.c::fc_getDisplacedSubsetDiameter" ref="g582f174f144644a7c2e2ff22e53b8349" args="(FC_Subset subset, FC_Variable coord_displ, double *diameter, int *numPair, int **pairIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSubsetDiameter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a displaced subset. 
<p>
This routine returns the diameter of the set of displaced vertices that make up the members of the subset. For more details see <a class="el" href="group__GeometricRelations.html#g4d0810ecf214489a94f56073aa141164">fc_getMeshDiameter()</a>.<p>
<b>Modifications:</b> <ul>
<li>6/24/05 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - A subset </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - the owning mesh's coordinate displacements </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01790">1790</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02127">_fc_getDiameterOutputArgsTest()</a>, <a class="el" href="geom_8c-source.html#l02256">_fc_getSubsetDiameterCore()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="elemdeath_8c-source.html#l01196">fc_calcTearLength()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01798"></a>01798   {
<a name="l01799"></a>01799   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01800"></a>01800   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l01801"></a>01801  
<a name="l01802"></a>01802   <span class="comment">// log message</span>
<a name="l01803"></a>01803   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced subset diameter."</span>);
<a name="l01804"></a>01804 
<a name="l01805"></a>01805   <span class="comment">// set default returns &amp; test output args</span>
<a name="l01806"></a>01806   rc = <a class="code" href="group__PrivateGeometricRelations.html#ge6ea8457b23e18e1945b23fe328fbbd1">_fc_getDiameterOutputArgsTest</a>(diameter, numPair, pairIDs);
<a name="l01807"></a>01807   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01808"></a>01808     <span class="keywordflow">return</span> rc;
<a name="l01809"></a>01809 
<a name="l01810"></a>01810   <span class="comment">// test input</span>
<a name="l01811"></a>01811   <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l01812"></a>01812   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || 
<a name="l01813"></a>01813       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ)) {
<a name="l01814"></a>01814     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01815"></a>01815     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01816"></a>01816   }
<a name="l01817"></a>01817 
<a name="l01818"></a>01818   <span class="comment">// do it</span>
<a name="l01819"></a>01819   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#g7b6c20a9dc1adb93878b76c326d656ac">_fc_getSubsetDiameterCore</a>(subset, &amp;coord_displ, diameter, numPair, pairIDs);
<a name="l01820"></a>01820 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g7da48dd54f4ae3e1a20ec50854d87c41"></a><!-- doxytag: member="geom.c::fc_getDisplacedSubsetsDiameter" ref="g7da48dd54f4ae3e1a20ec50854d87c41" args="(int numSubset, FC_Subset *subsets, FC_Variable *displs, double *diameter, int *numPair, int **pairIDs, FC_Subset **pairSubsets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSubsetsDiameter           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numSubset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>displs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>pairSubsets</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a group of displaced subsets. 
<p>
This routine returns the diameter of the set of displaced vertices that make up the members of a gorup of subsets. For more details see <a class="el" href="group__GeometricRelations.html#ga827e7709fded608a7de79dde212552d">fc_getMeshesDiameter()</a>.<p>
<b>Modifications:</b> <ul>
<li>3/9/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numSubset</em>&nbsp;</td><td>
input - number of subsets </td></tr>
<tr><td valign="top"><em>subsets</em>&nbsp;</td><td>
input - Array of subset </td></tr>
<tr><td valign="top"><em>displs</em>&nbsp;</td><td>
input - the owning mesh's coordinate displacements </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairSubsets</em>&nbsp;</td><td>
output - the subsets of the pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02068">2068</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02207">_fc_getDiameterOutputArgsTestSubsets()</a>, <a class="el" href="geom_8c-source.html#l02382">_fc_getSubsetsDiameterCore()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l02078"></a>02078   {
<a name="l02079"></a>02079   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02080"></a>02080   <span class="keywordtype">int</span> i;
<a name="l02081"></a>02081   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l02082"></a>02082  
<a name="l02083"></a>02083   <span class="comment">// log message</span>
<a name="l02084"></a>02084   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced subsets diameter."</span>);
<a name="l02085"></a>02085 
<a name="l02086"></a>02086   <span class="comment">// set default returns &amp; test output args</span>
<a name="l02087"></a>02087   rc = <a class="code" href="group__PrivateGeometricRelations.html#gd5ee7780e249a1b8a390cd1a7eddc2ac">_fc_getDiameterOutputArgsTestSubsets</a>(diameter, numPair, pairIDs,
<a name="l02088"></a>02088                              pairSubsets);
<a name="l02089"></a>02089   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02090"></a>02090     <span class="keywordflow">return</span> rc;
<a name="l02091"></a>02091 
<a name="l02092"></a>02092   <span class="comment">// test input</span>
<a name="l02093"></a>02093   <span class="keywordflow">if</span> (numSubset &lt; 1 || !subsets || !displs) {
<a name="l02094"></a>02094     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02095"></a>02095     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02096"></a>02096   }
<a name="l02097"></a>02097   <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++) {
<a name="l02098"></a>02098     <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subsets[i], &amp;mesh);
<a name="l02099"></a>02099     <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subsets[i]) || 
<a name="l02100"></a>02100      !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, displs[i])) {
<a name="l02101"></a>02101       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02102"></a>02102       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02103"></a>02103     }
<a name="l02104"></a>02104   }
<a name="l02105"></a>02105 
<a name="l02106"></a>02106   <span class="comment">// do it</span>
<a name="l02107"></a>02107   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#gc3ff82fc255522698bef399215b8639b">_fc_getSubsetsDiameterCore</a>(numSubset, subsets, displs, diameter, 
<a name="l02108"></a>02108                         numPair, pairIDs, pairSubsets);
<a name="l02109"></a>02109 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ga4fb02306f46b1fbb7034d67d605aabe"></a><!-- doxytag: member="geom.c::fc_getDisplacedSubsetsProximity" ref="ga4fb02306f46b1fbb7034d67d605aabe" args="(FC_Subset subset1, FC_Variable displ1, FC_Subset subset2, FC_Variable displ2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSubsetsProximity           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh1VertIDs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh2VertIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the proximal vertices between two displaced subsets. 
<p>
<b>Description:</b> <p>
This returns all vertex pairs that are less than or equal to min_dist apart. Vertices may show up in more than one pair. (In the extrememe case if you put in min_dist = infinity, you would end up with each vertex being connected to all vertices of the other subset.)<p>
The routine can be forced to return "early", after the first match is found, if you use NULL for the last two arguments (the vertex arrays). In this case, the returned numPair is really a flag for whether a pair was found or not and will never be greater than 1 even if there are more than one possible pairs.<p>
Note, passing in min_dist = 0 will find overlapping vertices, or if subsets are on the same mesh, will find common vertices.<p>
Note, subsets may be closer together than any of the vertex pairs (imagine 1 vertex of one mesh very close to middle of a face of another mesh. the vert to face distance is less than distance to the face's verts).<p>
Will return if error if subset1 == subset2 AND displ1 == displ2. (subset1 can be the same as subset2 if displ1 != displ2)<p>
<b>Modifications:</b> <ul>
<li>02/14/2006 WSD Created.</li><li>03/14/2006 WSD guts common to all proximity routines to a common core routine.</li><li>03/16/2006 WSD changed behavior so that if NULLs are passed in for the vertIDs, will return after 1st match. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset1</em>&nbsp;</td><td>
input - the first subset </td></tr>
<tr><td valign="top"><em>displ1</em>&nbsp;</td><td>
input - the displacements on the mesh of the first subset </td></tr>
<tr><td valign="top"><em>subset2</em>&nbsp;</td><td>
input - the second subset </td></tr>
<tr><td valign="top"><em>displ2</em>&nbsp;</td><td>
input - the displacements on the mesh of the second subset </td></tr>
<tr><td valign="top"><em>min_dist</em>&nbsp;</td><td>
input - the distance cutoff </td></tr>
<tr><td valign="top"><em>numPair_p</em>&nbsp;</td><td>
output - the number of vertex pairs found </td></tr>
<tr><td valign="top"><em>mesh1VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh1 verts (order matters), user is responsible for freeing </td></tr>
<tr><td valign="top"><em>mesh2VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh2 verts (order matters), user is responsible for freeing </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05133">5133</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l05181">_fc_getSubsetsProximityArgsTest()</a>, <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l05146"></a>05146   {
<a name="l05147"></a>05147   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05148"></a>05148 
<a name="l05149"></a>05149   <span class="comment">// argument testing &amp; default returns</span>
<a name="l05150"></a>05150   rc = <a class="code" href="group__PrivateGeometricRelations.html#gd6f42749fc51c2c345947d616aea2c2e">_fc_getSubsetsProximityArgsTest</a>(NULL, &amp;subset1, &amp;displ1, NULL,
<a name="l05151"></a>05151                            &amp;subset2, &amp;displ2, min_dist, numPair_p,
<a name="l05152"></a>05152                            mesh1VertIDs_p, mesh2VertIDs_p);
<a name="l05153"></a>05153   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05154"></a>05154     <span class="keywordflow">return</span> rc;
<a name="l05155"></a>05155 
<a name="l05156"></a>05156   <span class="comment">// log message</span>
<a name="l05157"></a>05157   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced subsets proximity"</span>);
<a name="l05158"></a>05158 
<a name="l05159"></a>05159   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#gb8a027025dc64581aaf438723d9f62d8">_fc_getSubsetsProximityCore</a>(subset1, &amp;displ1, subset2, &amp;displ2,
<a name="l05160"></a>05160                          min_dist, numPair_p,
<a name="l05161"></a>05161                          mesh1VertIDs_p, mesh2VertIDs_p);
<a name="l05162"></a>05162 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g9ecba1f193ba8c621994332a5a0e4c29"></a><!-- doxytag: member="geom.c::fc_getDisplacedSubsetVolume" ref="g9ecba1f193ba8c621994332a5a0e4c29" args="(FC_Subset subs, int doStrict, FC_Variable coord_displ, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSubsetVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doStrict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a variable with the volume of the subset on the displaced mesh. 
<p>
<b>Description:</b> <p>
This will return with an error if the elements of the mesh are not 3D (e.g. it is an error to ask for volumes of a subset on a quad mesh).<p>
This routine uses fc_getDisplacedRegionVolumes and therefore has the same assumptions fc_getDisplacedRegionVolumes does.<p>
This routine uses fc_copySubsetWithNewAssociation to make a temporary intermediate subset with association FC_AT_ELEMENT. the "doStrict" input variable is for this call. See documentation there for further information.<p>
<b>Modifications:</b> <ul>
<li>12/06/04 ACG, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subs</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>doStrict</em>&nbsp;</td><td>
input - flag for dropping incomplete entities </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - volume of subset </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04240">4240</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="subset_8c-source.html#l00311">fc_copySubsetWithNewAssociation()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04543">fc_getVariableNumDataPoint()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="volumeSegments_8c-source.html#l00334">calcSegmentsVolumes()</a>.<div class="fragment"><pre class="fragment"><a name="l04245"></a>04245   {
<a name="l04246"></a>04246   <span class="keywordtype">int</span> k;
<a name="l04247"></a>04247   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l04248"></a>04248   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04249"></a>04249   <a class="code" href="structFC__Variable.html">FC_Variable</a> elemvols;
<a name="l04250"></a>04250   <a class="code" href="structFC__Subset.html">FC_Subset</a>  newSubset;
<a name="l04251"></a>04251   <span class="keywordtype">void</span>* actual_vols;
<a name="l04252"></a>04252   <span class="keywordtype">int</span> numDataPoint;
<a name="l04253"></a>04253   <span class="keywordtype">char</span> newSubsetName[20] = <span class="stringliteral">"junkSubset"</span>;
<a name="l04254"></a>04254   <span class="keywordtype">int</span> subsize;
<a name="l04255"></a>04255   <span class="keywordtype">int</span>* memarray;
<a name="l04256"></a>04256   <span class="keywordtype">double</span> vol = 0.0;
<a name="l04257"></a>04257 
<a name="l04258"></a>04258   <span class="comment">// default return</span>
<a name="l04259"></a>04259   <span class="keywordflow">if</span> (volume)
<a name="l04260"></a>04260     *volume = -1;
<a name="l04261"></a>04261 
<a name="l04262"></a>04262   <span class="comment">// test input</span>
<a name="l04263"></a>04263   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subs) || (doStrict != 0 &amp;&amp; doStrict != 1) ||
<a name="l04264"></a>04264       !volume) {
<a name="l04265"></a>04265     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04266"></a>04266     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04267"></a>04267   }
<a name="l04268"></a>04268   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subs, &amp;mesh);
<a name="l04269"></a>04269   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04270"></a>04270     <span class="keywordflow">return</span> rc;
<a name="l04271"></a>04271   <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ)) {
<a name="l04272"></a>04272     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04273"></a>04273     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04274"></a>04274   }
<a name="l04275"></a>04275 
<a name="l04276"></a>04276   <span class="comment">// log message</span>
<a name="l04277"></a>04277   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing displaced subset volume."</span>);
<a name="l04278"></a>04278 
<a name="l04279"></a>04279   <span class="comment">// get volumes of displaced regions of mesh</span>
<a name="l04280"></a>04280   rc = <a class="code" href="group__GeometricRelations.html#g05ba60b4aa725ef7d7938e64925ba75b">fc_getDisplacedRegionVolumes</a>(mesh, coord_displ, &amp;elemvols);
<a name="l04281"></a>04281   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04282"></a>04282     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04283"></a>04283     <span class="keywordflow">return</span> rc;
<a name="l04284"></a>04284   }
<a name="l04285"></a>04285 
<a name="l04286"></a>04286   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(elemvols,&amp;actual_vols);
<a name="l04287"></a>04287   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04288"></a>04288     <span class="comment">//    fc_printfErrorMessage("cant get actual vols");</span>
<a name="l04289"></a>04289     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04290"></a>04290     <span class="keywordflow">return</span> rc;
<a name="l04291"></a>04291   }
<a name="l04292"></a>04292 
<a name="l04293"></a>04293   <span class="comment">// just want to know how many there are for safety check below</span>
<a name="l04294"></a>04294   rc = <a class="code" href="group__Variable.html#gca6fc2e25075838bc8b2ef3a347efb20">fc_getVariableNumDataPoint</a>(elemvols, &amp;numDataPoint);
<a name="l04295"></a>04295   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04296"></a>04296     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04297"></a>04297     <span class="keywordflow">return</span> rc;
<a name="l04298"></a>04298   }
<a name="l04299"></a>04299 
<a name="l04300"></a>04300   rc = <a class="code" href="group__Subset.html#gb776198fa763b99d16d1512d1e75d818">fc_copySubsetWithNewAssociation</a>(subs, newSubsetName, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, 
<a name="l04301"></a>04301                            doStrict, &amp;newSubset);
<a name="l04302"></a>04302   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l04303"></a>04303     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04304"></a>04304     <span class="keywordflow">return</span> rc;
<a name="l04305"></a>04305   }
<a name="l04306"></a>04306 
<a name="l04307"></a>04307   <span class="comment">// next steps to match up subset elements with displaced mesh region vols</span>
<a name="l04308"></a>04308   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(newSubset, &amp;subsize, &amp;memarray);
<a name="l04309"></a>04309   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04310"></a>04310     <span class="comment">//    fc_printfErrorMessage("cant get subset members as array");</span>
<a name="l04311"></a>04311     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04312"></a>04312     rc = <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(newSubset);
<a name="l04313"></a>04313     free(memarray);
<a name="l04314"></a>04314     <span class="keywordflow">return</span> rc;
<a name="l04315"></a>04315   }
<a name="l04316"></a>04316 
<a name="l04317"></a>04317   vol = 0.0;
<a name="l04318"></a>04318   <span class="keywordflow">for</span> (k = 0; k &lt; subsize; k++)
<a name="l04319"></a>04319     vol += ((<span class="keywordtype">double</span> *)(actual_vols))[memarray[k]];
<a name="l04320"></a>04320 
<a name="l04321"></a>04321   <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04322"></a>04322   rc = <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(newSubset);
<a name="l04323"></a>04323   free(memarray);
<a name="l04324"></a>04324   *volume = vol;
<a name="l04325"></a>04325   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04326"></a>04326 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g907e473afb0077c1d57ce68fc7f7f010"></a><!-- doxytag: member="geom.c::fc_getDisplacedSurfaceNormals" ref="g907e473afb0077c1d57ce68fc7f7f010" args="(FC_Mesh mesh, FC_Variable displ, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getDisplacedSurfaceNormals           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute surface normals on all elements in a mesh. 
<p>
<b>Description:</b> <p>
Compute surface normals on all elements in a mesh after the mesh has been deformed by adding a displacement vector to the coordinates. See fc_getSurfaceNormals.<p>
<b>Modifications:</b> <ul>
<li>2003-JUL-01 W Koegler Created from fc_getSurfaceNormals</li><li>2003-SEP-04 W Koegler Moved calculation of displaced coords to its own function, fc_getDisplacedVertices. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh to compute surface normals of </td></tr>
<tr><td valign="top"><em>displ</em>&nbsp;</td><td>
input - coord displacment variable </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - new variable w/ surface normals as data </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04542">4542</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06901">_fc_calcSurfaceNormal()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="base_8c-source.html#l00549">fc_getElementTypeNumVertex()</a>, <a class="el" href="mesh_8c-source.html#l02981">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l04547"></a>04547 {
<a name="l04548"></a>04548   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04549"></a>04549   <span class="keywordtype">int</span> i, j, k;
<a name="l04550"></a>04550   <span class="keywordtype">double</span> *normals;
<a name="l04551"></a>04551   <a class="code" href="group__SimpleDataObjects.html#g84c64ce1a8b6f4beca59ee9140f3f109">FC_Vector</a> temp_normal;         <span class="comment">// normal vector an the element</span>
<a name="l04552"></a>04552   <span class="keywordtype">int</span> numElem, dim, numVertPerElem;
<a name="l04553"></a>04553   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l04554"></a>04554   <span class="keywordtype">double</span> *displ_coords; <span class="comment">// mesh's displaced coords</span>
<a name="l04555"></a>04555   <span class="keywordtype">int</span>* conns;
<a name="l04556"></a>04556   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> temp_vertices[4];
<a name="l04557"></a>04557 
<a name="l04558"></a>04558   <span class="comment">// default return</span>
<a name="l04559"></a>04559   <span class="keywordflow">if</span> (new_var)
<a name="l04560"></a>04560     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l04561"></a>04561   
<a name="l04562"></a>04562   <span class="comment">// check input</span>
<a name="l04563"></a>04563   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l04564"></a>04564       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, displ) || 
<a name="l04565"></a>04565       !new_var) {
<a name="l04566"></a>04566     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04567"></a>04567     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04568"></a>04568   }
<a name="l04569"></a>04569 
<a name="l04570"></a>04570   <span class="comment">// log message</span>
<a name="l04571"></a>04571   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting displaced surface normals."</span>);  
<a name="l04572"></a>04572   
<a name="l04573"></a>04573   <span class="comment">// get this meshes element info</span>
<a name="l04574"></a>04574   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, &amp;numElem, &amp;elemType);
<a name="l04575"></a>04575   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04576"></a>04576     <span class="keywordflow">return</span> rc;
<a name="l04577"></a>04577   rc = <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(mesh, &amp;conns);
<a name="l04578"></a>04578   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04579"></a>04579     <span class="keywordflow">return</span> rc;
<a name="l04580"></a>04580   numVertPerElem = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(elemType);
<a name="l04581"></a>04581  
<a name="l04582"></a>04582   <span class="comment">// get the displaced vertex list</span>
<a name="l04583"></a>04583   <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, displ, &amp;displ_coords);
<a name="l04584"></a>04584   
<a name="l04585"></a>04585   <span class="comment">// make space for the data array </span>
<a name="l04586"></a>04586   normals = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * dim * numElem);
<a name="l04587"></a>04587   <span class="keywordflow">if</span> (normals == NULL ) {
<a name="l04588"></a>04588     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l04589"></a>04589     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l04590"></a>04590   } 
<a name="l04591"></a>04591 
<a name="l04592"></a>04592   <span class="comment">// compute Surface normals, save in buffer</span>
<a name="l04593"></a>04593   <span class="keywordflow">for</span> (i = 0; i &lt; numElem; i++) {
<a name="l04594"></a>04594     <span class="comment">// make list of pointers to this elements vertices</span>
<a name="l04595"></a>04595     <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerElem; j++) {
<a name="l04596"></a>04596       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++)
<a name="l04597"></a>04597         temp_vertices[j][k] = displ_coords[conns[i*numVertPerElem+j]*dim + k];
<a name="l04598"></a>04598       <span class="keywordflow">for</span> (k = dim; k &lt; 3; k++)
<a name="l04599"></a>04599         temp_vertices[j][k] = 0.;
<a name="l04600"></a>04600     }
<a name="l04601"></a>04601 
<a name="l04602"></a>04602     <span class="comment">// calculate normal  </span>
<a name="l04603"></a>04603     <a class="code" href="group__PrivateGeometricRelations.html#g220950bef4a17b1ad88db87868459421">_fc_calcSurfaceNormal</a>(numVertPerElem, temp_vertices, &amp;temp_normal);
<a name="l04604"></a>04604     
<a name="l04605"></a>04605     <span class="comment">// save in array to make var</span>
<a name="l04606"></a>04606     <span class="keywordflow">for</span> (j = 0; j &lt; dim; j++) 
<a name="l04607"></a>04607       normals[i*dim+j] = temp_normal[j];
<a name="l04608"></a>04608   }
<a name="l04609"></a>04609   free(displ_coords);
<a name="l04610"></a>04610   
<a name="l04611"></a>04611   <span class="comment">// add new variable to current mesh</span>
<a name="l04612"></a>04612   <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"displacedSurfaceNormals"</span>, new_var);
<a name="l04613"></a>04613   <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numElem, dim, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, 
<a name="l04614"></a>04614                         <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, normals);
<a name="l04615"></a>04615   <span class="comment">// don't free normals</span>
<a name="l04616"></a>04616  
<a name="l04617"></a>04617   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04618"></a>04618 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g942ca3d5601ded5ad4f6cde5ff3ec767"></a><!-- doxytag: member="geom.c::fc_getEdgeLengths" ref="g942ca3d5601ded5ad4f6cde5ff3ec767" args="(FC_Mesh mesh, FC_Variable *edge_lengths)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getEdgeLengths           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>edge_lengths</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the edge lengths of the mesh. 
<p>
<b>Description:</b> <p>
If the mesh is made of 1D elements (i.e. lines)only lines, the length variable will be associated with the elements. Otherwise it will be associated with the edges of the mesh.<p>
This routine will return with an error if the elements of the mesh are not at least 2D (e.g. it is an error to ask for lengths of a point mesh)<p>
<b>Modifications:</b> <ul>
<li>02/03/04 WSK, Created to be more generally useful than fc_createEdgeMesh</li><li>08/23/04 WSK, Fixed bug: was failing for line mesh. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>edge_lengths</em>&nbsp;</td><td>
output - edge lengths variable handle </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03415">3415</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="geom_8c-source.html#l00116">fc_calcEuclideanDistance()</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02790">fc_getMeshEdgeConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="mesh_8c-source.html#l02380">fc_getMeshNumEdge()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="edgeStats_8c-source.html#l00063">get_and_print_lengths()</a>, and <a class="el" href="gaplines_8c-source.html#l00176">getMeshMaxEdgeLength()</a>.<div class="fragment"><pre class="fragment"><a name="l03418"></a>03418   {
<a name="l03419"></a>03419   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03420"></a>03420   <span class="keywordtype">int</span> i;
<a name="l03421"></a>03421   <span class="keywordtype">int</span> dim, numEdge;
<a name="l03422"></a>03422   <span class="keywordtype">double</span> *lengths;
<a name="l03423"></a>03423   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03424"></a>03424   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l03425"></a>03425   <span class="keywordtype">double</span>* coords;
<a name="l03426"></a>03426   <span class="keywordtype">int</span>* edgeConns;
<a name="l03427"></a>03427   
<a name="l03428"></a>03428   <span class="comment">// default return</span>
<a name="l03429"></a>03429   <span class="keywordflow">if</span> (edge_lengths) 
<a name="l03430"></a>03430     *edge_lengths = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03431"></a>03431 
<a name="l03432"></a>03432   <span class="comment">// check input</span>
<a name="l03433"></a>03433   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || edge_lengths == NULL) {
<a name="l03434"></a>03434     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03435"></a>03435     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03436"></a>03436   }
<a name="l03437"></a>03437     
<a name="l03438"></a>03438   <span class="comment">// log message</span>
<a name="l03439"></a>03439   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the edge lengths of the mesh."</span>);  
<a name="l03440"></a>03440 
<a name="l03441"></a>03441   <span class="comment">// setup &amp; more checking</span>
<a name="l03442"></a>03442   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, NULL, &amp;elemType);
<a name="l03443"></a>03443   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03444"></a>03444     <span class="keywordflow">return</span> rc;
<a name="l03445"></a>03445   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l03446"></a>03446   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03447"></a>03447     <span class="keywordflow">return</span> rc;
<a name="l03448"></a>03448   rc = <a class="code" href="group__Mesh.html#g0526437d03be312b52b0bbe8bc60a701">fc_getMeshNumEdge</a>(mesh, &amp;numEdge);
<a name="l03449"></a>03449   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03450"></a>03450     <span class="keywordflow">return</span> rc;
<a name="l03451"></a>03451   rc = <a class="code" href="group__Mesh.html#gf2e80f30f86823573a2a2e516234eab8">fc_getMeshEdgeConnsPtr</a>(mesh, &amp;edgeConns);
<a name="l03452"></a>03452   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03453"></a>03453     <span class="keywordflow">return</span> rc;
<a name="l03454"></a>03454   <span class="keywordflow">if</span> (numEdge &lt; 1 &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>) {
<a name="l03455"></a>03455     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03456"></a>03456     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03457"></a>03457   }
<a name="l03458"></a>03458   
<a name="l03459"></a>03459   <span class="comment">// compute edge lengths</span>
<a name="l03460"></a>03460   lengths = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * numEdge);
<a name="l03461"></a>03461   <span class="keywordflow">if</span> (lengths == NULL ) {
<a name="l03462"></a>03462     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03463"></a>03463     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03464"></a>03464   }
<a name="l03465"></a>03465   <span class="keywordflow">for</span> (i = 0; i &lt; numEdge; i++) 
<a name="l03466"></a>03466     <a class="code" href="group__GeometricRelations.html#gb2950eac8ed0ef2ea89db89bcac653c8">fc_calcEuclideanDistance</a>(&amp;coords[edgeConns[i*2]*dim],
<a name="l03467"></a>03467                              &amp;coords[edgeConns[i*2 + 1]*dim], 
<a name="l03468"></a>03468                              dim, &amp;lengths[i]);
<a name="l03469"></a>03469 
<a name="l03470"></a>03470   <span class="comment">// create new variable</span>
<a name="l03471"></a>03471   <span class="keywordflow">if</span> (elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4e17a2f7fa15c69d4f9c2f89ecbab0c18">FC_ET_LINE</a>)
<a name="l03472"></a>03472     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>;
<a name="l03473"></a>03473   <span class="keywordflow">else</span>
<a name="l03474"></a>03474     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fb5fd66bec9d026fbfab895c518842d4">FC_AT_EDGE</a>;
<a name="l03475"></a>03475   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"edge_lengths"</span>, edge_lengths);
<a name="l03476"></a>03476   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l03477"></a>03477     free(lengths);
<a name="l03478"></a>03478     <span class="keywordflow">return</span> rc;
<a name="l03479"></a>03479   }
<a name="l03480"></a>03480   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*edge_lengths, numEdge, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03481"></a>03481                              <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, lengths);
<a name="l03482"></a>03482   <span class="comment">// don't free lengths!</span>
<a name="l03483"></a>03483   
<a name="l03484"></a>03484   <span class="keywordflow">return</span> rc;
<a name="l03485"></a>03485 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g9f337bd2e04f0188991e127207a9abc3"></a><!-- doxytag: member="geom.c::fc_getEntitiesWithinBoundingBox" ref="g9f337bd2e04f0188991e127207a9abc3" args="(FC_Mesh mesh, FC_VertexBin *bin, FC_Coords lowpoint, FC_Coords highpoint, FC_AssociationType assoc, int *numEntity, int **entityIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getEntitiesWithinBoundingBox           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *&nbsp;</td>
          <td class="paramname"> <em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a>&nbsp;</td>
          <td class="paramname"> <em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numEntity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>entityIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find all entities within a bounding box. 
<p>
<b>Description:</b> <p>
Takes two points describing a bounding box and returns IDs of entities in a mesh that lie completely within the bounding box (and on it's boundary), regardless of the topology the mesh. To use this routine, you must first call fc_createMeshVertexBin or fc_createDisplacedMeshVertexBin to make the vertex bins used for searching<p>
The returned ID array is created by this routine, but it is the responsibility of the caller to free it.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000044">Todo:</a></b></dt><dd>add argument so user can request entities compeletely within range, or entities that are partially in range. </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000044">Todo:</a></b></dt><dd>Change routines to return a subset instead</dd></dl>
<b>Modifications:</b> <ul>
<li>10/27/04, WSK, Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>bin</em>&nbsp;</td><td>
input - vertex bin for the mesh </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
input - lower left corner of bounding box </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
input - upper left corner of bounding box </td></tr>
<tr><td valign="top"><em>assoc</em>&nbsp;</td><td>
input - type of entity </td></tr>
<tr><td valign="top"><em>numEntity</em>&nbsp;</td><td>
output - number of entities within sphere </td></tr>
<tr><td valign="top"><em>entityIDs</em>&nbsp;</td><td>
output - array of entity IDs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05704">5704</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06312">_fc_getVertexIDsWithinBoundingBoxUsingVertexBin()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040dc201b7d1982fc7cf126faa5d610fa25">FC_AT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00198">FC_AT_WHOLE_DATASET</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00285">fc_isAssociationTypeValid()</a>, <a class="el" href="geom_8c-source.html#l00444">fc_isBoundingBoxValid()</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, <a class="el" href="geom_8h-source.html#l00210">FC_VertexBin::mesh</a>, and <a class="el" href="geom_8h-source.html#l00212">FC_VertexBin::numDim</a>.<div class="fragment"><pre class="fragment"><a name="l05713"></a>05713 {
<a name="l05714"></a>05714   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05715"></a>05715   <span class="keywordtype">int</span> numVertex, *vertexIDs;            <span class="comment">// number &amp; IDs in sphere</span>
<a name="l05716"></a>05716 
<a name="l05717"></a>05717   <span class="comment">// default return</span>
<a name="l05718"></a>05718   <span class="keywordflow">if</span> (numEntity)
<a name="l05719"></a>05719     *numEntity = -1;
<a name="l05720"></a>05720   <span class="keywordflow">if</span> (entityIDs)
<a name="l05721"></a>05721     *entityIDs = NULL;
<a name="l05722"></a>05722   
<a name="l05723"></a>05723   <span class="comment">// check input</span>
<a name="l05724"></a>05724   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !bin || !<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(mesh, bin-&gt;<a class="code" href="structFC__VertexBin.html#6173abf5864ca8fe5a8c1cb1e2389868">mesh</a>) ||
<a name="l05725"></a>05725       !<a class="code" href="group__GeometricRelations.html#gecdc6fb052fa5d9dc695fcd6be58c808">fc_isBoundingBoxValid</a>(bin-&gt;<a class="code" href="structFC__VertexBin.html#37ad37b01247147eadf8f3301e7e6ba8">numDim</a>, lowpoint, highpoint) ||
<a name="l05726"></a>05726       !<a class="code" href="group__DataTypes.html#g8f5259ca911a1f9ec4cecf5762dc1913">fc_isAssociationTypeValid</a>(assoc) || assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040dc201b7d1982fc7cf126faa5d610fa25">FC_AT_UNKNOWN</a> || 
<a name="l05727"></a>05727       assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fea6eb08c0f82d61de1d1daab7c5d761">FC_AT_WHOLE_DATASET</a> || !numEntity || !entityIDs) {
<a name="l05728"></a>05728     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l05729"></a>05729     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05730"></a>05730   }
<a name="l05731"></a>05731   
<a name="l05732"></a>05732   <span class="comment">// log message</span>
<a name="l05733"></a>05733   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Finding entities within a bounding box."</span>);    
<a name="l05734"></a>05734 
<a name="l05735"></a>05735   <span class="comment">// get the vertices within radius</span>
<a name="l05736"></a>05736   rc = <a class="code" href="group__PrivateGeometricRelations.html#gbb478b2e19e43f21683d782908552341">_fc_getVertexIDsWithinBoundingBoxUsingVertexBin</a>(mesh, bin, lowpoint,
<a name="l05737"></a>05737                                    highpoint, &amp;numVertex, &amp;vertexIDs);
<a name="l05738"></a>05738   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05739"></a>05739     <span class="keywordflow">return</span> rc;
<a name="l05740"></a>05740 
<a name="l05741"></a>05741   <span class="comment">// if we asked for vertices, we are done!</span>
<a name="l05742"></a>05742   <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>) {
<a name="l05743"></a>05743     *numEntity = numVertex;
<a name="l05744"></a>05744     *entityIDs = vertexIDs;
<a name="l05745"></a>05745     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l05746"></a>05746   }
<a name="l05747"></a>05747 
<a name="l05748"></a>05748   <span class="comment">// convert to requested entity type</span>
<a name="l05749"></a>05749   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, numVertex, vertexIDs,
<a name="l05750"></a>05750                       assoc, 1, numEntity, entityIDs);
<a name="l05751"></a>05751   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05752"></a>05752     <span class="keywordflow">return</span> rc;
<a name="l05753"></a>05753 
<a name="l05754"></a>05754   <span class="comment">// cleanup</span>
<a name="l05755"></a>05755   free(vertexIDs);
<a name="l05756"></a>05756 
<a name="l05757"></a>05757   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l05758"></a>05758 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g77c54eb65c09c6f4d062ed151cd68208"></a><!-- doxytag: member="geom.c::fc_getEntitiesWithinSphere" ref="g77c54eb65c09c6f4d062ed151cd68208" args="(FC_Mesh mesh, FC_VertexBin *bin, FC_Coords center, double radius, FC_AssociationType assoc, int *numEntity, int **entityIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getEntitiesWithinSphere           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__VertexBin.html">FC_VertexBin</a> *&nbsp;</td>
          <td class="paramname"> <em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a>&nbsp;</td>
          <td class="paramname"> <em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numEntity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>entityIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find all entities within a sphere. 
<p>
<b>Description:</b> <p>
Takes a point and a radius, and returns IDs of entities in a mesh that lie completely within the radius of the point (i.e. the elements whose vertices all fall within the radius of the point), regardless of the topology the mesh. To use this routine, you must first call fc_createMeshVertexBin or fc_createDisplacedMeshVertexBin to make the vertex bins used for searching.<p>
The returned ID array is created by this routine, but it is the responsibility of the caller to free it.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000046">Todo:</a></b></dt><dd>add argument so user can request entities compeletely within range, or entities that are partially in range. </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000046">Todo:</a></b></dt><dd>Changed routines to return a subset instead</dd></dl>
<b>Modifications:</b> <ul>
<li>10/14/04 WSK, Created to replace fc_getVertexIDsWithinSphereUsingBertexBin and fc_getElementIDsWithinSphereUsingVertexBin with a more general purpose routine. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>bin</em>&nbsp;</td><td>
input - vertex bin for the mesh </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
input - center of the sphere </td></tr>
<tr><td valign="top"><em>radius</em>&nbsp;</td><td>
input - radius of the sphere </td></tr>
<tr><td valign="top"><em>assoc</em>&nbsp;</td><td>
input - type of entity </td></tr>
<tr><td valign="top"><em>numEntity</em>&nbsp;</td><td>
output - number of entities within sphere </td></tr>
<tr><td valign="top"><em>entityIDs</em>&nbsp;</td><td>
output - array of entity IDs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05786">5786</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06462">_fc_getVertexIDsWithinSphereUsingVertexBin()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040dc201b7d1982fc7cf126faa5d610fa25">FC_AT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="base_8h-source.html#l00198">FC_AT_WHOLE_DATASET</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00285">fc_isAssociationTypeValid()</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, and <a class="el" href="geom_8h-source.html#l00210">FC_VertexBin::mesh</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l06615">_fc_geomSmoothCore()</a>, and <a class="el" href="gaplines_8c-source.html#l00433">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05795"></a>05795 {
<a name="l05796"></a>05796   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05797"></a>05797   <span class="keywordtype">int</span> numVertex, *vertexIDs;            <span class="comment">// number &amp; IDs in sphere</span>
<a name="l05798"></a>05798 
<a name="l05799"></a>05799   <span class="comment">// default return</span>
<a name="l05800"></a>05800   <span class="keywordflow">if</span> (numEntity)
<a name="l05801"></a>05801     *numEntity = -1;
<a name="l05802"></a>05802   <span class="keywordflow">if</span> (entityIDs)
<a name="l05803"></a>05803     *entityIDs = NULL;
<a name="l05804"></a>05804   
<a name="l05805"></a>05805   <span class="comment">// check input</span>
<a name="l05806"></a>05806   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !bin || !<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(mesh, bin-&gt;<a class="code" href="structFC__VertexBin.html#6173abf5864ca8fe5a8c1cb1e2389868">mesh</a>) ||
<a name="l05807"></a>05807       !center || radius &lt; 0 || !<a class="code" href="group__DataTypes.html#g8f5259ca911a1f9ec4cecf5762dc1913">fc_isAssociationTypeValid</a>(assoc) || 
<a name="l05808"></a>05808       assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040dc201b7d1982fc7cf126faa5d610fa25">FC_AT_UNKNOWN</a> || assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040fea6eb08c0f82d61de1d1daab7c5d761">FC_AT_WHOLE_DATASET</a> || 
<a name="l05809"></a>05809       !numEntity || !entityIDs) {
<a name="l05810"></a>05810     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l05811"></a>05811     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l05812"></a>05812   }
<a name="l05813"></a>05813   
<a name="l05814"></a>05814   <span class="comment">// log message</span>
<a name="l05815"></a>05815   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Finding entities within a sphere."</span>);    
<a name="l05816"></a>05816 
<a name="l05817"></a>05817   <span class="comment">// get the vertices within radius</span>
<a name="l05818"></a>05818   rc = <a class="code" href="group__PrivateGeometricRelations.html#g1c8bf5ff4ee3b3907f79e9f1d6f1761b">_fc_getVertexIDsWithinSphereUsingVertexBin</a>(mesh, bin, center,
<a name="l05819"></a>05819                                    radius, &amp;numVertex, &amp;vertexIDs);
<a name="l05820"></a>05820   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05821"></a>05821     <span class="keywordflow">return</span> rc;
<a name="l05822"></a>05822 
<a name="l05823"></a>05823   <span class="comment">// if we asked for vertices, we are done!</span>
<a name="l05824"></a>05824   <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>) {
<a name="l05825"></a>05825     *numEntity = numVertex;
<a name="l05826"></a>05826     *entityIDs = vertexIDs;
<a name="l05827"></a>05827     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l05828"></a>05828   }
<a name="l05829"></a>05829 
<a name="l05830"></a>05830   <span class="comment">// convert to requested entity type</span>
<a name="l05831"></a>05831   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, numVertex, vertexIDs,
<a name="l05832"></a>05832                       assoc, 1, numEntity, entityIDs);
<a name="l05833"></a>05833   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05834"></a>05834     <span class="keywordflow">return</span> rc;
<a name="l05835"></a>05835 
<a name="l05836"></a>05836   <span class="comment">// cleanup</span>
<a name="l05837"></a>05837   free(vertexIDs);
<a name="l05838"></a>05838 
<a name="l05839"></a>05839   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l05840"></a>05840 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf2bc95dcfbc5842503038dfc47e43efa"></a><!-- doxytag: member="geom.c::fc_getFaceAreas" ref="gf2bc95dcfbc5842503038dfc47e43efa" args="(FC_Mesh mesh, FC_Variable *face_areas)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getFaceAreas           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>face_areas</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the face areas of the mesh. 
<p>
<b>Description:</b> <p>
If the mesh is made of 2D elements (i.e. tris and quads), the area variable will be associated with the elements. Otherwise it will be associated with the faces of the mesh.<p>
This routine will return with an error if the elements of the mesh are not at least 2D (e.g. it is an error to ask for areas of an edge mesh).<p>
This routine assumes that faces are planar.<p>
<b>Modifications:</b> <ul>
<li>08/23/04 WSK, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>face_areas</em>&nbsp;</td><td>
output - face areas variable handle </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03600">3600</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l07296">_fc_calcQuadArea()</a>, <a class="el" href="geom_8c-source.html#l07227">_fc_calcTriArea()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>, <a class="el" href="base_8c-source.html#l00384">fc_getElementTypeText()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02910">fc_getMeshFaceConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02841">fc_getMeshFaceTypesPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="mesh_8c-source.html#l02427">fc_getMeshNumFace()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l04344">fc_getSubsetArea()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l03603"></a>03603   {
<a name="l03604"></a>03604   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03605"></a>03605   <span class="keywordtype">int</span> i, j, k;
<a name="l03606"></a>03606   <span class="keywordtype">int</span> dim, numFace;
<a name="l03607"></a>03607   <span class="keywordtype">double</span> *areas;
<a name="l03608"></a>03608   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l03609"></a>03609   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType, *faceTypes;
<a name="l03610"></a>03610   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> coords[4];    <span class="comment">// buffer for coords</span>
<a name="l03611"></a>03611   <span class="keywordtype">double</span>* mesh_coords;    <span class="comment">// coords for entire mesh</span>
<a name="l03612"></a>03612   <span class="keywordtype">int</span> maxNumVertPerFace, *numVertPerFaces, *faceConns;
<a name="l03613"></a>03613   
<a name="l03614"></a>03614   <span class="comment">// default return</span>
<a name="l03615"></a>03615   <span class="keywordflow">if</span> (face_areas) 
<a name="l03616"></a>03616     *face_areas = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03617"></a>03617 
<a name="l03618"></a>03618   <span class="comment">// check input</span>
<a name="l03619"></a>03619   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || face_areas == NULL) {
<a name="l03620"></a>03620     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03621"></a>03621     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03622"></a>03622   }
<a name="l03623"></a>03623     
<a name="l03624"></a>03624   <span class="comment">// log message</span>
<a name="l03625"></a>03625   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the face areas of the mesh."</span>);  
<a name="l03626"></a>03626 
<a name="l03627"></a>03627   <span class="comment">// setup &amp; more checking</span>
<a name="l03628"></a>03628   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, NULL, &amp;elemType);
<a name="l03629"></a>03629   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03630"></a>03630     <span class="keywordflow">return</span> rc;
<a name="l03631"></a>03631   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;mesh_coords);
<a name="l03632"></a>03632   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03633"></a>03633     <span class="keywordflow">return</span> rc;
<a name="l03634"></a>03634   rc = <a class="code" href="group__Mesh.html#g0f4d7e58dc5936fc8f3824cbce0bf7c4">fc_getMeshNumFace</a>(mesh, &amp;numFace);
<a name="l03635"></a>03635   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03636"></a>03636     <span class="keywordflow">return</span> rc;
<a name="l03637"></a>03637   rc = <a class="code" href="group__Mesh.html#g216435eac0f72ad3ccb35e44b2df6ca5">fc_getMeshFaceConnsPtr</a>(mesh, &amp;numVertPerFaces, &amp;maxNumVertPerFace,
<a name="l03638"></a>03638                      &amp;faceConns);
<a name="l03639"></a>03639   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03640"></a>03640     <span class="keywordflow">return</span> rc;
<a name="l03641"></a>03641   rc = <a class="code" href="group__Mesh.html#g0d44e57289411649dd174c54bc25264a">fc_getMeshFaceTypesPtr</a>(mesh, &amp;faceTypes);
<a name="l03642"></a>03642   <span class="keywordflow">if</span> (numFace == 0 &amp;&amp; !(elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a> || elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>)) {
<a name="l03643"></a>03643     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03644"></a>03644     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03645"></a>03645   }
<a name="l03646"></a>03646   
<a name="l03647"></a>03647   <span class="comment">// compute face areas</span>
<a name="l03648"></a>03648   areas = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * numFace);
<a name="l03649"></a>03649   <span class="keywordflow">if</span> (areas == NULL ) {
<a name="l03650"></a>03650     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03651"></a>03651     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03652"></a>03652   } 
<a name="l03653"></a>03653   <span class="keywordflow">for</span> (i = 0; i &lt; numFace; i++) {
<a name="l03654"></a>03654     <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerFaces[i]; j++)
<a name="l03655"></a>03655       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++) 
<a name="l03656"></a>03656         coords[j][k] = mesh_coords[faceConns[i*maxNumVertPerFace+j]*dim+k];
<a name="l03657"></a>03657     <span class="keywordflow">switch</span> (faceTypes[i]) {
<a name="l03658"></a>03658     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>:   <a class="code" href="group__PrivateGeometricRelations.html#gd284766d3899ab073eaaf310d5835f12">_fc_calcTriArea</a>(dim, coords, &amp;areas[i]);   <span class="keywordflow">break</span>;
<a name="l03659"></a>03659     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>:  <a class="code" href="group__PrivateGeometricRelations.html#gb817182a39647bc03d2a0faaffab900d">_fc_calcQuadArea</a>(dim, coords, &amp;areas[i]);  <span class="keywordflow">break</span>;
<a name="l03660"></a>03660     <span class="keywordflow">default</span>:
<a name="l03661"></a>03661       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Unexpected face type %s encountered"</span>,
<a name="l03662"></a>03662                             <a class="code" href="group__DataTypes.html#gb3fcc2417d4e38eb3cbd511a42048acd">fc_getElementTypeText</a>(faceTypes[i]));
<a name="l03663"></a>03663       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03664"></a>03664     }
<a name="l03665"></a>03665   }
<a name="l03666"></a>03666 
<a name="l03667"></a>03667   <span class="comment">// create new variable</span>
<a name="l03668"></a>03668   <span class="keywordflow">if</span> (elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a> || elemType == <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>)
<a name="l03669"></a>03669     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>;
<a name="l03670"></a>03670   <span class="keywordflow">else</span>
<a name="l03671"></a>03671     assoc = <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>;
<a name="l03672"></a>03672   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"face_areas"</span>, face_areas);
<a name="l03673"></a>03673   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l03674"></a>03674     free(areas);
<a name="l03675"></a>03675     <span class="keywordflow">return</span> rc;
<a name="l03676"></a>03676   }
<a name="l03677"></a>03677   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*face_areas, numFace, 1, assoc, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, 
<a name="l03678"></a>03678                           <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, areas);
<a name="l03679"></a>03679   <span class="comment">// don't free areas! </span>
<a name="l03680"></a>03680   
<a name="l03681"></a>03681   <span class="keywordflow">return</span> rc;
<a name="l03682"></a>03682 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g2b4340615ac4674f35b401a11ea4cdbe"></a><!-- doxytag: member="geom.c::fc_getMeshBoundingBox" ref="g2b4340615ac4674f35b401a11ea4cdbe" args="(FC_Mesh mesh, int *numDim, FC_Coords *lowpoint, FC_Coords *highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getMeshBoundingBox           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute mesh bounding box. 
<p>
<b>Description:</b> <p>
The smallest bounding box (sides parallel to the coordinate axes) that fits around the entire mesh. It is described by two points: lowpoint is the smallest coordinates of the box, and highpoint is the largest coordinates of the box.<p>
Mesh entities may lie (some will by definition) on the boundary of the bounding box.<p>
<b>Modifications:</b> <ul>
<li>Nancy Collins Created.</li><li>July 3, 2002 W Koegler Adapted to modified _FC_Vertex\</li><li>July 9, 2002 W Koegler Adapted to modified struct Vector</li><li>2003-AUG-05 W Koegler changed to use doubles internally</li><li>04/19/04 WSK, Added return argument for number of dimensions </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh handle </td></tr>
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
output - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
output - lower left corner of bbox </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
output - upper right corner of bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00686">686</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l05522">fc_createMeshVertexBin()</a>, <a class="el" href="geom_8c-source.html#l00847">fc_getSubsetBoundingBox()</a>, and <a class="el" href="extents_8c-source.html#l00098">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00691"></a>00691   {
<a name="l00692"></a>00692   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00693"></a>00693   <span class="keywordtype">int</span> i, j;
<a name="l00694"></a>00694   <span class="keywordtype">int</span> numVertex;
<a name="l00695"></a>00695   <span class="keywordtype">double</span> *coords_p, temp;
<a name="l00696"></a>00696   <span class="comment">// must initalize all entries of coords to 0 in case numDim &lt; 3</span>
<a name="l00697"></a>00697   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> low = { 0., 0., 0. }, high = { 0., 0., 0. };
<a name="l00698"></a>00698 
<a name="l00699"></a>00699   <span class="comment">// set default output</span>
<a name="l00700"></a>00700   <span class="keywordflow">if</span> (numDim)
<a name="l00701"></a>00701     *numDim = -1;
<a name="l00702"></a>00702   <span class="keywordflow">if</span> (lowpoint) 
<a name="l00703"></a>00703     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00704"></a>00704       (*lowpoint)[i] = -1.;
<a name="l00705"></a>00705   <span class="keywordflow">if</span> (highpoint) 
<a name="l00706"></a>00706     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00707"></a>00707       (*highpoint)[i] = -2.; <span class="comment">// makes bb invalid</span>
<a name="l00708"></a>00708 
<a name="l00709"></a>00709   <span class="comment">// check input</span>
<a name="l00710"></a>00710   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !numDim || !lowpoint || !highpoint) {
<a name="l00711"></a>00711     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00712"></a>00712     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00713"></a>00713   }
<a name="l00714"></a>00714 
<a name="l00715"></a>00715   <span class="comment">// log message</span>
<a name="l00716"></a>00716   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing mesh bounding box."</span>);  
<a name="l00717"></a>00717 
<a name="l00718"></a>00718   <span class="comment">// setup</span>
<a name="l00719"></a>00719   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, numDim, &amp;numVertex, NULL, NULL);
<a name="l00720"></a>00720   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00721"></a>00721     <span class="keywordflow">return</span> rc;
<a name="l00722"></a>00722   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l00723"></a>00723   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00724"></a>00724     <span class="keywordflow">return</span> rc;
<a name="l00725"></a>00725   
<a name="l00726"></a>00726   <span class="comment">// initialize  - start with 1st point</span>
<a name="l00727"></a>00727   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++) 
<a name="l00728"></a>00728     low[i] = high[i] = coords_p[i];
<a name="l00729"></a>00729   
<a name="l00730"></a>00730   <span class="comment">// find min &amp; max in each dim</span>
<a name="l00731"></a>00731   <span class="keywordflow">for</span> (i = 1; i &lt; numVertex; i++) {
<a name="l00732"></a>00732     <span class="keywordflow">for</span> (j = 0; j &lt; *numDim; j++) {
<a name="l00733"></a>00733       temp = coords_p[i*(*numDim)+j];
<a name="l00734"></a>00734       <span class="keywordflow">if</span> (temp &lt; low[j])
<a name="l00735"></a>00735         low[j] = temp;
<a name="l00736"></a>00736       <span class="keywordflow">if</span> (temp &gt; high[j])
<a name="l00737"></a>00737         high[j] = temp;
<a name="l00738"></a>00738     }
<a name="l00739"></a>00739   }
<a name="l00740"></a>00740 
<a name="l00741"></a>00741   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++) {
<a name="l00742"></a>00742     (*lowpoint)[i] = low[i];
<a name="l00743"></a>00743     (*highpoint)[i] = high[i];
<a name="l00744"></a>00744   }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00747"></a>00747 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g25e99a690489a8e823cae6b9afc1ee65"></a><!-- doxytag: member="geom.c::fc_getMeshCentroid" ref="g25e99a690489a8e823cae6b9afc1ee65" args="(FC_Mesh mesh, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getMeshCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute centroid of mesh. 
<p>
<b>Description:</b> <p>
The centroid is the geometric center of the mesh and is calculated by averaging the coordinates in each dimension. Also called center of mass or center of gravity.<p>
<b>Modifications:</b> <ul>
<li>Wendy Koegler Created.</li><li>July 3, 2002 W. Koegler removed dependence on var</li><li>July 3, 2002 W Koegler Adapted to modified _FC_Vertex</li><li>July 9, 2002 W Koegler Adapted to modified struct Vector</li><li>2003-AUG-05 W Koegler Changed to use doubles internally</li><li>10/29/04 WSK, added 'mesh' to name &amp; added dim to returned arg. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh id </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of coords </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02590">2590</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l02940">fc_getSubsetCentroid()</a>.<div class="fragment"><pre class="fragment"><a name="l02594"></a>02594   {
<a name="l02595"></a>02595   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02596"></a>02596   <span class="keywordtype">int</span> i, j;
<a name="l02597"></a>02597   <span class="keywordtype">int</span> numDim, numVertex;
<a name="l02598"></a>02598   <span class="keywordtype">double</span> *coords_p;
<a name="l02599"></a>02599   <span class="keywordtype">double</span> coords_sum[3];
<a name="l02600"></a>02600   
<a name="l02601"></a>02601   <span class="comment">// default</span>
<a name="l02602"></a>02602   <span class="keywordflow">if</span> (dim)
<a name="l02603"></a>02603     *dim = -1;
<a name="l02604"></a>02604   <span class="keywordflow">if</span> (center) {
<a name="l02605"></a>02605     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02606"></a>02606       (*center)[i] = -1.;
<a name="l02607"></a>02607   }
<a name="l02608"></a>02608 
<a name="l02609"></a>02609   <span class="comment">// check input</span>
<a name="l02610"></a>02610   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !dim || !center) {
<a name="l02611"></a>02611     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02612"></a>02612     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02613"></a>02613   }
<a name="l02614"></a>02614 
<a name="l02615"></a>02615   <span class="comment">// log message</span>
<a name="l02616"></a>02616   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing mesh centroid."</span>);  
<a name="l02617"></a>02617   
<a name="l02618"></a>02618   <span class="comment">// get vertices </span>
<a name="l02619"></a>02619   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l02620"></a>02620   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02621"></a>02621     <span class="keywordflow">return</span> rc;
<a name="l02622"></a>02622   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l02623"></a>02623   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) 
<a name="l02624"></a>02624     <span class="keywordflow">return</span> rc;
<a name="l02625"></a>02625   
<a name="l02626"></a>02626   <span class="comment">// calculate coordinate sums</span>
<a name="l02627"></a>02627   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02628"></a>02628     coords_sum[i] = 0.;
<a name="l02629"></a>02629   
<a name="l02630"></a>02630   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++)
<a name="l02631"></a>02631     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l02632"></a>02632       coords_sum[j] += coords_p[i*numDim + j];
<a name="l02633"></a>02633   
<a name="l02634"></a>02634   <span class="comment">// calculate centroids</span>
<a name="l02635"></a>02635   *dim = numDim;
<a name="l02636"></a>02636   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l02637"></a>02637     (*center)[i] = coords_sum[i]/numVertex;
<a name="l02638"></a>02638   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l02639"></a>02639     (*center)[i] = 0.;
<a name="l02640"></a>02640   
<a name="l02641"></a>02641   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l02642"></a>02642 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g4d0810ecf214489a94f56073aa141164"></a><!-- doxytag: member="geom.c::fc_getMeshDiameter" ref="g4d0810ecf214489a94f56073aa141164" args="(FC_Mesh mesh, double *diameter, int *numPair, int **pairIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getMeshDiameter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a mesh. 
<p>
The diameter of a set of points is the maximum distance between any two points in the set. (It is also the diameter of the mimimum area circle circumscribing the set of points). This routine returns the diameter of the set of vertices that make up the mesh.<p>
If requested, this routine will also return the IDs of the vertices that determined the diameter. There may be multiple point pairs that have the same distance, so the number of pairs is returned and an array which lists the first pair, then the next, etc.<p>
<b>Modifications:</b> <ul>
<li>6/27/05 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - A mesh </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01649">1649</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02127">_fc_getDiameterOutputArgsTest()</a>, <a class="el" href="geom_8c-source.html#l02256">_fc_getSubsetDiameterCore()</a>, <a class="el" href="subset_8c-source.html#l01178">fc_addMemberToSubset()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l01655"></a>01655   {
<a name="l01656"></a>01656   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01657"></a>01657   <a class="code" href="structFC__Subset.html">FC_Subset</a> subset;
<a name="l01658"></a>01658 
<a name="l01659"></a>01659   <span class="comment">// log message</span>
<a name="l01660"></a>01660   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing mesh diameter."</span>);
<a name="l01661"></a>01661 
<a name="l01662"></a>01662   <span class="comment">// set default returns &amp; test output args</span>
<a name="l01663"></a>01663   rc = <a class="code" href="group__PrivateGeometricRelations.html#ge6ea8457b23e18e1945b23fe328fbbd1">_fc_getDiameterOutputArgsTest</a>(diameter, numPair, pairIDs);
<a name="l01664"></a>01664   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01665"></a>01665     <span class="keywordflow">return</span> rc;
<a name="l01666"></a>01666 
<a name="l01667"></a>01667   <span class="comment">// test input</span>
<a name="l01668"></a>01668   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh)) {
<a name="l01669"></a>01669     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01670"></a>01670     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01671"></a>01671   }
<a name="l01672"></a>01672 
<a name="l01673"></a>01673   <span class="comment">// Create subset that is whole</span>
<a name="l01674"></a>01674   rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subset);
<a name="l01675"></a>01675   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01676"></a>01676     <span class="keywordflow">return</span> rc;
<a name="l01677"></a>01677   rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subset, 0);
<a name="l01678"></a>01678   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01679"></a>01679     <span class="keywordflow">return</span> rc;
<a name="l01680"></a>01680 
<a name="l01681"></a>01681   <span class="comment">// Send to core getSubsetDiameter code</span>
<a name="l01682"></a>01682   rc = <a class="code" href="group__PrivateGeometricRelations.html#g7b6c20a9dc1adb93878b76c326d656ac">_fc_getSubsetDiameterCore</a>(subset, NULL, diameter, numPair, pairIDs);
<a name="l01683"></a>01683 
<a name="l01684"></a>01684   <span class="comment">// Cleanup &amp; return</span>
<a name="l01685"></a>01685   <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subset);
<a name="l01686"></a>01686   <span class="keywordflow">return</span> rc;
<a name="l01687"></a>01687 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ga827e7709fded608a7de79dde212552d"></a><!-- doxytag: member="geom.c::fc_getMeshesDiameter" ref="ga827e7709fded608a7de79dde212552d" args="(int numMesh, FC_Mesh *meshes, double *diameter, int *numPair, int **pairIDs, FC_Mesh **pairMeshes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getMeshesDiameter           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> *&nbsp;</td>
          <td class="paramname"> <em>meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a> **&nbsp;</td>
          <td class="paramname"> <em>pairMeshes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a group of meshes. 
<p>
The diameter of a set of points is the maximum distance between any two points in the set. (It is also the diameter of the mimimum area circle circumscribing the set of points). This routine returns the diameter of the set of vertices that make up a group of meshes.<p>
If requested, this routine will also return the IDs of the vertices that determined the diameter. There may be multiple point pairs that have the same distance, so the number of pairs is returned and two arrays which identify the pairs. The pairIDs list the vertex IDs (local to a mesh) for the first pair, then the next pair. The pairMeshes is the originating mesh for each vertex in pairIDs.<p>
<b>Modifications:</b> <ul>
<li>3/9/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numMesh</em>&nbsp;</td><td>
input - number of meshes </td></tr>
<tr><td valign="top"><em>meshes</em>&nbsp;</td><td>
input - Array of meshes </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairMeshes</em>&nbsp;</td><td>
output - the meshes of the pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01841">1841</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02165">_fc_getDiameterOutputArgsTestMeshes()</a>, <a class="el" href="geom_8c-source.html#l02382">_fc_getSubsetsDiameterCore()</a>, <a class="el" href="subset_8c-source.html#l01178">fc_addMemberToSubset()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l01849"></a>01849   {
<a name="l01850"></a>01850   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01851"></a>01851   <span class="keywordtype">int</span> i;
<a name="l01852"></a>01852   <a class="code" href="structFC__Subset.html">FC_Subset</a>* subsets, *pairSubs;
<a name="l01853"></a>01853 
<a name="l01854"></a>01854   <span class="comment">// log message</span>
<a name="l01855"></a>01855   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing meshes diameter."</span>);
<a name="l01856"></a>01856 
<a name="l01857"></a>01857   <span class="comment">// set default returns &amp; test output args</span>
<a name="l01858"></a>01858   rc = <a class="code" href="group__PrivateGeometricRelations.html#gf5861c53412f3b68b23d9279d1b83da0">_fc_getDiameterOutputArgsTestMeshes</a>(diameter, numPair, pairIDs,
<a name="l01859"></a>01859                             pairMeshes);
<a name="l01860"></a>01860   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01861"></a>01861     <span class="keywordflow">return</span> rc;
<a name="l01862"></a>01862 
<a name="l01863"></a>01863   <span class="comment">// test input</span>
<a name="l01864"></a>01864   <span class="keywordflow">if</span> (numMesh &lt; 1 || !meshes) {
<a name="l01865"></a>01865     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01866"></a>01866     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01867"></a>01867   }
<a name="l01868"></a>01868   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l01869"></a>01869     <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(meshes[i])) {
<a name="l01870"></a>01870       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01871"></a>01871       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01872"></a>01872     }
<a name="l01873"></a>01873   }
<a name="l01874"></a>01874 
<a name="l01875"></a>01875   <span class="comment">// Create subsets that are whole</span>
<a name="l01876"></a>01876   subsets = (<a class="code" href="structFC__Subset.html">FC_Subset</a>*)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Subset.html">FC_Subset</a>));
<a name="l01877"></a>01877   <span class="keywordflow">if</span> (!subsets) {
<a name="l01878"></a>01878     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01879"></a>01879     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01880"></a>01880   }
<a name="l01881"></a>01881   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++) {
<a name="l01882"></a>01882     rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(meshes[i], <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subsets[i]);
<a name="l01883"></a>01883     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01884"></a>01884       <span class="keywordflow">return</span> rc;
<a name="l01885"></a>01885     rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subsets[i], 0);
<a name="l01886"></a>01886     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01887"></a>01887       <span class="keywordflow">return</span> rc;
<a name="l01888"></a>01888   }
<a name="l01889"></a>01889 
<a name="l01890"></a>01890   <span class="comment">// Send to core getSubsetsDiameter code</span>
<a name="l01891"></a>01891   rc = <a class="code" href="group__PrivateGeometricRelations.html#gc3ff82fc255522698bef399215b8639b">_fc_getSubsetsDiameterCore</a>(numMesh, subsets, NULL, diameter, numPair, 
<a name="l01892"></a>01892                       pairIDs, &amp;pairSubs);
<a name="l01893"></a>01893 
<a name="l01894"></a>01894   <span class="comment">// convert pairSubs to pairMeshes</span>
<a name="l01895"></a>01895   <span class="keywordflow">if</span> (rc == <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a> &amp;&amp; numPair &amp;&amp; *numPair &gt; 0) {
<a name="l01896"></a>01896     <a class="code" href="structFC__Mesh.html">FC_Mesh</a> *subMeshes;
<a name="l01897"></a>01897     subMeshes = (<a class="code" href="structFC__Mesh.html">FC_Mesh</a>*)malloc(2*(*numPair)*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Mesh.html">FC_Mesh</a>));
<a name="l01898"></a>01898     <span class="keywordflow">if</span> (!meshes) {
<a name="l01899"></a>01899       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01900"></a>01900       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01901"></a>01901     }
<a name="l01902"></a>01902     <span class="keywordflow">for</span> (i = 0; i &lt; 2*(*numPair); i++) {
<a name="l01903"></a>01903       rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(pairSubs[i], &amp;subMeshes[i]);
<a name="l01904"></a>01904       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01905"></a>01905       <span class="keywordflow">return</span> rc;
<a name="l01906"></a>01906     }
<a name="l01907"></a>01907     *pairMeshes = subMeshes;
<a name="l01908"></a>01908     free(pairSubs);
<a name="l01909"></a>01909   }
<a name="l01910"></a>01910 
<a name="l01911"></a>01911   <span class="comment">// Cleanup &amp; return</span>
<a name="l01912"></a>01912   <span class="keywordflow">for</span> (i = 0; i &lt; numMesh; i++)
<a name="l01913"></a>01913     <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subsets[i]);
<a name="l01914"></a>01914   free(subsets);
<a name="l01915"></a>01915 
<a name="l01916"></a>01916   <span class="keywordflow">return</span> rc;
<a name="l01917"></a>01917 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd1dec7883e2d655b16909d6527052850"></a><!-- doxytag: member="geom.c::fc_getMeshesProximity" ref="gd1dec7883e2d655b16909d6527052850" args="(FC_Mesh mesh1, FC_Mesh mesh2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getMeshesProximity           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh1VertIDs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh2VertIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the proximal vertices between two meshes. 
<p>
<b>Description:</b> <p>
This returns all vertex pairs that are less than or equal to min_dist apart. Vertices may show up in more than one pair. (In the extrememe case if you put in min_dist = infinity, you would end up with each vertex being connected to all vertices of the other mesh.)<p>
The routine can be forced to return "early", after the first match is found, if you use NULL for the last two arguments (the vertex arrays). In this case, the returned numPair is really a flag for whether a pair was found or not and will never be greater than 1 even if there are more than one possible pairs.<p>
Note, passing in min_dist = 0 will find overlapping vertices.<p>
Note, meshes may be closer together than any of the vertex pairs (imagine 1 vertex of one mesh very close to middle of a face of another mesh. the vert to face distance is less than distance to the face's verts).<p>
Will return if error if mesh1 == mesh2.<p>
<b>Modifications:</b> <ul>
<li>02/13/2006 WSD Created.</li><li>03/14/2006 WSD guts common to all proximity routines to a common core routine.</li><li>03/16/2006 WSD changed behavior so that if NULLs are passed in for the vertIDs, will return after 1st match. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh1</em>&nbsp;</td><td>
input - the first mesh </td></tr>
<tr><td valign="top"><em>mesh2</em>&nbsp;</td><td>
input - the second mesh </td></tr>
<tr><td valign="top"><em>min_dist</em>&nbsp;</td><td>
input - the distance cutoff </td></tr>
<tr><td valign="top"><em>numPair_p</em>&nbsp;</td><td>
output - the number of vertex pairs found </td></tr>
<tr><td valign="top"><em>mesh1VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh1 verts (order matters), user is responsible for freeing </td></tr>
<tr><td valign="top"><em>mesh2VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh2 verts (order matters), user is responsible for freeing </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04897">4897</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l05181">_fc_getSubsetsProximityArgsTest()</a>, <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="subset_8c-source.html#l01178">fc_addMemberToSubset()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l04906"></a>04906   {
<a name="l04907"></a>04907   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04908"></a>04908   <a class="code" href="structFC__Subset.html">FC_Subset</a> subset1, subset2;
<a name="l04909"></a>04909 
<a name="l04910"></a>04910   <span class="comment">// argument testing &amp; default returns</span>
<a name="l04911"></a>04911   rc = <a class="code" href="group__PrivateGeometricRelations.html#gd6f42749fc51c2c345947d616aea2c2e">_fc_getSubsetsProximityArgsTest</a>(&amp;mesh1, NULL, NULL, &amp;mesh2,
<a name="l04912"></a>04912                            NULL, NULL, min_dist, numPair_p,
<a name="l04913"></a>04913                            mesh1VertIDs_p, mesh2VertIDs_p);
<a name="l04914"></a>04914   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04915"></a>04915     <span class="keywordflow">return</span> rc;
<a name="l04916"></a>04916 
<a name="l04917"></a>04917   <span class="comment">// log message</span>
<a name="l04918"></a>04918   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing meshes proximity"</span>);
<a name="l04919"></a>04919 
<a name="l04920"></a>04920   <span class="comment">// convert to subsets (WHOLE_MESH)</span>
<a name="l04921"></a>04921   rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh1, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subset1);
<a name="l04922"></a>04922   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04923"></a>04923     <span class="keywordflow">return</span> rc;
<a name="l04924"></a>04924   rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subset1, 0);
<a name="l04925"></a>04925   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04926"></a>04926     <span class="keywordflow">return</span> rc;
<a name="l04927"></a>04927   rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh2, <span class="stringliteral">"temp"</span>, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, &amp;subset2);
<a name="l04928"></a>04928   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04929"></a>04929     <span class="keywordflow">return</span> rc;
<a name="l04930"></a>04930   rc = <a class="code" href="group__Subset.html#gf105b25f063533c8bdc24a6e0f1d1002">fc_addMemberToSubset</a>(subset2, 0);
<a name="l04931"></a>04931   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04932"></a>04932     <span class="keywordflow">return</span> rc;
<a name="l04933"></a>04933 
<a name="l04934"></a>04934   <span class="comment">// do it</span>
<a name="l04935"></a>04935   rc = <a class="code" href="group__PrivateGeometricRelations.html#gb8a027025dc64581aaf438723d9f62d8">_fc_getSubsetsProximityCore</a>(subset1, NULL, subset2, NULL, min_dist, 
<a name="l04936"></a>04936                        numPair_p, mesh1VertIDs_p, mesh2VertIDs_p);
<a name="l04937"></a>04937 
<a name="l04938"></a>04938   <span class="comment">// cleanup</span>
<a name="l04939"></a>04939   <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subset1);
<a name="l04940"></a>04940   <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(subset2);
<a name="l04941"></a>04941 
<a name="l04942"></a>04942   <span class="keywordflow">return</span> rc;
<a name="l04943"></a>04943 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g417caea8baaef8a0a90964ea0af9fa40"></a><!-- doxytag: member="geom.c::fc_getMeshVolume" ref="g417caea8baaef8a0a90964ea0af9fa40" args="(FC_Mesh mesh, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getMeshVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the volume of the mesh. 
<p>
<b>Description:</b> <p>
This will return with an error and volume = -1 if the elements of the mesh are not 3D (e.g. it is an error to ask for volumes of a quad mesh).<p>
This routine uses fc_getRegionVolumes and therefore has the same assumptions fc_getRegionVolumes does.<p>
<b>Modifications:</b> <ul>
<li>11/23/04 ACG, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - volume of mesh </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04004">4004</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="geom_8c-source.html#l03808">fc_getRegionVolumes()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="statistics_8c-source.html#l00303">fc_getVariableSum()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="volumeSegments_8c-source.html#l00334">calcSegmentsVolumes()</a>.<div class="fragment"><pre class="fragment"><a name="l04007"></a>04007   {
<a name="l04008"></a>04008 
<a name="l04009"></a>04009   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04010"></a>04010   <a class="code" href="structFC__Variable.html">FC_Variable</a> elemvols;
<a name="l04011"></a>04011   <span class="keywordtype">double</span> vol;
<a name="l04012"></a>04012 
<a name="l04013"></a>04013   <span class="comment">// log message</span>
<a name="l04014"></a>04014   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Calculating volume of mesh"</span>);
<a name="l04015"></a>04015 
<a name="l04016"></a>04016 
<a name="l04017"></a>04017   <span class="comment">// default return</span>
<a name="l04018"></a>04018   <span class="keywordflow">if</span> (volume)
<a name="l04019"></a>04019     *volume = -1;
<a name="l04020"></a>04020 
<a name="l04021"></a>04021   <span class="comment">// test input</span>
<a name="l04022"></a>04022   <span class="keywordflow">if</span> (!volume) {
<a name="l04023"></a>04023     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04024"></a>04024     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04025"></a>04025   }
<a name="l04026"></a>04026 
<a name="l04027"></a>04027   <span class="comment">//this will test if mesh is valid</span>
<a name="l04028"></a>04028   rc = <a class="code" href="group__GeometricRelations.html#gf7687aa264403fd9234d8b1ff133a6b7">fc_getRegionVolumes</a>(mesh,&amp;elemvols);
<a name="l04029"></a>04029   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04030"></a>04030     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04031"></a>04031     <span class="keywordflow">return</span> rc;
<a name="l04032"></a>04032   }
<a name="l04033"></a>04033   rc = <a class="code" href="group__Statistics.html#ge08935af09502122f5f080bb2eb952a3">fc_getVariableSum</a>(elemvols,&amp;vol);
<a name="l04034"></a>04034   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04035"></a>04035     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04036"></a>04036     <span class="keywordflow">return</span> rc;
<a name="l04037"></a>04037   }
<a name="l04038"></a>04038 
<a name="l04039"></a>04039   <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04040"></a>04040   *volume = vol;
<a name="l04041"></a>04041   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04042"></a>04042 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gf7687aa264403fd9234d8b1ff133a6b7"></a><!-- doxytag: member="geom.c::fc_getRegionVolumes" ref="gf7687aa264403fd9234d8b1ff133a6b7" args="(FC_Mesh mesh, FC_Variable *region_volumes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getRegionVolumes           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>region_volumes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a variable with the region volumes of the mesh. 
<p>
<b>Description:</b> <p>
This will return with an error if the elements of the mesh are not 3D (e.g. it is an error to ask for volumes of a quad mesh).<p>
This routine assumes that the faces of the regions are planar.<p>
<b>Modifications:</b> <ul>
<li>08/23/04 WSK, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>region_volumes</em>&nbsp;</td><td>
output - region volumes variable handle </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03808">3808</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l07456">_fc_calcHexVolume()</a>, <a class="el" href="geom_8c-source.html#l07416">_fc_calcPrismVolume()</a>, <a class="el" href="geom_8c-source.html#l07375">_fc_calcPyramidVolume()</a>, <a class="el" href="geom_8c-source.html#l07344">_fc_calcTetVolume()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a>, <a class="el" href="base_8c-source.html#l00549">fc_getElementTypeNumVertex()</a>, <a class="el" href="base_8c-source.html#l00384">fc_getElementTypeText()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02981">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l04004">fc_getMeshVolume()</a>, <a class="el" href="geom_8c-source.html#l04129">fc_getSubsetVolume()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l03811"></a>03811   {
<a name="l03812"></a>03812   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03813"></a>03813   <span class="keywordtype">int</span> i, j, k;
<a name="l03814"></a>03814   <span class="keywordtype">int</span> dim, numElement, numVertPerElem;
<a name="l03815"></a>03815   <span class="keywordtype">double</span> *vols;
<a name="l03816"></a>03816   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l03817"></a>03817   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> points[8];    <span class="comment">// buffer for coords</span>
<a name="l03818"></a>03818   <span class="keywordtype">double</span>* coords;
<a name="l03819"></a>03819   <span class="keywordtype">int</span>* conns;
<a name="l03820"></a>03820 
<a name="l03821"></a>03821   <span class="comment">// default return</span>
<a name="l03822"></a>03822   <span class="keywordflow">if</span> (region_volumes) 
<a name="l03823"></a>03823     *region_volumes = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l03824"></a>03824   
<a name="l03825"></a>03825   <span class="comment">// check input</span>
<a name="l03826"></a>03826   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || region_volumes == NULL) {
<a name="l03827"></a>03827     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03828"></a>03828     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03829"></a>03829   }
<a name="l03830"></a>03830   
<a name="l03831"></a>03831   <span class="comment">// log message</span>
<a name="l03832"></a>03832   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Getting the region volumes of the mesh."</span>);  
<a name="l03833"></a>03833   
<a name="l03834"></a>03834   <span class="comment">// setup &amp; more checking</span>
<a name="l03835"></a>03835   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, &amp;numElement, &amp;elemType);
<a name="l03836"></a>03836   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03837"></a>03837     <span class="keywordflow">return</span> rc;
<a name="l03838"></a>03838   <span class="keywordflow">if</span> (elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a> &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a> &amp;&amp; 
<a name="l03839"></a>03839       elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a> &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>) {
<a name="l03840"></a>03840     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03841"></a>03841     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03842"></a>03842   }
<a name="l03843"></a>03843   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l03844"></a>03844   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03845"></a>03845     <span class="keywordflow">return</span> rc;
<a name="l03846"></a>03846   rc = <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(mesh, &amp;conns);
<a name="l03847"></a>03847   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03848"></a>03848     <span class="keywordflow">return</span> rc;
<a name="l03849"></a>03849   numVertPerElem = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(elemType);
<a name="l03850"></a>03850   
<a name="l03851"></a>03851   <span class="comment">// compute element volumes</span>
<a name="l03852"></a>03852   vols = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * numElement);
<a name="l03853"></a>03853   <span class="keywordflow">if</span> (vols == NULL ) {
<a name="l03854"></a>03854     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l03855"></a>03855     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l03856"></a>03856   } 
<a name="l03857"></a>03857   <span class="keywordflow">for</span> (i = 0; i &lt; numElement; i++) {
<a name="l03858"></a>03858     <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerElem; j++)
<a name="l03859"></a>03859       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++) 
<a name="l03860"></a>03860         points[j][k] = coords[conns[i*numVertPerElem+j]*dim+k];
<a name="l03861"></a>03861     <span class="keywordflow">switch</span> (elemType) {
<a name="l03862"></a>03862     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b493889d88ac4d5cbd3f0c5b6ddcb7022d">FC_ET_TET</a>:      <a class="code" href="group__PrivateGeometricRelations.html#g52628920b39574a4fa2280913ace4046">_fc_calcTetVolume</a>(points, &amp;vols[i]);      <span class="keywordflow">break</span>;
<a name="l03863"></a>03863     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b43b1aa291ea6a8432b07075f53b38756d">FC_ET_PYRAMID</a>:  <a class="code" href="group__PrivateGeometricRelations.html#g687b2ddb6667e3f37189e4294057d1a3">_fc_calcPyramidVolume</a>(points, &amp;vols[i]);  <span class="keywordflow">break</span>;
<a name="l03864"></a>03864     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b401f884cd916ee4eda7dbbc791446b9f1">FC_ET_PRISM</a>:    <a class="code" href="group__PrivateGeometricRelations.html#gdfeb042b46ada6ecd247abbe460570aa">_fc_calcPrismVolume</a>(points, &amp;vols[i]);    <span class="keywordflow">break</span>;
<a name="l03865"></a>03865     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b49e84aa94138112a229fbaf4f69b4735b">FC_ET_HEX</a>:      <a class="code" href="group__PrivateGeometricRelations.html#g520a713351463f90e452887d18703cd9">_fc_calcHexVolume</a>(points, &amp;vols[i]);      <span class="keywordflow">break</span>;
<a name="l03866"></a>03866     <span class="keywordflow">default</span>:
<a name="l03867"></a>03867       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Unexpected element type %s encountered"</span>,
<a name="l03868"></a>03868                             <a class="code" href="group__DataTypes.html#gb3fcc2417d4e38eb3cbd511a42048acd">fc_getElementTypeText</a>(elemType));
<a name="l03869"></a>03869       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03870"></a>03870     }
<a name="l03871"></a>03871   }
<a name="l03872"></a>03872 
<a name="l03873"></a>03873   <span class="comment">// create new variable</span>
<a name="l03874"></a>03874   rc = <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"region_volumes"</span>, region_volumes);
<a name="l03875"></a>03875   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>) {
<a name="l03876"></a>03876     free(vols);
<a name="l03877"></a>03877     <span class="keywordflow">return</span> rc;
<a name="l03878"></a>03878   }
<a name="l03879"></a>03879   rc = <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*region_volumes, numElement, 1, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>,
<a name="l03880"></a>03880                              <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b3599bbbe8f8e41851a17f1037bd44a83f">FC_MT_SCALAR</a>, <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, vols);
<a name="l03881"></a>03881   <span class="comment">// don't free vols!</span>
<a name="l03882"></a>03882   
<a name="l03883"></a>03883   <span class="keywordflow">return</span> rc;
<a name="l03884"></a>03884 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gcf76b8606254cc1a1c610ccd31760cdf"></a><!-- doxytag: member="geom.c::fc_getSubsetArea" ref="gcf76b8606254cc1a1c610ccd31760cdf" args="(FC_Subset subset, double *area)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetArea           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>area</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a variable with the area of the subset. 
<p>
<b>Description:</b> <p>
Returns the area of subset. The subset must have assoc FC_AT_FACE. Fails for NULL Subset, Returns 0 for empty subset.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000036">Todo:</a></b></dt><dd><ul>
<li>make displaced version</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>07/18/06 ACG, Created from old fc_getSidesAreas </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>area</em>&nbsp;</td><td>
output - area of subset </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04344">4344</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="geom_8c-source.html#l03600">fc_getFaceAreas()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01874">fc_getSubsetAssociationType()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00617">projection()</a>.<div class="fragment"><pre class="fragment"><a name="l04347"></a>04347   {
<a name="l04348"></a>04348   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l04349"></a>04349   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04350"></a>04350   <a class="code" href="structFC__Variable.html">FC_Variable</a> faceareas;
<a name="l04351"></a>04351   <span class="keywordtype">double</span> *areaarray;
<a name="l04352"></a>04352   <span class="keywordtype">double</span> retarea = 0.0;
<a name="l04353"></a>04353   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l04354"></a>04354   <span class="keywordtype">int</span> numMem, *ids;
<a name="l04355"></a>04355   <span class="keywordtype">int</span> i;
<a name="l04356"></a>04356 
<a name="l04357"></a>04357   <span class="comment">//default return</span>
<a name="l04358"></a>04358   <span class="keywordflow">if</span> (area)
<a name="l04359"></a>04359     *area = -1;
<a name="l04360"></a>04360 
<a name="l04361"></a>04361   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !area ){
<a name="l04362"></a>04362     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04363"></a>04363     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04364"></a>04364   }
<a name="l04365"></a>04365 
<a name="l04366"></a>04366 
<a name="l04367"></a>04367   rc = <a class="code" href="group__Subset.html#gd546b0c5303f4c8a0f256662aff729a4">fc_getSubsetAssociationType</a>(subset, &amp;assoc);
<a name="l04368"></a>04368   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04369"></a>04369     <span class="keywordflow">return</span> rc;
<a name="l04370"></a>04370   <span class="keywordflow">if</span> ( assoc != <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30402787462c13709118df8e232282a530a4">FC_AT_FACE</a>){
<a name="l04371"></a>04371     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Wrong association type"</span>);
<a name="l04372"></a>04372     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04373"></a>04373   }
<a name="l04374"></a>04374 
<a name="l04375"></a>04375   <span class="comment">// log message</span>
<a name="l04376"></a>04376   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing Subset Area"</span>);
<a name="l04377"></a>04377 
<a name="l04378"></a>04378 
<a name="l04379"></a>04379   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMem, &amp;ids);
<a name="l04380"></a>04380   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04381"></a>04381     <span class="keywordflow">return</span> rc;
<a name="l04382"></a>04382   }
<a name="l04383"></a>04383   <span class="keywordflow">if</span> (numMem == 0){
<a name="l04384"></a>04384     *area = 0.0;
<a name="l04385"></a>04385     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04386"></a>04386   }
<a name="l04387"></a>04387 
<a name="l04388"></a>04388   <span class="comment">//get areas for all faces of the mesh</span>
<a name="l04389"></a>04389   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset,&amp;mesh);
<a name="l04390"></a>04390   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04391"></a>04391     free(ids);
<a name="l04392"></a>04392     <span class="keywordflow">return</span> rc;
<a name="l04393"></a>04393   }
<a name="l04394"></a>04394 
<a name="l04395"></a>04395   rc = <a class="code" href="group__GeometricRelations.html#gf2bc95dcfbc5842503038dfc47e43efa">fc_getFaceAreas</a>(mesh,&amp;faceareas);
<a name="l04396"></a>04396   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04397"></a>04397     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"cant get face areas"</span>);
<a name="l04398"></a>04398     free(ids);
<a name="l04399"></a>04399     <span class="keywordflow">return</span> rc;
<a name="l04400"></a>04400   }
<a name="l04401"></a>04401 
<a name="l04402"></a>04402   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(faceareas,(<span class="keywordtype">void</span> **) &amp;areaarray);
<a name="l04403"></a>04403   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04404"></a>04404     free(ids);
<a name="l04405"></a>04405     <span class="keywordflow">return</span> rc;
<a name="l04406"></a>04406   }
<a name="l04407"></a>04407 
<a name="l04408"></a>04408 
<a name="l04409"></a>04409   <span class="keywordflow">for</span> (i = 0; i &lt; numMem; i++){
<a name="l04410"></a>04410     retarea += areaarray[ids[i]];
<a name="l04411"></a>04411   }
<a name="l04412"></a>04412   free(ids);
<a name="l04413"></a>04413   <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(faceareas);
<a name="l04414"></a>04414   *area = retarea;
<a name="l04415"></a>04415 
<a name="l04416"></a>04416   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04417"></a>04417 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gea0c3be70612767ac91c6c9b6d9b8be2"></a><!-- doxytag: member="geom.c::fc_getSubsetBoundingBox" ref="gea0c3be70612767ac91c6c9b6d9b8be2" args="(FC_Subset subset, int *numDim, FC_Coords *lowpoint, FC_Coords *highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetBoundingBox           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute bounding box of subset. 
<p>
<b>Description:</b> <p>
See <a class="el" href="group__GeometricRelations.html#g2b4340615ac4674f35b401a11ea4cdbe">fc_getMeshBoundingBox()</a> for a description of bounding boxes.<p>
Returns with an error if nothing is marked.<p>
<b>Modifications:</b> <ul>
<li>02/05/04 WSK, created.</li><li>04/19/04 WSK, Added return argument for number of dimensions</li><li>06/15/04 RM, marked list changed to subset added return FC_ERROR in switch statement if wrong assoc </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset handle </td></tr>
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
output - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
output - lower left corner of bbox </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
output - upper right corner of bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00847">847</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l00686">fc_getMeshBoundingBox()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02172">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01754">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="threshBoundBox_8c-source.html#l00454">find_and_print_bbs()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00853"></a>00853 {
<a name="l00854"></a>00854   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l00855"></a>00855   <span class="keywordtype">int</span> i, j;
<a name="l00856"></a>00856   <span class="keywordtype">int</span> numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l00857"></a>00857   <span class="keywordtype">double</span> *coords_p, temp;
<a name="l00858"></a>00858   <span class="comment">// must initialize all entries of coords to 0 in case numDim &lt; 3</span>
<a name="l00859"></a>00859   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> low = { 0., 0., 0. }, high = { 0., 0., 0. };
<a name="l00860"></a>00860   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l00861"></a>00861   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l00862"></a>00862 
<a name="l00863"></a>00863   <span class="comment">// default output</span>
<a name="l00864"></a>00864   <span class="keywordflow">if</span> (numDim)
<a name="l00865"></a>00865     *numDim = -1;
<a name="l00866"></a>00866   <span class="keywordflow">if</span> (lowpoint) 
<a name="l00867"></a>00867     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00868"></a>00868       (*lowpoint)[i] = -1.;
<a name="l00869"></a>00869   <span class="keywordflow">if</span> (highpoint) 
<a name="l00870"></a>00870     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00871"></a>00871       (*highpoint)[i] = -2.; <span class="comment">// makes bb invalid</span>
<a name="l00872"></a>00872 
<a name="l00873"></a>00873   <span class="comment">// check input </span>
<a name="l00874"></a>00874   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !numDim || !lowpoint || !highpoint) {
<a name="l00875"></a>00875     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00876"></a>00876     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l00877"></a>00877   }  
<a name="l00878"></a>00878   
<a name="l00879"></a>00879   <span class="comment">// log message</span>
<a name="l00880"></a>00880   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing subset bounding box"</span>);    
<a name="l00881"></a>00881   
<a name="l00882"></a>00882   <span class="comment">// setup I</span>
<a name="l00883"></a>00883   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l00884"></a>00884   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00885"></a>00885     <span class="keywordflow">return</span> rc;
<a name="l00886"></a>00886   rc = <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;assoc);
<a name="l00887"></a>00887   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00888"></a>00888     <span class="keywordflow">return</span> rc;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890   <span class="comment">// Error case: if subset has zero members - return error</span>
<a name="l00891"></a>00891   <span class="keywordflow">if</span> (numMember == 0 ) {
<a name="l00892"></a>00892     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members"</span>);
<a name="l00893"></a>00893     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l00894"></a>00894   }
<a name="l00895"></a>00895   
<a name="l00896"></a>00896   <span class="comment">// special case -- whole association</span>
<a name="l00897"></a>00897   <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) 
<a name="l00898"></a>00898     <span class="keywordflow">return</span> <a class="code" href="group__GeometricRelations.html#g2b4340615ac4674f35b401a11ea4cdbe">fc_getMeshBoundingBox</a>(mesh, numDim, lowpoint, highpoint);
<a name="l00899"></a>00899 
<a name="l00900"></a>00900   <span class="comment">// get vertices of the members</span>
<a name="l00901"></a>00901   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l00902"></a>00902   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00903"></a>00903     <span class="keywordflow">return</span> rc;
<a name="l00904"></a>00904   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, assoc, numMember, memberIDs, 
<a name="l00905"></a>00905                                <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l00906"></a>00906   free(memberIDs);
<a name="l00907"></a>00907 
<a name="l00908"></a>00908   <span class="comment">// setup II</span>
<a name="l00909"></a>00909   rc = <a class="code" href="group__Mesh.html#geaea4205623196e6b1b58da0b4b82b20">fc_getMeshDim</a>(mesh, numDim);
<a name="l00910"></a>00910   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00911"></a>00911     <span class="keywordflow">return</span> rc;
<a name="l00912"></a>00912   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l00913"></a>00913   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l00914"></a>00914     <span class="keywordflow">return</span> rc;
<a name="l00915"></a>00915 
<a name="l00916"></a>00916   <span class="comment">// initialize - start with 1st point</span>
<a name="l00917"></a>00917   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++)
<a name="l00918"></a>00918     low[i] = high[i] = coords_p[vertexIDs[0]*(*numDim)+i];
<a name="l00919"></a>00919 
<a name="l00920"></a>00920   <span class="comment">// find min &amp; max in each dim</span>
<a name="l00921"></a>00921   <span class="keywordflow">for</span> (i = 1; i &lt; numVertex; i++) {
<a name="l00922"></a>00922     <span class="keywordflow">for</span> (j = 0; j &lt; *numDim; j++) {
<a name="l00923"></a>00923       temp = coords_p[vertexIDs[i]*(*numDim)+j];
<a name="l00924"></a>00924       <span class="keywordflow">if</span> (temp &lt; low[j])
<a name="l00925"></a>00925         low[j] = temp;
<a name="l00926"></a>00926       <span class="keywordflow">if</span> (temp &gt; high[j])
<a name="l00927"></a>00927         high[j] = temp;
<a name="l00928"></a>00928     }
<a name="l00929"></a>00929   }
<a name="l00930"></a>00930   free(vertexIDs);
<a name="l00931"></a>00931 
<a name="l00932"></a>00932   <span class="keywordflow">for</span> (i = 0; i &lt; *numDim; i++) {
<a name="l00933"></a>00933     (*lowpoint)[i] = low[i];
<a name="l00934"></a>00934     (*highpoint)[i] = high[i];
<a name="l00935"></a>00935   }
<a name="l00936"></a>00936 
<a name="l00937"></a>00937   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l00938"></a>00938 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gbbaa194dd7ef7e6ef0d1d47831ba73f1"></a><!-- doxytag: member="geom.c::fc_getSubsetCentroid" ref="gbbaa194dd7ef7e6ef0d1d47831ba73f1" args="(FC_Subset subset, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute centroid of a subset. 
<p>
<b>Description:</b> <p>
The centroid is the geometric center of the subset and is calculated by averaging the coordinates in each dimension. Also called center of mass or center of gravity.<p>
<b>Modifications:</b> <ul>
<li>10/29/04 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of coords </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02940">2940</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l02590">fc_getMeshCentroid()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02172">fc_getMeshDim()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01754">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="ex1__intro_8c-source.html#l00069">main()</a>.<div class="fragment"><pre class="fragment"><a name="l02944"></a>02944   {
<a name="l02945"></a>02945   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02946"></a>02946   <span class="keywordtype">int</span> i, j;
<a name="l02947"></a>02947   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l02948"></a>02948   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l02949"></a>02949   <span class="keywordtype">int</span> numDim, numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l02950"></a>02950   <span class="keywordtype">double</span> *coords_p;
<a name="l02951"></a>02951   <span class="keywordtype">double</span> coords_sum[3];
<a name="l02952"></a>02952   
<a name="l02953"></a>02953   <span class="comment">// default</span>
<a name="l02954"></a>02954   <span class="keywordflow">if</span> (dim)
<a name="l02955"></a>02955     *dim = -1;
<a name="l02956"></a>02956   <span class="keywordflow">if</span> (center) {
<a name="l02957"></a>02957     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02958"></a>02958       (*center)[i] = -1.;
<a name="l02959"></a>02959   }
<a name="l02960"></a>02960 
<a name="l02961"></a>02961   <span class="comment">// check input</span>
<a name="l02962"></a>02962   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !dim || !center) {
<a name="l02963"></a>02963     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02964"></a>02964     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02965"></a>02965   }
<a name="l02966"></a>02966 
<a name="l02967"></a>02967   <span class="comment">// log message</span>
<a name="l02968"></a>02968   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing subset centroid."</span>);  
<a name="l02969"></a>02969   
<a name="l02970"></a>02970   <span class="comment">// setup I</span>
<a name="l02971"></a>02971   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l02972"></a>02972   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02973"></a>02973     <span class="keywordflow">return</span> rc;
<a name="l02974"></a>02974   rc = <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;assoc);
<a name="l02975"></a>02975   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02976"></a>02976     <span class="keywordflow">return</span> rc;
<a name="l02977"></a>02977 
<a name="l02978"></a>02978   <span class="comment">// Error case: if subset has zero members - return error</span>
<a name="l02979"></a>02979   <span class="keywordflow">if</span> (numMember == 0 ) {
<a name="l02980"></a>02980     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members"</span>);
<a name="l02981"></a>02981     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l02982"></a>02982   }
<a name="l02983"></a>02983   
<a name="l02984"></a>02984   <span class="comment">// special case -- whole association</span>
<a name="l02985"></a>02985   <span class="keywordflow">if</span> (assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) 
<a name="l02986"></a>02986     <span class="keywordflow">return</span> <a class="code" href="group__GeometricRelations.html#g25e99a690489a8e823cae6b9afc1ee65">fc_getMeshCentroid</a>(mesh, dim, center);
<a name="l02987"></a>02987     
<a name="l02988"></a>02988   <span class="comment">// setup II</span>
<a name="l02989"></a>02989   rc = <a class="code" href="group__Mesh.html#geaea4205623196e6b1b58da0b4b82b20">fc_getMeshDim</a>(mesh, &amp;numDim);
<a name="l02990"></a>02990   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02991"></a>02991     <span class="keywordflow">return</span> rc;
<a name="l02992"></a>02992   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l02993"></a>02993   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02994"></a>02994     <span class="keywordflow">return</span> rc;
<a name="l02995"></a>02995   
<a name="l02996"></a>02996   <span class="comment">// get vertices of the members</span>
<a name="l02997"></a>02997   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l02998"></a>02998   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02999"></a>02999     <span class="keywordflow">return</span> rc;
<a name="l03000"></a>03000   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, assoc, numMember, memberIDs, 
<a name="l03001"></a>03001                                <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l03002"></a>03002   free(memberIDs);
<a name="l03003"></a>03003 
<a name="l03004"></a>03004   <span class="comment">// calculate coordinate sums</span>
<a name="l03005"></a>03005   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03006"></a>03006     coords_sum[i] = 0.;
<a name="l03007"></a>03007   
<a name="l03008"></a>03008   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++)
<a name="l03009"></a>03009     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l03010"></a>03010       coords_sum[j] += coords_p[vertexIDs[i]*numDim + j];
<a name="l03011"></a>03011   free(vertexIDs);
<a name="l03012"></a>03012   
<a name="l03013"></a>03013   <span class="comment">// calculate centroids</span>
<a name="l03014"></a>03014   *dim = numDim;
<a name="l03015"></a>03015   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l03016"></a>03016     (*center)[i] = coords_sum[i]/numVertex;
<a name="l03017"></a>03017   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l03018"></a>03018     (*center)[i] = 0.;
<a name="l03019"></a>03019   
<a name="l03020"></a>03020   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l03021"></a>03021 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g065a93ebc03ea18a0c7c25ad237f78da"></a><!-- doxytag: member="geom.c::fc_getSubsetDiameter" ref="g065a93ebc03ea18a0c7c25ad237f78da" args="(FC_Subset subset, double *diameter, int *numPair, int **pairIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetDiameter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a subset. 
<p>
This routine returns the diameter of the set of vertices that make up the members of the subset. For more details see <a class="el" href="group__GeometricRelations.html#g4d0810ecf214489a94f56073aa141164">fc_getMeshDiameter()</a>.<p>
The function will return with an error if the subset is empty.<p>
<b>Modifications:</b> <ul>
<li>6/24/05 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - A subset </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01753">1753</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02127">_fc_getDiameterOutputArgsTest()</a>, <a class="el" href="geom_8c-source.html#l02256">_fc_getSubsetDiameterCore()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="elemdeath_8c-source.html#l01196">fc_calcTearLength()</a>, and <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01759"></a>01759   {
<a name="l01760"></a>01760   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01761"></a>01761  
<a name="l01762"></a>01762   <span class="comment">// log message</span>
<a name="l01763"></a>01763   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing subset diameter."</span>);
<a name="l01764"></a>01764 
<a name="l01765"></a>01765   <span class="comment">// set default returns &amp; test output args</span>
<a name="l01766"></a>01766   rc = <a class="code" href="group__PrivateGeometricRelations.html#ge6ea8457b23e18e1945b23fe328fbbd1">_fc_getDiameterOutputArgsTest</a>(diameter, numPair, pairIDs);
<a name="l01767"></a>01767   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01768"></a>01768     <span class="keywordflow">return</span> rc;
<a name="l01769"></a>01769 
<a name="l01770"></a>01770   <span class="comment">// test input</span>
<a name="l01771"></a>01771   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset)) {
<a name="l01772"></a>01772     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01773"></a>01773     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01774"></a>01774   }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776   <span class="comment">// do it</span>
<a name="l01777"></a>01777   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#g7b6c20a9dc1adb93878b76c326d656ac">_fc_getSubsetDiameterCore</a>(subset, NULL, diameter, numPair, pairIDs);
<a name="l01778"></a>01778 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gc6a90cc1b35e9acb6c94c2857b11e730"></a><!-- doxytag: member="geom.c::fc_getSubsetsDiameter" ref="gc6a90cc1b35e9acb6c94c2857b11e730" args="(int numSubset, FC_Subset *subsets, double *diameter, int *numPair, int **pairIDs, FC_Subset **pairSubsets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetsDiameter           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numSubset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>diameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>pairIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>pairSubsets</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the diameter of a group of subsets. 
<p>
This routine returns the diameter of the set of vertices that make up the members of a group of subsets. For more details see <a class="el" href="group__GeometricRelations.html#ga827e7709fded608a7de79dde212552d">fc_getMeshesDiameter()</a>.<p>
<b>Modifications:</b> <ul>
<li>3/9/06 WSD Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numSubset</em>&nbsp;</td><td>
input - number of subsets </td></tr>
<tr><td valign="top"><em>subsets</em>&nbsp;</td><td>
input - Array of subsets </td></tr>
<tr><td valign="top"><em>diameter</em>&nbsp;</td><td>
ouput - diameter of the vertex set </td></tr>
<tr><td valign="top"><em>numPair</em>&nbsp;</td><td>
output - number of pairs of vertices that are diameter distance from each other </td></tr>
<tr><td valign="top"><em>pairIDs</em>&nbsp;</td><td>
output - IDs of the vertex pairs </td></tr>
<tr><td valign="top"><em>pairSubsets</em>&nbsp;</td><td>
output - the subsets of the pairs </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02019">2019</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l02207">_fc_getDiameterOutputArgsTestSubsets()</a>, <a class="el" href="geom_8c-source.html#l02382">_fc_getSubsetsDiameterCore()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l02027"></a>02027   {
<a name="l02028"></a>02028   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02029"></a>02029   <span class="keywordtype">int</span> i;
<a name="l02030"></a>02030 
<a name="l02031"></a>02031   <span class="comment">// log message</span>
<a name="l02032"></a>02032   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing subsets diameter."</span>);
<a name="l02033"></a>02033 
<a name="l02034"></a>02034   <span class="comment">// set default returns &amp; test output args</span>
<a name="l02035"></a>02035   rc = <a class="code" href="group__PrivateGeometricRelations.html#gd5ee7780e249a1b8a390cd1a7eddc2ac">_fc_getDiameterOutputArgsTestSubsets</a>(diameter, numPair, pairIDs,
<a name="l02036"></a>02036                          pairSubsets);
<a name="l02037"></a>02037   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02038"></a>02038     <span class="keywordflow">return</span> rc;
<a name="l02039"></a>02039 
<a name="l02040"></a>02040   <span class="comment">// test input</span>
<a name="l02041"></a>02041   <span class="keywordflow">if</span> (numSubset &lt; 1 || !subsets) {
<a name="l02042"></a>02042     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02043"></a>02043     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02044"></a>02044   }
<a name="l02045"></a>02045   <span class="keywordflow">for</span> (i = 0; i &lt; numSubset; i++) {
<a name="l02046"></a>02046     <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subsets[i])) {
<a name="l02047"></a>02047       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02048"></a>02048       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02049"></a>02049     }
<a name="l02050"></a>02050   }
<a name="l02051"></a>02051 
<a name="l02052"></a>02052   <span class="comment">// do it</span>
<a name="l02053"></a>02053   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#gc3ff82fc255522698bef399215b8639b">_fc_getSubsetsDiameterCore</a>(numSubset, subsets, NULL, diameter,
<a name="l02054"></a>02054                         numPair, pairIDs, pairSubsets);
<a name="l02055"></a>02055 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g29e5532aa97ec9d43456579e8e1b26ea"></a><!-- doxytag: member="geom.c::fc_getSubsetsProximity" ref="g29e5532aa97ec9d43456579e8e1b26ea" args="(FC_Subset subset1, FC_Subset subset2, double min_dist, int *numPair_p, int **mesh1VertIDs_p, int **mesh2VertIDs_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetsProximity           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numPair_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh1VertIDs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>mesh2VertIDs_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the proximal vertices between two subsets. 
<p>
<b>Description:</b> <p>
This returns all vertex pairs that are less than or equal to min_dist apart. Vertices may show up in more than one pair. (In the extrememe case if you put in min_dist = infinity, you would end up with each vertex being connected to all vertices of the other subset.)<p>
The routine can be forced to return "early", after the first match is found, if you use NULL for the last two arguments (the vertex arrays). In this case, the returned numPair is really a flag for whether a pair was found or not and will never be greater than 1 even if there are more than one possible pairs.<p>
Note, passing in min_dist = 0 will find overlapping vertices, or if subsets are on the same mesh, will find common vertices.<p>
Note, subsets may be closer together than any of the vertex pairs (imagine 1 vertex of one mesh very close to middle of a face of another mesh. the vert to face distance is less than distance to the face's verts).<p>
Will return if error if subset1 == subset2.<p>
<b>Modifications:</b> <ul>
<li>02/14/2006 WSD Created.</li><li>03/14/2006 WSD guts common to all proximity routines to a common core routine.</li><li>03/16/2006 WSD changed behavior so that if NULLs are passed in for the vertIDs, will return after 1st match. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset1</em>&nbsp;</td><td>
input - the first subset </td></tr>
<tr><td valign="top"><em>subset2</em>&nbsp;</td><td>
input - the second subset </td></tr>
<tr><td valign="top"><em>min_dist</em>&nbsp;</td><td>
input - the distance cutoff </td></tr>
<tr><td valign="top"><em>numPair_p</em>&nbsp;</td><td>
output - the number of vertex pairs found </td></tr>
<tr><td valign="top"><em>mesh1VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh1 verts (order matters), user is responsible for freeing </td></tr>
<tr><td valign="top"><em>mesh2VertIDs_p</em>&nbsp;</td><td>
output - ids of the mesh2 verts (order matters), user is responsible for freeing </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l05068">5068</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l05181">_fc_getSubsetsProximityArgsTest()</a>, <a class="el" href="geom_8c-source.html#l05303">_fc_getSubsetsProximityCore()</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="tears_8c-source.html#l00922">main()</a>.<div class="fragment"><pre class="fragment"><a name="l05077"></a>05077   {
<a name="l05078"></a>05078   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l05079"></a>05079 
<a name="l05080"></a>05080   <span class="comment">// argument testing &amp; default returns</span>
<a name="l05081"></a>05081   rc = <a class="code" href="group__PrivateGeometricRelations.html#gd6f42749fc51c2c345947d616aea2c2e">_fc_getSubsetsProximityArgsTest</a>(NULL, &amp;subset1, NULL, NULL,
<a name="l05082"></a>05082                            &amp;subset2, NULL, min_dist, numPair_p,
<a name="l05083"></a>05083                            mesh1VertIDs_p, mesh2VertIDs_p);
<a name="l05084"></a>05084   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l05085"></a>05085     <span class="keywordflow">return</span> rc;
<a name="l05086"></a>05086  
<a name="l05087"></a>05087   <span class="comment">// log message</span>
<a name="l05088"></a>05088   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing subsets proximity"</span>);
<a name="l05089"></a>05089 
<a name="l05090"></a>05090   <span class="comment">// do it</span>
<a name="l05091"></a>05091   <span class="keywordflow">return</span> <a class="code" href="group__PrivateGeometricRelations.html#gb8a027025dc64581aaf438723d9f62d8">_fc_getSubsetsProximityCore</a>(subset1, NULL, subset2, NULL, min_dist,
<a name="l05092"></a>05092                          numPair_p, mesh1VertIDs_p,
<a name="l05093"></a>05093                          mesh2VertIDs_p);
<a name="l05094"></a>05094 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gad13734d528eba302b4bd4f3ce3216f6"></a><!-- doxytag: member="geom.c::fc_getSubsetVolume" ref="gad13734d528eba302b4bd4f3ce3216f6" args="(FC_Subset subs, int doStrict, double *volume)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSubsetVolume           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doStrict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>volume</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a variable with the volume of the subset. 
<p>
<b>Description:</b> <p>
This will return with an error if the elements of the mesh are not 3D (e.g. it is an error to ask for volumes of a subset on a quad mesh).<p>
This routine uses fc_getRegionVolumes and therefore has the same assumptions fc_getRegionVolumes does.<p>
This routine uses fc_copySubsetWithNewAssociation to make a temporary intermediate subset with association FC_AT_ELEMENT. the "doStrict" input variable is for this call. See documentation there for further information.<p>
<b>Modifications:</b> <ul>
<li>11/30/04 ACG, Created </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subs</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>doStrict</em>&nbsp;</td><td>
input - flag for dropping incomplete entities </td></tr>
<tr><td valign="top"><em>volume</em>&nbsp;</td><td>
output - volume of subset </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04129">4129</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="subset_8c-source.html#l00311">fc_copySubsetWithNewAssociation()</a>, <a class="el" href="subset_8c-source.html#l01589">fc_deleteSubset()</a>, <a class="el" href="variable_8c-source.html#l03856">fc_deleteVariable()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="geom_8c-source.html#l03808">fc_getRegionVolumes()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04543">fc_getVariableNumDataPoint()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="volumeSegments_8c-source.html#l00334">calcSegmentsVolumes()</a>.<div class="fragment"><pre class="fragment"><a name="l04133"></a>04133   {
<a name="l04134"></a>04134   <span class="keywordtype">int</span> k;
<a name="l04135"></a>04135   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l04136"></a>04136   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04137"></a>04137   <a class="code" href="structFC__Variable.html">FC_Variable</a> elemvols;
<a name="l04138"></a>04138   <a class="code" href="structFC__Subset.html">FC_Subset</a>  newSubset;
<a name="l04139"></a>04139   <span class="keywordtype">void</span>* actual_vols;
<a name="l04140"></a>04140   <span class="keywordtype">int</span> numDataPoint;
<a name="l04141"></a>04141   <span class="keywordtype">char</span> newSubsetName[20] = <span class="stringliteral">"junkSubset"</span>;
<a name="l04142"></a>04142   <span class="keywordtype">int</span> subsize;
<a name="l04143"></a>04143   <span class="keywordtype">int</span>* memarray;
<a name="l04144"></a>04144   <span class="keywordtype">double</span> vol = 0.0;
<a name="l04145"></a>04145 
<a name="l04146"></a>04146   <span class="comment">// default return</span>
<a name="l04147"></a>04147   <span class="keywordflow">if</span> (volume)
<a name="l04148"></a>04148     *volume = -1;
<a name="l04149"></a>04149 
<a name="l04150"></a>04150   <span class="comment">// test input</span>
<a name="l04151"></a>04151   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subs) || !volume ||
<a name="l04152"></a>04152       (doStrict != 0 &amp;&amp; doStrict != 1)) {
<a name="l04153"></a>04153     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04154"></a>04154     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04155"></a>04155   }
<a name="l04156"></a>04156 
<a name="l04157"></a>04157   <span class="comment">// log message</span>
<a name="l04158"></a>04158   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing subset volume."</span>);
<a name="l04159"></a>04159 
<a name="l04160"></a>04160   <span class="comment">//need parent </span>
<a name="l04161"></a>04161   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subs,&amp;mesh);
<a name="l04162"></a>04162   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04163"></a>04163     <span class="comment">//    fc_printfErrorMessage("cant get mesh from subset");</span>
<a name="l04164"></a>04164     <span class="keywordflow">return</span> rc;
<a name="l04165"></a>04165   }
<a name="l04166"></a>04166 
<a name="l04167"></a>04167   <span class="comment">// get volumes of regions of mesh</span>
<a name="l04168"></a>04168   <span class="comment">// know these have assoc fc_AT_ELEMENT</span>
<a name="l04169"></a>04169   rc = <a class="code" href="group__GeometricRelations.html#gf7687aa264403fd9234d8b1ff133a6b7">fc_getRegionVolumes</a>(mesh,&amp;elemvols);
<a name="l04170"></a>04170   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04171"></a>04171     <span class="comment">//    fc_printfErrorMessage("cant get region volumes");</span>
<a name="l04172"></a>04172     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04173"></a>04173     <span class="keywordflow">return</span> rc;
<a name="l04174"></a>04174   }
<a name="l04175"></a>04175 
<a name="l04176"></a>04176   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(elemvols,&amp;actual_vols);
<a name="l04177"></a>04177   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04178"></a>04178     <span class="comment">//    fc_printfErrorMessage("cant get actual vols");</span>
<a name="l04179"></a>04179     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04180"></a>04180     <span class="keywordflow">return</span> rc;
<a name="l04181"></a>04181   }
<a name="l04182"></a>04182 
<a name="l04183"></a>04183   <span class="comment">//just want to know how many there are for safety check below</span>
<a name="l04184"></a>04184   rc = <a class="code" href="group__Variable.html#gca6fc2e25075838bc8b2ef3a347efb20">fc_getVariableNumDataPoint</a>(elemvols, &amp;numDataPoint);
<a name="l04185"></a>04185   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04186"></a>04186     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04187"></a>04187     <span class="keywordflow">return</span> rc;
<a name="l04188"></a>04188   }
<a name="l04189"></a>04189 
<a name="l04190"></a>04190   rc = <a class="code" href="group__Subset.html#gb776198fa763b99d16d1512d1e75d818">fc_copySubsetWithNewAssociation</a>
<a name="l04191"></a>04191     (subs,newSubsetName,<a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>,doStrict,&amp;newSubset);
<a name="l04192"></a>04192   <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04193"></a>04193     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04194"></a>04194     <span class="keywordflow">return</span> rc;
<a name="l04195"></a>04195   }
<a name="l04196"></a>04196 
<a name="l04197"></a>04197   <span class="comment">//next steps to match up subset elements with mesh region vols</span>
<a name="l04198"></a>04198   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(newSubset,&amp;subsize,&amp;memarray);
<a name="l04199"></a>04199   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l04200"></a>04200     <span class="comment">//    fc_printfErrorMessage("cant get subset members as array");</span>
<a name="l04201"></a>04201     <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04202"></a>04202     rc = <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(newSubset);
<a name="l04203"></a>04203     free(memarray);
<a name="l04204"></a>04204     <span class="keywordflow">return</span> rc;
<a name="l04205"></a>04205   }
<a name="l04206"></a>04206 
<a name="l04207"></a>04207   vol = 0.0;
<a name="l04208"></a>04208   <span class="keywordflow">for</span> (k = 0; k &lt; subsize; k++)
<a name="l04209"></a>04209     vol += ((<span class="keywordtype">double</span> *)(actual_vols))[memarray[k]];
<a name="l04210"></a>04210 
<a name="l04211"></a>04211   <a class="code" href="group__Variable.html#g2f48fcbd551131488dd5757c27364656">fc_deleteVariable</a>(elemvols);
<a name="l04212"></a>04212   rc = <a class="code" href="group__Subset.html#gfdcc399692041499cc461916a9973558">fc_deleteSubset</a>(newSubset);
<a name="l04213"></a>04213   free(memarray);
<a name="l04214"></a>04214   *volume = vol;
<a name="l04215"></a>04215   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04216"></a>04216 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gceec77d10551423fb5b7511cbf18e235"></a><!-- doxytag: member="geom.c::fc_getSurfaceNormals" ref="gceec77d10551423fb5b7511cbf18e235" args="(FC_Mesh mesh, FC_Variable *new_var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getSurfaceNormals           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a> *&nbsp;</td>
          <td class="paramname"> <em>new_var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute surface normals on all elements in a mesh. 
<p>
<b>Description:</b> <p>
Compute surface normals on all elements in a mesh. Currently only correct for meshes with planar elements (like triangles and planar quads).<p>
<b>Modifications:</b> <ul>
<li>Steph Boyles Created.</li><li>2002-JUL-09 W Koegler Adapted to modified struct Vector</li><li>2003-SEP-04 W Koegler Created: _fc_SurfaceNormal was split between this function and _fc_calcSurfaceNormal for better modularity.</li></ul>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000037">Todo:</a></b></dt><dd>needs a flag if the normals are already computed </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000037">Todo:</a></b></dt><dd>expand to 3D elements -&gt; could return surface normals of faces? ... but what would their orientation be? </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh to compute surface normals of </td></tr>
<tr><td valign="top"><em>new_var</em>&nbsp;</td><td>
output - new variable w/ surface normals as data </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l04448">4448</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="geom_8c-source.html#l06901">_fc_calcSurfaceNormal()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="variable_8c-source.html#l00284">fc_createVariable()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>, <a class="el" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a>, <a class="el" href="base_8c-source.html#l00549">fc_getElementTypeNumVertex()</a>, <a class="el" href="base_8c-source.html#l00384">fc_getElementTypeText()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02981">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, <a class="el" href="base_8c-source.html#l00778">FC_NULL_VARIABLE</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, <a class="el" href="variable_8c-source.html#l00602">fc_setVariableDataPtr()</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l04451"></a>04451   {
<a name="l04452"></a>04452   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l04453"></a>04453   <span class="keywordtype">int</span> i, j, k;
<a name="l04454"></a>04454   <span class="keywordtype">double</span> *normals;
<a name="l04455"></a>04455   <a class="code" href="group__SimpleDataObjects.html#g84c64ce1a8b6f4beca59ee9140f3f109">FC_Vector</a> temp_normal;  <span class="comment">// normal vector to an element</span>
<a name="l04456"></a>04456   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> temp_vertices[4]; <span class="comment">// array of vertex coords to pass around</span>
<a name="l04457"></a>04457   <span class="keywordtype">int</span> numElem, dim, numVertPerElem;
<a name="l04458"></a>04458   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemType;
<a name="l04459"></a>04459   <span class="keywordtype">double</span>* coords;
<a name="l04460"></a>04460   <span class="keywordtype">int</span>* conns;
<a name="l04461"></a>04461   
<a name="l04462"></a>04462   <span class="comment">// default return</span>
<a name="l04463"></a>04463   <span class="keywordflow">if</span> (new_var)
<a name="l04464"></a>04464     *new_var = <a class="code" href="group__Handles.html#ge44060288d9dc607cfddcc314cdf48cf">FC_NULL_VARIABLE</a>;
<a name="l04465"></a>04465   
<a name="l04466"></a>04466   <span class="comment">// check input</span>
<a name="l04467"></a>04467   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !new_var) {
<a name="l04468"></a>04468     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l04469"></a>04469     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04470"></a>04470   }
<a name="l04471"></a>04471 
<a name="l04472"></a>04472   <span class="comment">// setup and more checking</span>
<a name="l04473"></a>04473   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;dim, NULL, &amp;numElem, &amp;elemType);
<a name="l04474"></a>04474   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04475"></a>04475     <span class="keywordflow">return</span> rc;
<a name="l04476"></a>04476   <span class="keywordflow">if</span> (elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b4eb83ad249f4296eaf2609e27b6a59aa1">FC_ET_TRI</a> &amp;&amp; elemType != <a class="code" href="group__DataTypes.html#gg5d0bf8bd47afb81d89d4c5d60c7d62b406121f0d65d618dcb6111ba50740b4ad">FC_ET_QUAD</a>) {
<a name="l04477"></a>04477     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s, can't handle element type %s"</span>, 
<a name="l04478"></a>04478         <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>),<a class="code" href="group__DataTypes.html#gb3fcc2417d4e38eb3cbd511a42048acd">fc_getElementTypeText</a>(elemType));
<a name="l04479"></a>04479     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l04480"></a>04480   }
<a name="l04481"></a>04481   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords);
<a name="l04482"></a>04482   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04483"></a>04483     <span class="keywordflow">return</span> rc;
<a name="l04484"></a>04484   rc = <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(mesh, &amp;conns);
<a name="l04485"></a>04485   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l04486"></a>04486     <span class="keywordflow">return</span> rc;
<a name="l04487"></a>04487   numVertPerElem = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(elemType);
<a name="l04488"></a>04488   
<a name="l04489"></a>04489   <span class="comment">// log message</span>
<a name="l04490"></a>04490   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing surface normals."</span>);
<a name="l04491"></a>04491   
<a name="l04492"></a>04492   <span class="comment">// make space for the data array </span>
<a name="l04493"></a>04493   normals = (<span class="keywordtype">double</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * dim * numElem);
<a name="l04494"></a>04494   <span class="keywordflow">if</span> (normals == NULL ) {
<a name="l04495"></a>04495     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l04496"></a>04496     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l04497"></a>04497   } 
<a name="l04498"></a>04498   
<a name="l04499"></a>04499   <span class="comment">// compute Surface normals, save in buffer</span>
<a name="l04500"></a>04500   <span class="keywordflow">for</span> (i = 0; i &lt; numElem; i++) {
<a name="l04501"></a>04501 
<a name="l04502"></a>04502     <span class="comment">// make list of pointers to this elements vertices</span>
<a name="l04503"></a>04503     <span class="keywordflow">for</span> (j = 0; j &lt; numVertPerElem; j++) {
<a name="l04504"></a>04504       <span class="keywordflow">for</span> (k = 0; k &lt; dim; k++)
<a name="l04505"></a>04505         temp_vertices[j][k] = coords[conns[i*numVertPerElem+j]*dim+k];
<a name="l04506"></a>04506       <span class="keywordflow">for</span> (k = dim; k &lt; 3; k++)
<a name="l04507"></a>04507         temp_vertices[j][k] = 0;
<a name="l04508"></a>04508     }
<a name="l04509"></a>04509 
<a name="l04510"></a>04510     <span class="comment">// calculate normal</span>
<a name="l04511"></a>04511     <a class="code" href="group__PrivateGeometricRelations.html#g220950bef4a17b1ad88db87868459421">_fc_calcSurfaceNormal</a>(numVertPerElem, temp_vertices, &amp;temp_normal);
<a name="l04512"></a>04512     
<a name="l04513"></a>04513     <span class="comment">// save results in element info and an array to make into a var</span>
<a name="l04514"></a>04514     <span class="keywordflow">for</span> (j = 0; j &lt; dim; j++) 
<a name="l04515"></a>04515       normals[i*dim+j] = temp_normal[j];
<a name="l04516"></a>04516   }
<a name="l04517"></a>04517   
<a name="l04518"></a>04518   <span class="comment">// add new variable to current mesh</span>
<a name="l04519"></a>04519   <a class="code" href="group__Variable.html#g2f498c4fbd85d8094f0f640a17341cb3">fc_createVariable</a>(mesh, <span class="stringliteral">"surfaceNormals"</span>, new_var);
<a name="l04520"></a>04520   <a class="code" href="group__Variable.html#g4491a3d96b7252fd5d0de54089d6838d">fc_setVariableDataPtr</a>(*new_var, numElem, dim, <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="code" href="group__DataTypes.html#ggf4416c02a52bd37e799d442b985151b367e06c1812f7a0127035e27d14fd597d">FC_MT_VECTOR</a>, 
<a name="l04521"></a>04521                         <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, normals);
<a name="l04522"></a>04522   <span class="comment">// don't free normals</span>
<a name="l04523"></a>04523   
<a name="l04524"></a>04524   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l04525"></a>04525 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ga33e8f8750201b783262d71628c1d455"></a><!-- doxytag: member="geom.c::fc_getVariableWeightedDisplacedMeshCentroid" ref="ga33e8f8750201b783262d71628c1d455" args="(FC_Mesh mesh, FC_Variable coord_displ, FC_Variable weightsVar, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getVariableWeightedDisplacedMeshCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>weightsVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute variable weighted centroid of a displaced mesh. 
<p>
<b>Description:</b> <p>
Computes the centroid of a mesh weighted by the variable values (equivalent to center of mass where the variable is the masses). The weights variable must be a scalar variable on the vertices (and should have the same number of vertices as the mesh if it is from a different mesh).<p>
<b>Modifications:</b> <ul>
<li>10/29/04 WSK created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>weightsVar</em>&nbsp;</td><td>
input - weights </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of centroid </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02836">2836</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l03267">fc_getVariableWeightedDisplacedSubsetCentroid()</a>.<div class="fragment"><pre class="fragment"><a name="l02842"></a>02842   {
<a name="l02843"></a>02843   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02844"></a>02844   <span class="keywordtype">int</span> i, j;
<a name="l02845"></a>02845   <span class="keywordtype">int</span> numDim, numVertex, numDataPoint, data_dim;
<a name="l02846"></a>02846   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc; <span class="comment">// data association</span>
<a name="l02847"></a>02847   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype; <span class="comment">// data type</span>
<a name="l02848"></a>02848   <span class="keywordtype">double</span> coords_sum[3];
<a name="l02849"></a>02849   <span class="keywordtype">double</span>* coords, weight_sum, weight;
<a name="l02850"></a>02850   <span class="keywordtype">void</span>* data_p;
<a name="l02851"></a>02851 
<a name="l02852"></a>02852   <span class="comment">// default output</span>
<a name="l02853"></a>02853   <span class="keywordflow">if</span> (dim)
<a name="l02854"></a>02854     *dim = -1;
<a name="l02855"></a>02855   <span class="keywordflow">if</span> (center) {
<a name="l02856"></a>02856     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02857"></a>02857       (*center)[i] = -1.;
<a name="l02858"></a>02858   }
<a name="l02859"></a>02859 
<a name="l02860"></a>02860   <span class="comment">// check input</span>
<a name="l02861"></a>02861   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || 
<a name="l02862"></a>02862       !<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ) ||
<a name="l02863"></a>02863       !<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(weightsVar) || !dim || !center) {
<a name="l02864"></a>02864     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02865"></a>02865     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02866"></a>02866   }
<a name="l02867"></a>02867   
<a name="l02868"></a>02868   <span class="comment">// get mesh &amp; weights variable information</span>
<a name="l02869"></a>02869   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l02870"></a>02870   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02871"></a>02871     <span class="keywordflow">return</span> rc;
<a name="l02872"></a>02872   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(weightsVar, &amp;numDataPoint, &amp;data_dim, &amp;assoc,  
<a name="l02873"></a>02873                  NULL, &amp;datatype);
<a name="l02874"></a>02874   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02875"></a>02875     <span class="keywordflow">return</span> rc;
<a name="l02876"></a>02876   
<a name="l02877"></a>02877    <span class="comment">// more checking</span>
<a name="l02878"></a>02878   <span class="keywordflow">if</span> (assoc != <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a> || numDataPoint != numVertex || data_dim != 1 ||
<a name="l02879"></a>02879       !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(datatype) || datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || 
<a name="l02880"></a>02880       datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>) {
<a name="l02881"></a>02881     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Inappropriate variable for weights"</span>);
<a name="l02882"></a>02882     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l02883"></a>02883   }
<a name="l02884"></a>02884 
<a name="l02885"></a>02885   <span class="comment">// log message</span>
<a name="l02886"></a>02886   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing variable weighted centroid of mesh."</span>);  
<a name="l02887"></a>02887 
<a name="l02888"></a>02888   <span class="comment">// get vertices and data</span>
<a name="l02889"></a>02889   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l02890"></a>02890   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02891"></a>02891     <span class="keywordflow">return</span> rc;
<a name="l02892"></a>02892   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(weightsVar, &amp;data_p);
<a name="l02893"></a>02893   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02894"></a>02894     <span class="keywordflow">return</span> rc;
<a name="l02895"></a>02895 
<a name="l02896"></a>02896   <span class="comment">// init coord sums</span>
<a name="l02897"></a>02897   weight_sum = 0.;
<a name="l02898"></a>02898   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02899"></a>02899     coords_sum[i] = 0;
<a name="l02900"></a>02900 
<a name="l02901"></a>02901   <span class="comment">// collect sums</span>
<a name="l02902"></a>02902   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++) {
<a name="l02903"></a>02903     <span class="keywordflow">switch</span>(datatype) {
<a name="l02904"></a>02904     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> :    weight = ((<span class="keywordtype">int</span>*)data_p)[i];     <span class="keywordflow">break</span>;
<a name="l02905"></a>02905     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:   weight = ((<span class="keywordtype">float</span>*)data_p)[i];   <span class="keywordflow">break</span>;
<a name="l02906"></a>02906     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:  weight = ((<span class="keywordtype">double</span>*)data_p)[i];  <span class="keywordflow">break</span>;
<a name="l02907"></a>02907     <span class="keywordflow">default</span>:
<a name="l02908"></a>02908       ; <span class="comment">// nothing</span>
<a name="l02909"></a>02909     }
<a name="l02910"></a>02910     weight_sum += weight;
<a name="l02911"></a>02911     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++) {
<a name="l02912"></a>02912       coords_sum[j] += coords[i*numDim + j] * weight;
<a name="l02913"></a>02913     }
<a name="l02914"></a>02914   }
<a name="l02915"></a>02915   free(coords);
<a name="l02916"></a>02916 
<a name="l02917"></a>02917   <span class="comment">// calculate weight centroid</span>
<a name="l02918"></a>02918   *dim = numDim;
<a name="l02919"></a>02919   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l02920"></a>02920     (*center)[i] = coords_sum[i]/weight_sum;
<a name="l02921"></a>02921   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l02922"></a>02922     (*center)[i] = 0.;
<a name="l02923"></a>02923 
<a name="l02924"></a>02924   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l02925"></a>02925 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g212cbb848ec9d75fa5fa6f2a59f0d6d7"></a><!-- doxytag: member="geom.c::fc_getVariableWeightedDisplacedSubsetCentroid" ref="g212cbb848ec9d75fa5fa6f2a59f0d6d7" args="(FC_Subset subset, FC_Variable coord_displ, FC_Variable weightsVar, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getVariableWeightedDisplacedSubsetCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>coord_displ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>weightsVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute centroid of a displaced subset. 
<p>
<b>Description:</b> <p>
The centroid is the geometric center of the subset and is calculated by averaging the coordinates in each dimension. Also called center of mass or center of gravity.<p>
<b>Modifications:</b> <ul>
<li>10/29/04 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>coord_displ</em>&nbsp;</td><td>
input - coord displacements </td></tr>
<tr><td valign="top"><em>weightsVar</em>&nbsp;</td><td>
input - weights </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of coords </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03267">3267</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01754">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="geom_8c-source.html#l02836">fc_getVariableWeightedDisplacedMeshCentroid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="geom_8c-source.html#l00309">fc_isValidDisplacementVariable()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03273"></a>03273   {
<a name="l03274"></a>03274   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03275"></a>03275   <span class="keywordtype">int</span> i, j;
<a name="l03276"></a>03276   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l03277"></a>03277   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> var_assoc, subset_assoc;
<a name="l03278"></a>03278   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype; <span class="comment">// data type</span>
<a name="l03279"></a>03279   <span class="keywordtype">int</span> numDim, numVertexInMesh, numDataPoint, data_dim;
<a name="l03280"></a>03280   <span class="keywordtype">int</span> numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l03281"></a>03281   <span class="keywordtype">double</span> coords_sum[3];
<a name="l03282"></a>03282   <span class="keywordtype">double</span> *coords, weight_sum, weight;
<a name="l03283"></a>03283   <span class="keywordtype">void</span>* data_p;
<a name="l03284"></a>03284 
<a name="l03285"></a>03285   <span class="comment">// default</span>
<a name="l03286"></a>03286   <span class="keywordflow">if</span> (dim)
<a name="l03287"></a>03287     *dim = -1;
<a name="l03288"></a>03288   <span class="keywordflow">if</span> (center) {
<a name="l03289"></a>03289     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03290"></a>03290       (*center)[i] = -1.;
<a name="l03291"></a>03291   }
<a name="l03292"></a>03292 
<a name="l03293"></a>03293   <span class="comment">// check input</span>
<a name="l03294"></a>03294   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(weightsVar) ||
<a name="l03295"></a>03295       !dim || !center) {
<a name="l03296"></a>03296     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03297"></a>03297     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03298"></a>03298   }
<a name="l03299"></a>03299   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l03300"></a>03300   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03301"></a>03301     <span class="keywordflow">return</span> rc;
<a name="l03302"></a>03302   <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricRelations.html#gcffba2f092986b21bf1fc2e2e50c8d6e">fc_isValidDisplacementVariable</a>(mesh, coord_displ)) {
<a name="l03303"></a>03303     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03304"></a>03304     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03305"></a>03305   }
<a name="l03306"></a>03306 
<a name="l03307"></a>03307   <span class="comment">// get mesh &amp; weights variable information</span>
<a name="l03308"></a>03308   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertexInMesh, NULL, NULL);
<a name="l03309"></a>03309   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03310"></a>03310     <span class="keywordflow">return</span> rc;
<a name="l03311"></a>03311   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(weightsVar, &amp;numDataPoint, &amp;data_dim, &amp;var_assoc,  
<a name="l03312"></a>03312                  NULL, &amp;datatype);
<a name="l03313"></a>03313   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03314"></a>03314     <span class="keywordflow">return</span> rc;
<a name="l03315"></a>03315   
<a name="l03316"></a>03316   <span class="comment">// more checking</span>
<a name="l03317"></a>03317   <span class="keywordflow">if</span> (var_assoc != <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a> || numDataPoint != numVertexInMesh || 
<a name="l03318"></a>03318       data_dim != 1 || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(datatype) || 
<a name="l03319"></a>03319       datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>) {
<a name="l03320"></a>03320     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Inappropriate variable for weights"</span>);
<a name="l03321"></a>03321     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03322"></a>03322   }
<a name="l03323"></a>03323 
<a name="l03324"></a>03324   <span class="comment">// log message</span>
<a name="l03325"></a>03325   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing variable weighted subset centroid."</span>);  
<a name="l03326"></a>03326   
<a name="l03327"></a>03327   <span class="comment">// setup I</span>
<a name="l03328"></a>03328   rc = <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;subset_assoc);
<a name="l03329"></a>03329   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03330"></a>03330     <span class="keywordflow">return</span> rc;
<a name="l03331"></a>03331 
<a name="l03332"></a>03332   <span class="comment">// Error case: if subset has zero members - return error</span>
<a name="l03333"></a>03333   <span class="keywordflow">if</span> (numMember == 0 ) {
<a name="l03334"></a>03334     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members"</span>);
<a name="l03335"></a>03335     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03336"></a>03336   }
<a name="l03337"></a>03337   
<a name="l03338"></a>03338   <span class="comment">// special case -- whole association</span>
<a name="l03339"></a>03339   <span class="keywordflow">if</span> (subset_assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) 
<a name="l03340"></a>03340     <span class="keywordflow">return</span> <a class="code" href="group__GeometricRelations.html#ga33e8f8750201b783262d71628c1d455">fc_getVariableWeightedDisplacedMeshCentroid</a>(mesh, coord_displ,
<a name="l03341"></a>03341                                  weightsVar, dim, center);
<a name="l03342"></a>03342     
<a name="l03343"></a>03343   <span class="comment">// setup II</span>
<a name="l03344"></a>03344   rc = <a class="code" href="group__GeometricRelations.html#g78716e2414d2a11d92097b70f5d8431c">fc_getDisplacedMeshCoords</a>(mesh, coord_displ, &amp;coords);
<a name="l03345"></a>03345   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03346"></a>03346     <span class="keywordflow">return</span> rc;
<a name="l03347"></a>03347   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(weightsVar, &amp;data_p);
<a name="l03348"></a>03348   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03349"></a>03349     <span class="keywordflow">return</span> rc;
<a name="l03350"></a>03350   
<a name="l03351"></a>03351   <span class="comment">// get vertices of the members</span>
<a name="l03352"></a>03352   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l03353"></a>03353   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03354"></a>03354     <span class="keywordflow">return</span> rc;
<a name="l03355"></a>03355   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, subset_assoc, numMember, memberIDs, 
<a name="l03356"></a>03356                                <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l03357"></a>03357   free(memberIDs);
<a name="l03358"></a>03358 
<a name="l03359"></a>03359   <span class="comment">// init coordinate sums</span>
<a name="l03360"></a>03360   weight_sum = 0.;
<a name="l03361"></a>03361   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03362"></a>03362     coords_sum[i] = 0.;
<a name="l03363"></a>03363   
<a name="l03364"></a>03364   <span class="comment">// collect sums</span>
<a name="l03365"></a>03365   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++) {
<a name="l03366"></a>03366     <span class="keywordflow">switch</span>(datatype) {
<a name="l03367"></a>03367     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> :    weight = ((<span class="keywordtype">int</span>*)data_p)[vertexIDs[i]];     <span class="keywordflow">break</span>;
<a name="l03368"></a>03368     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:   weight = ((<span class="keywordtype">float</span>*)data_p)[vertexIDs[i]];   <span class="keywordflow">break</span>;
<a name="l03369"></a>03369     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:  weight = ((<span class="keywordtype">double</span>*)data_p)[vertexIDs[i]];  <span class="keywordflow">break</span>;
<a name="l03370"></a>03370     <span class="keywordflow">default</span>:
<a name="l03371"></a>03371       ; <span class="comment">// nothing</span>
<a name="l03372"></a>03372     }
<a name="l03373"></a>03373     weight_sum += weight;
<a name="l03374"></a>03374     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l03375"></a>03375       coords_sum[j] += coords[vertexIDs[i]*numDim + j] * weight;
<a name="l03376"></a>03376   }
<a name="l03377"></a>03377   free(vertexIDs);
<a name="l03378"></a>03378   free(coords);
<a name="l03379"></a>03379   
<a name="l03380"></a>03380   <span class="comment">// calculate centroids</span>
<a name="l03381"></a>03381   *dim = numDim;
<a name="l03382"></a>03382   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l03383"></a>03383     (*center)[i] = coords_sum[i]/weight_sum;
<a name="l03384"></a>03384   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l03385"></a>03385     (*center)[i] = 0.;
<a name="l03386"></a>03386   
<a name="l03387"></a>03387   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l03388"></a>03388 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g0085e109c1963d937aeffa915fa81ceb"></a><!-- doxytag: member="geom.c::fc_getVariableWeightedMeshCentroid" ref="g0085e109c1963d937aeffa915fa81ceb" args="(FC_Mesh mesh, FC_Variable weightsVar, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getVariableWeightedMeshCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>weightsVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute variable weighted centroid of a mesh. 
<p>
<b>Description:</b> <p>
Computes the centroid of a mesh weighted by the variable values (equivalent to center of mass where the variable is the masses). The weights variable must be a scalar variable on the vertices (and should have the same number of vertices as the mesh if it is from a different mesh).<p>
<b>Modifications:</b> <ul>
<li>Wendy Koegler Created.</li><li>July 3, 2002 W Koegler Created, work in progress</li><li>July 3, 2002 W Koegler Adapted to modified _FC_Vertex</li><li>July 9, 2002 W Koegler Adapted to modified struct Vector</li><li>10/29/04 WSK added mesh to input args and dim to output args. Fixed up. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>weightsVar</em>&nbsp;</td><td>
input - weights </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of centroid </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l02734">2734</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l03138">fc_getVariableWeightedSubsetCentroid()</a>.<div class="fragment"><pre class="fragment"><a name="l02739"></a>02739   {
<a name="l02740"></a>02740   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l02741"></a>02741   <span class="keywordtype">int</span> i, j;
<a name="l02742"></a>02742   <span class="keywordtype">int</span> numDim, numVertex, numDataPoint, data_dim;
<a name="l02743"></a>02743   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc; <span class="comment">// data association</span>
<a name="l02744"></a>02744   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype; <span class="comment">// data type</span>
<a name="l02745"></a>02745   <span class="keywordtype">double</span> coords_sum[3];
<a name="l02746"></a>02746   <span class="keywordtype">double</span>* coords_p, weight_sum, weight;
<a name="l02747"></a>02747   <span class="keywordtype">void</span>* data_p;
<a name="l02748"></a>02748 
<a name="l02749"></a>02749   <span class="comment">// default output</span>
<a name="l02750"></a>02750   <span class="keywordflow">if</span> (dim)
<a name="l02751"></a>02751     *dim = -1;
<a name="l02752"></a>02752   <span class="keywordflow">if</span> (center) {
<a name="l02753"></a>02753     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02754"></a>02754       (*center)[i] = -1.;
<a name="l02755"></a>02755   }
<a name="l02756"></a>02756 
<a name="l02757"></a>02757   <span class="comment">// check input</span>
<a name="l02758"></a>02758   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(weightsVar) || !dim || 
<a name="l02759"></a>02759       !center) {
<a name="l02760"></a>02760     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l02761"></a>02761     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l02762"></a>02762   }
<a name="l02763"></a>02763   
<a name="l02764"></a>02764   <span class="comment">// get mesh &amp; variable information</span>
<a name="l02765"></a>02765   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l02766"></a>02766   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02767"></a>02767     <span class="keywordflow">return</span> rc;
<a name="l02768"></a>02768   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(weightsVar, &amp;numDataPoint, &amp;data_dim, &amp;assoc,  
<a name="l02769"></a>02769                  NULL, &amp;datatype);
<a name="l02770"></a>02770   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02771"></a>02771     <span class="keywordflow">return</span> rc;
<a name="l02772"></a>02772   
<a name="l02773"></a>02773    <span class="comment">// more checking</span>
<a name="l02774"></a>02774   <span class="keywordflow">if</span> (assoc != <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a> || numDataPoint != numVertex || data_dim != 1 ||
<a name="l02775"></a>02775       !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(datatype) || datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || 
<a name="l02776"></a>02776       datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>) {
<a name="l02777"></a>02777     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Inappropriate variable for weights"</span>);
<a name="l02778"></a>02778     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l02779"></a>02779   }
<a name="l02780"></a>02780 
<a name="l02781"></a>02781   <span class="comment">// log message</span>
<a name="l02782"></a>02782   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing variable weighted centroid of mesh."</span>);  
<a name="l02783"></a>02783 
<a name="l02784"></a>02784   <span class="comment">// get vertices and data</span>
<a name="l02785"></a>02785   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l02786"></a>02786   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02787"></a>02787     <span class="keywordflow">return</span> rc;
<a name="l02788"></a>02788   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(weightsVar, &amp;data_p);
<a name="l02789"></a>02789   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l02790"></a>02790     <span class="keywordflow">return</span> rc;
<a name="l02791"></a>02791 
<a name="l02792"></a>02792 
<a name="l02793"></a>02793   <span class="comment">// init coord sums</span>
<a name="l02794"></a>02794   weight_sum = 0.;
<a name="l02795"></a>02795   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l02796"></a>02796     coords_sum[i] = 0;
<a name="l02797"></a>02797 
<a name="l02798"></a>02798   <span class="comment">// collect sums</span>
<a name="l02799"></a>02799   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++) {
<a name="l02800"></a>02800     <span class="keywordflow">switch</span>(datatype) {
<a name="l02801"></a>02801     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> :    weight = ((<span class="keywordtype">int</span>*)data_p)[i];     <span class="keywordflow">break</span>;
<a name="l02802"></a>02802     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:   weight = ((<span class="keywordtype">float</span>*)data_p)[i];   <span class="keywordflow">break</span>;
<a name="l02803"></a>02803     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:  weight = ((<span class="keywordtype">double</span>*)data_p)[i];  <span class="keywordflow">break</span>;
<a name="l02804"></a>02804     <span class="keywordflow">default</span>:
<a name="l02805"></a>02805       ; <span class="comment">// nothing</span>
<a name="l02806"></a>02806     }
<a name="l02807"></a>02807     weight_sum += weight;
<a name="l02808"></a>02808     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++) 
<a name="l02809"></a>02809       coords_sum[j] += coords_p[i*numDim + j] * weight;
<a name="l02810"></a>02810   }
<a name="l02811"></a>02811 
<a name="l02812"></a>02812   <span class="comment">// calculate weight centroid</span>
<a name="l02813"></a>02813   *dim = numDim;
<a name="l02814"></a>02814   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l02815"></a>02815     (*center)[i] = coords_sum[i]/weight_sum;
<a name="l02816"></a>02816   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l02817"></a>02817     (*center)[i] = 0.;
<a name="l02818"></a>02818 
<a name="l02819"></a>02819   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l02820"></a>02820 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ge82d1284fda2ed5b7fe3d041ba86742b"></a><!-- doxytag: member="geom.c::fc_getVariableWeightedSubsetCentroid" ref="ge82d1284fda2ed5b7fe3d041ba86742b" args="(FC_Subset subset, FC_Variable weightsVar, int *dim, FC_Coords *center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_getVariableWeightedSubsetCentroid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>weightsVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *&nbsp;</td>
          <td class="paramname"> <em>center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute centroid of a subset. 
<p>
<b>Description:</b> <p>
The centroid is the geometric center of the subset and is calculated by averaging the coordinates in each dimension. Also called center of mass or center of gravity.<p>
<b>Modifications:</b> <ul>
<li>10/29/04 WSK Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>subset</em>&nbsp;</td><td>
input - subset </td></tr>
<tr><td valign="top"><em>weightsVar</em>&nbsp;</td><td>
input - weights </td></tr>
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
output - dimensionality of coords </td></tr>
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
output - coordinates of centroid </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l03138">3138</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>, <a class="el" href="topo_8c-source.html#l00369">fc_changeMeshEntityType()</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a>, <a class="el" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01754">fc_getSubsetInfo()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="variable_8c-source.html#l04591">fc_getVariableDataPtr()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="geom_8c-source.html#l02734">fc_getVariableWeightedMeshCentroid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="base_8c-source.html#l00239">fc_isDataTypeValid()</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03143"></a>03143   {
<a name="l03144"></a>03144   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l03145"></a>03145   <span class="keywordtype">int</span> i, j;
<a name="l03146"></a>03146   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh;
<a name="l03147"></a>03147   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> var_assoc, subset_assoc;
<a name="l03148"></a>03148   <a class="code" href="group__DataTypes.html#gbbab9b2f35d4bc42e868e4f5853a6297">FC_DataType</a> datatype; <span class="comment">// data type</span>
<a name="l03149"></a>03149   <span class="keywordtype">int</span> numDim, numVertexInMesh, numDataPoint, data_dim;
<a name="l03150"></a>03150   <span class="keywordtype">int</span> numVertex, *vertexIDs, numMember, *memberIDs;
<a name="l03151"></a>03151   <span class="keywordtype">double</span> coords_sum[3];
<a name="l03152"></a>03152   <span class="keywordtype">double</span> *coords_p, weight_sum, weight;
<a name="l03153"></a>03153   <span class="keywordtype">void</span>* data_p;
<a name="l03154"></a>03154 
<a name="l03155"></a>03155   <span class="comment">// default</span>
<a name="l03156"></a>03156   <span class="keywordflow">if</span> (dim)
<a name="l03157"></a>03157     *dim = -1;
<a name="l03158"></a>03158   <span class="keywordflow">if</span> (center) {
<a name="l03159"></a>03159     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03160"></a>03160       (*center)[i] = -1.;
<a name="l03161"></a>03161   }
<a name="l03162"></a>03162 
<a name="l03163"></a>03163   <span class="comment">// check input</span>
<a name="l03164"></a>03164   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(subset) || !<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(weightsVar) || !dim 
<a name="l03165"></a>03165       || !center) {
<a name="l03166"></a>03166     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l03167"></a>03167     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l03168"></a>03168   }
<a name="l03169"></a>03169 
<a name="l03170"></a>03170   <span class="comment">// get mesh &amp; variable information</span>
<a name="l03171"></a>03171   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(subset, &amp;mesh);
<a name="l03172"></a>03172   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03173"></a>03173     <span class="keywordflow">return</span> rc;
<a name="l03174"></a>03174   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertexInMesh, NULL, NULL);
<a name="l03175"></a>03175   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03176"></a>03176     <span class="keywordflow">return</span> rc;
<a name="l03177"></a>03177   rc = <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(weightsVar, &amp;numDataPoint, &amp;data_dim, &amp;var_assoc,  
<a name="l03178"></a>03178                  NULL, &amp;datatype);
<a name="l03179"></a>03179   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03180"></a>03180     <span class="keywordflow">return</span> rc;
<a name="l03181"></a>03181   
<a name="l03182"></a>03182   <span class="comment">// more checking</span>
<a name="l03183"></a>03183   <span class="keywordflow">if</span> (var_assoc != <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a> || numDataPoint != numVertexInMesh || 
<a name="l03184"></a>03184       data_dim != 1 || !<a class="code" href="group__DataTypes.html#ged8b462070c0f2617ee62753bcbe2f19">fc_isDataTypeValid</a>(datatype) || 
<a name="l03185"></a>03185       datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a62975da602b780b75ca6362662d6a9ad5a5f">FC_DT_UNKNOWN</a> || datatype == <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297a1c2c6e22d293be2bf392b0b2633b387">FC_DT_CHAR</a>) {
<a name="l03186"></a>03186     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Inappropriate variable for weights"</span>);
<a name="l03187"></a>03187     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03188"></a>03188   }
<a name="l03189"></a>03189 
<a name="l03190"></a>03190   <span class="comment">// log message</span>
<a name="l03191"></a>03191   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"Computing variable weighted subset centroid."</span>);  
<a name="l03192"></a>03192   
<a name="l03193"></a>03193   <span class="comment">// setup I</span>
<a name="l03194"></a>03194   rc = <a class="code" href="group__Subset.html#g23f364364af36ff74b89ffecf1c4ae28">fc_getSubsetInfo</a>(subset, &amp;numMember, NULL, &amp;subset_assoc);
<a name="l03195"></a>03195   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03196"></a>03196     <span class="keywordflow">return</span> rc;
<a name="l03197"></a>03197 
<a name="l03198"></a>03198   <span class="comment">// Error case: if subset has zero members - return error</span>
<a name="l03199"></a>03199   <span class="keywordflow">if</span> (numMember == 0 ) {
<a name="l03200"></a>03200     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subset has 0 members"</span>);
<a name="l03201"></a>03201     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l03202"></a>03202   }
<a name="l03203"></a>03203   
<a name="l03204"></a>03204   <span class="comment">// special case -- whole association</span>
<a name="l03205"></a>03205   <span class="keywordflow">if</span> (subset_assoc == <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b304008f144f8c1298e5724d7a601ed063099">FC_AT_WHOLE_MESH</a>) 
<a name="l03206"></a>03206     <span class="keywordflow">return</span> <a class="code" href="group__GeometricRelations.html#g0085e109c1963d937aeffa915fa81ceb">fc_getVariableWeightedMeshCentroid</a>(mesh, weightsVar, dim, center);
<a name="l03207"></a>03207     
<a name="l03208"></a>03208   <span class="comment">// setup II</span>
<a name="l03209"></a>03209   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh, &amp;coords_p);
<a name="l03210"></a>03210   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03211"></a>03211     <span class="keywordflow">return</span> rc;
<a name="l03212"></a>03212   rc = <a class="code" href="group__Variable.html#g26d6dc6119ce91abb2d2b0edf17865f6">fc_getVariableDataPtr</a>(weightsVar, &amp;data_p);
<a name="l03213"></a>03213   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03214"></a>03214     <span class="keywordflow">return</span> rc;
<a name="l03215"></a>03215   
<a name="l03216"></a>03216   <span class="comment">// get vertices of the members</span>
<a name="l03217"></a>03217   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(subset, &amp;numMember, &amp;memberIDs);
<a name="l03218"></a>03218   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l03219"></a>03219     <span class="keywordflow">return</span> rc;
<a name="l03220"></a>03220   rc = <a class="code" href="group__TopologyRelations.html#gf4ca2001668b08cc6c09a88f55e45ebe">fc_changeMeshEntityType</a>(mesh, subset_assoc, numMember, memberIDs, 
<a name="l03221"></a>03221                                <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b30408cc812de98bed6c7106d5fa72e11f726">FC_AT_VERTEX</a>, 1, &amp;numVertex, &amp;vertexIDs);
<a name="l03222"></a>03222   free(memberIDs);
<a name="l03223"></a>03223 
<a name="l03224"></a>03224   <span class="comment">// init coordinate sums</span>
<a name="l03225"></a>03225   weight_sum = 0.;
<a name="l03226"></a>03226   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l03227"></a>03227     coords_sum[i] = 0.;
<a name="l03228"></a>03228   
<a name="l03229"></a>03229   <span class="comment">// collect sums</span>
<a name="l03230"></a>03230   <span class="keywordflow">for</span> (i = 0; i &lt; numVertex; i++) {
<a name="l03231"></a>03231     <span class="keywordflow">switch</span>(datatype) {
<a name="l03232"></a>03232     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297f0b74a7d9f58ca6960dd832980645f7d">FC_DT_INT</a> :    weight = ((<span class="keywordtype">int</span>*)data_p)[vertexIDs[i]];     <span class="keywordflow">break</span>;
<a name="l03233"></a>03233     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297ad59da2c9908f7fd6dcc81b25680057b">FC_DT_FLOAT</a>:   weight = ((<span class="keywordtype">float</span>*)data_p)[vertexIDs[i]];   <span class="keywordflow">break</span>;
<a name="l03234"></a>03234     <span class="keywordflow">case</span> <a class="code" href="group__DataTypes.html#ggbbab9b2f35d4bc42e868e4f5853a6297806cef8a12ffc6ef267ac21addb95ab3">FC_DT_DOUBLE</a>:  weight = ((<span class="keywordtype">double</span>*)data_p)[vertexIDs[i]];  <span class="keywordflow">break</span>;
<a name="l03235"></a>03235     <span class="keywordflow">default</span>:
<a name="l03236"></a>03236       ; <span class="comment">// nothing</span>
<a name="l03237"></a>03237     }
<a name="l03238"></a>03238     weight_sum += weight;
<a name="l03239"></a>03239     <span class="keywordflow">for</span> (j = 0; j &lt; numDim; j++)
<a name="l03240"></a>03240       coords_sum[j] += coords_p[vertexIDs[i]*numDim + j] * weight;
<a name="l03241"></a>03241   }
<a name="l03242"></a>03242   free(vertexIDs);
<a name="l03243"></a>03243   
<a name="l03244"></a>03244   <span class="comment">// calculate centroids</span>
<a name="l03245"></a>03245   *dim = numDim;
<a name="l03246"></a>03246   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++)
<a name="l03247"></a>03247     (*center)[i] = coords_sum[i]/weight_sum;
<a name="l03248"></a>03248   <span class="keywordflow">for</span> (i = numDim; i &lt; 3; i++)
<a name="l03249"></a>03249     (*center)[i] = 0.;
<a name="l03250"></a>03250   
<a name="l03251"></a>03251   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l03252"></a>03252 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gecdc6fb052fa5d9dc695fcd6be58c808"></a><!-- doxytag: member="geom.c::fc_isBoundingBoxValid" ref="gecdc6fb052fa5d9dc695fcd6be58c808" args="(int numDim, FC_Coords lowpoint, FC_Coords highpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fc_isBoundingBoxValid           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>lowpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>highpoint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determine if a bounding box is valid. 
<p>
<b>Description:</b> <p>
For a bounding box to be valid, the lowpoint cannot be "higher" in coordinates space than the highpoint. This is determined by a component-wise comparison of coordinates. A zero width bounding box (lowpoint = highpoint) is considered valid.<p>
Returns 1 (true) for valid, 0 (false) for not valid.<p>
<b>Modifications:</b> <ul>
<li>10/28/04 WSK, created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>numDim</em>&nbsp;</td><td>
input - the number of dimensions of bbox </td></tr>
<tr><td valign="top"><em>lowpoint</em>&nbsp;</td><td>
input - lower left corner of bbox </td></tr>
<tr><td valign="top"><em>highpoint</em>&nbsp;</td><td>
input - upper right corner of bbox </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00444">444</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="util_8c-source.html#l00691">fc_gtd()</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l06312">_fc_getVertexIDsWithinBoundingBoxUsingVertexBin()</a>, <a class="el" href="geom_8c-source.html#l00614">fc_combineBoundingBoxes()</a>, <a class="el" href="geom_8c-source.html#l00480">fc_getBoundingBoxesOverlap()</a>, and <a class="el" href="geom_8c-source.html#l05704">fc_getEntitiesWithinBoundingBox()</a>.<div class="fragment"><pre class="fragment"><a name="l00448"></a>00448   {
<a name="l00449"></a>00449   <span class="keywordtype">int</span> i;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <span class="keywordflow">if</span> (numDim &lt; 1 || numDim &gt; 3 || !lowpoint || !highpoint)
<a name="l00452"></a>00452     <span class="keywordflow">return</span> 0; <span class="comment">// not valid</span>
<a name="l00453"></a>00453   <span class="keywordflow">for</span> (i = 0; i &lt; numDim; i++) {
<a name="l00454"></a>00454     <span class="keywordflow">if</span> (<a class="code" href="group__PublicFloatingPoint.html#g94f8391d98988b0cff3796b546140f3d">fc_gtd</a>(lowpoint[i], highpoint[i]))
<a name="l00455"></a>00455       <span class="keywordflow">return</span> 0; <span class="comment">// not valid</span>
<a name="l00456"></a>00456   }
<a name="l00457"></a>00457  
<a name="l00458"></a>00458   <span class="comment">// passed all tests</span>
<a name="l00459"></a>00459   <span class="keywordflow">return</span> 1; <span class="comment">// valid</span>
<a name="l00460"></a>00460 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gcffba2f092986b21bf1fc2e2e50c8d6e"></a><!-- doxytag: member="geom.c::fc_isValidDisplacementVariable" ref="gcffba2f092986b21bf1fc2e2e50c8d6e" args="(FC_Mesh mesh, FC_Variable variable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fc_isValidDisplacementVariable           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Variable.html">FC_Variable</a>&nbsp;</td>
          <td class="paramname"> <em>variable</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Test to see if variable can be used as displacment variable. 
<p>
<b>Description:</b> <p>
Test a variable to see if it can be used as a displacement variable on the given mesh. The variable does NOT have to be on the given mesh, but has to match enough to be used. The variable must have the same number of as the mesh has vertices and the number of components must equal the dimensionality of the mesh.<p>
Returns true (1) if the variable can be used as displacements on the mesh, false (0) if the variable is not appropriate to use on the mesh (including the case if either the mesh or variable are not valid).<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000031">Todo:</a></b></dt><dd>Should we be more strick. Should the var have to be on verts? Should the var have the correct math type?</dd></dl>
<b>Modifications:</b> <ul>
<li>02/14/2006 WSD, Created. </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - the mesh that the displacement would be applied to </td></tr>
<tr><td valign="top"><em>variable</em>&nbsp;</td><td>
input - the variable to check </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l00309">309</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="variable_8c-source.html#l04309">fc_getVariableInfo()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="variable_8c-source.html#l04032">fc_isVariableValid()</a>, and <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l06615">_fc_geomSmoothCore()</a>, <a class="el" href="geom_8c-source.html#l05181">_fc_getSubsetsProximityArgsTest()</a>, <a class="el" href="geom_8c-source.html#l04764">fc_calcMeshDeformationUsingCentroid()</a>, <a class="el" href="geom_8c-source.html#l04650">fc_calcMeshDeformationUsingRefVertex()</a>, <a class="el" href="geom_8c-source.html#l05589">fc_createDisplacedMeshVertexBin()</a>, <a class="el" href="geom_8c-source.html#l06028">fc_displacedGeomSmoothSeqVariable()</a>, <a class="el" href="geom_8c-source.html#l03503">fc_getDisplacedEdgeLengths()</a>, <a class="el" href="geom_8c-source.html#l03702">fc_getDisplacedFaceAreas()</a>, <a class="el" href="geom_8c-source.html#l00763">fc_getDisplacedMeshBoundingBox()</a>, <a class="el" href="geom_8c-source.html#l02656">fc_getDisplacedMeshCentroid()</a>, <a class="el" href="geom_8c-source.html#l00352">fc_getDisplacedMeshCoords()</a>, <a class="el" href="geom_8c-source.html#l01699">fc_getDisplacedMeshDiameter()</a>, <a class="el" href="geom_8c-source.html#l01929">fc_getDisplacedMeshesDiameter()</a>, <a class="el" href="geom_8c-source.html#l04065">fc_getDisplacedMeshVolume()</a>, <a class="el" href="geom_8c-source.html#l03900">fc_getDisplacedRegionVolumes()</a>, <a class="el" href="geom_8c-source.html#l00956">fc_getDisplacedSubsetBoundingBox()</a>, <a class="el" href="geom_8c-source.html#l03036">fc_getDisplacedSubsetCentroid()</a>, <a class="el" href="geom_8c-source.html#l01790">fc_getDisplacedSubsetDiameter()</a>, <a class="el" href="geom_8c-source.html#l02068">fc_getDisplacedSubsetsDiameter()</a>, <a class="el" href="geom_8c-source.html#l04240">fc_getDisplacedSubsetVolume()</a>, <a class="el" href="geom_8c-source.html#l04542">fc_getDisplacedSurfaceNormals()</a>, <a class="el" href="geom_8c-source.html#l02836">fc_getVariableWeightedDisplacedMeshCentroid()</a>, <a class="el" href="geom_8c-source.html#l03267">fc_getVariableWeightedDisplacedSubsetCentroid()</a>, and <a class="el" href="edgeStats_8c-source.html#l00105">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00313"></a>00313   {
<a name="l00314"></a>00314   <span class="keywordtype">int</span> numDim, numVertex, numDataPoint, numComp;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316   <span class="comment">// test input</span>
<a name="l00317"></a>00317   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !<a class="code" href="group__Variable.html#g888dc4800278e9343a1c35599fa82d63">fc_isVariableValid</a>(variable)) {
<a name="l00318"></a>00318     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l00319"></a>00319     <span class="keywordflow">return</span> 0;
<a name="l00320"></a>00320   }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322   <span class="comment">// collect info</span>
<a name="l00323"></a>00323   <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a>(mesh, NULL, &amp;numDim, &amp;numVertex, NULL, NULL);
<a name="l00324"></a>00324   <a class="code" href="group__Variable.html#g415dc8be07262ef04c7c66028bc0217f">fc_getVariableInfo</a>(variable, &amp;numDataPoint, &amp;numComp, NULL, NULL, NULL);
<a name="l00325"></a>00325 
<a name="l00326"></a>00326   <span class="comment">// testing</span>
<a name="l00327"></a>00327   <span class="keywordflow">if</span> (numDim != numComp || numVertex != numDataPoint)
<a name="l00328"></a>00328     <span class="keywordflow">return</span> 0;
<a name="l00329"></a>00329 
<a name="l00330"></a>00330   <span class="comment">// passed tests</span>
<a name="l00331"></a>00331   <span class="keywordflow">return</span> 1;
<a name="l00332"></a>00332 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g94257f304b660eff0908ee4f1b721713"></a><!-- doxytag: member="geom.c::fc_projectedElementBoundingBoxIntersection" ref="g94257f304b660eff0908ee4f1b721713" args="(FC_Mesh mesh, int elemID_1, int elemID_2, FC_Coords proj_normal, int *intersectval)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_projectedElementBoundingBoxIntersection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>elemID_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>elemID_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>proj_normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>intersectval</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns indication if the bounding boxes of 2 elements, when projected onto the same planar surface (given a projection direction) haven any intersection. 
<p>
<b>Description:</b> <p>
Returns indication if the bounding boxes of 2 elements, when projected onto the same planar surface (given a projection direction) have any intersection.<p>
The intent of this method is to find overlap of projections of elements, but the mathematics of that can be very complex for general cases. Instead we are going with the more trivial bounding box approach and hoping that gives us enough information.<p>
Returns 1 if there is any overlap and 0 if there is none. Single point or single edge overlap is considered not to be overlap, since that is only boundary overlap, except for cases where an element projects into a line or point. Returns -1 in case of error.<p>
Note: I have the proj normal as FC_Coords rather than a vector. I have debated chanign this to a FC_Vector instead.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000032">Todo:</a></b></dt><dd><ul>
<li>see if the BB version gives the resolution necessary</li><li>see if the exceptions for the cases of points and lines are really the exceptions we want to make.</li><li>check results for 2 dimensions -- SHOULD THIS EVEN WORK FOR 2D elems ?</li><li>can reduce the allocation of intermediate results if turns out we wont actaully need to keep them (some intermediates im keeping while i decide on the algorithm)</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>10/21/05 ACG created (but not put into production)</li><li>10/24/05 ACG changed from face occlusion to projected element bounding box overlap to simplify algorithmic necessity of handling possibly concave simple polygon intersection.</li><li>11/21/05 ACG putting into production now that lower level type changes are completed</li><li>03/15/06 ACG changed projnormal type from double* to FC_Coords</li><li>03/28/06 ACG fixed bug in proj matrix - i had it antisymmetirc rather than symmetric </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>mesh</em>&nbsp;</td><td>
input - mesh </td></tr>
<tr><td valign="top"><em>elemID_1</em>&nbsp;</td><td>
input - elementID 1 </td></tr>
<tr><td valign="top"><em>elemID_2</em>&nbsp;</td><td>
input - elementID 2 </td></tr>
<tr><td valign="top"><em>proj_normal</em>&nbsp;</td><td>
input - the proj normal </td></tr>
<tr><td valign="top"><em>intersectval</em>&nbsp;</td><td>
output - result 1 or 0 </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01223">1223</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="util_8h-source.html#l00136">FC_DBL_EQUIV</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="util_8h-source.html#l00111">FC_FLT_EQUIV</a>, <a class="el" href="base_8c-source.html#l00549">fc_getElementTypeNumVertex()</a>, <a class="el" href="mesh_8c-source.html#l02655">fc_getMeshCoordsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02981">fc_getMeshElementConnsPtr()</a>, <a class="el" href="mesh_8c-source.html#l02067">fc_getMeshInfo()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="mesh_8c-source.html#l01961">fc_isMeshValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00162">fc_printfLogMessage</a>, and <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>.
<p>
Referenced by <a class="el" href="geom_8c-source.html#l01456">fc_projectedSubsetElementBoundingBoxIntersection()</a>.<div class="fragment"><pre class="fragment"><a name="l01229"></a>01229  {
<a name="l01230"></a>01230   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01231"></a>01231   <span class="keywordtype">int</span> *elem_id_array;
<a name="l01232"></a>01232   <a class="code" href="group__DataTypes.html#g5d0bf8bd47afb81d89d4c5d60c7d62b4">FC_ElementType</a> elemtype;
<a name="l01233"></a>01233   <a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a> *refcoords, *projrefcoords, *compcoords, *projcompcoords; 
<a name="l01234"></a>01234   <span class="keywordtype">double</span> *mesh_coords;
<a name="l01235"></a>01235   <span class="keywordtype">double</span> minmax[2][6];
<a name="l01236"></a>01236   <span class="keywordtype">double</span> projmatrix[3][3];
<a name="l01237"></a>01237   <span class="keywordtype">double</span> tempval, val;
<a name="l01238"></a>01238 
<a name="l01239"></a>01239   <span class="comment">//  FC_Vector temp_normal;</span>
<a name="l01240"></a>01240   <span class="keywordtype">int</span> topodim,numDim;
<a name="l01241"></a>01241   <span class="keywordtype">int</span> line[2][3];
<a name="l01242"></a>01242   <span class="keywordtype">int</span> numelem, numvertex,e_vertex;
<a name="l01243"></a>01243   <span class="keywordtype">int</span> i,j,k;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245   <span class="keywordflow">if</span> (intersectval)
<a name="l01246"></a>01246     *intersectval = -1;
<a name="l01247"></a>01247 
<a name="l01248"></a>01248   <span class="keywordflow">if</span> (!<a class="code" href="group__Mesh.html#gdc4cdd6e7f6a9151458bcb2c25715fd5">fc_isMeshValid</a>(mesh) || !intersectval){
<a name="l01249"></a>01249     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01250"></a>01250     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01251"></a>01251   }
<a name="l01252"></a>01252   
<a name="l01253"></a>01253 
<a name="l01254"></a>01254   <span class="comment">// log message</span>
<a name="l01255"></a>01255   <a class="code" href="group__Library.html#g523b10264df36531b23de2260393db30">fc_printfLogMessage</a>(<span class="stringliteral">"calc elem bounding box intersection."</span>);   
<a name="l01256"></a>01256 
<a name="l01257"></a>01257   rc = <a class="code" href="group__Mesh.html#g12034c759ea24e05c321a611de1bab8e">fc_getMeshInfo</a> (mesh,&amp;topodim,&amp;numDim,&amp;numvertex,&amp;numelem,&amp;elemtype);
<a name="l01258"></a>01258   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01259"></a>01259     <span class="keywordflow">return</span> rc;
<a name="l01260"></a>01260  <span class="comment">//Note: verify that ID is same as array index</span>
<a name="l01261"></a>01261   <span class="keywordflow">if</span> (elemID_1 &lt; 0 || elemID_1 &gt; numelem ||
<a name="l01262"></a>01262       elemID_2 &lt; 0 || elemID_2 &gt; numelem){
<a name="l01263"></a>01263     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01264"></a>01264     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01265"></a>01265   }
<a name="l01266"></a>01266 
<a name="l01267"></a>01267   tempval = 0.;
<a name="l01268"></a>01268   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l01269"></a>01269     tempval+=proj_normal[i]*proj_normal[i];
<a name="l01270"></a>01270   }
<a name="l01271"></a>01271 
<a name="l01272"></a>01272   <span class="keywordflow">if</span> (tempval &lt; 0){
<a name="l01273"></a>01273     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"bad val for normal"</span>);
<a name="l01274"></a>01274     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01275"></a>01275   }
<a name="l01276"></a>01276   val = sqrt(fabs(tempval));
<a name="l01277"></a>01277 
<a name="l01278"></a>01278   <span class="comment">//make sure normal has mag 1</span>
<a name="l01279"></a>01279   <span class="keywordflow">if</span> (!(<a class="code" href="group__PublicFloatingPoint.html#gcca666e28137c4c9e0d737733275530b">FC_FLT_EQUIV</a>(val,1.0))){
<a name="l01280"></a>01280     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"normal does not have magnitude 1"</span>);
<a name="l01281"></a>01281     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01282"></a>01282   }
<a name="l01283"></a>01283 
<a name="l01284"></a>01284   <span class="comment">//get numverticies for the elem</span>
<a name="l01285"></a>01285   e_vertex = <a class="code" href="group__DataTypes.html#gf75ed80296bf7b5631bf464ea4a4de25">fc_getElementTypeNumVertex</a>(elemtype);
<a name="l01286"></a>01286   <span class="keywordflow">if</span> (e_vertex &lt; 1){
<a name="l01287"></a>01287     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"bad number of verticies for these elements"</span>);
<a name="l01288"></a>01288     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01289"></a>01289   }
<a name="l01290"></a>01290 
<a name="l01291"></a>01291   rc = <a class="code" href="group__Mesh.html#g71ce3ca34963dcc548b6a7c38aa17fd9">fc_getMeshElementConnsPtr</a>(mesh,&amp;elem_id_array);
<a name="l01292"></a>01292   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01293"></a>01293     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295   rc = <a class="code" href="group__Mesh.html#g44d09391731a139c4efc2c4fb2eda4e7">fc_getMeshCoordsPtr</a>(mesh,&amp;mesh_coords);
<a name="l01296"></a>01296   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01297"></a>01297     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01298"></a>01298 
<a name="l01299"></a>01299 
<a name="l01300"></a>01300   refcoords = (<a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>*)malloc(e_vertex*<span class="keyword">sizeof</span>(<a class="code" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>));
<a name="l01301"></a>01301   compcoords = (FC_Coords*)malloc(e_vertex*<span class="keyword">sizeof</span>(FC_Coords));
<a name="l01302"></a>01302   projrefcoords = (FC_Coords*)malloc(e_vertex*<span class="keyword">sizeof</span>(FC_Coords));
<a name="l01303"></a>01303   projcompcoords = (FC_Coords*)malloc(e_vertex*<span class="keyword">sizeof</span>(FC_Coords));
<a name="l01304"></a>01304 
<a name="l01305"></a>01305   <span class="keywordflow">if</span> (!refcoords || !compcoords || !projrefcoords || !projcompcoords){
<a name="l01306"></a>01306     <span class="keywordflow">if</span> (refcoords) free(refcoords);
<a name="l01307"></a>01307     <span class="keywordflow">if</span> (projrefcoords) free(projrefcoords);
<a name="l01308"></a>01308     <span class="keywordflow">if</span> (compcoords) free(compcoords);
<a name="l01309"></a>01309     <span class="keywordflow">if</span> (compcoords) free(projcompcoords);
<a name="l01310"></a>01310     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01311"></a>01311     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;               
<a name="l01312"></a>01312   }
<a name="l01313"></a>01313 
<a name="l01314"></a>01314   <span class="comment">//  printf("\n");</span>
<a name="l01315"></a>01315   <span class="keywordflow">for</span> (j = 0; j &lt; e_vertex; j++){
<a name="l01316"></a>01316     <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++)
<a name="l01317"></a>01317       <span class="comment">//       refcoords[j][k] = mesh_coords[conns[elemID_1*e_vertex+j]*numDim+k];</span>
<a name="l01318"></a>01318       refcoords[j][k] = mesh_coords[elem_id_array[elemID_1*e_vertex +j]*numDim+k];
<a name="l01319"></a>01319     <span class="keywordflow">if</span> (numDim &lt; 3) refcoords[j][2] = 0;
<a name="l01320"></a>01320   }
<a name="l01321"></a>01321 
<a name="l01322"></a>01322   <span class="keywordflow">for</span> (j = 0; j &lt; e_vertex; j++){
<a name="l01323"></a>01323     <span class="keywordflow">for</span> (k = 0; k &lt; numDim; k++)
<a name="l01324"></a>01324       compcoords[j][k] = mesh_coords[elem_id_array[elemID_2*e_vertex+j]*numDim+k];
<a name="l01325"></a>01325     <span class="keywordflow">if</span> (numDim &lt; 3) compcoords[j][2] = 0;
<a name="l01326"></a>01326   }
<a name="l01327"></a>01327 
<a name="l01328"></a>01328 
<a name="l01329"></a>01329   <span class="comment">// project each of the points onto the plane defined by the proj normal</span>
<a name="l01330"></a>01330   <span class="comment">// its is ax+by+cz = 0 for the plane that intersects the origin where</span>
<a name="l01331"></a>01331   <span class="comment">// a,b,and c are the components of the proj normal</span>
<a name="l01332"></a>01332   projmatrix[0][0] = proj_normal[1]*proj_normal[1]+
<a name="l01333"></a>01333     proj_normal[2]*proj_normal[2];
<a name="l01334"></a>01334   projmatrix[1][1] = proj_normal[0]*proj_normal[0]+
<a name="l01335"></a>01335     proj_normal[2]*proj_normal[2];
<a name="l01336"></a>01336   projmatrix[2][2] = proj_normal[0]*proj_normal[0]+
<a name="l01337"></a>01337     proj_normal[1]*proj_normal[1];
<a name="l01338"></a>01338   projmatrix[0][1] = -proj_normal[0]*proj_normal[1];
<a name="l01339"></a>01339   projmatrix[0][2] = -proj_normal[0]*proj_normal[2];
<a name="l01340"></a>01340   projmatrix[1][0] = projmatrix[0][1];
<a name="l01341"></a>01341   projmatrix[2][0] = projmatrix[0][2];
<a name="l01342"></a>01342   projmatrix[1][2] = -proj_normal[1]*proj_normal[2];
<a name="l01343"></a>01343   projmatrix[2][1] = projmatrix[1][2];
<a name="l01344"></a>01344 
<a name="l01345"></a>01345 
<a name="l01346"></a>01346   <span class="comment">//proj each point of the elems onto the projection plane. dont</span>
<a name="l01347"></a>01347   <span class="comment">//actaully need to keep these, but holding on to them</span>
<a name="l01348"></a>01348   <span class="comment">//for now in case i change the algorithm</span>
<a name="l01349"></a>01349   <span class="comment">//and get the bounding boxes for the resulting elements</span>
<a name="l01350"></a>01350   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++){
<a name="l01351"></a>01351     <span class="keywordflow">for</span> (j = 0; j &lt;3; j++){
<a name="l01352"></a>01352       minmax[i][2*j] = DBL_MAX;
<a name="l01353"></a>01353       minmax[i][2*j+1] = -1*DBL_MAX;
<a name="l01354"></a>01354     }
<a name="l01355"></a>01355   }
<a name="l01356"></a>01356 
<a name="l01357"></a>01357 
<a name="l01358"></a>01358   <span class="keywordflow">for</span> (i = 0; i &lt; e_vertex; i++){ <span class="comment">//for each vertex</span>
<a name="l01359"></a>01359     <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++){ <span class="comment">//for each component</span>
<a name="l01360"></a>01360       projrefcoords[i][j] = 
<a name="l01361"></a>01361      projmatrix[j][0] * refcoords[i][0]+
<a name="l01362"></a>01362      projmatrix[j][1] * refcoords[i][1]+
<a name="l01363"></a>01363      projmatrix[j][2] * refcoords[i][2];
<a name="l01364"></a>01364       projcompcoords[i][j] = 
<a name="l01365"></a>01365      projmatrix[j][0] * compcoords[i][0]+
<a name="l01366"></a>01366      projmatrix[j][1] * compcoords[i][1]+
<a name="l01367"></a>01367      projmatrix[j][2] * compcoords[i][2];
<a name="l01368"></a>01368       minmax[0][2*j] = (projrefcoords[i][j] &lt; minmax[0][2*j] ?
<a name="l01369"></a>01369                projrefcoords[i][j] : minmax[0][2*j]);
<a name="l01370"></a>01370       minmax[0][2*j+1] = (projrefcoords[i][j] &gt; minmax[0][2*j+1] ?
<a name="l01371"></a>01371                projrefcoords[i][j] : minmax[0][2*j+1]);
<a name="l01372"></a>01372       minmax[1][2*j] = (projcompcoords[i][j] &lt; minmax[1][2*j] ?
<a name="l01373"></a>01373                projcompcoords[i][j] : minmax[1][2*j]);
<a name="l01374"></a>01374       minmax[1][2*j+1] = (projcompcoords[i][j] &gt; minmax[1][2*j+1] ?
<a name="l01375"></a>01375                projcompcoords[i][j] : minmax[1][2*j+1]);
<a name="l01376"></a>01376     }
<a name="l01377"></a>01377   }
<a name="l01378"></a>01378 
<a name="l01379"></a>01379 
<a name="l01380"></a>01380   <span class="comment">// can we capitalize on having projected them into the same plane ?</span>
<a name="l01381"></a>01381   <span class="comment">//    (these are really flat elements now)</span>
<a name="l01382"></a>01382   <span class="comment">//    rot the plane or something and then not have to consider "z" ???</span>
<a name="l01383"></a>01383   <span class="comment">//    is it ok to check only one way ??</span>
<a name="l01384"></a>01384 
<a name="l01385"></a>01385   <span class="comment">//first check if it reduces to a line or point case</span>
<a name="l01386"></a>01386   <span class="keywordflow">for</span> (i =0; i &lt; 2; i++){
<a name="l01387"></a>01387     <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++){
<a name="l01388"></a>01388       line[i][j] = (<a class="code" href="group__PublicFloatingPoint.html#gef9a2ac5984a93f3daf980de76ab1456">FC_DBL_EQUIV</a>(minmax[i][2*j],minmax[i][2*j+1])? 1: 0);
<a name="l01389"></a>01389     }
<a name="l01390"></a>01390   }
<a name="l01391"></a>01391   <span class="comment">//if its a line in a direction, then we will consider it</span>
<a name="l01392"></a>01392   <span class="comment">//as overlapping, if the edge aligns, otherwise need more</span>
<a name="l01393"></a>01393   <span class="comment">//than just edge overlap</span>
<a name="l01394"></a>01394   k = 1;
<a name="l01395"></a>01395   <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++){
<a name="l01396"></a>01396     <span class="keywordflow">if</span> (line[0][i] || line [1][i]){ <span class="comment">//allow edge overlap</span>
<a name="l01397"></a>01397       <span class="keywordflow">if</span> ((minmax[0][2*i] &gt; minmax[1][2*i+1]) ||
<a name="l01398"></a>01398        (minmax[0][2*i+1] &lt; minmax[1][2*i])){
<a name="l01399"></a>01399      k = 0;
<a name="l01400"></a>01400      <span class="keywordflow">break</span>;
<a name="l01401"></a>01401       }
<a name="l01402"></a>01402     }<span class="keywordflow">else</span> {
<a name="l01403"></a>01403       <span class="keywordflow">if</span> (!(minmax[0][2*i] &lt; minmax[1][2*i+1] &amp;&amp;
<a name="l01404"></a>01404        minmax[0][2*i+1] &gt; minmax[1][2*i])){
<a name="l01405"></a>01405      k = 0;
<a name="l01406"></a>01406      <span class="keywordflow">break</span>;
<a name="l01407"></a>01407       }
<a name="l01408"></a>01408     }
<a name="l01409"></a>01409   }
<a name="l01410"></a>01410 
<a name="l01411"></a>01411   *intersectval = k;
<a name="l01412"></a>01412   free(refcoords);
<a name="l01413"></a>01413   free(projrefcoords);
<a name="l01414"></a>01414   free(compcoords);
<a name="l01415"></a>01415   free(projcompcoords);
<a name="l01416"></a>01416   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l01417"></a>01417 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g95b267fcaa314e0fcddd0c72b53ccbeb"></a><!-- doxytag: member="geom.c::fc_projectedSubsetElementBoundingBoxIntersection" ref="g95b267fcaa314e0fcddd0c72b53ccbeb" args="(FC_Subset compelemIDs, FC_Subset refelemIDs, FC_Coords proj_normal, FC_Subset *intersectingrefIDs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> fc_projectedSubsetElementBoundingBoxIntersection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>compelemIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>refelemIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__SimpleDataObjects.html#g9687c6aad22d56c60f87659f533869c2">FC_Coords</a>&nbsp;</td>
          <td class="paramname"> <em>proj_normal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>intersectingrefIDs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given a subset of elements ids and a reference subset of element ids, projects those elements onto the same plane and calculates which elements of the reference subset have bounding boxes in the projected plane that are intersected by the bounding boxes of the comparison elements in the projected plane. 
<p>
<b>Description:</b> <p>
Given a subset of elements ids and a reference subset of element ids, projects those elements onto the same plane and calculates which elements of the reference subset have bounding boxes in the projected plane that are intersected by the bounding boxes of the comparison elements in the projected plane.<p>
This is intended for getting an estimate of amount of the tie surface that has dead elements above it, in some direction. Neither subset can be NULL. The reference subset cannot be empty. The comp subset can be empty.<p>
Name of output subset is that of the input ref subset, postpended with "_Intersect"<p>
Uses fc_projectedElementBoundingBoxIntersection.<p>
<b>Modifications:</b> <ul>
<li>10/25/05 ACG created (but not put into production)</li><li>11/21/05 ACG putting into production now that lower level type changes are completed</li><li>03/15/06 ACG changed projnormal type from double* to FC_Coords</li><li>08/07/06 WSD changed orig linked lists to arrays, and the out linked list to a sorted int array.</li><li>10/10/06 ACG changed so once an item satisfies overlap it is removed from comparison</li><li>10/16/06 removed mesh from arg list to make more consistent with other subset calls </li></ul>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>compelemIDs</em>&nbsp;</td><td>
input - subset of comp elem ids </td></tr>
<tr><td valign="top"><em>refelemIDs</em>&nbsp;</td><td>
input - subset of reference elem ids </td></tr>
<tr><td valign="top"><em>proj_normal</em>&nbsp;</td><td>
input - proj normal </td></tr>
<tr><td valign="top"><em>intersectingrefIDs</em>&nbsp;</td><td>
output - subset of ref elem ids satisfying the calculation </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="geom_8c-source.html#l01456">1456</a> of file <a class="el" href="geom_8c-source.html">geom.c</a>.
<p>
References <a class="el" href="subset_8c-source.html#l02596">_fc_getSubSlot()</a>, <a class="el" href="subset_8c-source.html#l01234">fc_addArrayMembersToSubset()</a>, <a class="el" href="storage_8c-source.html#l00300">fc_addIntToSortedIntArray()</a>, <a class="el" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>, <a class="el" href="storage_8c-source.html#l01142">fc_convertIntArrayToSortedIntArray()</a>, <a class="el" href="subset_8c-source.html#l00127">fc_createSubset()</a>, <a class="el" href="storage_8c-source.html#l00463">fc_deleteIntFromSortedIntArray()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>, <a class="el" href="storage_8c-source.html#l00706">fc_freeSortedIntArray()</a>, <a class="el" href="subset_8c-source.html#l01713">fc_getMeshFromSubset()</a>, <a class="el" href="base_8c-source.html#l00354">fc_getReturnCodeText()</a>, <a class="el" href="subset_8c-source.html#l01874">fc_getSubsetAssociationType()</a>, <a class="el" href="subset_8c-source.html#l01973">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="storage_8c-source.html#l00094">fc_initSortedIntArray()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>, <a class="el" href="subset_8c-source.html#l01652">fc_isSubsetValid()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>, <a class="el" href="base_8c-source.html#l00783">FC_NULL_SUBSET</a>, <a class="el" href="library_8h-source.html#l00096">fc_printfErrorMessage</a>, <a class="el" href="geom_8c-source.html#l01223">fc_projectedElementBoundingBoxIntersection()</a>, <a class="el" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>, <a class="el" href="subsetP_8h-source.html#l00073">_FC_SubSlot::header</a>, <a class="el" href="tableP_8h-source.html#l00100">_FC_SlotHeader::name</a>, <a class="el" href="storage_8h-source.html#l00098">FC_SortedIntArray::numVal</a>, and <a class="el" href="storage_8h-source.html#l00100">FC_SortedIntArray::vals</a>.
<p>
Referenced by <a class="el" href="screwBreaks_8c-source.html#l00617">projection()</a>.<div class="fragment"><pre class="fragment"><a name="l01462"></a>01462  {
<a name="l01463"></a>01463   <a class="code" href="group__DataTypes.html#g2a816f8eddef0c2d8c2e3a0393b1f52e">FC_ReturnCode</a> rc;
<a name="l01464"></a>01464   <a class="code" href="structFC__Mesh.html">FC_Mesh</a> mesh1, mesh2;
<a name="l01465"></a>01465   <span class="keywordtype">int</span> *orig1, *orig2;
<a name="l01466"></a>01466   <a class="code" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> ref2, out2;
<a name="l01467"></a>01467   <a class="code" href="group__DataTypes.html#g63044bd7bb5313d8a79ea8a71f1b3040">FC_AssociationType</a> assoc;
<a name="l01468"></a>01468   <span class="keywordtype">int</span> count1, count2;
<a name="l01469"></a>01469   <span class="keywordtype">int</span> i, j;
<a name="l01470"></a>01470 
<a name="l01471"></a>01471   <span class="keywordflow">if</span> (intersectingrefIDs)
<a name="l01472"></a>01472     *intersectingrefIDs = <a class="code" href="group__Handles.html#g05b02ab7a13c2ad72dd9a0862fc11356">FC_NULL_SUBSET</a>;
<a name="l01473"></a>01473 
<a name="l01474"></a>01474   <span class="keywordflow">if</span> (!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(compelemIDs) ||!<a class="code" href="group__Subset.html#g4ceb4c71219255a80166405a22773952">fc_isSubsetValid</a>(refelemIDs) ||
<a name="l01475"></a>01475       !intersectingrefIDs){
<a name="l01476"></a>01476     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>));
<a name="l01477"></a>01477     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01478"></a>01478   }
<a name="l01479"></a>01479 
<a name="l01480"></a>01480   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++){
<a name="l01481"></a>01481     <a class="code" href="structFC__Subset.html">FC_Subset</a> temp;
<a name="l01482"></a>01482     temp = i? compelemIDs: refelemIDs;
<a name="l01483"></a>01483     rc = <a class="code" href="group__Subset.html#gd546b0c5303f4c8a0f256662aff729a4">fc_getSubsetAssociationType</a>(temp, &amp;assoc);
<a name="l01484"></a>01484     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>)
<a name="l01485"></a>01485       <span class="keywordflow">return</span> rc;
<a name="l01486"></a>01486     
<a name="l01487"></a>01487     <span class="keywordflow">if</span> (assoc != <a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>){
<a name="l01488"></a>01488       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Wrong association type"</span>);
<a name="l01489"></a>01489       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01490"></a>01490     }
<a name="l01491"></a>01491   }
<a name="l01492"></a>01492   <span class="comment">//normal is checked in inner method since its just passed through</span>
<a name="l01493"></a>01493 
<a name="l01494"></a>01494   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(compelemIDs,&amp;mesh1);
<a name="l01495"></a>01495   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01496"></a>01496     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get mesh from subset"</span>);
<a name="l01497"></a>01497     <span class="keywordflow">return</span> rc;
<a name="l01498"></a>01498   }
<a name="l01499"></a>01499 
<a name="l01500"></a>01500   rc = <a class="code" href="group__Subset.html#g095c5b064f4ae81a17682666aadd420b">fc_getMeshFromSubset</a>(refelemIDs,&amp;mesh2);
<a name="l01501"></a>01501   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01502"></a>01502     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get mesh from subset"</span>);
<a name="l01503"></a>01503     <span class="keywordflow">return</span> rc;
<a name="l01504"></a>01504   }
<a name="l01505"></a>01505 
<a name="l01506"></a>01506   <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#gf1de8e9eed3c2f3c7ffcaa6527fe0adf">FC_HANDLE_EQUIV</a>(mesh1,mesh2)){
<a name="l01507"></a>01507     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Subsets must be on same mesh"</span>);
<a name="l01508"></a>01508     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01509"></a>01509   }
<a name="l01510"></a>01510 
<a name="l01511"></a>01511   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(compelemIDs,&amp;count1,&amp;orig1);
<a name="l01512"></a>01512   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01513"></a>01513     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get subset memebers"</span>);
<a name="l01514"></a>01514     <span class="keywordflow">return</span> rc;
<a name="l01515"></a>01515   }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517   rc = <a class="code" href="group__Subset.html#g7a79d4d1e13846ae12abe55ef2db3c3d">fc_getSubsetMembersAsArray</a>(refelemIDs,&amp;count2,&amp;orig2);
<a name="l01518"></a>01518   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01519"></a>01519     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't get subset memebers"</span>);
<a name="l01520"></a>01520     <span class="keywordflow">return</span> rc;
<a name="l01521"></a>01521   }
<a name="l01522"></a>01522 
<a name="l01523"></a>01523   <span class="keywordflow">if</span> (count2 == 0){
<a name="l01524"></a>01524     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"refsubset cannot be empty"</span>);
<a name="l01525"></a>01525     free(orig1);
<a name="l01526"></a>01526     free(orig2);
<a name="l01527"></a>01527     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e4905abab801292d8b6338a89462b8e22">FC_INPUT_ERROR</a>;
<a name="l01528"></a>01528   }
<a name="l01529"></a>01529 
<a name="l01530"></a>01530   rc = <a class="code" href="group__SimpleDataObjects.html#g912a92c1aa3a3a93579a975d9976ac6d">fc_convertIntArrayToSortedIntArray</a>(count2,orig2,1,&amp;ref2);
<a name="l01531"></a>01531   <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01532"></a>01532     <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't convert ref array"</span>);
<a name="l01533"></a>01533     free(orig1);
<a name="l01534"></a>01534     free(orig2);
<a name="l01535"></a>01535   }
<a name="l01536"></a>01536 
<a name="l01537"></a>01537   <span class="comment">//compare each item in the orig1 list to all (remaining) items in the ref2 list</span>
<a name="l01538"></a>01538   <a class="code" href="group__SimpleDataObjects.html#g06e00500dd0122a9ad53fdeb52649de7">fc_initSortedIntArray</a>(&amp;out2);
<a name="l01539"></a>01539   <span class="keywordflow">for</span> (i = 0; i &lt; count1 &amp;&amp; ref2.<a class="code" href="structFC__SortedIntArray.html#7788cf6104dcf23fe03af42ab8a65ce9">numVal</a>; i++) {
<a name="l01540"></a>01540     <span class="keywordtype">int</span> elem1 = orig1[i];
<a name="l01541"></a>01541     <a class="code" href="structFC__SortedIntArray.html">FC_SortedIntArray</a> rem; 
<a name="l01542"></a>01542     <a class="code" href="group__SimpleDataObjects.html#g06e00500dd0122a9ad53fdeb52649de7">fc_initSortedIntArray</a>(&amp;rem);
<a name="l01543"></a>01543     <span class="keywordflow">for</span> (j = 0; j &lt; ref2.<a class="code" href="structFC__SortedIntArray.html#7788cf6104dcf23fe03af42ab8a65ce9">numVal</a>; j++) {
<a name="l01544"></a>01544       <span class="keywordtype">int</span> elem2 = ref2.<a class="code" href="structFC__SortedIntArray.html#60520a789b3d255c10053389b65bab10">vals</a>[j];
<a name="l01545"></a>01545       <span class="keywordtype">int</span> intersectval;
<a name="l01546"></a>01546       <span class="comment">//      printf("\t(%d) and elem %d\n",count2++,elem2);</span>
<a name="l01547"></a>01547       rc = <a class="code" href="group__GeometricRelations.html#g94257f304b660eff0908ee4f1b721713">fc_projectedElementBoundingBoxIntersection</a>(mesh1,elem1,elem2,
<a name="l01548"></a>01548                                     proj_normal,&amp;intersectval);
<a name="l01549"></a>01549       <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01550"></a>01550      <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't determine intersection"</span>);
<a name="l01551"></a>01551      free(orig1);
<a name="l01552"></a>01552      <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01553"></a>01553      <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;ref2);
<a name="l01554"></a>01554      <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;rem);
<a name="l01555"></a>01555      <span class="keywordflow">return</span> rc;
<a name="l01556"></a>01556       }
<a name="l01557"></a>01557       <span class="keywordflow">if</span> (intersectval == 1){
<a name="l01558"></a>01558      <span class="keywordtype">int</span> ret = <a class="code" href="group__SimpleDataObjects.html#g64768f52c122c1cd322cbebac85979f2">fc_addIntToSortedIntArray</a>(&amp;out2, elem2);
<a name="l01559"></a>01559      <span class="keywordflow">if</span> (ret &lt; 0 ){
<a name="l01560"></a>01560        <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't add id to sorted int array"</span>);
<a name="l01561"></a>01561        free(orig1);
<a name="l01562"></a>01562        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01563"></a>01563        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;ref2);
<a name="l01564"></a>01564        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;rem);
<a name="l01565"></a>01565        <span class="keywordflow">return</span> ret; <span class="comment">//its an error code</span>
<a name="l01566"></a>01566      }
<a name="l01567"></a>01567      ret = <a class="code" href="group__SimpleDataObjects.html#g64768f52c122c1cd322cbebac85979f2">fc_addIntToSortedIntArray</a>(&amp;rem, elem2);
<a name="l01568"></a>01568      <span class="keywordflow">if</span> (ret &lt; 0 ){
<a name="l01569"></a>01569        <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't add id to sorted int array"</span>);
<a name="l01570"></a>01570        free(orig1);
<a name="l01571"></a>01571        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01572"></a>01572        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;ref2);
<a name="l01573"></a>01573        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;rem);
<a name="l01574"></a>01574        <span class="keywordflow">return</span> ret; <span class="comment">//its an error code</span>
<a name="l01575"></a>01575      }
<a name="l01576"></a>01576       }
<a name="l01577"></a>01577     } <span class="comment">//j</span>
<a name="l01578"></a>01578     <span class="keywordflow">for</span> (j = 0; j &lt; rem.<a class="code" href="structFC__SortedIntArray.html#7788cf6104dcf23fe03af42ab8a65ce9">numVal</a>; j++){
<a name="l01579"></a>01579       <span class="keywordtype">int</span> ret = <a class="code" href="group__SimpleDataObjects.html#g91742f8b36d51071647f7f40341d94bf">fc_deleteIntFromSortedIntArray</a>(&amp;ref2,rem.<a class="code" href="structFC__SortedIntArray.html#60520a789b3d255c10053389b65bab10">vals</a>[j]);
<a name="l01580"></a>01580       if (ret != 1){
<a name="l01581"></a>01581      <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"Can't delete id from sorted int array"</span>);
<a name="l01582"></a>01582      free(orig1);
<a name="l01583"></a>01583      <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01584"></a>01584      <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;ref2);
<a name="l01585"></a>01585      <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;rem);
<a name="l01586"></a>01586      <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e51d318f8c97c8b094cf9820b51e4fa83">FC_ERROR</a>;
<a name="l01587"></a>01587       }
<a name="l01588"></a>01588     }
<a name="l01589"></a>01589     <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;rem);
<a name="l01590"></a>01590   } <span class="comment">//i</span>
<a name="l01591"></a>01591   free(orig1);
<a name="l01592"></a>01592   <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;ref2);
<a name="l01593"></a>01593   <span class="comment">//rem is freed</span>
<a name="l01594"></a>01594 
<a name="l01595"></a>01595   {<span class="comment">// allowed to send back empty subsets</span>
<a name="l01596"></a>01596     <a class="code" href="struct__FC__SubSlot.html">_FC_SubSlot</a> *subSlot;
<a name="l01597"></a>01597     <span class="keywordtype">char</span> *subsetName, *tempName;
<a name="l01598"></a>01598     subSlot = <a class="code" href="group__PrivateSubset.html#g8f78520bce8753ac1e5fda62c47862da">_fc_getSubSlot</a>(refelemIDs);
<a name="l01599"></a>01599     subsetName = subSlot-&gt;<a class="code" href="struct__FC__SubSlot.html#3d4cf6721e221bdaa68d1ea3b2709aaa">header</a>.<a class="code" href="struct__FC__SlotHeader.html#a3977050dc75352e26c943617ee4fcd8">name</a>;
<a name="l01600"></a>01600     tempName = malloc((strlen(subsetName)+20)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l01601"></a>01601     <span class="keywordflow">if</span> (tempName == NULL){
<a name="l01602"></a>01602        <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g97ca6452d8a5b6625a2c02166dc87bb7">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>));
<a name="l01603"></a>01603        <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01604"></a>01604        <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52ee4bf428a2cdead5d4e3e3391a2cdab0d">FC_MEMORY_ERROR</a>;
<a name="l01605"></a>01605     }
<a name="l01606"></a>01606     sprintf(tempName,<span class="stringliteral">"%s_Intersect"</span>,subsetName);
<a name="l01607"></a>01607     rc = <a class="code" href="group__Subset.html#g40d47282abccd83987c83e8051064db2">fc_createSubset</a>(mesh1,tempName,<a class="code" href="group__DataTypes.html#gg63044bd7bb5313d8a79ea8a71f1b3040f4be04f2efb0e31c558b6146cf83f191">FC_AT_ELEMENT</a>,intersectingrefIDs);
<a name="l01608"></a>01608     free(tempName);
<a name="l01609"></a>01609     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01610"></a>01610       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"cannot create new element subset"</span>);
<a name="l01611"></a>01611       <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01612"></a>01612       <span class="keywordflow">return</span> rc;
<a name="l01613"></a>01613     }
<a name="l01614"></a>01614     rc = <a class="code" href="group__Subset.html#g47d34843c8d66c114c2c81e3a1fc14e4">fc_addArrayMembersToSubset</a>(*intersectingrefIDs,out2.<a class="code" href="structFC__SortedIntArray.html#7788cf6104dcf23fe03af42ab8a65ce9">numVal</a>,
<a name="l01615"></a>01615                            out2.<a class="code" href="structFC__SortedIntArray.html#60520a789b3d255c10053389b65bab10">vals</a>);
<a name="l01616"></a>01616     <a class="code" href="group__SimpleDataObjects.html#ga6ecd909b91f581633b4accbc88642b2">fc_freeSortedIntArray</a>(&amp;out2);
<a name="l01617"></a>01617     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>){
<a name="l01618"></a>01618       <a class="code" href="group__Library.html#gb41a63cb101314fb41df98cef504a556">fc_printfErrorMessage</a>(<span class="stringliteral">"cannot add items to subset"</span>);
<a name="l01619"></a>01619       <span class="keywordflow">return</span> rc;
<a name="l01620"></a>01620     }
<a name="l01621"></a>01621   }
<a name="l01622"></a>01622 
<a name="l01623"></a>01623   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a816f8eddef0c2d8c2e3a0393b1f52e27738acee5b8b2ef61be6e9b14a26613">FC_SUCCESS</a>;
<a name="l01624"></a>01624 }
</pre></div>
<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Wed Oct 31 11:10:01 2007 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
