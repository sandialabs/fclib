<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>FCLib: tools/screwBreaks.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>tools/screwBreaks.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
screw breaking analysis 
<p>
<dl class="rcs" compact><dt><b>Source</b></dt><dd>/usr/local/Repositories/fcdmf/fclib/tools/screwBreaks.c,v </dd></dl>
<dl class="rcs" compact><dt><b>Revision</b></dt><dd>1.26 </dd></dl>
<dl class="rcs" compact><dt><b>Date</b></dt><dd>2006/10/16 20:04:39 </dd></dl>
<p>
<b>Description:</b> <p>
DEAD VARS: User specifies elements to be considered dead by a number of variables and threshold values for each specified on the command line. The dead set is thus the union of all the specified sets.<p>
BREAKAGE CONDITIONS: Tool reports when the screws first break or when any screw side entirely erodes due to the dead set. The eroded case means the screw has separated from whatever that side was attached to (this is typically a tie surface, which is therefore a special case breakage condition, where the screw has not split into pieces.). Also gives total number of broken screws.<p>
BREAKAGE RATIO: Tool also reports the breakage ratio. This is a rough estimate of the accumulated cross sectional area of the dead elements in the column above the screw base. The screw base is the smallest side which is connected to only one other side - in a normal shaped screw this is the bottom circular section. In a regular cylinder this will be either one of the two circular sections. This calculation considers the non-displaced areas and locations of the elements.<p>
Explicitly, the breakage ratio is determined by 1) projecting the dead elements in the screw and the base surface elements both onto a plane with normal = normal of the screw base. 2) determining which elements in the screw base are overlapped by the projected elements - this is done by comparing the bounding boxes of the projected dead elements and the screw base elements and is therefore an overestimation of overlap 3) summing the area of the overlapped screw base faces 4) calculating the ratio relative to the complete screw base area. Be careful how you use this measure - it is an overestimation and does not take into consideration how far the dead elements are relative to one another.<p>
RESULT OUTPUT: Results are presented in the following fashion: Every output line lists the Mesh, ScrewID and the timestep #, to make it easy to grep through an output file. Screw breakage ratios are reported for all time steps for each screw, up until the screw is broken (or is eroded).<p>
SCREWS: The screwmeshes must consist entirely of distinct screws, but there can be multiple screws in each screwmesh. Screws are defined by segmenting the screwmesh -- there is nothing to check that there is anything screw-like about the screws, other than there must be at least one distinct "end" which is used in the calculation of the breakage ratio.<p>
Screws are identified by an arbitary identifier which will be the same from run to run, as long as the mesh is identical - renumberings of the mesh verticies, etc, even if it is topologically the same may result in a different screw identifier.<p>
Screwmeshes should be input by the same name they have if you run the fcdump tool on the dataset.(This name may be different than that given it by different tools - i.e., may be a different name than appears in ensight).<p>
OTHER: Seg_dim is the segmenation_dimension for determining breakage, defaults to 0. The segmentation dimension is used to specify the conditions for which live regions in each screw are considered separate. If 2 regions are to be considered separate if no element in one region shares a face with any element in another region (but they may share edges and verticies), then seg_dim =2. If the elements in the 2 regions cannot share faces or edges, but may share verticies, choose seg_dim = 1. If the elements in the two regions cannot share even verticies, then seg_dim = 0.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000128">Todo:</a></b></dt><dd><ul>
<li>Note: if we decide to drop the breakage ratio, then this would be generally useful, since the constraint on the shapes having an identifiable base is only necessary for calculating the BR. We could potentially drop that since we now have the damage variable as something we can loop through to get closeness to breaking.</li><li>also print out screw verticies or bounding box, so can ID screws from run to run.</li></ul>
</dd></dl>
<b>Modifications:</b> <ul>
<li>03/09/2006 ACG created. Modification of screw.c.</li><li>03/14/2006 ACG changed flag for seg_dim, removed writeout of nonbroken screws.</li><li>03/14/2006 ACG added breakage ratio</li><li>03/20/2006 ACG commented out local normal function since now have fc_getPlanarSideNormal</li><li>03/22/2006 ACG user can specify more than 1 variable and cutoff for the dead set.</li><li>03/22/2006 ACG removed commented out screwbasenormal function</li><li>03/24/2006 ACG switching to more general shape screws - using getShapeEnds rather than getScrewSides</li><li>03/24/2006 ACG struct for screw and deathvars for clarity</li><li>03/24/2006 ACG put proj function into its own subroutine. now projects to smallest end, no matter what the shape.</li><li>03/26/2006 ACG moved some stuff into subroutines for clarity. Trying to do that with screwBuild but ive got a memory leak...</li><li>03/26/2006 ACG added loop to check all sides erosion, untested. Moved broken, eroded into their own subroutines for symmetry</li><li>03/27/2006 ACG added printscrew - note IDS start at zero per mesh and therefore match ensight format id, but not the lsdyna ids (ie, cant match up element ids looking at d3plot file)</li><li>03/27/2006 ACG WSK fixed memory leak</li><li>03/28/2006 ACG verified projection results, which resulted in bug fix on geom</li><li>03/28/2006 ACG moved to tools from sandbox (was screw_tool.c)</li><li>03/29/2006 ACG documentation changes</li><li>03/29/2006 ACG removed option to specify screwmesh by number becuase that might get confused with the material ID. now must specify mesh bysame name it has when you do fcdump.</li><li>05/09/2006 ACG Now outputing info on each screw for all timesteps for each screw, up until the screw is broken, even if there are no dead elements in the screw. (WSK wanted this)</li><li>05/09/2006 ACG handles multiple screw meshes (specified on teh command line)</li><li>05/22/2006 WSD In no mesh names are supplied on the command line, this will attemp to find all meshes with 'screw' or 'scrw' in the name (case insensitive).</li><li>05/22/2006 WSD Fiddled with output. Now there is always exactly 1 line of output per screw per timestep. At the first break it does not report BR any more. And after the first break it know prints a line "*** still broken ***".</li><li>06/02/2006 ACG updated for new fc_getSubsetSies interface</li><li>06/12/2006 WSD Prints values of sequence. Prints screw bounding boxes.</li><li>06/28/2006 ACG uses new shape interface </li></ul>

<p>Definition in file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;<a class="el" href="fc_8h-source.html">fc.h</a>&quot;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>

<p>
<div class="dynheader">
Include dependency graph for screwBreaks.c:</div>
<div class="dynsection">
<p><center><img src="screwBreaks_8c__incl.gif" border="0" usemap="#tools/screwBreaks.c_map" alt=""></center>
<map name="tools/screwBreaks.c_map">
<area shape="rect" href="fc_8h.html" title="Master header file for FCLib." alt="" coords="1236,84,1284,111"><area shape="rect" href="base_8h.html" title="Public declarations for Data Types, Data Interface, and Handles Modules." alt="" coords="195,161,264,188"><area shape="rect" href="storage_8h.html" title="Public declarations for Simple Data Objects Module." alt="" coords="288,161,376,188"><area shape="rect" href="library_8h.html" title="Public declarations for the Library Module." alt="" coords="400,161,477,188"><area shape="rect" href="dataset_8h.html" title="Public declarations for the Dataset Module." alt="" coords="501,161,589,188"><area shape="rect" href="sequence_8h.html" title="Public declarations for the Sequence Module." alt="" coords="613,161,717,188"><area shape="rect" href="mesh_8h.html" title="Public declarations for the Mesh Module." alt="" coords="741,161,816,188"><area shape="rect" href="subset_8h.html" title="Public declarations for Subset module." alt="" coords="840,161,920,188"><area shape="rect" href="variable_8h.html" title="Public declarations for Variable Module." alt="" coords="944,161,1037,188"><area shape="rect" href="feature_8h.html" title="Public declarations for Features module." alt="" coords="1061,161,1149,188"><area shape="rect" href="shape_8h.html" title="Declarations for Shape module." alt="" coords="1173,161,1251,188"><area shape="rect" href="fileio_8h.html" title="Public declarations for File IO module." alt="" coords="1275,161,1344,188"><area shape="rect" href="error_8h.html" title="Declarations for Error Handling Module." alt="" coords="1368,161,1435,188"><area shape="rect" href="geom_8h.html" title="Public declarations for Geometric Relations module." alt="" coords="1459,161,1536,188"><area shape="rect" href="statistics_8h.html" title="Public declarations for Statistics Routines module." alt="" coords="1487,239,1583,265"><area shape="rect" href="sierra_8h.html" title="Public declarations for the Sierra module." alt="" coords="1611,161,1685,188"><area shape="rect" href="threshold_8h.html" title="Public declarations for Threshold module." alt="" coords="1709,161,1811,188"><area shape="rect" href="elemdeath_8h.html" title="Declarations for Element Death module." alt="" coords="1835,161,1949,188"><area shape="rect" href="series_8h.html" title="Public declarations for Series Routines module." alt="" coords="1973,161,2048,188"><area shape="rect" href="topo_8h.html" title="Public declarations for Topological Relations module." alt="" coords="2072,161,2139,188"><area shape="rect" href="util_8h.html" title="Public declarations for Utilities module." alt="" coords="2163,161,2219,188"><area shape="rect" href="track_8h.html" title="Declaration of tracking routines." alt="" coords="2243,161,2312,188"><area shape="rect" href="varmath_8h.html" title="Public declarations for Variable Math module." alt="" coords="2336,161,2432,188"><area shape="rect" href="custom_8h.html" title="Declarations for Custom module." alt="" coords="2456,161,2544,188"></map>
</div>

<p>
<a href="screwBreaks_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscrewinfo.html">screwinfo</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#8cfe3116e5212b2de2afc18796f93775">parser</a> (int argc, char **argv, char **<a class="el" href="subsetter_8c.html#8505c513bc640d1f69e5f76fb32b24a8">file_name</a>, int *numscrewmeshes, char ***screwmesh_names, <a class="el" href="group__DataTypes.html#g1ceb59a5b485f8bcbcb8acad4cfb9323">FC_VerbosityLevel</a> *<a class="el" href="subsetter_8c.html#46e260e16f29333b3f475e879e4d8e70">verbose_level</a>, int *numdeathvars, <a class="el" href="structdeathvarinfo.html">deathvarinfo</a> **deathvars, int *seg_dim)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#75a1168f7a684a9f25cf579ff3354e77">hasScrewInStr</a> (char *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#6fb18051e7cbacebf794269fbf48714b">parseDeathVarSet</a> (int argc, char **argv, int *idx, int *numvars, <a class="el" href="structdeathvarinfo.html">deathvarinfo</a> **deathvars)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#3a579140fa9c0199f3b71eb4ebb8bfe3">printDeathVarSet</a> (int numvars, <a class="el" href="structdeathvarinfo.html">deathvarinfo</a> *deathvars)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#5b2658e5dca1e6bdd3c5762e886e13d9">segmentMesh</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int shared_dim, int *numsegs, <a class="el" href="structFC__Subset.html">FC_Subset</a> **segs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#7e195214c57db04d1ca65632302f8839">screwInit</a> (<a class="el" href="structscrewinfo.html">screwinfo</a> *screw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#1621cd96bc51df48516c7d24bbeff0c3">printScrew</a> (<a class="el" href="structscrewinfo.html">screwinfo</a> screw, char *screwmeshname, int screwID, int verb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#a3a7eb2e04c8951d8460e9b168c5b638">buildScrews</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int *numScrews, <a class="el" href="structscrewinfo.html">screwinfo</a> **screws)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#adf7702dd1f9fc920beb85d7eecb9be2">getDeathThresholdSubset</a> (<a class="el" href="structFC__Mesh.html">FC_Mesh</a> mesh, int numdeathvars, <a class="el" href="structdeathvarinfo.html">deathvarinfo</a> *deathvars, int timestep, <a class="el" href="structFC__Subset.html">FC_Subset</a> *<a class="el" href="subsetter_8c.html#fcfbedec6ebde62c6a091ce335836ef1">threshold</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#66ee6b8635e75c477ac624a14428a299">projection</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> deadscrew, <a class="el" href="structscrewinfo.html">screwinfo</a> screw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#b1c7fa64d32d5bdaa3fbc07592fbae4c">broken</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> deadscrew, int seg_dim, <a class="el" href="structscrewinfo.html">screwinfo</a> *screw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#2b9de9602e69bbe7fcd9fc2e0780764c">eroded</a> (<a class="el" href="structFC__Subset.html">FC_Subset</a> deadscrew, <a class="el" href="structscrewinfo.html">screwinfo</a> *screw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="screwBreaks_8c.html#3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="b1c7fa64d32d5bdaa3fbc07592fbae4c"></a><!-- doxytag: member="screwBreaks.c::broken" ref="b1c7fa64d32d5bdaa3fbc07592fbae4c" args="(FC_Subset deadscrew, int seg_dim, screwinfo *screw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int broken           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>deadscrew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>seg_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscrewinfo.html">screwinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>screw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00652">652</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="screwBreaks_8c-source.html#l00199">screwinfo::broken</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="elemdeath_8c-source.html#l00898">fc_subsetSegmentsSubset()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00194">screwinfo::whole</a>.</p>

<p>Referenced by <a class="el" href="tears_8c-source.html#l00686">calcShapeIntersection()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00652"></a>00652                                                                      {
<a name="l00653"></a>00653   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00654"></a>00654   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *livesegments;
<a name="l00655"></a>00655   <span class="keywordtype">int</span> numliveseg;
<a name="l00656"></a>00656   <span class="keywordtype">int</span> k;
<a name="l00657"></a>00657 
<a name="l00658"></a>00658   <span class="comment">//segment live regions</span>
<a name="l00659"></a>00659   rc = <a class="code" href="group__ElemDeath.html#g666b97bf9ae5501aa0e296436f6dec7b" title="returns the segments (and their number) that result from segmenting a subset by another...">fc_subsetSegmentsSubset</a>(deadscrew, screw-&gt;<a class="code" href="structscrewinfo.html#57f74bfa95b1364400457dbcfdfe35c8">whole</a>,
<a name="l00660"></a>00660                       seg_dim,<span class="stringliteral">"live"</span>,&amp;numliveseg, &amp;livesegments);
<a name="l00661"></a>00661   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed in subsetSegmentsSubset"</span>);
<a name="l00662"></a>00662      
<a name="l00663"></a>00663   <span class="keywordflow">if</span> (numliveseg &gt; 1){
<a name="l00664"></a>00664     screw-&gt;<a class="code" href="structscrewinfo.html#7a6fcf9c10e4029dc173ccc64c040c0f">broken</a> = 1;
<a name="l00665"></a>00665   }
<a name="l00666"></a>00666      
<a name="l00667"></a>00667   <span class="keywordflow">for</span> (k = 0; k &lt; numliveseg; k++){
<a name="l00668"></a>00668     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(livesegments[k]);
<a name="l00669"></a>00669   }
<a name="l00670"></a>00670   free(livesegments);
<a name="l00671"></a>00671 
<a name="l00672"></a>00672   <span class="keywordflow">return</span> screw-&gt;<a class="code" href="structscrewinfo.html#7a6fcf9c10e4029dc173ccc64c040c0f">broken</a>;
<a name="l00673"></a>00673 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a3a7eb2e04c8951d8460e9b168c5b638"></a><!-- doxytag: member="screwBreaks.c::buildScrews" ref="a3a7eb2e04c8951d8460e9b168c5b638" args="(FC_Mesh mesh, int *numScrews, screwinfo **screws)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int buildScrews           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numScrews</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscrewinfo.html">screwinfo</a> **&nbsp;</td>
          <td class="paramname"> <em>screws</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00500">500</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="screwBreaks_8c-source.html#l00197">screwinfo::baseArea</a>, <a class="el" href="screwBreaks_8c-source.html#l00196">screwinfo::baseID</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="shape_8c-source.html#l02320">fc_freeShape()</a>, <a class="el" href="shape_8c-source.html#l03873">fc_getPlanarSideNormal()</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="shape_8c-source.html#l03603">fc_getShapeEnds()</a>, <a class="el" href="geom_8c-source.html#l04344">fc_getSubsetArea()</a>, <a class="el" href="shape_8c-source.html#l01339">fc_getSubsetShapes()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="screwBreaks_8c-source.html#l00466">screwInit()</a>, <a class="el" href="screwBreaks_8c-source.html#l00439">segmentMesh()</a>, <a class="el" href="screwBreaks_8c-source.html#l00195">screwinfo::shape</a>, and <a class="el" href="screwBreaks_8c-source.html#l00194">screwinfo::whole</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00500"></a>00500                                                                    {
<a name="l00501"></a>00501   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00502"></a>00502   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> *screwsegs;
<a name="l00503"></a>00503   <span class="keywordtype">int</span> numScrews;
<a name="l00504"></a>00504   <a class="code" href="structscrewinfo.html">screwinfo</a> *screws;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506   <span class="keywordtype">int</span> screwsideangle = 80;
<a name="l00507"></a>00507   <span class="keywordtype">int</span> screwshareddim = 0;
<a name="l00508"></a>00508   <span class="keywordtype">int</span> i;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510   
<a name="l00511"></a>00511   <span class="comment">//segment mesh to get the screws</span>
<a name="l00512"></a>00512   <span class="comment">//cant use the screw function becuase 1) we want the whole segments for</span>
<a name="l00513"></a>00513   <span class="comment">//the projection 2) this does the plug shaped screws as well</span>
<a name="l00514"></a>00514   rc = <a class="code" href="screwBreaks_8c.html#5b2658e5dca1e6bdd3c5762e886e13d9">segmentMesh</a>(mesh,0, &amp;numScrews, &amp;screwsegs);
<a name="l00515"></a>00515   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Can't segment mesh to get screws"</span>);
<a name="l00516"></a>00516   <span class="comment">//  printf("num screws = %d\n",numScrews);</span>
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   screws = malloc(numScrews*<span class="keyword">sizeof</span>(<a class="code" href="structscrewinfo.html">screwinfo</a>)); 
<a name="l00519"></a>00519   <span class="keywordflow">if</span> (screws == NULL){
<a name="l00520"></a>00520     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00521"></a>00521     exit(-1);
<a name="l00522"></a>00522   }
<a name="l00523"></a>00523 
<a name="l00524"></a>00524   <span class="keywordflow">for</span> (i = 0; i &lt; numScrews; i++){
<a name="l00525"></a>00525     <span class="keywordtype">int</span> numEnds, *endArray;
<a name="l00526"></a>00526     <a class="code" href="structFC__Shape.html" title="Shape Struct.">FC_Shape</a> *shapes;
<a name="l00527"></a>00527     <span class="keywordtype">int</span> numShapes;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     <a class="code" href="screwBreaks_8c.html#7e195214c57db04d1ca65632302f8839">screwInit</a>(&amp;(screws[i]));
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     screws[i].<a class="code" href="structscrewinfo.html#57f74bfa95b1364400457dbcfdfe35c8">whole</a> = screwsegs[i];
<a name="l00532"></a>00532     <span class="comment">//this will get them in some random order</span>
<a name="l00533"></a>00533     rc = <a class="code" href="group__Shape.html#g390c8304bc716ff39e4ef3c63657a6f5" title="given a subset, returns an array of FC_Shapes">fc_getSubsetShapes</a>(screws[i].whole,screwsideangle,screwshareddim,
<a name="l00534"></a>00534                     &amp;numShapes,&amp;shapes);
<a name="l00535"></a>00535     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a> || numShapes &lt;= 1){
<a name="l00536"></a>00536       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Can't get screw shape - aborting"</span>);
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538     
<a name="l00539"></a>00539     screws[i].<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a> = shapes[0];
<a name="l00540"></a>00540     free(shapes); <span class="comment">//but not the shape</span>
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     <span class="comment">//now get the smallest end for the projection</span>
<a name="l00543"></a>00543     rc = <a class="code" href="group__Shape.html#gf49458c53989d7b1733647a5bca33754" title="given a shape returns the shape&amp;#39;s ends.">fc_getShapeEnds</a>(&amp;screws[i].shape, &amp;numEnds,&amp;endArray);
<a name="l00544"></a>00544     <span class="keywordflow">if</span> (rc != <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00545"></a>00545       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Can't get screwsubset ends - aborting"</span>);
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="comment">// early exit</span>
<a name="l00549"></a>00549     <span class="comment">// Question: we are rejecting the whole mesh, but we could just dump </span>
<a name="l00550"></a>00550     <span class="comment">// non-screw segemnts? YES we could, but not today AG 6/28/06</span>
<a name="l00551"></a>00551     <span class="keywordflow">if</span> (numEnds &lt;= 1) {
<a name="l00552"></a>00552       <span class="comment">// FIX: probably have within screw data to cleanup</span>
<a name="l00553"></a>00553       <span class="comment">// need a screwFinal</span>
<a name="l00554"></a>00554       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;screws[i].shape);
<a name="l00555"></a>00555       free(screws);
<a name="l00556"></a>00556       free(screwsegs);
<a name="l00557"></a>00557       <span class="keywordflow">return</span> 1;
<a name="l00558"></a>00558     } 
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     screws[i].<a class="code" href="structscrewinfo.html#776ea4d296026be64c5bf9d677539fec">baseID</a> = endArray[0];
<a name="l00561"></a>00561     free(endArray);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     rc = <a class="code" href="group__GeometricRelations.html#gfd4c940dc417f742e067c8a706cd5563" title="Returns a variable with the area of the subset.">fc_getSubsetArea</a>(screws[i].shape.faces[screws[i].<a class="code" href="structscrewinfo.html#776ea4d296026be64c5bf9d677539fec">baseID</a>],
<a name="l00564"></a>00564                  &amp;screws[i].<a class="code" href="structscrewinfo.html#759e5760604c7d5210ccf6c1344bcc29">baseArea</a>);
<a name="l00565"></a>00565     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"Can't get screwbase area"</span>);
<a name="l00566"></a>00566 
<a name="l00567"></a>00567     rc = <a class="code" href="group__Shape.html#gc9ab86a7eb1c1ac2780f2493b9219bc3" title="Given a shape and the ID of a planar side, returns the outward normal to that face...">fc_getPlanarSideNormal</a>(&amp;screws[i].shape,screws[i].baseID,
<a name="l00568"></a>00568                     &amp;(screws[i].baseNormal));
<a name="l00569"></a>00569     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"Can't get screwbase normal"</span>);
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   }
<a name="l00573"></a>00573   
<a name="l00574"></a>00574   *nScrews = numScrews;
<a name="l00575"></a>00575   *scr = screws;
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   free(screwsegs);
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00580"></a>00580 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2b9de9602e69bbe7fcd9fc2e0780764c"></a><!-- doxytag: member="screwBreaks.c::eroded" ref="2b9de9602e69bbe7fcd9fc2e0780764c" args="(FC_Subset deadscrew, screwinfo *screw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int eroded           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>deadscrew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscrewinfo.html">screwinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>screw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00676">676</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="screwBreaks_8c-source.html#l00200">screwinfo::eroded</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="elemdeath_8c-source.html#l00669">fc_getShapeSidesDecayType()</a>, <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>, and <a class="el" href="screwBreaks_8c-source.html#l00195">screwinfo::shape</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00676"></a>00676                                                         {
<a name="l00677"></a>00677   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00678"></a>00678   <span class="keywordtype">int</span> *flag;
<a name="l00679"></a>00679   <span class="keywordtype">int</span> k;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681   rc = <a class="code" href="group__ElemDeath.html#g5cef93bfeb2c73c7990a26be98b44849" title="Get identifier telling if deadSubset intersects or entirely erodes the sides of a...">fc_getShapeSidesDecayType</a>(deadscrew,&amp;(screw-&gt;<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>),&amp;flag);
<a name="l00682"></a>00682   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Can't get decayed shape "</span>);
<a name="l00683"></a>00683   <span class="keywordflow">for</span> (k = 0; k &lt; screw-&gt;<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; k++){
<a name="l00684"></a>00684     <span class="keywordflow">if</span> (flag[k] ==2){
<a name="l00685"></a>00685       screw-&gt;<a class="code" href="structscrewinfo.html#81c5798289493a60118e77b43eaf7438">eroded</a> = 1;
<a name="l00686"></a>00686       <span class="keywordflow">break</span>;
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688   }
<a name="l00689"></a>00689   free(flag);
<a name="l00690"></a>00690   <span class="keywordflow">return</span> screw-&gt;<a class="code" href="structscrewinfo.html#81c5798289493a60118e77b43eaf7438">eroded</a>;
<a name="l00691"></a>00691 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="adf7702dd1f9fc920beb85d7eecb9be2"></a><!-- doxytag: member="screwBreaks.c::getDeathThresholdSubset" ref="adf7702dd1f9fc920beb85d7eecb9be2" args="(FC_Mesh mesh, int numdeathvars, deathvarinfo *deathvars, int timestep, FC_Subset *threshold)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int getDeathThresholdSubset           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numdeathvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>deathvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> *&nbsp;</td>
          <td class="paramname"> <em>threshold</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00583">583</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="subset_8c-source.html#l02064">fc_addArrayMembersToSubset()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="threshold_8c-source.html#l00088">fc_createThresholdSubset()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="subset_8c-source.html#l03001">fc_getSubsetMembersAsArray()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="subsetter_8c-source.html#l00108">op</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00586"></a>00586                                             {
<a name="l00587"></a>00587   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00588"></a>00588   <span class="keywordtype">int</span> k;
<a name="l00589"></a>00589 
<a name="l00590"></a>00590   rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh,<span class="stringliteral">"threshold"</span>,<a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>,threshold);
<a name="l00591"></a>00591   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"failed to create empty threshold subset"</span>);
<a name="l00592"></a>00592   <span class="comment">//get dead regions for this timestep</span>
<a name="l00593"></a>00593   <span class="keywordflow">for</span> (k = 0; k &lt; numdeathvars; k++){
<a name="l00594"></a>00594     <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> deathset;
<a name="l00595"></a>00595     <span class="keywordtype">int</span> *arr, nummem;
<a name="l00596"></a>00596 
<a name="l00597"></a>00597     rc = <a class="code" href="group__Threshold.html#g6419d82dbacbe4aed0a6e2cde7c3d146" title="Create thresholded region.">fc_createThresholdSubset</a>(deathvars[k].elemdeath[timestep], 
<a name="l00598"></a>00598                       deathvars[k].<a class="code" href="subsetter_8c.html#15206368e0a18f984f0ad6cb10c2995e">op</a>,
<a name="l00599"></a>00599                       deathvars[k].val,
<a name="l00600"></a>00600                       <span class="stringliteral">"temp"</span>, &amp;deathset);
<a name="l00601"></a>00601     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to theshold using op '%s' and value '%g'"</span>,
<a name="l00602"></a>00602                 deathvars[k].<a class="code" href="subsetter_8c.html#15206368e0a18f984f0ad6cb10c2995e">op</a>, deathvars[k].val);
<a name="l00603"></a>00603     
<a name="l00604"></a>00604     rc=<a class="code" href="group__Subset.html#g6cebfda6e20e2a518636838b170185da" title="Get a copy of subset members as array.">fc_getSubsetMembersAsArray</a>(deathset,&amp;nummem,&amp;arr);
<a name="l00605"></a>00605     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant get dead subset members"</span>);
<a name="l00606"></a>00606     rc = <a class="code" href="group__Subset.html#g123bb2337bd35a1915aa736270ed3d40" title="Add members from an array to a subset.">fc_addArrayMembersToSubset</a>(*threshold,nummem,arr);
<a name="l00607"></a>00607     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant add dead subset members to threshold subset"</span>);
<a name="l00608"></a>00608     
<a name="l00609"></a>00609     free(arr);
<a name="l00610"></a>00610     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(deathset);
<a name="l00611"></a>00611   }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00614"></a>00614 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="75a1168f7a684a9f25cf579ff3354e77"></a><!-- doxytag: member="screwBreaks.c::hasScrewInStr" ref="75a1168f7a684a9f25cf579ff3354e77" args="(char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int hasScrewInStr           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00346">346</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00346"></a>00346                                      {
<a name="l00347"></a>00347   <span class="keywordtype">int</span> i;
<a name="l00348"></a>00348   <span class="keywordtype">int</span> len = strlen(name);
<a name="l00349"></a>00349 
<a name="l00350"></a>00350   <span class="comment">// scan string</span>
<a name="l00351"></a>00351   <span class="keywordflow">for</span> (i = 0; i &lt; len-3; i++) {
<a name="l00352"></a>00352     <span class="keywordflow">if</span> (name[i] == <span class="charliteral">'s'</span> || name[i] == <span class="charliteral">'S'</span>) {
<a name="l00353"></a>00353       <span class="keywordflow">if</span> (!strncasecmp(&amp;name[i], <span class="stringliteral">"screw"</span>, 5) ||
<a name="l00354"></a>00354        !strncasecmp(&amp;name[i], <span class="stringliteral">"scrw"</span>, 4)) {
<a name="l00355"></a>00355      <span class="keywordflow">return</span> 1;
<a name="l00356"></a>00356       }
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358   }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <span class="comment">// didnt' find one</span>
<a name="l00361"></a>00361   <span class="keywordflow">return</span> 0;
<a name="l00362"></a>00362 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3c04138a5bfe5d72780bb7e82a18e627"></a><!-- doxytag: member="screwBreaks.c::main" ref="3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00700">700</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="screwBreaks_8c-source.html#l00652">broken()</a>, <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>, <a class="el" href="screwBreaks_8c-source.html#l00676">eroded()</a>, <a class="el" href="subset_8c-source.html#l01040">fc_createSubsetIntersection()</a>, <a class="el" href="dataset_8c-source.html#l00659">fc_deleteDataset()</a>, <a class="el" href="variable_8c-source.html#l05062">fc_deleteSeqVariable()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="base_8h-source.html#l00150">FC_DT_DOUBLE</a>, <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="error_8h-source.html#l00080">fc_exitIfError</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="library_8c-source.html#l00256">fc_finalLibrary()</a>, <a class="el" href="shape_8c-source.html#l02320">fc_freeShape()</a>, <a class="el" href="mesh_8c-source.html#l02285">fc_getMeshByName()</a>, <a class="el" href="mesh_8c-source.html#l02183">fc_getMeshes()</a>, <a class="el" href="mesh_8c-source.html#l02762">fc_getMeshName()</a>, <a class="el" href="variable_8c-source.html#l04695">fc_getOrGenerateUniqueSeqVariableByName()</a>, <a class="el" href="sequence_8c-source.html#l01794">fc_getSequenceCoordsAsDataType()</a>, <a class="el" href="sequence_8c-source.html#l01652">fc_getSequenceNumStep()</a>, <a class="el" href="sequence_8c-source.html#l01150">fc_getSequences()</a>, <a class="el" href="geom_8c-source.html#l00847">fc_getSubsetBoundingBox()</a>, <a class="el" href="subset_8c-source.html#l02828">fc_getSubsetNumMember()</a>, <a class="el" href="library_8c-source.html#l00208">fc_initLibrary()</a>, <a class="el" href="base_8h-source.html#l00107">FC_INPUT_ERROR</a>, <a class="el" href="fileio_8c-source.html#l01565">fc_loadDataset()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="library_8h-source.html#l00154">fc_printfWarningMessage</a>, <a class="el" href="base_8h-source.html#l00081">FC_QUIET</a>, <a class="el" href="library_8c-source.html#l00146">fc_setLibraryVerbosity()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="subsetter_8c-source.html#l00114">file_name</a>, <a class="el" href="screwBreaks_8c-source.html#l00583">getDeathThresholdSubset()</a>, <a class="el" href="screwBreaks_8c-source.html#l00346">hasScrewInStr()</a>, <a class="el" href="screwBreaks_8c-source.html#l00234">parser()</a>, <a class="el" href="screwBreaks_8c-source.html#l00481">printScrew()</a>, <a class="el" href="screwBreaks_8c-source.html#l00617">projection()</a>, <a class="el" href="subsetter_8c-source.html#l00109">threshold</a>, and <a class="el" href="regionreassembler_8c-source.html#l00069">verbose_level</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00700"></a>00700                                 {
<a name="l00701"></a>00701   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00702"></a>00702   <a class="code" href="structFC__Dataset.html" title="Dataset Handle.">FC_Dataset</a> dataset;
<a name="l00703"></a>00703   <a class="code" href="structFC__Sequence.html" title="Sequence Handle.">FC_Sequence</a> *sequences, sequence;
<a name="l00704"></a>00704   <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>* meshes, *screwmeshes;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706   <a class="code" href="structscrewinfo.html">screwinfo</a> *screws;
<a name="l00707"></a>00707   <span class="keywordtype">int</span> numMesh, numSeq, numStep;
<a name="l00708"></a>00708   <span class="keywordtype">int</span> numScrews;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710   <span class="keywordtype">int</span> seg_dim = 0;
<a name="l00711"></a>00711   <span class="keywordtype">char</span>* <a class="code" href="subsetter_8c.html#8505c513bc640d1f69e5f76fb32b24a8">file_name</a> = NULL;
<a name="l00712"></a>00712   <span class="keywordtype">char</span>** screwmesh_names;
<a name="l00713"></a>00713   <span class="keywordtype">int</span> numscrewmeshes = 0;
<a name="l00714"></a>00714   <span class="keywordtype">int</span> numdeathvars = 0;
<a name="l00715"></a>00715   <a class="code" href="structdeathvarinfo.html">deathvarinfo</a> *deathvars;
<a name="l00716"></a>00716   <span class="keywordtype">int</span> tscrews = 0;
<a name="l00717"></a>00717   <span class="keywordtype">int</span> tscrewsbroken = 0;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719   <a class="code" href="group__DataTypes.html#g1ceb59a5b485f8bcbcb8acad4cfb9323" title="Possible verbosity levels.">FC_VerbosityLevel</a> <a class="code" href="regionreassembler_8c.html#46e260e16f29333b3f475e879e4d8e70">verbose_level</a> = <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323b4443923870aca5048c4cfc22ce803c5">FC_QUIET</a>;
<a name="l00720"></a>00720   <span class="keywordtype">int</span> i,j,imesh;
<a name="l00721"></a>00721   
<a name="l00722"></a>00722   rc = <a class="code" href="screwBreaks_8c.html#8cfe3116e5212b2de2afc18796f93775">parser</a>(argc,argv, &amp;file_name, &amp;numscrewmeshes,&amp;screwmesh_names,
<a name="l00723"></a>00723            &amp;verbose_level, &amp;numdeathvars, &amp;deathvars, &amp;seg_dim);
<a name="l00724"></a>00724   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"can't parse args"</span>);
<a name="l00725"></a>00725 
<a name="l00726"></a>00726   <span class="comment">// init library and load dataset </span>
<a name="l00727"></a>00727   rc = <a class="code" href="group__Library.html#gc54575c50a63dd29c694c78315d8fcf2" title="Set the library verbosity level.">fc_setLibraryVerbosity</a>(verbose_level);
<a name="l00728"></a>00728   <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00729"></a>00729   rc = <a class="code" href="group__Library.html#g18b26962103ffc9596657386d55a93af" title="Setup Feature Characterization Library for use.">fc_initLibrary</a>();
<a name="l00730"></a>00730   <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00731"></a>00731   rc = <a class="code" href="group__FileIO.html#g77b8250a472752e14bda28962116a66b" title="Load a dataset and it&amp;#39;s members from a file.">fc_loadDataset</a>(file_name, &amp;dataset);
<a name="l00732"></a>00732   <span class="keywordflow">if</span> (rc!=<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00733"></a>00733     printf(<span class="stringliteral">"Failed to load dataset %s\n"</span>,file_name);
<a name="l00734"></a>00734     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to load dataset '%s'"</span>, file_name);
<a name="l00735"></a>00735   }
<a name="l00736"></a>00736   
<a name="l00737"></a>00737   <span class="comment">// Get number of meshes and mesh names</span>
<a name="l00738"></a>00738   rc = <a class="code" href="group__Mesh.html#gcb092c2c909dd536c0120830890a9f36" title="Get the meshes in a dataset.">fc_getMeshes</a>(dataset, &amp;numMesh, &amp;meshes);
<a name="l00739"></a>00739   <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(rc);
<a name="l00740"></a>00740 
<a name="l00741"></a>00741   <span class="comment">// Get the screw meshes</span>
<a name="l00742"></a>00742   screwmeshes = (<a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>*)malloc(numMesh*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>)); <span class="comment">// numMesh is max</span>
<a name="l00743"></a>00743   <span class="keywordflow">if</span> (!screwmeshes)
<a name="l00744"></a>00744     <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00745"></a>00745   <span class="keywordflow">if</span> (numscrewmeshes &gt; 0) {
<a name="l00746"></a>00746     <span class="keywordflow">for</span> (imesh = 0; imesh &lt; numscrewmeshes; imesh++) {
<a name="l00747"></a>00747       <a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a> *returnMeshes;
<a name="l00748"></a>00748       <span class="keywordtype">int</span> numReturnMeshes;
<a name="l00749"></a>00749       rc = <a class="code" href="group__Mesh.html#gb72987c2bf83a19f208df925bc8af86b" title="Get all meshes with a given name from the dataset.">fc_getMeshByName</a>(dataset, screwmesh_names[imesh], 
<a name="l00750"></a>00750                    &amp;numReturnMeshes,&amp;returnMeshes);
<a name="l00751"></a>00751       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get mesh by name"</span>);
<a name="l00752"></a>00752       <span class="keywordflow">if</span> (numReturnMeshes != 1){
<a name="l00753"></a>00753      <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Problems finding (unique) mesh '%s' - found %d matches"</span>,
<a name="l00754"></a>00754                     screwmesh_names[imesh],numReturnMeshes);
<a name="l00755"></a>00755       }
<a name="l00756"></a>00756       screwmeshes[imesh] = returnMeshes[0];
<a name="l00757"></a>00757       free(returnMeshes);
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759   }
<a name="l00760"></a>00760   <span class="keywordflow">else</span> {
<a name="l00761"></a>00761     <span class="keywordtype">char</span>* temp_name;
<a name="l00762"></a>00762     screwmesh_names = (<span class="keywordtype">char</span>**)malloc(numMesh*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00763"></a>00763     <span class="keywordflow">if</span> (!screwmesh_names)
<a name="l00764"></a>00764       <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00765"></a>00765     <span class="keywordflow">for</span> (imesh = 0; imesh &lt; numMesh; imesh++) {
<a name="l00766"></a>00766       rc = <a class="code" href="group__Mesh.html#g3d701a44941883311e4940d7d3b4146a" title="Return name of a mesh.">fc_getMeshName</a>(meshes[imesh], &amp;temp_name);
<a name="l00767"></a>00767       <span class="keywordflow">if</span> (<a class="code" href="screwBreaks_8c.html#75a1168f7a684a9f25cf579ff3354e77">hasScrewInStr</a>(temp_name)) {
<a name="l00768"></a>00768      screwmeshes[numscrewmeshes] = meshes[imesh];
<a name="l00769"></a>00769      screwmesh_names[numscrewmeshes] = temp_name;
<a name="l00770"></a>00770      numscrewmeshes++;
<a name="l00771"></a>00771       }
<a name="l00772"></a>00772       <span class="keywordflow">else</span> {
<a name="l00773"></a>00773      free(temp_name);
<a name="l00774"></a>00774       }
<a name="l00775"></a>00775     }
<a name="l00776"></a>00776     <span class="keywordflow">if</span> (numscrewmeshes &lt; 1) 
<a name="l00777"></a>00777       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>, 
<a name="l00778"></a>00778       <span class="stringliteral">"No meshes with 'screw' or 'scrw' in the name were found"</span>);
<a name="l00779"></a>00779   }
<a name="l00780"></a>00780   <span class="keywordflow">if</span> (numscrewmeshes &lt; numMesh) {
<a name="l00781"></a>00781     realloc(screwmeshes, numscrewmeshes*<span class="keyword">sizeof</span>(<a class="code" href="structFC__Mesh.html" title="Mesh Handle.">FC_Mesh</a>)); <span class="comment">// shrink to actual</span>
<a name="l00782"></a>00782   }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784   <span class="comment">// get the sequence</span>
<a name="l00785"></a>00785   rc = <a class="code" href="group__Sequence.html#g0ad1217500f245d78aaad5c79f960ba1" title="Get the sequences in a dataset.">fc_getSequences</a>(dataset, &amp;numSeq, &amp;sequences);
<a name="l00786"></a>00786   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to get sequences"</span>);
<a name="l00787"></a>00787   <span class="keywordflow">if</span> (numSeq &lt; 1) {
<a name="l00788"></a>00788     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>, <span class="stringliteral">"expecting at least one sequence"</span>);
<a name="l00789"></a>00789   }
<a name="l00790"></a>00790   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numSeq &gt; 1) {
<a name="l00791"></a>00791     <a class="code" href="group__Library.html#g160cfb8cb557ccf48fee07ae11e65482" title="Print a warning message to stdout.">fc_printfWarningMessage</a>(<span class="stringliteral">"Expected only 1 sequence not %d, will use "</span>
<a name="l00792"></a>00792                    <span class="stringliteral">"first one"</span>, numSeq);
<a name="l00793"></a>00793   }
<a name="l00794"></a>00794   sequence = sequences[0];
<a name="l00795"></a>00795   free(sequences);
<a name="l00796"></a>00796   
<a name="l00797"></a>00797   <span class="comment">// header</span>
<a name="l00798"></a>00798   printf(<span class="stringliteral">"Screw characterizations for dataset '%s'\n"</span>, file_name);
<a name="l00799"></a>00799   <span class="keywordflow">if</span> (numMesh &lt; 0) {
<a name="l00800"></a>00800     printf(<span class="stringliteral">"No meshes found\n"</span>);
<a name="l00801"></a>00801     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"No meshes were found\n"</span>);
<a name="l00802"></a>00802     exit(-1);
<a name="l00803"></a>00803   }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805   printf(<span class="stringliteral">"Sequence values:\n"</span>);
<a name="l00806"></a>00806   {
<a name="l00807"></a>00807     <span class="keywordtype">double</span>* coords;
<a name="l00808"></a>00808     rc = <a class="code" href="group__Sequence.html#g194ee559cc88eaefc57a556dbcd6b6cb" title="Get number of steps in a sequence.">fc_getSequenceNumStep</a>(sequence, &amp;numStep);
<a name="l00809"></a>00809     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to get sequence numStep"</span>);
<a name="l00810"></a>00810     rc = <a class="code" href="group__Sequence.html#gea571d126666a139232f8800e5abac0c" title="Get a copy of the sequence&amp;#39;s coords as the requested data type.">fc_getSequenceCoordsAsDataType</a>(sequence, <a class="code" href="group__DataTypes.html#ggcca24e957488bb76e40a84ea651975d9250e83e5dab9b5c1872f0f82665ff905">FC_DT_DOUBLE</a>, 
<a name="l00811"></a>00811                          (<span class="keywordtype">void</span>**)&amp;coords);
<a name="l00812"></a>00812     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"failed to get coords as double"</span>);
<a name="l00813"></a>00813     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++)
<a name="l00814"></a>00814       printf(<span class="stringliteral">"  Step %d: %g\n"</span>, i, coords[i]);
<a name="l00815"></a>00815     fflush(NULL);
<a name="l00816"></a>00816     free(coords);
<a name="l00817"></a>00817   }
<a name="l00818"></a>00818 
<a name="l00819"></a>00819   printf(<span class="stringliteral">"%d mesh(es):\n"</span>, numscrewmeshes);
<a name="l00820"></a>00820   fflush(NULL);
<a name="l00821"></a>00821   
<a name="l00822"></a>00822   <span class="keywordflow">for</span> (imesh = 0; imesh &lt; numscrewmeshes; imesh++){
<a name="l00823"></a>00823     <span class="keywordtype">char</span>* screwmesh_name = screwmesh_names[imesh];
<a name="l00824"></a>00824     <span class="keywordtype">int</span> numBrokePerStep[numStep];
<a name="l00825"></a>00825     <span class="keywordtype">int</span>* brokenScrewIDs[numStep];
<a name="l00826"></a>00826 
<a name="l00827"></a>00827     <span class="comment">// initialize summary info</span>
<a name="l00828"></a>00828     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00829"></a>00829       numBrokePerStep[i] = 0;
<a name="l00830"></a>00830       brokenScrewIDs[i] = NULL;
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     <span class="keywordflow">for</span> (i = 0; i &lt; numdeathvars; i++){
<a name="l00834"></a>00834       rc = <a class="code" href="group__Variable.html#g9022a4933230e252076467a05f101a68" title="Gets a unique seq var if it exists, otherwise generate it from components if possible...">fc_getOrGenerateUniqueSeqVariableByName</a>(screwmeshes[imesh], deathvars[i].name,
<a name="l00835"></a>00835                                  &amp;numStep, &amp;deathvars[i].elemdeath);
<a name="l00836"></a>00836       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to find element death variable '%s'"</span>,
<a name="l00837"></a>00837                   deathvars[i].name);
<a name="l00838"></a>00838       <span class="keywordflow">if</span> (!deathvars[i].elemdeath){
<a name="l00839"></a>00839      <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce464a3d55131c355cdf036f95d0d7e1a6e">FC_INPUT_ERROR</a>,
<a name="l00840"></a>00840                     <span class="stringliteral">"Failed to find element death variable '%s'"</span>,
<a name="l00841"></a>00841                     deathvars[i].name);
<a name="l00842"></a>00842       }
<a name="l00843"></a>00843     }
<a name="l00844"></a>00844     
<a name="l00845"></a>00845     rc = <a class="code" href="screwBreaks_8c.html#a3a7eb2e04c8951d8460e9b168c5b638">buildScrews</a>(screwmeshes[imesh],&amp;numScrews,&amp;screws);
<a name="l00846"></a>00846     <span class="keywordflow">if</span> (rc == 1) {
<a name="l00847"></a>00847       printf(<span class="stringliteral">"WARNING: Mesh %s does not look like screws and will be ignored\n"</span>,
<a name="l00848"></a>00848           screwmesh_names[imesh]);
<a name="l00849"></a>00849       <span class="keywordflow">continue</span>;
<a name="l00850"></a>00850     }
<a name="l00851"></a>00851     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"Cant build the screws"</span>);
<a name="l00852"></a>00852     
<a name="l00853"></a>00853 
<a name="l00854"></a>00854     printf(<span class="stringliteral">"Mesh %d: '%s' has %d screws\n"</span>, imesh, screwmesh_name, numScrews);
<a name="l00855"></a>00855     printf(<span class="stringliteral">"Screw bounding boxes at Step 0:\n"</span>);
<a name="l00856"></a>00856     <span class="keywordflow">for</span> (i = 0; i &lt; numScrews; i++) {
<a name="l00857"></a>00857       <span class="keywordtype">int</span> numDim;
<a name="l00858"></a>00858       <a class="code" href="group__SimpleDataObjects.html#gf0a2bdabac4a21b42f4b480baf9128d7" title="Coordinates data structure.">FC_Coords</a> lowers, uppers;
<a name="l00859"></a>00859       rc = <a class="code" href="group__GeometricRelations.html#gac16d03bbbd1911f25ef27a23cb57321" title="Compute bounding box of subset.">fc_getSubsetBoundingBox</a>(screws[i].whole, &amp;numDim, &amp;lowers, &amp;uppers);
<a name="l00860"></a>00860       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get screw bounding box"</span>);
<a name="l00861"></a>00861       printf(<span class="stringliteral">"  Screw %d: [ %g"</span>, i, lowers[0]);
<a name="l00862"></a>00862       <span class="keywordflow">for</span> (j = 1; j &lt; numDim; j++)
<a name="l00863"></a>00863      printf(<span class="stringliteral">", %g"</span>, lowers[j]);
<a name="l00864"></a>00864       printf(<span class="stringliteral">" ] - [ %g"</span>, uppers[0]);
<a name="l00865"></a>00865       <span class="keywordflow">for</span> (j = 1; j &lt; numDim; j++)
<a name="l00866"></a>00866      printf(<span class="stringliteral">", %g"</span>, uppers[j]);
<a name="l00867"></a>00867       printf(<span class="stringliteral">" ]\n"</span>);
<a name="l00868"></a>00868     }
<a name="l00869"></a>00869     fflush(NULL);
<a name="l00870"></a>00870     
<a name="l00871"></a>00871     <span class="comment">//------------------dead analysis----------------------------------//</span>
<a name="l00872"></a>00872     <span class="keywordflow">for</span> (j = 0; j &lt; numStep; j++){
<a name="l00873"></a>00873       <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> <a class="code" href="subsetter_8c.html#fcfbedec6ebde62c6a091ce335836ef1">threshold</a>;
<a name="l00874"></a>00874       <span class="keywordtype">int</span> num;
<a name="l00875"></a>00875       
<a name="l00876"></a>00876       <span class="comment">// break out if no unbroken or eroded screws left to check</span>
<a name="l00877"></a>00877       num = 0;
<a name="l00878"></a>00878       <span class="keywordflow">for</span> (i = 0; i &lt; numScrews; i++){
<a name="l00879"></a>00879      <span class="keywordflow">if</span> (!(screws[i].<a class="code" href="screwBreaks_8c.html#b1c7fa64d32d5bdaa3fbc07592fbae4c">broken</a> || screws[i].<a class="code" href="screwBreaks_8c.html#2b9de9602e69bbe7fcd9fc2e0780764c">eroded</a>)){
<a name="l00880"></a>00880        num = 1;
<a name="l00881"></a>00881        <span class="keywordflow">break</span>;
<a name="l00882"></a>00882      }
<a name="l00883"></a>00883       }
<a name="l00884"></a>00884       <span class="keywordflow">if</span> (num == 0){
<a name="l00885"></a>00885      <span class="keywordflow">break</span>;
<a name="l00886"></a>00886       }
<a name="l00887"></a>00887 
<a name="l00888"></a>00888       rc = <a class="code" href="screwBreaks_8c.html#adf7702dd1f9fc920beb85d7eecb9be2">getDeathThresholdSubset</a>(screwmeshes[imesh],numdeathvars,
<a name="l00889"></a>00889                        deathvars,j,&amp;threshold);
<a name="l00890"></a>00890       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc,<span class="stringliteral">"cant get death subset"</span>);
<a name="l00891"></a>00891       <span class="comment">//    fc_printSubset(threshold,"communal",0);</span>
<a name="l00892"></a>00892     
<a name="l00893"></a>00893       <span class="keywordflow">for</span> (i = 0; i &lt; numScrews; i++){
<a name="l00894"></a>00894      <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> deadscrew;
<a name="l00895"></a>00895      <span class="keywordtype">double</span> projArea;
<a name="l00896"></a>00896      <span class="keywordtype">int</span> broke = 0, erode = 0;
<a name="l00897"></a>00897      
<a name="l00898"></a>00898      <span class="keywordflow">if</span> (!screws[i].<a class="code" href="screwBreaks_8c.html#b1c7fa64d32d5bdaa3fbc07592fbae4c">broken</a> &amp;&amp; !screws[i].<a class="code" href="screwBreaks_8c.html#2b9de9602e69bbe7fcd9fc2e0780764c">eroded</a>){ 
<a name="l00899"></a>00899      
<a name="l00900"></a>00900        <span class="comment">//get the dead part of the screw at this time step</span>
<a name="l00901"></a>00901        rc = <a class="code" href="group__Subset.html#gebbcc05ef1a5287612b7767903e69b68" title="Create subset based on intersection of two input subsets.">fc_createSubsetIntersection</a>(threshold,<span class="stringliteral">"AND"</span>,screws[i].whole,<span class="stringliteral">"dead"</span>,
<a name="l00902"></a>00902                             &amp;deadscrew);
<a name="l00903"></a>00903        <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Cant get dead screw bits"</span>);
<a name="l00904"></a>00904        
<a name="l00905"></a>00905        rc = <a class="code" href="group__Subset.html#gdf7851470403bb379426110abf7923ba" title="Get number of members in a subset.">fc_getSubsetNumMember</a>(deadscrew,&amp;num);
<a name="l00906"></a>00906        <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Cant get num dead elements"</span>);
<a name="l00907"></a>00907        
<a name="l00908"></a>00908        
<a name="l00909"></a>00909        <span class="comment">//-------------------broken-------------------------------------//</span>
<a name="l00910"></a>00910        broke = <a class="code" href="screwBreaks_8c.html#b1c7fa64d32d5bdaa3fbc07592fbae4c">broken</a>(deadscrew, seg_dim, &amp;screws[i]);
<a name="l00911"></a>00911        
<a name="l00912"></a>00912        <span class="comment">//-------------------eroded-------------------------------------//</span>
<a name="l00913"></a>00913        <span class="keywordflow">if</span> (!screws[i].<a class="code" href="screwBreaks_8c.html#b1c7fa64d32d5bdaa3fbc07592fbae4c">broken</a>) {
<a name="l00914"></a>00914          erode = <a class="code" href="screwBreaks_8c.html#2b9de9602e69bbe7fcd9fc2e0780764c">eroded</a>(deadscrew,&amp;screws[i]);
<a name="l00915"></a>00915        }
<a name="l00916"></a>00916 
<a name="l00917"></a>00917        <span class="comment">//-------------------projection-------------------------------------//</span>
<a name="l00918"></a>00918        <span class="keywordflow">if</span> (!screws[i].broken &amp;&amp; !screws[i].eroded) {
<a name="l00919"></a>00919          projArea = <a class="code" href="screwBreaks_8c.html#66ee6b8635e75c477ac624a14428a299">projection</a>(deadscrew,screws[i]);
<a name="l00920"></a>00920        }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922        <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(deadscrew);
<a name="l00923"></a>00923      }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925      <span class="comment">// print results</span>
<a name="l00926"></a>00926      printf(<span class="stringliteral">"Mesh %-20s Screw %-3d Step %-3d "</span>, screwmesh_name, i, j);
<a name="l00927"></a>00927      <span class="keywordflow">if</span> (broke) {
<a name="l00928"></a>00928        printf(<span class="stringliteral">"First broken"</span>);
<a name="l00929"></a>00929      }
<a name="l00930"></a>00930      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (erode) {
<a name="l00931"></a>00931        printf(<span class="stringliteral">"First broken, side eroded"</span>);
<a name="l00932"></a>00932      }
<a name="l00933"></a>00933      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (screws[i].broken || screws[i].eroded) {
<a name="l00934"></a>00934        printf(<span class="stringliteral">"*** still broken ***"</span>);
<a name="l00935"></a>00935      } 
<a name="l00936"></a>00936      <span class="keywordflow">else</span> {
<a name="l00937"></a>00937        printf(<span class="stringliteral">"BR =%6.2f (%7.2f/%7.2f)"</span>,(projArea/screws[i].baseArea),projArea,
<a name="l00938"></a>00938            screws[i].baseArea);
<a name="l00939"></a>00939      }
<a name="l00940"></a>00940      printf(<span class="stringliteral">"\n"</span>);
<a name="l00941"></a>00941      
<a name="l00942"></a>00942      <span class="comment">// collect summary info</span>
<a name="l00943"></a>00943      <span class="keywordflow">if</span> (broke || erode) {
<a name="l00944"></a>00944        <span class="keywordtype">void</span>* temp;
<a name="l00945"></a>00945        temp = realloc(brokenScrewIDs[j], (numBrokePerStep[j]+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00946"></a>00946        <span class="keywordflow">if</span> (!temp) 
<a name="l00947"></a>00947          <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00948"></a>00948        brokenScrewIDs[j] = temp;
<a name="l00949"></a>00949        brokenScrewIDs[j][numBrokePerStep[j]] = i;
<a name="l00950"></a>00950        numBrokePerStep[j]++;
<a name="l00951"></a>00951      }
<a name="l00952"></a>00952 
<a name="l00953"></a>00953      <span class="comment">//diagnostic</span>
<a name="l00954"></a>00954      <span class="keywordflow">if</span> (0){
<a name="l00955"></a>00955        <span class="keywordflow">if</span> (screws[i].broken || screws[i].eroded){
<a name="l00956"></a>00956          <a class="code" href="screwBreaks_8c.html#1621cd96bc51df48516c7d24bbeff0c3">printScrew</a>(screws[i],screwmesh_name,i,1);
<a name="l00957"></a>00957        }
<a name="l00958"></a>00958      }
<a name="l00959"></a>00959 
<a name="l00960"></a>00960       } <span class="comment">//for each screw</span>
<a name="l00961"></a>00961       <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(threshold);
<a name="l00962"></a>00962     } <span class="comment">//for each timestep</span>
<a name="l00963"></a>00963 
<a name="l00964"></a>00964     <span class="comment">//final writeout    </span>
<a name="l00965"></a>00965     i = 0;
<a name="l00966"></a>00966     <span class="keywordflow">for</span> (j = 0; j &lt; numScrews; j++){
<a name="l00967"></a>00967       <span class="keywordflow">if</span> (screws[j].broken || screws[j].eroded){
<a name="l00968"></a>00968      i++;
<a name="l00969"></a>00969       }
<a name="l00970"></a>00970     }
<a name="l00971"></a>00971     printf(<span class="stringliteral">"Mesh %-20s Broken/Total screws: %d/%d\n"</span>,screwmesh_name, i,numScrews);
<a name="l00972"></a>00972     tscrews+=numScrews;
<a name="l00973"></a>00973     tscrewsbroken +=i;
<a name="l00974"></a>00974 
<a name="l00975"></a>00975     <span class="comment">// print summary info</span>
<a name="l00976"></a>00976     <span class="keywordflow">for</span> (i = 0; i &lt; numStep; i++) {
<a name="l00977"></a>00977       <span class="keywordflow">if</span> (numBrokePerStep[i] &gt; 0) {
<a name="l00978"></a>00978      printf(<span class="stringliteral">"  %d screw(s) broke at Step %d: %d"</span>, numBrokePerStep[i],
<a name="l00979"></a>00979             i, brokenScrewIDs[i][0]);
<a name="l00980"></a>00980      <span class="keywordflow">for</span> (j = 1; j &lt; numBrokePerStep[i]; j++)
<a name="l00981"></a>00981        printf(<span class="stringliteral">", %d"</span>, brokenScrewIDs[i][j]);
<a name="l00982"></a>00982      printf(<span class="stringliteral">"\n"</span>);
<a name="l00983"></a>00983      free(brokenScrewIDs[i]);
<a name="l00984"></a>00984       }
<a name="l00985"></a>00985     }
<a name="l00986"></a>00986 
<a name="l00987"></a>00987     <span class="comment">//cleanup after this mesh</span>
<a name="l00988"></a>00988     <span class="keywordflow">for</span> (i = 0; i &lt; numdeathvars; i++){ <span class="comment">//release the deathvar on this mesh</span>
<a name="l00989"></a>00989       <a class="code" href="group__Variable.html#gef5ebe119abe1d217a216f0faad0e667" title="Delete a sequence variable.">fc_deleteSeqVariable</a>(numStep,deathvars[i].elemdeath);
<a name="l00990"></a>00990       free(deathvars[i].elemdeath);
<a name="l00991"></a>00991     }
<a name="l00992"></a>00992     
<a name="l00993"></a>00993     <span class="keywordflow">for</span> (i = 0; i &lt; numScrews; i++){
<a name="l00994"></a>00994       <a class="code" href="group__Shape.html#gfb8474857a22e70a547b5e7875dc9c19" title="frees a Shape">fc_freeShape</a>(&amp;screws[i].shape);
<a name="l00995"></a>00995       <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(screws[i].whole);
<a name="l00996"></a>00996     }
<a name="l00997"></a>00997     free(screws);
<a name="l00998"></a>00998   }
<a name="l00999"></a>00999   printf(<span class="stringliteral">"All %d Mesh(es) %10s Broken/Total screws: %d/%d\n"</span>,numscrewmeshes,<span class="stringliteral">" "</span>,
<a name="l01000"></a>01000       tscrewsbroken,tscrews);
<a name="l01001"></a>01001 
<a name="l01002"></a>01002   <span class="comment">//clean up after all meshes</span>
<a name="l01003"></a>01003   free(meshes);
<a name="l01004"></a>01004   <span class="keywordflow">for</span> (i = 0; i &lt; numscrewmeshes; i++)
<a name="l01005"></a>01005     free(screwmesh_names[i]);
<a name="l01006"></a>01006   free(screwmesh_names);
<a name="l01007"></a>01007   <span class="comment">// deathvars[i].elemdeath has already been freed</span>
<a name="l01008"></a>01008   free(deathvars);      <span class="comment">//dont need to free name or op since assigned from argv </span>
<a name="l01009"></a>01009 
<a name="l01010"></a>01010   <span class="comment">// shut down</span>
<a name="l01011"></a>01011   <a class="code" href="group__Dataset.html#g34fa9d41751a903d238574a800456d78" title="Delete a dataset.">fc_deleteDataset</a>(dataset);
<a name="l01012"></a>01012   <a class="code" href="group__Library.html#g29ff0e41fb4f58b55489bc875ac32b2f" title="Cleanup when done using Feature Characterization Library.">fc_finalLibrary</a>();
<a name="l01013"></a>01013 
<a name="l01014"></a>01014   exit(0);
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6fb18051e7cbacebf794269fbf48714b"></a><!-- doxytag: member="screwBreaks.c::parseDeathVarSet" ref="6fb18051e7cbacebf794269fbf48714b" args="(int argc, char **argv, int *idx, int *numvars, deathvarinfo **deathvars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int parseDeathVarSet           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a> **&nbsp;</td>
          <td class="paramname"> <em>deathvars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00364">364</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00105">FC_ERROR</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00365"></a>00365                                             {
<a name="l00366"></a>00366   <span class="keywordtype">long</span> lcheck;
<a name="l00367"></a>00367   <span class="keywordtype">double</span> dcheck;
<a name="l00368"></a>00368   <span class="keywordtype">int</span> nvars;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370   <span class="keywordtype">char</span>* end_ptr;
<a name="l00371"></a>00371   <span class="keywordtype">int</span> i,j;
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="keywordflow">if</span> (*numvars !=0){
<a name="l00374"></a>00374     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: already have death vars"</span>);
<a name="l00375"></a>00375     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00376"></a>00376   }
<a name="l00377"></a>00377    
<a name="l00378"></a>00378 
<a name="l00379"></a>00379   i = *idx;
<a name="l00380"></a>00380   <span class="keywordflow">if</span> (argc &lt; *idx+1){
<a name="l00381"></a>00381     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: cant get num vars"</span>);
<a name="l00382"></a>00382     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>; <span class="comment">//cant get the num of vars</span>
<a name="l00383"></a>00383   }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385   lcheck =  strtol(argv[i], &amp;end_ptr,10);
<a name="l00386"></a>00386   <span class="keywordflow">if</span> (*end_ptr == <span class="charliteral">'\0'</span>){ <span class="comment">//its a number</span>
<a name="l00387"></a>00387     nvars = (int)lcheck;
<a name="l00388"></a>00388   }<span class="keywordflow">else</span> { <span class="comment">//not a number</span>
<a name="l00389"></a>00389     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00390"></a>00390   }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392   <span class="keywordflow">if</span> (nvars == 0){
<a name="l00393"></a>00393     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: no death vars"</span>);
<a name="l00394"></a>00394     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00395"></a>00395   }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="keywordflow">if</span> (argc &lt; i+3*nvars+1){
<a name="l00398"></a>00398     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: not enough args for num vars"</span>);
<a name="l00399"></a>00399     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00400"></a>00400   }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402   *deathvars = (<a class="code" href="structdeathvarinfo.html">deathvarinfo</a>*)malloc(nvars*<span class="keyword">sizeof</span>(<a class="code" href="structdeathvarinfo.html">deathvarinfo</a>));
<a name="l00403"></a>00403   <span class="keywordflow">if</span> (!deathvars){
<a name="l00404"></a>00404     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00405"></a>00405     <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>;
<a name="l00406"></a>00406   }
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   i++;
<a name="l00409"></a>00409   <span class="keywordflow">for</span>(j = 0; j &lt; nvars; j++){
<a name="l00410"></a>00410     (*deathvars)[j].name = argv[i++];
<a name="l00411"></a>00411     (*deathvars)[j].op = argv[i++];
<a name="l00412"></a>00412     dcheck =  strtod(argv[i++], &amp;end_ptr);
<a name="l00413"></a>00413     <span class="keywordflow">if</span> (*end_ptr == <span class="charliteral">'\0'</span>){ <span class="comment">//its a number</span>
<a name="l00414"></a>00414       (*deathvars)[j].val = dcheck;
<a name="l00415"></a>00415     } <span class="keywordflow">else</span>{
<a name="l00416"></a>00416       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid deathvar syntax: non-numerical value for cutoff"</span>);
<a name="l00417"></a>00417       <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4dfe7727a339a5a362cd2b90d81aeef76">FC_ERROR</a>;
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419   }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421   *numvars = nvars;           
<a name="l00422"></a>00422   *idx = i-1;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00425"></a>00425 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8cfe3116e5212b2de2afc18796f93775"></a><!-- doxytag: member="screwBreaks.c::parser" ref="8cfe3116e5212b2de2afc18796f93775" args="(int argc, char **argv, char **file_name, int *numscrewmeshes, char ***screwmesh_names, FC_VerbosityLevel *verbose_level, int *numdeathvars, deathvarinfo **deathvars, int *seg_dim)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int parser           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numscrewmeshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char ***&nbsp;</td>
          <td class="paramname"> <em>screwmesh_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DataTypes.html#g1ceb59a5b485f8bcbcb8acad4cfb9323">FC_VerbosityLevel</a> *&nbsp;</td>
          <td class="paramname"> <em>verbose_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numdeathvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a> **&nbsp;</td>
          <td class="paramname"> <em>deathvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>seg_dim</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00234">234</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="error_8h-source.html#l00080">fc_exitIfError</a>, <a class="el" href="base_8c-source.html#l00355">fc_getReturnCodeText()</a>, <a class="el" href="base_8h-source.html#l00084">FC_LOG_MESSAGES</a>, <a class="el" href="base_8h-source.html#l00106">FC_MEMORY_ERROR</a>, <a class="el" href="library_8h-source.html#l00120">fc_printfErrorMessage</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="base_8h-source.html#l00083">FC_WARNING_MESSAGES</a>, <a class="el" href="gaplines_8c-source.html#l00112">parseDeathVarSet()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00428">printDeathVarSet()</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00238"></a>00238                          {
<a name="l00239"></a>00239   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00240"></a>00240   <span class="keywordtype">char</span>** names;
<a name="l00241"></a>00241   <span class="keywordtype">int</span> i, j, nmesh;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243   <span class="comment">// handle arguments</span>
<a name="l00244"></a>00244   <span class="keywordflow">if</span> (argc &lt; 2){
<a name="l00245"></a>00245   usage:
<a name="l00246"></a>00246     printf(<span class="stringliteral">"Usage: %s  [options] file [screwmesh_name(s)]\n"</span>, 
<a name="l00247"></a>00247         argv[0]);
<a name="l00248"></a>00248     printf(<span class="stringliteral">"options: \n"</span>);
<a name="l00249"></a>00249     printf(<span class="stringliteral">"   -h            : print this help message\n"</span>);
<a name="l00250"></a>00250     printf(<span class="stringliteral">"   -v            : verbose: print warning and error messages\n"</span>);
<a name="l00251"></a>00251     printf(<span class="stringliteral">"   -V            : very verbose: prints log and error messages\n"</span>);
<a name="l00252"></a>00252     printf(<span class="stringliteral">"   -n            : number of vars that will specify element death\n"</span>);
<a name="l00253"></a>00253     printf(<span class="stringliteral">"                   followed by var_name, op, value triads. Default is\n"</span>);
<a name="l00254"></a>00254     printf(<span class="stringliteral">"                   Only 1 triad of \"elem_death\" &lt;= 0\n"</span>);
<a name="l00255"></a>00255     printf(<span class="stringliteral">"   -b seg_dim    : segmentation_dimension for determining breakage\n"</span>);
<a name="l00256"></a>00256     printf(<span class="stringliteral">"                   (default is 0)\n"</span>);
<a name="l00257"></a>00257     printf(<span class="stringliteral">"\n"</span>);
<a name="l00258"></a>00258     printf(<span class="stringliteral">"Examples:\n"</span>);
<a name="l00259"></a>00259     printf(<span class="stringliteral">"   ./screwBreaks -b 1 -n 2 elem_death \"&lt;=\" 0 elem_var_8 \"&gt;\" 0.1 ~wkoegle/Work/fcdmf/Data/screw-preload/d3plot Material_ID_1 \n"</span>);
<a name="l00260"></a>00260     printf(<span class="stringliteral">"   ./screwBreaks ~wkoegle/Work/fcdmf/Data/hatch_run1/d3plot\n"</span>);
<a name="l00261"></a>00261     printf(<span class="stringliteral">"   ./screwBreaks ~wkoegle/Work/fcdmf/Data/run30-EMMI-screws/d3plot Material_ID_25 Material_ID_49 &gt; junk; grep \"Screw 0\" junk\n"</span>);
<a name="l00262"></a>00262     printf(<span class="stringliteral">"   ./screwBreaks -n 1 damage \"&gt;=\" 0.5 ../data/gen_screws.ex2 \n"</span>);
<a name="l00263"></a>00263     printf(<span class="stringliteral">"\n"</span>);
<a name="l00264"></a>00264     printf(<span class="stringliteral">"Output: Prints Breakage Ratio and notification of when screws first break.\n"</span>);
<a name="l00265"></a>00265     printf(<span class="stringliteral">"\n"</span>);
<a name="l00266"></a>00266     printf(<span class="stringliteral">"Note: Screws can be normal screw shape or cylindrical etc. Only constraint is\n"</span>);
<a name="l00267"></a>00267     printf(<span class="stringliteral">"that they have an identifiable base for the Breakage Ratio calculation.\n"</span>);
<a name="l00268"></a>00268     exit(-1);
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 
<a name="l00272"></a>00272   nmesh = 0;
<a name="l00273"></a>00273   names = NULL;
<a name="l00274"></a>00274   <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {
<a name="l00275"></a>00275     <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-v"</span>)) {
<a name="l00276"></a>00276       *<a class="code" href="regionreassembler_8c.html#46e260e16f29333b3f475e879e4d8e70">verbose_level</a> = <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb9323d5f8d0b704dba62980776bac1283a741">FC_WARNING_MESSAGES</a>;
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-V"</span>)) {
<a name="l00279"></a>00279       *<a class="code" href="regionreassembler_8c.html#46e260e16f29333b3f475e879e4d8e70">verbose_level</a> = <a class="code" href="group__DataTypes.html#gg1ceb59a5b485f8bcbcb8acad4cfb932395535fc1e83f1faa426c80811de6c55e">FC_LOG_MESSAGES</a>;
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(argv[i], <span class="stringliteral">"-h"</span>, 2))
<a name="l00282"></a>00282       <span class="keywordflow">goto</span> usage;
<a name="l00283"></a>00283     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-n"</span>)) {      
<a name="l00284"></a>00284       i++;
<a name="l00285"></a>00285       rc = <a class="code" href="gaplines_8c.html#6fb18051e7cbacebf794269fbf48714b">parseDeathVarSet</a>(argc,argv,&amp;i, numdeathvars,deathvars);
<a name="l00286"></a>00286       <span class="keywordflow">if</span> (rc!= <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>){
<a name="l00287"></a>00287      <span class="keywordflow">goto</span> usage;
<a name="l00288"></a>00288       }
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">"-b"</span>)) {
<a name="l00291"></a>00291       i++;
<a name="l00292"></a>00292       <span class="keywordflow">if</span> (i &lt; argc){
<a name="l00293"></a>00293      *seg_dim = atoi(argv[i]);
<a name="l00294"></a>00294       }<span class="keywordflow">else</span>{
<a name="l00295"></a>00295      <span class="keywordflow">goto</span> usage;
<a name="l00296"></a>00296       }
<a name="l00297"></a>00297     }<span class="keywordflow">else</span>{ 
<a name="l00298"></a>00298       *<a class="code" href="subsetter_8c.html#8505c513bc640d1f69e5f76fb32b24a8">file_name</a> = argv[i];
<a name="l00299"></a>00299       <span class="comment">// optional mesh names</span>
<a name="l00300"></a>00300       <span class="keywordflow">for</span> (j = i+1; j &lt; argc; j++) {
<a name="l00301"></a>00301      <span class="keywordtype">void</span>* tmp;
<a name="l00302"></a>00302      <span class="keywordflow">if</span> (!strncmp(argv[j],<span class="stringliteral">"-"</span>,1))
<a name="l00303"></a>00303        <span class="keywordflow">break</span>;
<a name="l00304"></a>00304      tmp = (<span class="keywordtype">char</span>**)realloc(names, (nmesh+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l00305"></a>00305      <span class="keywordflow">if</span> (!tmp)
<a name="l00306"></a>00306        <a class="code" href="group__ErrorHandling.html#gcc9949110ba62c7ec8fabf7b455f1c0b" title="If the return code is an error, print diagnostic and exit.">fc_exitIfError</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>);
<a name="l00307"></a>00307      names = tmp;
<a name="l00308"></a>00308      names[nmesh] = (<span class="keywordtype">char</span>*)malloc((strlen(argv[j])+1)*<span class="keyword">sizeof</span>(char));
<a name="l00309"></a>00309      strcpy(names[nmesh], argv[j]);
<a name="l00310"></a>00310      nmesh++;
<a name="l00311"></a>00311      i++;
<a name="l00312"></a>00312       }
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314   }
<a name="l00315"></a>00315   *screwmesh_names = names;
<a name="l00316"></a>00316   *numscrewmeshes = nmesh;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   <span class="comment">// test args</span>
<a name="l00319"></a>00319   <span class="keywordflow">if</span> (!(*<a class="code" href="subsetter_8c.html#8505c513bc640d1f69e5f76fb32b24a8">file_name</a>))
<a name="l00320"></a>00320     <span class="keywordflow">goto</span> usage;
<a name="l00321"></a>00321   <span class="keywordflow">if</span> (*seg_dim &lt; 0 || *seg_dim &gt; 2){
<a name="l00322"></a>00322     <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"Invalid seg dim %d\n"</span>,*seg_dim);
<a name="l00323"></a>00323     exit(-1);
<a name="l00324"></a>00324   }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326   <span class="keywordflow">if</span> (*numdeathvars == 0){ <span class="comment">//default vals</span>
<a name="l00327"></a>00327     *numdeathvars = 1;
<a name="l00328"></a>00328     (*deathvars) = (<a class="code" href="structdeathvarinfo.html">deathvarinfo</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structdeathvarinfo.html">deathvarinfo</a>));
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (deathvars == NULL){
<a name="l00330"></a>00330       <a class="code" href="group__Library.html#g1473e77471cd1319f76eb9a32e4ad91f" title="Print an error message to stderr.">fc_printfErrorMessage</a>(<span class="stringliteral">"%s"</span>, <a class="code" href="group__DataTypes.html#g510d74cc1e13d4cdc5bde247a25d48e4" title="Return the name of the FC_ReturnCode&amp;#39;s value.">fc_getReturnCodeText</a>(<a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce4db79475c8e6c2fcf3e4e7979a4139658">FC_MEMORY_ERROR</a>));
<a name="l00331"></a>00331       exit(-1);
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333     (*deathvars)[0].name = <span class="stringliteral">"elem_death"</span>;
<a name="l00334"></a>00334     (*deathvars)[0].op = <span class="stringliteral">"&lt;="</span>;
<a name="l00335"></a>00335     (*deathvars[0]).val = 0;
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   <span class="keywordflow">if</span> (0){
<a name="l00339"></a>00339     <a class="code" href="screwBreaks_8c.html#3a579140fa9c0199f3b71eb4ebb8bfe3">printDeathVarSet</a>(*numdeathvars,*deathvars);
<a name="l00340"></a>00340   }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00343"></a>00343 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3a579140fa9c0199f3b71eb4ebb8bfe3"></a><!-- doxytag: member="screwBreaks.c::printDeathVarSet" ref="3a579140fa9c0199f3b71eb4ebb8bfe3" args="(int numvars, deathvarinfo *deathvars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int printDeathVarSet           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdeathvarinfo.html">deathvarinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>deathvars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00428">428</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, and <a class="el" href="subsetter_8c-source.html#l00108">op</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00234">parser()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00428"></a>00428                                                                  {
<a name="l00429"></a>00429   <span class="keywordtype">int</span> i; 
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   printf(<span class="stringliteral">"Deathvars (%d):\n"</span>,numvars);
<a name="l00432"></a>00432   <span class="keywordflow">for</span> (i = 0; i &lt; numvars; i++){
<a name="l00433"></a>00433     printf(<span class="stringliteral">"%s %s %12.4f\n"</span>,deathvars[i].name,deathvars[i].<a class="code" href="subsetter_8c.html#15206368e0a18f984f0ad6cb10c2995e">op</a>,
<a name="l00434"></a>00434         deathvars[i].val);
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00437"></a>00437 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1621cd96bc51df48516c7d24bbeff0c3"></a><!-- doxytag: member="screwBreaks.c::printScrew" ref="1621cd96bc51df48516c7d24bbeff0c3" args="(screwinfo screw, char *screwmeshname, int screwID, int verb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int printScrew           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscrewinfo.html">screwinfo</a>&nbsp;</td>
          <td class="paramname"> <em>screw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>screwmeshname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>screwID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>verb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00481">481</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="screwBreaks_8c-source.html#l00197">screwinfo::baseArea</a>, <a class="el" href="screwBreaks_8c-source.html#l00196">screwinfo::baseID</a>, <a class="el" href="screwBreaks_8c-source.html#l00198">screwinfo::baseNormal</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="subset_8c-source.html#l03173">fc_printSubset()</a>, <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>, <a class="el" href="shape_8h-source.html#l00087">FC_Shape::numSides</a>, and <a class="el" href="screwBreaks_8c-source.html#l00195">screwinfo::shape</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00481"></a>00481                                                                                   {
<a name="l00482"></a>00482   <span class="keywordtype">int</span> i;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   printf(<span class="stringliteral">"Mesh %20s Screw %d: numSides = %d, baseID = %d base area = %6.2f proj norm = (%3.2f, %3.2f, %3.2f)\n"</span>,
<a name="l00485"></a>00485       screwmeshname, screwID,screw.<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>,screw.<a class="code" href="structscrewinfo.html#776ea4d296026be64c5bf9d677539fec">baseID</a>,screw.<a class="code" href="structscrewinfo.html#759e5760604c7d5210ccf6c1344bcc29">baseArea</a>,
<a name="l00486"></a>00486       screw.<a class="code" href="structscrewinfo.html#516a7008a04f1eec88b28117d2eee8d2">baseNormal</a>[0],screw.<a class="code" href="structscrewinfo.html#516a7008a04f1eec88b28117d2eee8d2">baseNormal</a>[1],screw.<a class="code" href="structscrewinfo.html#516a7008a04f1eec88b28117d2eee8d2">baseNormal</a>[2]);
<a name="l00487"></a>00487   <span class="keywordflow">if</span> (verb){
<a name="l00488"></a>00488     <span class="keywordflow">for</span> (i = 0; i  &lt; screw.<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#c9ea723452fe6cd941e3abb06ac4aee3">numSides</a>; i++){
<a name="l00489"></a>00489       <span class="keywordflow">if</span> (i == screw.<a class="code" href="structscrewinfo.html#776ea4d296026be64c5bf9d677539fec">baseID</a>){
<a name="l00490"></a>00490      printf(<span class="stringliteral">"Side %d:\n"</span>,i);
<a name="l00491"></a>00491      <a class="code" href="group__Subset.html#g9e2ce19c0ca2d3f08df7f02643f82ce3" title="Print subset meta data to stdout, and optionally the member IDs.">fc_printSubset</a>(screw.<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[i],<span class="stringliteral">"faces"</span>,1);
<a name="l00492"></a>00492      <a class="code" href="group__Subset.html#g9e2ce19c0ca2d3f08df7f02643f82ce3" title="Print subset meta data to stdout, and optionally the member IDs.">fc_printSubset</a>(screw.<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[i],<span class="stringliteral">"elems"</span>,1);
<a name="l00493"></a>00493       }
<a name="l00494"></a>00494     }
<a name="l00495"></a>00495   }
<a name="l00496"></a>00496   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00497"></a>00497 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="66ee6b8635e75c477ac624a14428a299"></a><!-- doxytag: member="screwBreaks.c::projection" ref="66ee6b8635e75c477ac624a14428a299" args="(FC_Subset deadscrew, screwinfo screw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double projection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a>&nbsp;</td>
          <td class="paramname"> <em>deadscrew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscrewinfo.html">screwinfo</a>&nbsp;</td>
          <td class="paramname"> <em>screw</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00617">617</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="screwBreaks_8c-source.html#l00196">screwinfo::baseID</a>, <a class="el" href="screwBreaks_8c-source.html#l00198">screwinfo::baseNormal</a>, <a class="el" href="shape_8h-source.html#l00089">FC_Shape::elems</a>, <a class="el" href="shape_8h-source.html#l00088">FC_Shape::faces</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="elemdeath_8c-source.html#l00262">fc_getDecayedSkin()</a>, <a class="el" href="geom_8c-source.html#l04344">fc_getSubsetArea()</a>, <a class="el" href="subset_8c-source.html#l02828">fc_getSubsetNumMember()</a>, <a class="el" href="base_8h-source.html#l00319">FC_HANDLE_EQUIV</a>, <a class="el" href="base_8c-source.html#l00784">FC_NULL_SUBSET</a>, <a class="el" href="geom_8c-source.html#l01456">fc_projectedSubsetElementBoundingBoxIntersection()</a>, and <a class="el" href="screwBreaks_8c-source.html#l00195">screwinfo::shape</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00700">main()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00617"></a>00617                                                               {
<a name="l00618"></a>00618   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00619"></a>00619   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> maskedScrewBaseIDS;
<a name="l00620"></a>00620   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> decayedBase;
<a name="l00621"></a>00621   <span class="keywordtype">double</span> ret = 0.0;
<a name="l00622"></a>00622   <span class="keywordtype">int</span> num1;
<a name="l00623"></a>00623 
<a name="l00624"></a>00624   <span class="comment">//  fc_printSubset(deadscrew,"deadset",0);</span>
<a name="l00625"></a>00625   <span class="comment">//  fc_printSubset(screw.elems[screw.baseID],"screwbase",1);</span>
<a name="l00626"></a>00626   rc = <a class="code" href="group__Subset.html#gdf7851470403bb379426110abf7923ba" title="Get number of members in a subset.">fc_getSubsetNumMember</a>(deadscrew,&amp;num1);
<a name="l00627"></a>00627   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant get subset num members"</span>);
<a name="l00628"></a>00628   <span class="keywordflow">if</span> (num1){
<a name="l00629"></a>00629     rc = <a class="code" href="group__GeometricRelations.html#gc174efe624617b95287356b1b6bbecc8" title="Given a subset of elements ids and a reference subset of element ids, projects those...">fc_projectedSubsetElementBoundingBoxIntersection</a>(deadscrew,
<a name="l00630"></a>00630                                      screw.<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#840d2dfc7ec0e2c1a3624b94f5836679">elems</a>[screw.<a class="code" href="structscrewinfo.html#776ea4d296026be64c5bf9d677539fec">baseID</a>],
<a name="l00631"></a>00631                                      screw.<a class="code" href="structscrewinfo.html#516a7008a04f1eec88b28117d2eee8d2">baseNormal</a>,
<a name="l00632"></a>00632                                      &amp;maskedScrewBaseIDS);
<a name="l00633"></a>00633     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get projected BBox Intersection"</span>);
<a name="l00634"></a>00634     
<a name="l00635"></a>00635     <span class="comment">//Now we want the areas of the maskedIDS relative to the area of the</span>
<a name="l00636"></a>00636     <span class="comment">//full base.</span>
<a name="l00637"></a>00637     rc = <a class="code" href="group__ElemDeath.html#gcf6293155cfec71e92d3ef592bcb4b51" title="Get decayed skin.">fc_getDecayedSkin</a>(maskedScrewBaseIDS,&amp;screw.<a class="code" href="structscrewinfo.html#c9f523b2748910515fd73dabc0369c6f">shape</a>.<a class="code" href="structFC__Shape.html#d3057d72e60c8f7f024bf3770a6d7c74">faces</a>[screw.<a class="code" href="structscrewinfo.html#776ea4d296026be64c5bf9d677539fec">baseID</a>],
<a name="l00638"></a>00638                   &amp;decayedBase); <span class="comment">//go from elem-&gt;faces</span>
<a name="l00639"></a>00639     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get decayed skin"</span>);
<a name="l00640"></a>00640     <span class="keywordflow">if</span> (!<a class="code" href="group__Handles.html#g390004fca0870147d490f32c55afab8d" title="Check two handles for equality.">FC_HANDLE_EQUIV</a>(decayedBase,<a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>)){
<a name="l00641"></a>00641       rc = <a class="code" href="group__GeometricRelations.html#gfd4c940dc417f742e067c8a706cd5563" title="Returns a variable with the area of the subset.">fc_getSubsetArea</a>(decayedBase,&amp;ret);
<a name="l00642"></a>00642       <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"Failed to get areas"</span>);
<a name="l00643"></a>00643       <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(decayedBase);
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645     <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(maskedScrewBaseIDS);
<a name="l00646"></a>00646   }
<a name="l00647"></a>00647 
<a name="l00648"></a>00648   <span class="keywordflow">return</span> ret;
<a name="l00649"></a>00649 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7e195214c57db04d1ca65632302f8839"></a><!-- doxytag: member="screwBreaks.c::screwInit" ref="7e195214c57db04d1ca65632302f8839" args="(screwinfo *screw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int screwInit           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscrewinfo.html">screwinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>screw</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00466">466</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="base_8c-source.html#l00784">FC_NULL_SUBSET</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00466"></a>00466                                       {
<a name="l00467"></a>00467   (*screw).whole = <a class="code" href="group__Handles.html#gd007f5eb6e7e7f2febca17b53420fd15" title="Null (default) subset handle.">FC_NULL_SUBSET</a>;
<a name="l00468"></a>00468   <span class="comment">//shape gets allocation defaults</span>
<a name="l00469"></a>00469   (*screw).baseID = -1;
<a name="l00470"></a>00470   (*screw).baseArea = 0;
<a name="l00471"></a>00471   (*screw).baseNormal[0] = 0;
<a name="l00472"></a>00472   (*screw).baseNormal[1] = 0;
<a name="l00473"></a>00473   (*screw).baseNormal[2] = 0;
<a name="l00474"></a>00474   (*screw).broken = 0;
<a name="l00475"></a>00475   (*screw).eroded = 0;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00478"></a>00478 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5b2658e5dca1e6bdd3c5762e886e13d9"></a><!-- doxytag: member="screwBreaks.c::segmentMesh" ref="5b2658e5dca1e6bdd3c5762e886e13d9" args="(FC_Mesh mesh, int shared_dim, int *numsegs, FC_Subset **segs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int segmentMesh           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFC__Mesh.html">FC_Mesh</a>&nbsp;</td>
          <td class="paramname"> <em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shared_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>numsegs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFC__Subset.html">FC_Subset</a> **&nbsp;</td>
          <td class="paramname"> <em>segs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="screwBreaks_8c-source.html#l00439">439</a> of file <a class="el" href="screwBreaks_8c-source.html">screwBreaks.c</a>.</p>

<p>References <a class="el" href="subset_8c-source.html#l02008">fc_addMemberToSubset()</a>, <a class="el" href="base_8h-source.html#l00196">FC_AT_ELEMENT</a>, <a class="el" href="subset_8c-source.html#l00135">fc_createSubset()</a>, <a class="el" href="subset_8c-source.html#l02482">fc_deleteSubset()</a>, <a class="el" href="error_8h-source.html#l00116">fc_exitIfErrorPrintf</a>, <a class="el" href="mesh_8c-source.html#l03025">fc_getMeshNumElement()</a>, <a class="el" href="topo_8c-source.html#l01432">fc_segment()</a>, and <a class="el" href="base_8h-source.html#l00104">FC_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="screwBreaks_8c-source.html#l00500">buildScrews()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00440"></a>00440                                                 {
<a name="l00441"></a>00441   <a class="code" href="group__DataTypes.html#g2a40aa471d085988d5b582669f766ce4" title="Possible function return values.">FC_ReturnCode</a> rc;
<a name="l00442"></a>00442   <a class="code" href="structFC__Subset.html" title="Subset Handle.">FC_Subset</a> whole;
<a name="l00443"></a>00443   <span class="keywordtype">int</span> numMem;
<a name="l00444"></a>00444   <span class="keywordtype">int</span> k;
<a name="l00445"></a>00445 
<a name="l00446"></a>00446   rc = <a class="code" href="group__Mesh.html#g8bcadefbf0728724adf77ef52c1f3732" title="Returns number of elements in a mesh.">fc_getMeshNumElement</a>(mesh, &amp;numMem);
<a name="l00447"></a>00447   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant get mesh numelem"</span>);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449   rc = <a class="code" href="group__Subset.html#gccbfd6035cd0b949a4fac98888348e88" title="Create a new subset on a specified mesh.">fc_createSubset</a>(mesh, <span class="stringliteral">"whole"</span>, <a class="code" href="group__DataTypes.html#gg28b7cdba59395ddc988888d01dd19af690a2a90b49747de25e69b3bfdad27f4a">FC_AT_ELEMENT</a>, &amp;whole);
<a name="l00450"></a>00450   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant create whole mesh"</span>);
<a name="l00451"></a>00451 
<a name="l00452"></a>00452   <span class="keywordflow">for</span> (k = 0; k &lt; numMem; k++){
<a name="l00453"></a>00453     rc = <a class="code" href="group__Subset.html#g5ed37876a6f144458716efed8cb78dbe" title="Add member to a subset.">fc_addMemberToSubset</a>(whole,k);
<a name="l00454"></a>00454     <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant add member to subset"</span>);
<a name="l00455"></a>00455   }
<a name="l00456"></a>00456 
<a name="l00457"></a>00457   rc = <a class="code" href="group__TopologyRelations.html#g45c86dc9ebd4835c3f96efdf2a6003d9" title="Created separate connected components.">fc_segment</a>(whole, shared_dim,numsegs,segs);
<a name="l00458"></a>00458   <a class="code" href="error_8h.html#ed3cf62a82d02c561c0b9c80756fcab9">fc_exitIfErrorPrintf</a>(rc, <span class="stringliteral">"cant segment mesh"</span>);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <a class="code" href="group__Subset.html#g550d0636e4f35c29d6dbc427b3165a24" title="Delete a subset.">fc_deleteSubset</a>(whole);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462   <span class="keywordflow">return</span> <a class="code" href="group__DataTypes.html#gg2a40aa471d085988d5b582669f766ce46687acb19dbc2e15e6e89cdc39e8e18e">FC_SUCCESS</a>;
<a name="l00463"></a>00463 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Oct 27 13:26:12 2008 for FCLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
